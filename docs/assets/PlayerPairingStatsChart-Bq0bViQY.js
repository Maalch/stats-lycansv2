import{u as X,r as $,j as e}from"./index-qcnvDDF3.js";import{u as Y}from"./baseStatsHook-br_xh1LJ.js";import{u as J}from"./api-B4NWc1Vf.js";import{F as S,B as k,C as T,X as q,Y as F,a as z,b as L}from"./FullscreenChart-CoXXN0Ez.js";import{R as I,T as W}from"./CategoricalChart-28ZHlkGy.js";function Z(j){if(j.length===0)return null;const u={},h={};let c=0,P=0;j.forEach(l=>{const a=l.PlayerStats.filter(n=>n.MainRoleInitial==="Loup"),t=l.PlayerStats.filter(n=>n.MainRoleInitial==="Amoureux");if(a.length>=2){c++;for(let n=0;n<a.length;n++)for(let p=n+1;p<a.length;p++){const v=a[n].Username,m=a[p].Username,o=[v,m].sort().join(" & ");u[o]||(u[o]={appearances:0,wins:0,players:[v,m]}),u[o].appearances++,a[n].Victorious&&a[p].Victorious&&u[o].wins++}}if(t.length>=2){P++;for(let n=0;n<t.length;n+=2)if(n+1<t.length){const p=t[n].Username,v=t[n+1].Username,m=[p,v].sort().join(" & ");h[m]||(h[m]={appearances:0,wins:0,players:[p,v]}),h[m].appearances++,t[n].Victorious&&t[n+1].Victorious&&h[m].wins++}}});const y=Object.keys(u).map(l=>{const a=u[l],t=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:l,appearances:a.appearances,wins:a.wins,winRate:t,players:a.players}}),b=Object.keys(h).map(l=>{const a=h[l],t=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:l,appearances:a.appearances,wins:a.wins,winRate:t,players:a.players}});return y.sort((l,a)=>a.appearances-l.appearances),b.sort((l,a)=>a.appearances-l.appearances),{wolfPairs:{totalGames:c,pairs:y},loverPairs:{totalGames:P,pairs:b}}}function H(){const{data:j,isLoading:u,error:h}=Y(c=>Z(c));return{data:j,isLoading:u,error:h}}function ae(){const{navigateToGameDetails:j,navigationState:u,updateNavigationState:h}=X(),{data:c,isLoading:P,error:y}=H(),b=J(),[l,a]=$.useState(u.selectedPairingTab||"wolves"),[t,n]=$.useState(2),[p,v]=$.useState(1),m=[1,2,3,4,5];if(P)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(y)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",y]});if(!c)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const o=s=>b[s]||"#8884d8",G=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,w=s=>s.map(r=>{const[i,x]=r.players,d=o(i),B=o(x),D=G(r.pair);return e.jsxs("linearGradient",{id:D,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:d}),e.jsx("stop",{offset:"50%",stopColor:d}),e.jsx("stop",{offset:"50%",stopColor:B}),e.jsx("stop",{offset:"100%",stopColor:B})]},D)}),A=c.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:G(s.pair)})),N=c.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:G(s.pair)})),K=A.filter(s=>s.appearances>=t).length,M=N.filter(s=>s.appearances>=p).length,V=A.filter(s=>s.appearances>=2),E=N.filter(s=>s.appearances>=2),R=[...A].sort((s,r)=>r.appearances-s.appearances).slice(0,10),g=[...A].filter(s=>s.appearances>=t).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),C=[...N].sort((s,r)=>r.appearances-s.appearances).slice(0,10),f=[...N].filter(s=>s.appearances>=p).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),U=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:V.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),e.jsx(S,{title:"Paires de Loups les Plus Fréquentes",children:R.length>0?e.jsx("div",{style:{height:350},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs(k,{data:R,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:w(R)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Apparitions",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[x,d]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(x),borderRadius:"2px"}}),e.jsx("span",{children:x}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"appearances",name:"Apparitions",children:R.map((s,r)=>e.jsx(L,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"wolves"},fromComponent:"Paires de Loups les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-wolf-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-wolf-appearances-select",value:t,onChange:s=>n(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:m.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(S,{title:"Paires de Loups les Plus Performantes",children:[g.length>0?e.jsx("div",{style:{height:320},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs(k,{data:g,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:w(g)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[x,d]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(x),borderRadius:"2px"}}),e.jsx("span",{children:x}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]})]})}return null}}),e.jsx(z,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:g.map((s,r)=>e.jsx(L,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"wolves"},fromComponent:"Paires de Loups les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",g.length," des paires (sur ",K,") avec au moins ",t," apparition",t>1?"s":""]})]})]})]})]}),O=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:E.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),e.jsx(S,{title:"Paires d'Amoureux les Plus Fréquentes",children:C.length>0?e.jsx("div",{style:{height:350},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs(k,{data:C,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:w(C)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Apparitions",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[x,d]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(x),borderRadius:"2px"}}),e.jsx("span",{children:x}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"appearances",name:"Apparitions",children:C.map((s,r)=>e.jsx(L,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"lovers"},fromComponent:"Paires d'Amoureux les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-lover-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-lover-appearances-select",value:p,onChange:s=>v(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:m.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(S,{title:"Paires d'Amoureux les Plus Performantes",children:[f.length>0?e.jsx("div",{style:{height:320},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs(k,{data:f,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:w(f)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[x,d]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(x),borderRadius:"2px"}}),e.jsx("span",{children:x}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:o(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:f.map((s,r)=>e.jsx(L,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"lovers"},fromComponent:"Paires d'Amoureux les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",f.length," des paires (sur ",M,") avec au moins ",p," apparition",p>1?"s":""]})]})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${l==="wolves"?" active":""}`,onClick:()=>{a("wolves"),h({selectedPairingTab:"wolves"})},type:"button",children:["Paires de Loups (",c.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${l==="lovers"?" active":""}`,onClick:()=>{a("lovers"),h({selectedPairingTab:"lovers"})},type:"button",children:["Paires d'Amoureux (",c.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:l==="wolves"?U():O()})]})}export{ae as PlayerPairingStatsChart};
