import{u as Q,a as _,r as H,j as e}from"./index-CgrJ-tuH.js";import{u as ee}from"./baseStatsHook-B6lZipOh.js";import{u as se}from"./api-gO_uIFOk.js";import{F as T,B as W,C as q,X as I,Y as L,a as z,b as D}from"./FullscreenChart-DimugYiu.js";import{R as M,T as G}from"./CategoricalChart-BelCUvfp.js";function E(g,h,x=5){if(!h)return[];const o=g.filter(r=>r.players.includes(h));if(o.length===0)return[];const f=Math.max(...o.map(r=>r.appearances));return o.filter(r=>r.appearances===f).sort((r,d)=>parseFloat(d.winRate)-parseFloat(r.winRate)).slice(0,x)}function ae(g){if(g.length===0)return null;const h={},x={};let o=0,f=0;g.forEach(d=>{const t=d.PlayerStats.filter(n=>n.MainRoleInitial==="Loup"),p=d.PlayerStats.filter(n=>n.MainRoleInitial==="Amoureux");if(t.length>=2){o++;for(let n=0;n<t.length;n++)for(let y=n+1;y<t.length;y++){const u=t[n].Username,v=t[y].Username,j=[u,v].sort().join(" & ");h[j]||(h[j]={appearances:0,wins:0,players:[u,v]}),h[j].appearances++,t[n].Victorious&&t[y].Victorious&&h[j].wins++}}if(p.length>=2){f++;for(let n=0;n<p.length;n+=2)if(n+1<p.length){const y=p[n].Username,u=p[n+1].Username,v=[y,u].sort().join(" & ");x[v]||(x[v]={appearances:0,wins:0,players:[y,u]}),x[v].appearances++,p[n].Victorious&&p[n+1].Victorious&&x[v].wins++}}});const P=Object.keys(h).map(d=>{const t=h[d],p=t.appearances>0?(t.wins/t.appearances*100).toFixed(2):"0.00";return{pair:d,appearances:t.appearances,wins:t.wins,winRate:p,players:t.players}}),r=Object.keys(x).map(d=>{const t=x[d],p=t.appearances>0?(t.wins/t.appearances*100).toFixed(2):"0.00";return{pair:d,appearances:t.appearances,wins:t.wins,winRate:p,players:t.players}});return P.sort((d,t)=>t.appearances-d.appearances),r.sort((d,t)=>t.appearances-d.appearances),{wolfPairs:{totalGames:o,pairs:P},loverPairs:{totalGames:f,pairs:r}}}function re(){const{data:g,isLoading:h,error:x}=ee(o=>ae(o));return{data:g,isLoading:h,error:x}}function ce(){const{navigateToGameDetails:g,navigationState:h,updateNavigationState:x}=Q(),{data:o,isLoading:f,error:P}=re(),{settings:r}=_(),d=se(),[t,p]=H.useState(h.selectedPairingTab||"wolves"),[n,y]=H.useState(2),[u,v]=H.useState(1),j=[1,2,3,4,5];if(f)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(P)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",P]});if(!o)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const m=s=>d[s]||"#8884d8",b=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,A=s=>s.map(a=>{const[i,l]=a.players,c=m(i),K=m(l),V=b(a.pair);return e.jsxs("linearGradient",{id:V,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:c}),e.jsx("stop",{offset:"50%",stopColor:c}),e.jsx("stop",{offset:"50%",stopColor:K}),e.jsx("stop",{offset:"100%",stopColor:K})]},V)}),N=o.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),winRateDisplay:Math.max(parseFloat(s.winRate),1),gradientId:b(s.pair)})),C=o.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),winRateDisplay:Math.max(parseFloat(s.winRate),1),gradientId:b(s.pair)})),$=r.highlightedPlayer?E(o.wolfPairs.pairs,r.highlightedPlayer,5):[],B=r.highlightedPlayer?E(o.loverPairs.pairs,r.highlightedPlayer,5):[],O=N.filter(s=>s.appearances>=n).length,U=C.filter(s=>s.appearances>=u).length,X=N.filter(s=>s.appearances>=2),Y=C.filter(s=>s.appearances>=2),k=(s,a)=>{const i=new Map;return s.forEach(l=>{i.set(l.pair,{...l,isHighlightedAddition:!1})}),a.forEach(l=>{const c=i.get(l.pair);c?i.set(l.pair,{...c,winRateNum:parseFloat(c.winRate),winRateDisplay:Math.max(parseFloat(c.winRate),1),gradientId:b(c.pair)}):i.set(l.pair,{...l,winRateNum:parseFloat(l.winRate),winRateDisplay:Math.max(parseFloat(l.winRate),1),gradientId:b(l.pair),isHighlightedAddition:!0})}),Array.from(i.values())},S=k([...N].sort((s,a)=>a.appearances-s.appearances).slice(0,10),$),w=k([...N].filter(s=>s.appearances>=n).sort((s,a)=>a.winRateNum-s.winRateNum).slice(0,10),$.filter(s=>s.appearances>=n)),F=k([...C].sort((s,a)=>a.appearances-s.appearances).slice(0,10),B),R=k([...C].filter(s=>s.appearances>=u).sort((s,a)=>a.winRateNum-s.winRateNum).slice(0,10),B.filter(s=>s.appearances>=u)),J=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:X.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),e.jsx(T,{title:"Paires de Loups les Plus Fréquentes",children:S.length>0?e.jsx("div",{style:{height:350},children:e.jsx(M,{width:"100%",height:"100%",children:e.jsxs(W,{data:S,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:A(S)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(L,{label:{value:"Apparitions",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const i=a[0].payload,[l,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(l),borderRadius:"2px"}}),e.jsx("span",{children:l}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"appearances",name:"Apparitions",children:S.map((s,a)=>e.jsx(D,{fill:`url(#${s.gradientId})`,stroke:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?"var(--accent-primary)":s.isHighlightedAddition?"var(--accent-secondary)":"transparent",strokeWidth:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?3:s.isHighlightedAddition?2:0,onClick:()=>{g({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"wolves"},fromComponent:"Paires de Loups les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${a}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-wolf-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-wolf-appearances-select",value:n,onChange:s=>y(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:j.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(T,{title:"Paires de Loups les Plus Performantes",children:[w.length>0?e.jsx("div",{style:{height:320},children:e.jsx(M,{width:"100%",height:"100%",children:e.jsxs(W,{data:w,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:A(w)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(L,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const i=a[0].payload,[l,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(l),borderRadius:"2px"}}),e.jsx("span",{children:l}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]})]})}return null}}),e.jsx(z,{dataKey:"winRateDisplay",name:"Taux de victoire (%)",children:w.map((s,a)=>e.jsx(D,{fill:`url(#${s.gradientId})`,fillOpacity:parseFloat(s.winRate)===0?.3:1,stroke:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?"var(--accent-primary)":s.isHighlightedAddition?"var(--accent-secondary)":"transparent",strokeWidth:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?3:s.isHighlightedAddition?2:0,onClick:()=>{g({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"wolves"},fromComponent:"Paires de Loups les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${a}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",w.length," des paires (sur ",O,") avec au moins ",n," apparition",n>1?"s":""]})]})]})]})]}),Z=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:Y.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),e.jsx(T,{title:"Paires d'Amoureux les Plus Fréquentes",children:F.length>0?e.jsx("div",{style:{height:350},children:e.jsx(M,{width:"100%",height:"100%",children:e.jsxs(W,{data:F,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:A(F)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(L,{label:{value:"Apparitions",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const i=a[0].payload,[l,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(l),borderRadius:"2px"}}),e.jsx("span",{children:l}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"appearances",name:"Apparitions",children:F.map((s,a)=>e.jsx(D,{fill:`url(#${s.gradientId})`,stroke:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?"var(--accent-primary)":s.isHighlightedAddition?"var(--accent-secondary)":"transparent",strokeWidth:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?3:s.isHighlightedAddition?2:0,onClick:()=>{g({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"lovers"},fromComponent:"Paires d'Amoureux les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${a}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-lover-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-lover-appearances-select",value:u,onChange:s=>v(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:j.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(T,{title:"Paires d'Amoureux les Plus Performantes",children:[R.length>0?e.jsx("div",{style:{height:320},children:e.jsx(M,{width:"100%",height:"100%",children:e.jsxs(W,{data:R,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx("defs",{children:A(R)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(L,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const i=a[0].payload,[l,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(l),borderRadius:"2px"}}),e.jsx("span",{children:l}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:m(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"winRateDisplay",name:"Taux de victoire (%)",children:R.map((s,a)=>e.jsx(D,{fill:`url(#${s.gradientId})`,fillOpacity:parseFloat(s.winRate)===0?.3:1,stroke:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?"var(--accent-primary)":s.isHighlightedAddition?"var(--accent-secondary)":"transparent",strokeWidth:r.highlightedPlayer&&s.players.includes(r.highlightedPlayer)?3:s.isHighlightedAddition?2:0,onClick:()=>{g({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"lovers"},fromComponent:"Paires d'Amoureux les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${a}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",R.length," des paires (sur ",U,") avec au moins ",u," apparition",u>1?"s":""]})]})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${t==="wolves"?" active":""}`,onClick:()=>{p("wolves"),x({selectedPairingTab:"wolves"})},type:"button",children:["Paires de Loups (",o.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${t==="lovers"?" active":""}`,onClick:()=>{p("lovers"),x({selectedPairingTab:"lovers"})},type:"button",children:["Paires d'Amoureux (",o.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:t==="wolves"?J():Z()})]})}export{ce as PlayerPairingStatsChart};
