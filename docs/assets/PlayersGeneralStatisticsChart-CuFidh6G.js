import{r as o,u as J,j as r}from"./index-KHtRvJ0q.js";import{u as H}from"./usePlayerStatsFromRaw-CWT4XLYd.js";import{u as Q,m as U}from"./api-D4ZBPiXz.js";import{c as Z,r as _,F as N,B as k,C as L,X as W,Y as D,a as I,b as M}from"./FullscreenChart-DtoSkgBF.js";import{u as ee,a as re,r as te,b as ae,c as ie,d as A,s as ne,e as se,f as B,g as le,h as oe,L as ce,i as de,j as ue,k as V,l as q,R as z,T as G}from"./CategoricalChart-DfWDIJFa.js";import"./baseStatsHook-lTW925Va.js";function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),i.push.apply(i,n)}return i}function X(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?K(Object(i),!0).forEach(function(n){E(e,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))})}return e}function E(e,t,i){return(t=me(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function me(e){var t=xe(e,"string");return typeof t=="symbol"?t:t+""}function xe(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},C.apply(null,arguments)}var ye=(e,t)=>{var i;return o.isValidElement(e)?i=o.cloneElement(e,t):typeof e=="function"?i=e(t):i=o.createElement("line",C({},t,{className:"recharts-reference-line-line"})),i},pe=(e,t,i,n,u,p,x,O,c)=>{var{x:m,y:h,width:g,height:f}=u;if(i){var{y:j}=c,y=e.y.apply(j,{position:p});if(V(y)||c.ifOverflow==="discard"&&!e.y.isInRange(y))return null;var a=[{x:m+g,y},{x:m,y}];return O==="left"?a.reverse():a}if(t){var{x:l}=c,s=e.x.apply(l,{position:p});if(V(s)||c.ifOverflow==="discard"&&!e.x.isInRange(s))return null;var b=[{x:s,y:h+f},{x:s,y:h}];return x==="top"?b.reverse():b}if(n){var{segment:R}=c,P=R.map(v=>e.apply(v,{position:p}));return c.ifOverflow==="discard"&&P.some(v=>!e.isInRange(v))?null:P}return null};function he(e){var t=ee();return o.useEffect(()=>(t(re(e)),()=>{t(te(e))})),null}function fe(e){var{x:t,y:i,segment:n,xAxisId:u,yAxisId:p,shape:x,className:O,ifOverflow:c}=e,m=ae(),h=ie(),g=A(S=>ne(S,u)),f=A(S=>se(S,p)),j=A(S=>B(S,"xAxis",u,m)),y=A(S=>B(S,"yAxis",p,m)),a=le(),l=q(t),s=q(i);if(!h||!a||g==null||f==null||j==null||y==null)return null;var b=Z({x:j,y}),R=n&&n.length===2,P=pe(b,l,s,R,a,e.position,g.orientation,f.orientation,e);if(!P)return null;var[{x:v,y:d},{x:w,y:F}]=P,Y=c==="hidden"?"url(#".concat(h,")"):void 0,$=X(X({clipPath:Y},oe(e,!0)),{},{x1:v,y1:d,x2:w,y2:F});return o.createElement(ce,{className:de("recharts-reference-line",O)},ye(x,$),ue.renderCallByParent(e,_({x1:v,y1:d,x2:w,y2:F})))}function ve(e){return o.createElement(o.Fragment,null,o.createElement(he,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),o.createElement(fe,e))}class T extends o.Component{render(){return o.createElement(ve,this.props)}}E(T,"displayName","ReferenceLine");E(T,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Oe(){const{data:e,isLoading:t,error:i}=H(),{navigateToGameDetails:n}=J(),[u,p]=o.useState(50),[x,O]=o.useState("best"),[c,m]=o.useState(null),h=Q(),{participationData:g,winRateData:f,averageWinRate:j,totalEligiblePlayers:y}=o.useMemo(()=>{if(!e?.playerStats)return{participationData:[],winRateData:[],averageWinRate:"0",totalEligiblePlayers:0};const a=e.playerStats,l=[],s=[];let b=0;for(const d of a)b+=parseFloat(d.winPercent),d.gamesPlayed>=u&&l.push(d),d.gamesPlayed>2&&s.push(d);const R=a.length>0?(b/a.length).toFixed(1):"0",P=s.sort((d,w)=>w.gamesPlayed-d.gamesPlayed).slice(0,20),v=l.sort((d,w)=>x==="best"?parseFloat(w.winPercent)-parseFloat(d.winPercent):parseFloat(d.winPercent)-parseFloat(w.winPercent)).slice(0,20);return{participationData:P,winRateData:v,averageWinRate:R,totalEligiblePlayers:l.length}},[e,u,x]);return t?r.jsx("div",{className:"donnees-attente",children:"R√©cup√©ration des statistiques des joueurs..."}):i?r.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",i]}):e?r.jsxs("div",{className:"lycans-players-stats",children:[r.jsx("h2",{children:"Statistiques des Joueurs"}),r.jsxs("p",{className:"lycans-stats-info",children:["Total de ",e.totalGames," parties analys√©es avec ",e.playerStats.length," joueurs"]}),r.jsxs("div",{className:"lycans-graphiques-groupe",children:[r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsx("h3",{children:"Top Participations"}),r.jsx(N,{title:"Top Participations",children:r.jsx("div",{style:{height:400},children:r.jsx(z,{width:"100%",height:"100%",children:r.jsxs(k,{data:g,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(L,{strokeDasharray:"3 3"}),r.jsx(W,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(D,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),r.jsx(G,{content:({active:a,payload:l})=>{if(a&&l&&l.length>0){const s=l[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:s.player})}),r.jsxs("div",{children:["Parties jou√©es : ",s.gamesPlayed]}),r.jsxs("div",{children:["Pourcentage : ",s.gamesPlayedPercent,"%"]}),r.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),r.jsx(I,{dataKey:"gamesPlayed",name:"Parties jou√©es",fill:"#00C49F",children:g.map(a=>r.jsx(M,{fill:h[a.player]||"#00C49F",stroke:c===a.player?"var(--text-primary)":"none",strokeWidth:c===a.player?2:0,onClick:()=>{n({selectedPlayer:a.player,fromComponent:"Statistiques Joueurs"})},onMouseEnter:()=>m(a.player),onMouseLeave:()=>m(null),style:{cursor:"pointer"}},`cell-participation-${a.player}`))})]})})})})]}),r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[r.jsx("h3",{children:x==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),r.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),r.jsx("select",{id:"min-games-select",value:u,onChange:a=>p(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:U.map(a=>r.jsx("option",{value:a,children:a},a))}),r.jsxs("select",{value:x,onChange:a=>O(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[r.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),r.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),r.jsx(N,{title:x==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire",children:r.jsx("div",{style:{height:400},children:r.jsx(z,{width:"100%",height:"100%",children:r.jsxs(k,{data:f,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(L,{strokeDasharray:"3 3"}),r.jsx(W,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(D,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),r.jsx(G,{content:({active:a,payload:l})=>{if(a&&l&&l.length>0){const s=l[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:s.player})}),r.jsxs("div",{children:["Taux de victoire : ",s.winPercent,"%"]}),r.jsxs("div",{children:["Victoires : ",s.wins," / ",s.gamesPlayed]}),r.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),r.jsx(I,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:f.map(a=>r.jsx(M,{fill:h[a.player]||"#8884d8",stroke:c===a.player?"var(--text-primary)":"none",strokeWidth:c===a.player?2:0,onClick:()=>{n({selectedPlayer:a.player,selectedPlayerWinMode:"wins-only",fromComponent:"Taux de Victoire"})},onMouseEnter:()=>m(a.player),onMouseLeave:()=>m(null),style:{cursor:"pointer"}},`cell-winrate-${a.player}`))}),r.jsx(T,{y:parseFloat(j),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${j}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})})}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",f.length," des joueurs (sur ",y," ayant au moins ",u," partie",u>1?"s":"",")"]})]})]})]}):r.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e de joueur disponible"})}export{Oe as PlayersGeneralStatisticsChart};
