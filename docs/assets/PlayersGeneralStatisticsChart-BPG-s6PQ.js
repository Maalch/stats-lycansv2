import{r as o,j as e}from"./index-BMzbn9yu.js";import{u as _}from"./usePlayerStats-YA1ReNTu.js";import{p as T,m as J,l as H,g as Q}from"./api-BkgNdDCZ.js";import{u as U,a as Z,r as ee,b as re,c as ae,d as O,s as te,e as se,f as k,g as ie,h as ne,i as le,L as ce,j as oe,k as de,l as ue,m as B,n as M,R as A,B as K,C as V,X as W,Y as q,T as R,o as G,p as C}from"./BarChart-BE9TxMrF.js";import{P as me,a as xe}from"./PieChart-CvvSoc0Q.js";import{L as pe}from"./Legend-mjvCPVWC.js";function $(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(p){return Object.getOwnPropertyDescriptor(r,p).enumerable})),i.push.apply(i,l)}return i}function z(r){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?$(Object(i),!0).forEach(function(l){D(r,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(i,l))})}return r}function D(r,t,i){return(t=he(t))in r?Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[t]=i,r}function he(r){var t=ye(r,"string");return typeof t=="symbol"?t:t+""}function ye(r,t){if(typeof r!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var l=i.call(r,t);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function N(){return N=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)({}).hasOwnProperty.call(i,l)&&(r[l]=i[l])}return r},N.apply(null,arguments)}var ve=(r,t)=>{var i;return o.isValidElement(r)?i=o.cloneElement(r,t):typeof r=="function"?i=r(t):i=o.createElement("line",N({},t,{className:"recharts-reference-line-line"})),i},ge=(r,t,i,l,p,d,w,v,m)=>{var{x:g,y:h,width:y,height:f}=p;if(i){var{y:S}=m,u=r.y.apply(S,{position:d});if(B(u)||m.ifOverflow==="discard"&&!r.y.isInRange(u))return null;var j=[{x:g+y,y:u},{x:g,y:u}];return v==="left"?j.reverse():j}if(t){var{x:P}=m,a=r.x.apply(P,{position:d});if(B(a)||m.ifOverflow==="discard"&&!r.x.isInRange(a))return null;var s=[{x:a,y:h+f},{x:a,y:h}];return w==="top"?s.reverse():s}if(l){var{segment:n}=m,c=n.map(x=>r.apply(x,{position:d}));return m.ifOverflow==="discard"&&c.some(x=>!r.isInRange(x))?null:c}return null};function fe(r){var t=U();return o.useEffect(()=>(t(Z(r)),()=>{t(ee(r))})),null}function je(r){var{x:t,y:i,segment:l,xAxisId:p,yAxisId:d,shape:w,className:v,ifOverflow:m}=r,g=re(),h=ae(),y=O(b=>te(b,p)),f=O(b=>se(b,d)),S=O(b=>k(b,"xAxis",p,g)),u=O(b=>k(b,"yAxis",d,g)),j=ie(),P=M(t),a=M(i);if(!h||!j||y==null||f==null||S==null||u==null)return null;var s=ne({x:S,y:u}),n=l&&l.length===2,c=ge(s,P,a,n,j,r.position,y.orientation,f.orientation,r);if(!c)return null;var[{x,y:F},{x:I,y:L}]=c,X=m==="hidden"?"url(#".concat(h,")"):void 0,Y=z(z({clipPath:X},le(r,!0)),{},{x1:x,y1:F,x2:I,y2:L});return o.createElement(ce,{className:oe("recharts-reference-line",v)},ve(w,Y),de.renderCallByParent(r,ue({x1:x,y1:F,x2:I,y2:L})))}function be(r){return o.createElement(o.Fragment,null,o.createElement(fe,{yAxisId:r.yAxisId,xAxisId:r.xAxisId,ifOverflow:r.ifOverflow,x:r.x,y:r.y}),o.createElement(je,r))}class E extends o.Component{render(){return o.createElement(be,this.props)}}D(E,"displayName","ReferenceLine");D(E,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Ce(){const{playerStatsData:r,dataLoading:t,fetchError:i}=_(),[l,p]=o.useState(null),[d,w]=o.useState(50),[v,m]=o.useState("best");if(t)return e.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques des joueurs..."});if(i)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",i]});if(!r)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de joueur disponible"});const g=r.playerStats.filter(a=>a.gamesPlayed>=d).length,h=r.playerStats.filter(a=>a.gamesPlayed>2).sort((a,s)=>s.gamesPlayed-a.gamesPlayed).slice(0,20),y=r.playerStats.filter(a=>a.gamesPlayed>=d).sort((a,s)=>v==="best"?parseFloat(s.winPercent)-parseFloat(a.winPercent):parseFloat(a.winPercent)-parseFloat(s.winPercent)).slice(0,20),f=r.playerStats.length>0?(r.playerStats.reduce((a,s)=>a+parseFloat(s.winPercent),0)/r.playerStats.length).toFixed(1):"0",u=l?(a=>{const s=r.playerStats.find(n=>n.player===a);return s?Object.entries(s.camps).filter(([n,c])=>c>0).map(([n,c])=>({name:n,value:c,percentage:(c/s.gamesPlayed*100).toFixed(1)})):[]})(l):[],j=5,P=o.useMemo(()=>{if(!u.length)return[];let a=0;const s=[],n=[];return u.forEach(c=>{parseFloat(c.percentage)<j?(a+=Number(c.value),s.push(c)):n.push(c)}),a>0&&n.push({name:"Autres",value:a,percentage:(a/u.reduce((c,x)=>c+Number(x.value),0)*100).toFixed(1),_details:s}),n},[u]);return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques des Joueurs"}),e.jsxs("p",{className:"lycans-stats-info",children:["Total de ",r.totalGames," parties analysées avec ",r.playerStats.length," joueurs"]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Top Participations"}),e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(K,{data:h,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(q,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),e.jsx(R,{content:({active:a,payload:s})=>{if(a&&s&&s.length>0){const n=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:n.player})}),e.jsxs("div",{children:["Parties jouées : ",n.gamesPlayed]}),e.jsxs("div",{children:["Pourcentage : ",n.gamesPlayedPercent,"%"]})]})}return null}}),e.jsx(G,{dataKey:"gamesPlayed",name:"Parties jouées",fill:"#00C49F",children:h.map(a=>e.jsx(C,{fill:T[a.player]||"#00C49F",onClick:()=>p(a.player),style:{cursor:"pointer"}},`cell-participation-${a.player}`))})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:v==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),e.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:d,onChange:a=>w(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:J.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsxs("select",{value:v,onChange:a=>m(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[e.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),e.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(K,{data:y,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(q,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(R,{content:({active:a,payload:s})=>{if(a&&s&&s.length>0){const n=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:n.player})}),e.jsxs("div",{children:["Taux de victoire : ",n.winPercent,"%"]}),e.jsxs("div",{children:["Victoires : ",n.wins," / ",n.gamesPlayed]})]})}return null}}),e.jsx(G,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:y.map(a=>e.jsx(C,{fill:T[a.player]||"#8884d8",onClick:()=>p(a.player),style:{cursor:"pointer"}},`cell-winrate-${a.player}`))}),e.jsx(E,{y:parseFloat(f),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${f}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",y.length," des joueurs (sur ",g," ayant au moins ",d," partie",d>1?"s":"",")"]})]})]}),l&&e.jsxs("div",{className:"lycans-graphique-section lycans-joueur-details",children:[e.jsxs("h3",{children:["Distribution des Camps - ",l]}),e.jsx("div",{style:{height:300},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(me,{children:[e.jsx(xe,{data:P,cx:"50%",cy:"50%",labelLine:!0,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:a,percentage:s})=>a==="Autres"?"Autres":`${a}: ${s}%`,children:P.map((a,s)=>e.jsx(C,{fill:a.name==="Autres"?"#cccccc":H[a.name]||Q(a.name)},`cell-${s}`))}),e.jsx(R,{content:({active:a,payload:s})=>{if(a&&s&&s.length>0){const n=s[0].payload;return n.name==="Autres"&&n._details?e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:"Autres"})}),e.jsx("div",{children:n._details.map((c,x)=>e.jsxs("div",{children:[c.name,": ",c.value," parties (",c.percentage,"%)"]},x))}),e.jsxs("div",{style:{marginTop:4,fontWeight:"bold"},children:["Total: ",n.value," parties (",n.percentage,"%)"]})]}):e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:n.name})}),e.jsxs("div",{children:[n.value," parties (",n.percentage,"%)"]})]})}return null}}),e.jsx(pe,{})]})})})]})]})}export{Ce as PlayersGeneralStatisticsChart};
