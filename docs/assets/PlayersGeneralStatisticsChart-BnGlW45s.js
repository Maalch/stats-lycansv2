import{r as c,u as H,j as r}from"./index-BnMfkUOW.js";import{u as Q}from"./usePlayerStatsFromRaw-20HiONon.js";import{p as N,m as U}from"./api-beq3FXpM.js";import{c as Z,r as _,F as k,B as L,C as W,X as D,Y as I,a as M,b as B}from"./FullscreenChart-CzTQQWrz.js";import{u as ee,a as re,r as te,b as ae,c as ie,d as R,s as ne,e as se,f as V,g as le,h as oe,L as ce,i as de,j as ue,k as q,l as z,R as G,T as K}from"./CategoricalChart-DbTomGcB.js";import"./baseStatsHook-B7Qeo-jQ.js";function X(e,a){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),i.push.apply(i,n)}return i}function Y(e){for(var a=1;a<arguments.length;a++){var i=arguments[a]!=null?arguments[a]:{};a%2?X(Object(i),!0).forEach(function(n){C(e,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):X(Object(i)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))})}return e}function C(e,a,i){return(a=me(a))in e?Object.defineProperty(e,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[a]=i,e}function me(e){var a=xe(e,"string");return typeof a=="symbol"?a:a+""}function xe(e,a){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var n=i.call(e,a);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function A(){return A=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},A.apply(null,arguments)}var ye=(e,a)=>{var i;return c.isValidElement(e)?i=c.cloneElement(e,a):typeof e=="function"?i=e(a):i=c.createElement("line",A({},a,{className:"recharts-reference-line-line"})),i},pe=(e,a,i,n,u,p,x,S,d)=>{var{x:m,y:f,width:h,height:v}=u;if(i){var{y:P}=d,t=e.y.apply(P,{position:p});if(q(t)||d.ifOverflow==="discard"&&!e.y.isInRange(t))return null;var s=[{x:m+h,y:t},{x:m,y:t}];return S==="left"?s.reverse():s}if(a){var{x:o}=d,y=e.x.apply(o,{position:p});if(q(y)||d.ifOverflow==="discard"&&!e.x.isInRange(y))return null;var w=[{x:y,y:f+v},{x:y,y:f}];return x==="top"?w.reverse():w}if(n){var{segment:O}=d,g=O.map(l=>e.apply(l,{position:p}));return d.ifOverflow==="discard"&&g.some(l=>!e.isInRange(l))?null:g}return null};function fe(e){var a=ee();return c.useEffect(()=>(a(re(e)),()=>{a(te(e))})),null}function he(e){var{x:a,y:i,segment:n,xAxisId:u,yAxisId:p,shape:x,className:S,ifOverflow:d}=e,m=ae(),f=ie(),h=R(b=>ne(b,u)),v=R(b=>se(b,p)),P=R(b=>V(b,"xAxis",u,m)),t=R(b=>V(b,"yAxis",p,m)),s=le(),o=z(a),y=z(i);if(!f||!s||h==null||v==null||P==null||t==null)return null;var w=Z({x:P,y:t}),O=n&&n.length===2,g=pe(w,o,y,O,s,e.position,h.orientation,v.orientation,e);if(!g)return null;var[{x:l,y:j},{x:T,y:F}]=g,$=d==="hidden"?"url(#".concat(f,")"):void 0,J=Y(Y({clipPath:$},oe(e,!0)),{},{x1:l,y1:j,x2:T,y2:F});return c.createElement(ce,{className:de("recharts-reference-line",S)},ye(x,J),ue.renderCallByParent(e,_({x1:l,y1:j,x2:T,y2:F})))}function ve(e){return c.createElement(c.Fragment,null,c.createElement(fe,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),c.createElement(he,e))}class E extends c.Component{render(){return c.createElement(ve,this.props)}}C(E,"displayName","ReferenceLine");C(E,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Oe(){const{data:e,isLoading:a,error:i}=Q(),{navigateToGameDetails:n}=H(),[u,p]=c.useState(50),[x,S]=c.useState("best"),[d,m]=c.useState(null),{participationData:f,winRateData:h,averageWinRate:v,totalEligiblePlayers:P}=c.useMemo(()=>{if(!e?.playerStats)return{participationData:[],winRateData:[],averageWinRate:"0",totalEligiblePlayers:0};const t=e.playerStats,s=[],o=[];let y=0;for(const l of t)y+=parseFloat(l.winPercent),l.gamesPlayed>=u&&s.push(l),l.gamesPlayed>2&&o.push(l);const w=t.length>0?(y/t.length).toFixed(1):"0",O=o.sort((l,j)=>j.gamesPlayed-l.gamesPlayed).slice(0,20),g=s.sort((l,j)=>x==="best"?parseFloat(j.winPercent)-parseFloat(l.winPercent):parseFloat(l.winPercent)-parseFloat(j.winPercent)).slice(0,20);return{participationData:O,winRateData:g,averageWinRate:w,totalEligiblePlayers:s.length}},[e,u,x]);return a?r.jsx("div",{className:"donnees-attente",children:"R√©cup√©ration des statistiques des joueurs..."}):i?r.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",i]}):e?r.jsxs("div",{className:"lycans-players-stats",children:[r.jsx("h2",{children:"Statistiques des Joueurs"}),r.jsxs("p",{className:"lycans-stats-info",children:["Total de ",e.totalGames," parties analys√©es avec ",e.playerStats.length," joueurs"]}),r.jsxs("div",{className:"lycans-graphiques-groupe",children:[r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsx("h3",{children:"Top Participations"}),r.jsx(k,{title:"Top Participations",children:r.jsx("div",{style:{height:400},children:r.jsx(G,{width:"100%",height:"100%",children:r.jsxs(L,{data:f,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(W,{strokeDasharray:"3 3"}),r.jsx(D,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(I,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),r.jsx(K,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:o.player})}),r.jsxs("div",{children:["Parties jou√©es : ",o.gamesPlayed]}),r.jsxs("div",{children:["Pourcentage : ",o.gamesPlayedPercent,"%"]}),r.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),r.jsx(M,{dataKey:"gamesPlayed",name:"Parties jou√©es",fill:"#00C49F",children:f.map(t=>r.jsx(B,{fill:N[t.player]||"#00C49F",stroke:d===t.player?"var(--text-primary)":"none",strokeWidth:d===t.player?2:0,onClick:()=>{n({selectedPlayer:t.player,fromComponent:"Statistiques Joueurs"})},onMouseEnter:()=>m(t.player),onMouseLeave:()=>m(null),style:{cursor:"pointer"}},`cell-participation-${t.player}`))})]})})})})]}),r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[r.jsx("h3",{children:x==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),r.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),r.jsx("select",{id:"min-games-select",value:u,onChange:t=>p(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:U.map(t=>r.jsx("option",{value:t,children:t},t))}),r.jsxs("select",{value:x,onChange:t=>S(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[r.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),r.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),r.jsx(k,{title:x==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire",children:r.jsx("div",{style:{height:400},children:r.jsx(G,{width:"100%",height:"100%",children:r.jsxs(L,{data:h,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(W,{strokeDasharray:"3 3"}),r.jsx(D,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(I,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),r.jsx(K,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:o.player})}),r.jsxs("div",{children:["Taux de victoire : ",o.winPercent,"%"]}),r.jsxs("div",{children:["Victoires : ",o.wins," / ",o.gamesPlayed]}),r.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),r.jsx(M,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:h.map(t=>r.jsx(B,{fill:N[t.player]||"#8884d8",stroke:d===t.player?"var(--text-primary)":"none",strokeWidth:d===t.player?2:0,onClick:()=>{n({selectedPlayer:t.player,selectedPlayerWinMode:"wins-only",fromComponent:"Taux de Victoire"})},onMouseEnter:()=>m(t.player),onMouseLeave:()=>m(null),style:{cursor:"pointer"}},`cell-winrate-${t.player}`))}),r.jsx(E,{y:parseFloat(v),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${v}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})})}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",h.length," des joueurs (sur ",P," ayant au moins ",u," partie",u>1?"s":"",")"]})]})]})]}):r.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e de joueur disponible"})}export{Oe as PlayersGeneralStatisticsChart};
