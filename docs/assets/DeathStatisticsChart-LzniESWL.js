import{u as pe,r as C,c as ye,a as ve,j as e}from"./index-BO2AfKk_.js";import{u as se}from"./baseStatsHook-DVKLu8Tn.js";import{D as a,g as z}from"./datasyncExport-Drm4NSNA.js";import{c as te,a as xe,m as ae}from"./api-LqeNNpKV.js";import{F as H,B as U,C as G,X as W,Y,a as q}from"./FullscreenChart-CQ7BX0aw.js";import{R as w,T as $}from"./CategoricalChart-Dw_qhkFN.js";function fe(S){const y=new Set;S.filter(c=>!c.LegacyData||c.LegacyData.deathInformationFilled===!0).forEach(c=>{c.PlayerStats.forEach(F=>{const V=z(F.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});y.add(V)})});const i=Array.from(y);return[...te.filter(c=>i.includes(c)),...i.filter(c=>!te.includes(c)).sort()]}function re(S){switch(S){case a.SURVIVOR:return"Survivant";case a.VOTED:return"Mort aux votes";case a.BY_WOLF:return"Tué par un loup";case a.BY_WOLF_REZ:return"Tué par un loup ressuscité";case a.BY_WOLF_LOVER:return"Tué par un loup amoureux";case a.BY_ZOMBIE:return"Tué par un zombie";case a.BY_BEAST:return"Dévoré par la Bête";case a.BY_AVATAR_CHAIN:return"Mort liée à l'Avatar";case a.BULLET:return"Abattu par un chasseur";case a.BULLET_HUMAN:return"Tué par un chasseur en humain";case a.BULLET_WOLF:return"Tué par un chasseur en loup";case a.BULLET_BOUNTYHUNTER:return"Tué par un chasseur de primes";case a.SHERIF:return"Abattu par le Shérif";case a.OTHER_AGENT:return"Éliminé par l'Agent";case a.AVENGER:return"Tué par un vengeur";case a.SEER:return"Rôle deviné par un loup";case a.HANTED:return"Tué par une potion hantée";case a.ASSASSIN:return"Tué par une potion (Assassin)";case a.LOVER_DEATH:return"Mort par amoureux";case a.LOVER_DEATH_OWN:return"Tué par son amoureux";case a.BOMB:return"Mort dans une explosion";case a.CRUSHED:return"Écrasé";case a.STARVATION:return"Mort de faim";case a.STARVATION_AS_BEAST:return"Mort bestiale";case a.FALL:return"Mort de chute";case a.UNKNOWN:default:return"Mort inconnue"}}function ie(S){switch(S){case a.SURVIVOR:return"Survivant";case a.VOTED:return"Mort aux votes";case a.BY_WOLF:return"Kill en Loup";case a.BY_WOLF_REZ:return"Kill en Loup ressuscité";case a.BY_WOLF_LOVER:return"Kill en Loup amoureux";case a.BY_ZOMBIE:return"Kill en Zombie";case a.BY_BEAST:return"Kill en Bête";case a.BY_AVATAR_CHAIN:return"Mort d'Avatar";case a.BULLET:return"Tir de Chasseur";case a.BULLET_HUMAN:return"Kill en Chasseur (sur humain)";case a.BULLET_WOLF:return"Kill en Chasseur (sur loup)";case a.BULLET_BOUNTYHUNTER:return"Kill en Chasseur de primes";case a.SHERIF:return"Kill en Shérif";case a.OTHER_AGENT:return"Kill en Agent";case a.AVENGER:return"Kill en Vengeur";case a.SEER:return"Kill en Devin";case a.HANTED:return"Kill avec Potion hantée";case a.ASSASSIN:return"Kill avec Potion (Assassin)";case a.LOVER_DEATH:return"Kill de son amoureux";case a.LOVER_DEATH_OWN:return"Kill de son propre amoureux";case a.BOMB:return"Explosion";case a.CRUSHED:return"Écrasement";case a.STARVATION:return"Famine";case a.STARVATION_AS_BEAST:return"Tuerie bestiale";case a.FALL:return"Chute mortelle";case a.UNKNOWN:default:return"Kill inconnu"}}function Se(S){const y=new Set;S.forEach(u=>{u.PlayerStats.forEach(c=>{c.DeathType&&c.DeathType!==a.SURVIVOR&&c.DeathType!==""&&y.add(c.DeathType)})});const x=Array.from(y),i=[a.BY_WOLF,a.VOTED,a.BULLET,a.BULLET_HUMAN,a.BULLET_WOLF,a.BY_ZOMBIE,a.ASSASSIN,a.AVENGER,a.LOVER_DEATH,a.SURVIVOR];return[...i.filter(u=>x.includes(u)),...x.filter(u=>!i.includes(u)).sort()]}function Te(S,y){return S.PlayerStats.filter(x=>x.DeathType&&x.DeathType!==a.SURVIVOR&&x.DeathType!==""&&(x.DeathTiming||x.DeathType)).map(x=>{let i=null;if(x.KillerName){const u=S.PlayerStats.find(c=>c.Username===x.KillerName);u&&(i=z(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1}),u.MainRoleFinal&&u.MainRoleFinal!==u.MainRoleInitial&&(u.MainRoleFinal==="Loup"?i="Loup":u.MainRoleFinal==="Zombie"&&(i="Vaudou")))}return{playerName:x.Username,deathType:x.DeathType,killerName:x.KillerName,killerCamp:i}}).filter(x=>{if(!y||y==="Tous les camps")return!0;const i=S.PlayerStats.find(c=>c.Username===x.playerName);return i?z(i.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===y:!1})}function je(S,y){const x=[];return S.PlayerStats.forEach(i=>{if(i.KillerName&&i.DeathType){if(i.DeathType===a.SURVIVOR||i.DeathType===a.VOTED||i.DeathType===a.STARVATION||i.DeathType===a.FALL||i.DeathType===a.BY_AVATAR_CHAIN||i.DeathType==="")return;const u=S.PlayerStats.find(F=>F.Username===i.KillerName);if(!u)return;let c=z(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});u.MainRoleFinal&&u.MainRoleFinal!==u.MainRoleInitial&&(u.MainRoleFinal==="Loup"?c="Loup":u.MainRoleFinal==="Zombie"&&(c="Vaudou")),x.push({killerName:i.KillerName,victimName:i.Username,deathType:i.DeathType,killerCamp:c})}}),y&&y!=="Tous les camps"?x.filter(i=>i.killerCamp===y):x}function De(S,y){if(S.length===0)return null;const x=S.filter(m=>!m.LegacyData||m.LegacyData.deathInformationFilled===!0);if(x.length===0)return null;const i=[],u={};x.forEach(m=>{Te(m,y).forEach(j=>{i.push({...j,gameId:m.Id})}),m.PlayerStats.forEach(j=>{const k=j.Username;(!y||y==="Tous les camps"||z(j.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===y)&&(u[k]=(u[k]||0)+1)})});const c=i.length,F=x.length,V=F>0?c/F:0,P={};i.forEach(m=>{P[m.deathType]=(P[m.deathType]||0)+1});const I=Object.entries(P).map(([m,p])=>({type:m,count:p||0,percentage:c>0?(p||0)/c*100:0})).sort((m,p)=>p.count-m.count),M={};x.forEach(m=>{je(m,y).forEach(j=>{M[j.killerName]||(M[j.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),M[j.killerName].kills++,M[j.killerName].victims.add(j.victimName),M[j.killerName].killsByDeathType[j.deathType]=(M[j.killerName].killsByDeathType[j.deathType]||0)+1})});const K=Object.entries(M).map(([m,p])=>{const j=u[m]||0,k=j>0?p.kills/j:0;return{killerName:m,kills:p.kills,victims:Array.from(p.victims),percentage:c>0?p.kills/c*100:0,gamesPlayed:j,averageKillsPerGame:k,killsByDeathType:p.killsByDeathType}}).sort((m,p)=>p.kills-m.kills),n={};i.forEach(m=>{n[m.playerName]||(n[m.playerName]={totalDeaths:0,deathsByType:{},killedBy:{},deathDays:[]});const p=n[m.playerName];p.totalDeaths++,p.deathsByType[m.deathType]=(p.deathsByType[m.deathType]||0)+1,m.killerName&&(p.killedBy[m.killerName]=(p.killedBy[m.killerName]||0)+1)});const O=Object.entries(n).map(([m,p])=>({playerName:m,totalDeaths:p.totalDeaths,deathsByType:p.deathsByType,killedBy:p.killedBy,averageDeathDay:p.deathDays.length>0?p.deathDays.reduce((j,k)=>j+k,0)/p.deathDays.length:null,deathRate:u[m]>0?p.totalDeaths/u[m]:0})).sort((m,p)=>p.totalDeaths-m.totalDeaths),T=I.length>0?I[0].type:null,N=K.length>0?K[0].killerName:null;return{totalDeaths:c,totalGames:F,averageDeathsPerGame:V,deathsByType:I,killerStats:K,playerDeathStats:O,mostCommonDeathType:T,mostDeadlyKiller:N}}function Ae(S){return se(y=>De(y,S))}function Pe(){return se(S=>fe(S))}function ke(){const{navigateToGameDetails:S,navigationState:y,updateNavigationState:x}=pe(),[i,u]=C.useState(y.deathStatisticsState?.selectedCamp||y.deathStatsSelectedCamp||"Tous les camps"),[c,F]=C.useState(y.deathStatisticsState?.minGamesForAverage||10),{data:V}=Pe(),{data:P,isLoading:I,error:M}=Ae(i),{data:K}=ye(),{settings:n}=ve(),O=xe();C.useEffect(()=>{(!y.deathStatisticsState||y.deathStatisticsState.selectedCamp!==i||y.deathStatisticsState.minGamesForAverage!==c)&&x({deathStatisticsState:{selectedCamp:i,minGamesForAverage:c,focusChart:y.deathStatisticsState?.focusChart}})},[i,c,y.deathStatisticsState,x]);const T=C.useMemo(()=>K?Se(K):[],[K]),N=C.useMemo(()=>{const t={};T.forEach(r=>{r===a.BY_WOLF||r===a.BY_WOLF_REZ||r===a.BY_WOLF_LOVER?t[r]=O.Loup:r===a.VOTED?t[r]="var(--chart-color-1)":r===a.BULLET||r===a.BULLET_BOUNTYHUNTER||r===a.BULLET_HUMAN||r===a.BULLET_WOLF?t[r]=O.Chasseur:r===a.BY_ZOMBIE?t[r]=O.Vaudou:r===a.ASSASSIN?t[r]=O.Alchimiste:r===a.AVENGER?t[r]="var(--chart-color-2)":r===a.LOVER_DEATH||r===a.LOVER_DEATH_OWN?t[r]=O.Amoureux:r===a.BY_BEAST?t[r]="var(--chart-color-3)":r===a.SURVIVOR?t[r]="var(--chart-color-4)":r===a.SHERIF&&(t[r]="var(--chart-color-5)")});const d=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let o=0;return T.forEach(r=>{t[r]||(t[r]=d[o%d.length],o++)}),t},[T,O]),m=t=>{u(t),x({deathStatsSelectedCamp:t,deathStatisticsState:{selectedCamp:t,minGamesForAverage:c,focusChart:y.deathStatisticsState?.focusChart}})},p=t=>{F(t),x({deathStatisticsState:{selectedCamp:i,minGamesForAverage:t,focusChart:y.deathStatisticsState?.focusChart}})},{totalKillsData:j,averageKillsData:k,highlightedPlayerAddedToTotal:X,highlightedPlayerAddedToAverage:le,gamesWithKillers:ne,totalEligibleForAverage:oe}=C.useMemo(()=>{if(!P)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1,gamesWithKillers:0,totalEligibleForAverage:0};const t=P.killerStats.sort((l,v)=>v.kills-l.kills).slice(0,15),d=n.highlightedPlayer&&t.some(l=>l.killerName===n.highlightedPlayer),o=t.map(l=>{const v={name:l.killerName,value:l.kills,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!1};return T.forEach(A=>{v[A]=l.killsByDeathType[A]||0}),v});let r=!1;if(n.highlightedPlayer&&!d){const l=P.killerStats.find(v=>v.killerName===n.highlightedPlayer);if(l){const v={name:l.killerName,value:l.kills,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!0};T.forEach(A=>{v[A]=l.killsByDeathType[A]||0}),o.push(v),r=!0}}const D=P.killerStats.filter(l=>l.gamesPlayed>=c),B=D.sort((l,v)=>v.averageKillsPerGame-l.averageKillsPerGame).slice(0,15),E=n.highlightedPlayer&&B.some(l=>l.killerName===n.highlightedPlayer),g=B.map(l=>{const v={name:l.killerName,value:l.averageKillsPerGame,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!1};return T.forEach(A=>{const _=l.killsByDeathType[A]||0;v[A]=l.gamesPlayed>0?_/l.gamesPlayed:0}),v});let R=!1;if(n.highlightedPlayer&&!E){const l=P.killerStats.find(v=>v.killerName===n.highlightedPlayer);if(l){const v={name:l.killerName,value:l.averageKillsPerGame,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!0};T.forEach(A=>{const _=l.killsByDeathType[A]||0;v[A]=l.gamesPlayed>0?_/l.gamesPlayed:0}),g.push(v),R=!0}}return{totalKillsData:o,averageKillsData:g,highlightedPlayerAddedToTotal:r,highlightedPlayerAddedToAverage:R,gamesWithKillers:P.totalGames,totalEligibleForAverage:D.length}},[P,n.highlightedPlayer,c,T]),{totalDeathsData:Q,survivalRateData:ee,highlightedPlayerAddedToDeaths:ce,highlightedPlayerAddedToSurvival:he}=C.useMemo(()=>{if(!P||!K)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const t={},d=K.filter(s=>!s.LegacyData||s.LegacyData.deathInformationFilled===!0);d.forEach(s=>{s.PlayerStats.forEach(h=>{const f=h.Username;(!i||i==="Tous les camps"||z(h.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===i)&&(t[f]=(t[f]||0)+1)})});const o=P.playerDeathStats.sort((s,h)=>h.totalDeaths-s.totalDeaths).slice(0,15),r=n.highlightedPlayer&&o.some(s=>s.playerName===n.highlightedPlayer),D=o.map(s=>{const h=t[s.playerName]||0,f=h>0?(h-s.totalDeaths)/h*100:0,b={name:s.playerName,value:s.totalDeaths,totalDeaths:s.totalDeaths,gamesPlayed:h,deathRate:s.deathRate,survivalRate:f,isHighlightedAddition:!1};return T.forEach(L=>{b[L]=s.deathsByType[L]||0}),b});let B=!1;if(n.highlightedPlayer&&!r){const s=P.playerDeathStats.find(h=>h.playerName===n.highlightedPlayer);if(s){const h=t[s.playerName]||0,f=h>0?(h-s.totalDeaths)/h*100:0,b={name:s.playerName,value:s.totalDeaths,totalDeaths:s.totalDeaths,gamesPlayed:h,deathRate:s.deathRate,survivalRate:f,isHighlightedAddition:!0};T.forEach(L=>{b[L]=s.deathsByType[L]||0}),D.push(b),B=!0}}const E={},g={};d.forEach(s=>{s.PlayerStats.forEach(h=>{const f=h.Username;if((!i||i==="Tous les camps"||z(h.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===i)&&h.DeathType&&h.DeathType!=="N/A"){g[f]||(g[f]={totalDeaths:0,deathsByType:{}}),g[f].totalDeaths++;const L=h.DeathType;g[f].deathsByType[L]=(g[f].deathsByType[L]||0)+1}})}),Object.entries(t).forEach(([s,h])=>{if(h>=c){const f=g[s],b=f?f.totalDeaths:0,L=f?f.deathsByType:{},Z=h>0?(h-b)/h*100:0,J=h>0?b/h:0;E[s]={playerName:s,totalDeaths:b,deathsByType:L,gamesPlayed:h,survivalRate:Z,deathRate:J}}});const l=Object.values(E).sort((s,h)=>h.survivalRate-s.survivalRate).slice(0,15),v=n.highlightedPlayer&&l.some(s=>s.playerName===n.highlightedPlayer),A=l.map(s=>{const h={name:s.playerName,value:s.survivalRate,totalDeaths:s.totalDeaths,gamesPlayed:s.gamesPlayed,deathRate:s.deathRate,survivalRate:s.survivalRate,isHighlightedAddition:!1};return T.forEach(f=>{const b=s.deathsByType[f]||0;h[f]=s.gamesPlayed>0?b/s.gamesPlayed*100:0}),h});let _=!1;if(n.highlightedPlayer&&!v){let s=E[n.highlightedPlayer];if(!s){const h=t[n.highlightedPlayer]||0,f=g[n.highlightedPlayer],b=f?f.totalDeaths:0,L=f?f.deathsByType:{},Z=h>0?(h-b)/h*100:0,J=h>0?b/h:0;s={playerName:n.highlightedPlayer,totalDeaths:b,deathsByType:L,gamesPlayed:h,survivalRate:Z,deathRate:J}}if(s){const h={name:s.playerName,value:s.survivalRate,totalDeaths:s.totalDeaths,gamesPlayed:s.gamesPlayed,deathRate:s.deathRate,survivalRate:s.survivalRate,isHighlightedAddition:!0};T.forEach(f=>{const b=s.deathsByType[f]||0;h[f]=s.gamesPlayed>0?b/s.gamesPlayed*100:0}),A.push(h),_=!0}}return{totalDeathsData:D,survivalRateData:A,highlightedPlayerAddedToDeaths:B,highlightedPlayerAddedToSurvival:_}},[P,K,n.highlightedPlayer,c,T,i]);if(I)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."});if(M)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",M]});if(!P)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"});const de=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const r=d[0].payload,D=r.isHighlightedAddition,B=n.highlightedPlayer===r.name,E=T.reduce((g,R)=>g+(r[R]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",E]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",r.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),T.map(g=>{const R=r[g]||0;return R===0?null:e.jsxs("p",{style:{color:N[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:N[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ie(g),":"]})," ",R]},g)})]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},me=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const r=d[0].payload,D=r.isHighlightedAddition,B=n.highlightedPlayer===r.name,E=r.gamesPlayed>=c,g=P?.killerStats.find(v=>v.killerName===r.name),R=T.reduce((v,A)=>v+(r[A]||0),0),l=g?g.kills:Math.round(R*r.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",R.toFixed(2)," (",l," kills /",r.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",r.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),T.map(v=>{const A=r[v]||0;if(A===0)return null;const _=g?g.killsByDeathType[v]||0:Math.round(A*r.gamesPlayed);return e.jsxs("p",{style:{color:N[v],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:N[v],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ie(v),":"]})," ",A.toFixed(2)," (",_," kills /",r.gamesPlayed," games)"]},v)})]}),D&&!E&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",c," parties)"]}),D&&E&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},ge=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const r=d[0].payload,D=r.isHighlightedAddition,B=n.highlightedPlayer===r.name,E=T.reduce((g,R)=>g+(r[R]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",E]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",r.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",r.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),T.map(g=>{const R=r[g]||0;return R===0?null:e.jsxs("p",{style:{color:N[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:N[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[re(g),":"]})," ",R]},g)})]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},ue=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const r=d[0].payload,D=r.isHighlightedAddition,B=n.highlightedPlayer===r.name,E=r.gamesPlayed>=c;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",r.survivalRate.toFixed(1),"% (",r.gamesPlayed-r.totalDeaths," survies / ",r.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",r.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",r.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),T.map(g=>{const R=r[g]||0;return R===0?null:e.jsxs("p",{style:{color:N[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:N[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[re(g),":"]})," ",R.toFixed(1),"%"]},g)})]}),D&&!E&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",c," parties)"]}),D&&E&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:i,onChange:t=>m(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),V?.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:P.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:P.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:ne})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:i==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${i} (Total)`}),X&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(H,{title:i==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${i} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(U,{data:j,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(de,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"kills",fill:N[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};i!=="Tous les camps"&&(o.campFilter={selectedCamp:i,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,j.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:i==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${i} (Moyenne par partie)`}),le&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:c,onChange:t=>p(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ae.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(H,{title:i==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${i} (Moyenne par partie)`,children:e.jsx("div",{style:{height:400},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(U,{data:k,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(me,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"averageKills",fill:N[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};i!=="Tous les camps"&&(o.campFilter={selectedCamp:i,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,k.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",oe," ayant au moins ",c," partie",c>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:i==="Tous les camps"?"Morts (Total)":`Morts en ${i} (Total)`}),ce&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(H,{title:i==="Tous les camps"?"Morts (Total)":`Morts en ${i} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(U,{data:Q,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(ge,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"deaths",fill:N[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};i!=="Tous les camps"&&(o.campFilter={selectedCamp:i,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,Q.filter(t=>!t.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",i==="Tous les camps"?"(Total)":` en ${i}`]}),he&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:c,onChange:t=>p(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ae.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(H,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(U,{data:ee,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Taux de mort (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(ue,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"survivalRate",fill:N[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};i!=="Tous les camps"&&(o.campFilter={selectedCamp:i,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,ee.filter(t=>!t.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",c," partie",c>1?"s":"",")"]})]})]}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]})}export{ke as DeathStatisticsChart};
