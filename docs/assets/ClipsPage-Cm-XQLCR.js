import{a as B,r as i,j as s}from"./index-1qrZIWO-.js";import{u as O,c as q,d as N,e as F,h as M,g as h,C as $,f as v,a as z}from"./useClips-D8l6XPX1.js";function Z(){const{clips:c,isLoading:P,error:j}=O(),{settings:b}=B(),[n,p]=i.useState(null),[r,u]=i.useState(""),[t,y]=i.useState([]),[o,f]=i.useState(""),[m,A]=i.useState("newest"),C=i.useMemo(()=>q(c),[c]),I=i.useMemo(()=>{const e=new Set;return c.forEach(l=>{N(l).forEach(a=>e.add(a))}),Array.from(e).sort()},[c]),d=i.useMemo(()=>{let e=[...c];if(t.length>0&&(e=e.filter(l=>t.some(a=>F(c,a).includes(l)))),o&&(e=M(e,o)),r.trim()){const l=r.toLowerCase();e=e.filter(a=>{const L=h(a).toLowerCase(),R=a.AdditionalInfo?.toLowerCase()||"",k=a.ClipName?.toLowerCase()||"",V=N(a).join(" ").toLowerCase();return L.includes(l)||R.includes(l)||k.includes(l)||V.includes(l)})}return e.sort((l,a)=>{switch(m){case"newest":return a.ClipId.localeCompare(l.ClipId);case"oldest":return l.ClipId.localeCompare(a.ClipId);case"player":return l.POVPlayer.localeCompare(a.POVPlayer);case"name":return h(l).localeCompare(h(a));default:return 0}}),e},[c,t,o,r,m]),S=e=>{y(l=>l.includes(e)?l.filter(a=>a!==e):[...l,e])},g=()=>{u(""),y([]),f("")},T=e=>{p(e)},w=()=>{if(!n)return;const e=v(n,d);e&&p(e)},E=e=>{const l=c.find(a=>a.ClipId===e);l&&p(l)};if(!b.clipsEnabled)return s.jsx("div",{className:"lycans-clips-page",children:s.jsxs("div",{className:"lycans-clips-disabled",children:[s.jsx("div",{className:"lycans-clips-disabled-icon",children:"ðŸŽ¬"}),s.jsx("h2",{children:"Clips dÃ©sactivÃ©s"}),s.jsx("p",{children:"Cette fonctionnalitÃ© est actuellement dÃ©sactivÃ©e."}),s.jsxs("p",{children:["Ajoutez ",s.jsx("code",{children:"?clipsEnabled=true"})," Ã  l'URL pour l'activer."]})]})});if(P)return s.jsx("div",{className:"lycans-clips-page",children:s.jsxs("div",{className:"lycans-clips-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Chargement des clips..."})]})});if(j)return s.jsx("div",{className:"lycans-clips-page",children:s.jsx("div",{className:"lycans-clips-error",children:s.jsxs("p",{children:["Erreur lors du chargement des clips : ",j]})})});if(c.length===0)return s.jsx("div",{className:"lycans-clips-page",children:s.jsxs("div",{className:"lycans-clips-empty",children:[s.jsx("div",{className:"lycans-clips-empty-icon",children:"ðŸŽ¬"}),s.jsx("h2",{children:"Aucun clip disponible"}),s.jsx("p",{children:"Il n'y a actuellement aucun clip enregistrÃ© dans les parties."})]})});const x=r.trim()||t.length>0||o;return s.jsxs("div",{className:"lycans-clips-page",children:[s.jsx("div",{className:"lycans-clips-header",children:s.jsxs("div",{className:"lycans-clips-header-info",children:[s.jsx("h1",{children:"ðŸŽ¬ BibliothÃ¨que de Clips"}),s.jsxs("p",{className:"lycans-clips-count",children:[d.length," clip",d.length!==1?"s":"",x&&` sur ${c.length}`]})]})}),s.jsxs("div",{className:"lycans-clips-filters",children:[s.jsxs("div",{className:"lycans-clips-search",children:[s.jsx("input",{type:"text",placeholder:"Rechercher par nom, description, joueur...",value:r,onChange:e=>u(e.target.value),className:"lycans-clips-search-input"}),r&&s.jsx("button",{className:"lycans-clips-search-clear",onClick:()=>u(""),title:"Effacer la recherche",children:"âœ•"})]}),s.jsxs("div",{className:"lycans-clips-filter-controls",children:[s.jsxs("div",{className:"lycans-clips-filter-group",children:[s.jsx("label",{htmlFor:"player-filter",children:"Joueur POV :"}),s.jsxs("select",{id:"player-filter",value:o,onChange:e=>f(e.target.value),className:"lycans-clips-select",children:[s.jsx("option",{value:"",children:"Tous les joueurs"}),I.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{className:"lycans-clips-filter-group",children:[s.jsx("label",{htmlFor:"sort-filter",children:"Trier par :"}),s.jsxs("select",{id:"sort-filter",value:m,onChange:e=>A(e.target.value),className:"lycans-clips-select",children:[s.jsx("option",{value:"newest",children:"Plus rÃ©cent"}),s.jsx("option",{value:"oldest",children:"Plus ancien"}),s.jsx("option",{value:"player",children:"Joueur (A-Z)"}),s.jsx("option",{value:"name",children:"Nom (A-Z)"})]})]}),x&&s.jsx("button",{className:"lycans-clips-clear-filters",onClick:g,children:"âœ• RÃ©initialiser les filtres"})]}),C.length>0&&s.jsxs("div",{className:"lycans-clips-tags-filter",children:[s.jsx("label",{children:"CatÃ©gories :"}),s.jsx("div",{className:"lycans-clips-tags-list",children:C.map(e=>s.jsxs("button",{className:`lycans-clips-tag-btn ${t.includes(e)?"active":""}`,onClick:()=>S(e),children:[e,t.includes(e)&&s.jsx("span",{className:"tag-check",children:"âœ“"})]},e))})]})]}),d.length===0?s.jsxs("div",{className:"lycans-clips-no-results",children:[s.jsx("div",{className:"lycans-clips-no-results-icon",children:"ðŸ”"}),s.jsx("h3",{children:"Aucun clip trouvÃ©"}),s.jsx("p",{children:"Essayez de modifier vos filtres de recherche."}),x&&s.jsx("button",{className:"lycans-clips-clear-filters-btn",onClick:g,children:"RÃ©initialiser les filtres"})]}):s.jsx("div",{className:"lycans-clips-grid",children:d.map(e=>s.jsxs("button",{className:"lycans-clip-card",onClick:()=>T(e),children:[s.jsxs("div",{className:"lycans-clip-card-header",children:[s.jsx("span",{className:"lycans-clip-icon",children:"ðŸŽ¬"}),s.jsx("span",{className:"lycans-clip-name",children:h(e)})]}),s.jsxs("div",{className:"lycans-clip-card-pov",children:[s.jsx("span",{className:"lycans-clip-pov-badge",children:"POV"}),s.jsx("span",{className:"lycans-clip-pov-player",children:e.POVPlayer})]}),e.Tags&&e.Tags.length>0&&s.jsx("div",{className:"lycans-clip-card-tags",children:e.Tags.map((l,a)=>s.jsx("span",{className:"lycans-clip-card-tag",children:l},a))}),e.AdditionalInfo&&s.jsx("div",{className:"lycans-clip-card-info",children:e.AdditionalInfo.length>80?`${e.AdditionalInfo.substring(0,80)}...`:e.AdditionalInfo})]},e.ClipId))}),n&&s.jsx($,{clip:n,onClose:()=>p(null),relatedClips:z(n,c),nextClip:v(n,d),onNextClip:w,onRelatedClip:E})]})}export{Z as ClipsPage};
