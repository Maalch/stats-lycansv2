import{r as d,j as e}from"./index-DcpGSnKg.js";import{p as F}from"./api-BWHeASPZ.js";import{R as P,T as N,C as A}from"./CategoricalChart-BR7153jM.js";import{B as R,C,X as S,Y as k,a as I}from"./BarChart-jIC5Fa0n.js";function M(){const[t,L]=d.useState(null),[j,p]=d.useState(!0),[m,o]=d.useState(null);return d.useEffect(()=>{(async()=>{try{p(!0),o(null);const x=await fetch("https://script.google.com/macros/s/AKfycbxrhG1mb7N6q7Mg88ogw0mirXgSihPpNPurZwiEOy9miG24Cc3AlGZCn2uoGnygNhck/exec?action=playerPairingStats");if(!x.ok)throw new Error(`Erreur API: ${x.status}`);const g=await x.json();L(g)}catch(l){console.error("Erreur lors de la récupération des statistiques de paires:",l),o(l instanceof Error?l.message:"Erreur inconnue")}finally{p(!1)}})()},[]),{data:t,isLoading:j,error:m}}function Y(){const{data:t,isLoading:L,error:j}=M(),[p,m]=d.useState("wolves"),[o,q]=d.useState(2),[l,x]=d.useState(1),g=[1,2,3,4,5];if(L)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(j)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",j]});if(!t)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const c=s=>F[s]||"#8884d8",T=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,v=s=>s.map(r=>{const[a,n]=r.players,i=c(a),z=c(n),D=T(r.pair);return e.jsxs("linearGradient",{id:D,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:i}),e.jsx("stop",{offset:"50%",stopColor:i}),e.jsx("stop",{offset:"50%",stopColor:z}),e.jsx("stop",{offset:"100%",stopColor:z})]},D)}),y=t.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:T(s.pair)})),f=t.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:T(s.pair)})),$=y.filter(s=>s.appearances>=o).length,B=f.filter(s=>s.appearances>=l).length,E=y.filter(s=>s.appearances>=2),W=f.filter(s=>s.appearances>=2),b=[...y].sort((s,r)=>r.appearances-s.appearances).slice(0,10),h=[...y].filter(s=>s.appearances>=o).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),w=[...f].sort((s,r)=>r.appearances-s.appearances).slice(0,10),u=[...f].filter(s=>s.appearances>=l).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),G=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:E.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),b.length>0?e.jsx("div",{style:{height:350},children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(R,{data:b,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:v(b)}),e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(S,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(k,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx(N,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[n,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(n),borderRadius:"2px"}}),e.jsx("span",{children:n}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Apparitions: ",a.appearances]}),e.jsxs("div",{children:["Victoires: ",a.wins]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]})]})}return null}}),e.jsx(I,{dataKey:"appearances",name:"Apparitions",children:b.map((s,r)=>e.jsx(A,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-wolf-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-wolf-appearances-select",value:o,onChange:s=>q(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:g.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),h.length>0?e.jsx("div",{style:{height:320},children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(R,{data:h,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:v(h)}),e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(S,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(k,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(N,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[n,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(n),borderRadius:"2px"}}),e.jsx("span",{children:n}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",a.wins," / ",a.appearances]})]})}return null}}),e.jsx(I,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:h.map((s,r)=>e.jsx(A,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",h.length," des paires (sur ",$,") avec au moins ",o," apparition",o>1?"s":""]})]})]})]}),K=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:W.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),w.length>0?e.jsx("div",{style:{height:350},children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(R,{data:w,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:v(w)}),e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(S,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(k,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx(N,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[n,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(n),borderRadius:"2px"}}),e.jsx("span",{children:n}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Apparitions: ",a.appearances]}),e.jsxs("div",{children:["Victoires: ",a.wins]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]})]})}return null}}),e.jsx(I,{dataKey:"appearances",name:"Apparitions",children:w.map((s,r)=>e.jsx(A,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-lover-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-lover-appearances-select",value:l,onChange:s=>x(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:g.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),u.length>0?e.jsx("div",{style:{height:320},children:e.jsx(P,{width:"100%",height:"100%",children:e.jsxs(R,{data:u,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:v(u)}),e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(S,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(k,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(N,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[n,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(n),borderRadius:"2px"}}),e.jsx("span",{children:n}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",a.wins," / ",a.appearances]})]})}return null}}),e.jsx(I,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:u.map((s,r)=>e.jsx(A,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",u.length," des paires (sur ",B,") avec au moins ",l," apparition",l>1?"s":""]})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${p==="wolves"?" active":""}`,onClick:()=>m("wolves"),type:"button",children:["Paires de Loups (",t.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${p==="lovers"?" active":""}`,onClick:()=>m("lovers"),type:"button",children:["Paires d'Amoureux (",t.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:p==="wolves"?G():K()})]})}export{Y as PlayerPairingStatsChart};
