import{u as V}from"./baseStatsHook-D1OhdYKq.js";import{g as L,a as C}from"./datasyncExport-D6_8Fmuy.js";import{i as K,D as i}from"./deathTypes-CGUOTngO.js";import{c as k}from"./api-Ccku3syR.js";import{g as R}from"./index-CRlcrpYc.js";function M(u,o){if(!u||!o)return!1;const s=u.split(".").map(Number),r=o.split(".").map(Number);for(let t=0;t<Math.max(s.length,r.length);t++){const e=s[t]||0,n=r[t]||0;if(e>n)return!0;if(e<n)return!1}return!0}function P(u){return u===i.SURVIVALIST_NOT_SAVED?i.BY_WOLF:u}function b(u){const o=new Set;u.filter(e=>!e.LegacyData||e.LegacyData.deathInformationFilled===!0).forEach(e=>{e.PlayerStats.forEach(n=>{const d=L(n.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});o.add(d)})});const r=Array.from(o);return[...k.filter(e=>r.includes(e)),...r.filter(e=>!k.includes(e)).sort()]}function x(u){switch(u){case i.VOTED:return"Mort aux votes";case i.BY_WOLF:case i.SURVIVALIST_NOT_SAVED:return"Kill en Loup";case i.BY_ZOMBIE:return"Kill en Zombie";case i.BY_BEAST:return"Kill en Bête";case i.BY_AVATAR_CHAIN:return"Mort d'Avatar";case i.BULLET:return"Tir de Chasseur";case i.BULLET_HUMAN:return"Kill de Chasseur (sur humain)";case i.BULLET_WOLF:return"Kill de Chasseur (sur loup)";case i.SHERIF_SUCCESS:return"Kill de Shérif";case i.OTHER_AGENT:return"Kill d'Agent";case i.AVENGER:return"Kill de Vengeur";case i.SEER:return"Kill de Devin";case i.HANTED:return"Kill avec Potion hantée";case i.ASSASSIN:return"Kill avec Potion (Assassin)";case i.LOVER_DEATH:return"Kill d'amoureux";case i.BOMB:return"Explosion";case i.CRUSHED:return"Écrasement";case i.STARVATION:return"Famine";case i.STARVATION_AS_BEAST:return"Tuerie bestiale";case i.FALL:return"Chute mortelle";case i.UNKNOWN:return"Kill inconnu";default:return""}}function j(u){const o=new Set;u.forEach(t=>{t.PlayerStats.forEach(e=>{if(e.DeathType&&K(e.DeathType)){const n=P(e.DeathType);n&&o.add(n)}})});const s=Array.from(o),r=[i.BY_WOLF,i.VOTED,i.BULLET,i.BULLET_HUMAN,i.BULLET_WOLF,i.BY_ZOMBIE,i.ASSASSIN,i.AVENGER,i.LOVER_DEATH];return[...r.filter(t=>s.includes(t)),...s.filter(t=>!r.includes(t)).sort()]}function O(u,o){return u.PlayerStats.filter(s=>s.DeathType&&K(s.DeathType)&&(s.DeathTiming||s.DeathType)).map(s=>{let r=null,t=null;if(s.KillerName){const e=u.PlayerStats.find(n=>n.Username===s.KillerName);if(e){t=R(e);const n=C(e.MainRoleInitial,e.MainRoleChanges||[]);r=L(n,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1}),n&&n!==e.MainRoleInitial&&(n==="Loup"?r="Loup":n==="Zombie"&&(r="Vaudou"))}}return{playerId:R(s),playerName:s.Username,deathType:P(s.DeathType),killerId:t,killerName:s.KillerName,killerCamp:r}}).filter(s=>{if(!o||o==="Tous les camps")return!0;const r=u.PlayerStats.find(e=>e.Username===s.playerName);return r?L(r.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===o:!1})}function U(u,o,s){const r=[];u.PlayerStats.forEach(e=>{if(e.KillerName&&e.DeathType){if(e.DeathType===i.VOTED||e.DeathType===i.STARVATION||e.DeathType===i.FALL||e.DeathType===i.BY_AVATAR_CHAIN)return;const n=u.PlayerStats.find(h=>h.Username===e.KillerName);if(!n)return;let d=L(n.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});const I=C(n.MainRoleInitial,n.MainRoleChanges||[]);I&&I!==n.MainRoleInitial&&(I==="Loup"?d="Loup":I==="Zombie"&&(d="Vaudou"));const B=L(e.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0});r.push({killerId:R(n),killerName:n.Username,victimId:R(e),victimName:e.Username,deathType:P(e.DeathType),killerCamp:d,victimCamp:B})}});let t=r;return o&&o!=="Tous les camps"&&(t=t.filter(e=>e.killerCamp===o)),s&&s!=="Tous les camps"&&(t=t.filter(e=>s==="Roles solo"?e.victimCamp!=="Villageois"&&e.victimCamp!=="Loup":e.victimCamp===s)),t}function _(u,o,s){if(u.length===0)return null;const r=u.filter(a=>!a.LegacyData||a.LegacyData.deathInformationFilled===!0);if(r.length===0)return null;const t=[],e={},n={};r.forEach(a=>{O(a,o).forEach(l=>{t.push({...l,gameId:a.Id})}),a.PlayerStats.forEach(l=>{const T=R(l),E=l.Username;n[T]=E,(!o||o==="Tous les camps"||L(l.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===o)&&(e[T]=(e[T]||0)+1)})});const d=t.length,I=r.length,B=I>0?d/I:0,h={};t.forEach(a=>{h[a.deathType]=(h[a.deathType]||0)+1});const m=Object.entries(h).map(([a,c])=>({type:a,count:c||0,percentage:d>0?(c||0)/d*100:0})).sort((a,c)=>c.count-a.count),f={};r.forEach(a=>{U(a,o,s).forEach(l=>{n[l.killerId]=l.killerName,n[l.victimId]=l.victimName,f[l.killerId]||(f[l.killerId]={kills:0,victims:new Set,killsByDeathType:{}}),f[l.killerId].kills++,f[l.killerId].victims.add(l.victimId),f[l.killerId].killsByDeathType[l.deathType]=(f[l.killerId].killsByDeathType[l.deathType]||0)+1})});const D=Object.entries(f).map(([a,c])=>{const l=e[a]||0,T=l>0?c.kills/l:0;return{killerName:n[a]||a,kills:c.kills,victims:Array.from(c.victims).map(E=>n[E]||E),percentage:d>0?c.kills/d*100:0,gamesPlayed:l,averageKillsPerGame:T,killsByDeathType:c.killsByDeathType}}).sort((a,c)=>c.kills-a.kills),y={};t.forEach(a=>{y[a.playerId]||(y[a.playerId]={totalDeaths:0,deathsByType:{},killedById:{},deathDays:[]});const c=y[a.playerId];c.totalDeaths++,c.deathsByType[a.deathType]=(c.deathsByType[a.deathType]||0)+1,a.killerId&&(c.killedById[a.killerId]=(c.killedById[a.killerId]||0)+1)});const p=[];Object.entries(y).forEach(([a,c])=>{const l=n[a]||a,T={};Object.entries(c.killedById).forEach(([E,A])=>{const v=n[E]||E;T[v]=(T[v]||0)+A}),p.push({playerName:l,totalDeaths:c.totalDeaths,deathsByType:c.deathsByType,killedBy:T,deathRate:e[a]>0?c.totalDeaths/e[a]:0,gamesPlayed:e[a]||0})}),Object.entries(e).forEach(([a,c])=>{y[a]||p.push({playerName:n[a]||a,totalDeaths:0,deathsByType:{},killedBy:{},deathRate:0,gamesPlayed:c})});const g=p.sort((a,c)=>c.totalDeaths-a.totalDeaths),S=m.length>0?m[0].type:null,N=D.length>0?D[0].killerName:null;return{totalDeaths:d,totalGames:I,averageDeathsPerGame:B,deathsByType:m,killerStats:D,playerDeathStats:g,mostCommonDeathType:S,mostDeadlyKiller:N}}function G(u,o){const s=u.filter(h=>!h.LegacyData||h.LegacyData.deathInformationFilled===!0),r={},t={},e=s.length,n=[i.BULLET,i.BULLET_HUMAN,i.BULLET_WOLF];s.forEach(h=>{const m=new Set;h.PlayerStats.forEach(f=>{const D=f.MainRoleInitial,y=C(f.MainRoleInitial,f.MainRoleChanges||[]);if(D==="Chasseur"||y==="Chasseur"){const p=R(f);t[p]=f.Username,m.add(p),r[p]||(r[p]={kills:[],gamesPlayed:0,victimsCamps:[],gameVersions:[],gameModded:[]}),r[p].gamesPlayed++}}),h.PlayerStats.forEach(f=>{const D=f.DeathType,y=f.KillerName,p=y?h.PlayerStats.find(S=>S.Username===y):null,g=p?R(p):null;if(g&&p&&(t[g]=p.Username),D&&n.includes(D)&&g&&m.has(g)){const S=L(f.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});r[g].kills.push(D),r[g].victimsCamps.push(S),r[g].gameVersions.push(h.Version),r[g].gameModded.push(h.Modded)}})});const d=Object.entries(r).map(([h,m])=>{const f=m.kills.length,D={};m.kills.forEach(l=>{D[l]=(D[l]||0)+1});const y={};m.victimsCamps.forEach(l=>{y[l]=(y[l]||0)+1});let p=0,g=0;const S={},N={};m.victimsCamps.forEach((l,T)=>{const E=m.gameVersions[T],A=m.gameModded[T];l==="Idiot du Village"?A&&M(E,"0.202")?(g++,N[l]=(N[l]||0)+1):(p++,S[l]=(S[l]||0)+1):l==="Villageois"?(g++,N[l]=(N[l]||0)+1):(p++,S[l]=(S[l]||0)+1)});const a=m.gamesPlayed>0?f/m.gamesPlayed:0,c=m.gamesPlayed>0?p/m.gamesPlayed:0;return{hunterName:t[h]||h,totalKills:f,nonVillageoisKills:p,villageoisKills:g,gamesPlayedAsHunter:m.gamesPlayed,averageKillsPerGame:a,averageNonVillageoisKillsPerGame:c,killsByDeathType:D,victimsByCamp:y,goodVictimsByCamp:S,badVictimsByCamp:N}}).sort((h,m)=>m.totalKills-h.totalKills),I=d.length>0?d[0].hunterName:null,B=d.length>0?d.sort((h,m)=>m.averageNonVillageoisKillsPerGame-h.averageNonVillageoisKillsPerGame)[0].hunterName:null;return{totalHunters:d.length,totalGames:e,hunterStats:d,bestHunter:I,bestAverageHunter:B}}function Z(u,o){const s=[];return u.filter(r=>!r.LegacyData||r.LegacyData.deathInformationFilled===!0).forEach(r=>{r.PlayerStats.filter(t=>t.DeathPosition!==null).filter(t=>!o||o==="Tous les camps"?!0:L(t.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===o).forEach(t=>{if(t.DeathPosition){const e=L(t.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});s.push({x:t.DeathPosition.x,z:t.DeathPosition.z,playerName:t.Username,deathType:P(t.DeathType),mapName:r.MapName,killerName:t.KillerName||null,camp:e,gameId:r.DisplayedId,displayedGameId:r.DisplayedId})}})}),s}function z(u){const o=new Set;return u.filter(s=>!s.LegacyData||s.LegacyData.deathInformationFilled===!0).forEach(s=>{s.PlayerStats.some(t=>t.DeathPosition!==null)&&s.MapName&&o.add(s.MapName)}),Array.from(o).sort()}function q(u,o){return V(s=>_(s,u,o))}function J(){return V(u=>b(u))}function Q(u){return V(o=>G(o))}export{z as a,q as b,Z as c,Q as d,j as e,x as g,J as u};
