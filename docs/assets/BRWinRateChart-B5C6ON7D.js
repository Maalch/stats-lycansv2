import{a as G,r as y,j as e}from"./index-Cgeims2J.js";import{F as w,B,C as A,X as T,Y as H,a as z,b as C}from"./FullscreenChart-qrUCuYa6.js";import{u as L,a as $}from"./useRawBRData-B1tCliHG.js";import{u as O}from"./useJoueursData-S_9-vXLy.js";import{u as K,g as X}from"./api-Bvu_HYI1.js";import{R as F,T as k}from"./CategoricalChart-DiVXbPTg.js";const Y=[3,10,25,50,100];function te(){const{data:p,isLoading:D,error:x}=L(),{data:u,isLoading:E,error:v}=$(),{settings:a}=G(),{joueursData:N}=O(),[j,m]=y.useState(null),[h,I]=y.useState(3),M=K(N),V=t=>M[t]||X(t),f=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],d=y.useMemo(()=>{if(!p||!u)return null;const t=p.reduce((r,l)=>{const c=l.Participants;return r[c]||(r[c]={name:c,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),r[c].participations++,r[c].totalScore+=l.Score,l.Gagnant&&r[c].wins++,r},{});Object.values(t).forEach(r=>{r.averageScore=r.totalScore/r.participations,r.winRate=r.wins/r.participations*100});const s=Object.values(t).sort((r,l)=>l.participations-r.participations),i=Object.values(t).sort((r,l)=>l.wins-r.wins),n=i.slice(0,15),o=a.highlightedPlayer&&n.some(r=>r.name===a.highlightedPlayer);let g=!1,P=[...n];if(a.highlightedPlayer&&!o){const r=i.find(l=>l.name===a.highlightedPlayer);r&&(P.push({...r,isHighlightedAddition:!0}),g=!0)}const b=Object.values(t).filter(r=>r.participations>=h),R=b.sort((r,l)=>l.winRate-r.winRate).slice(0,15),q=a.highlightedPlayer&&R.some(r=>r.name===a.highlightedPlayer);let S=!1,W=[...R];if(a.highlightedPlayer&&!q){const r=s.find(l=>l.name===a.highlightedPlayer);r&&(W.push({...r,isHighlightedAddition:!0}),S=!0)}return{topPlayersByWins:P,highlightedPlayerInWins:g,topPlayersByWinRate:W,highlightedPlayerInWinRate:S,totalEligiblePlayers:b.length}},[p,u,a.highlightedPlayer,h]);return D||E?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):x||v?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",x||v]}):d?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Taux de Victoire - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Victoires"}),d.highlightedPlayerInWins&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(w,{title:"Victoires - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(F,{width:"100%",height:400,children:e.jsxs(B,{data:d.topPlayersByWins,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:t,y:s,payload:i})=>e.jsx("text",{x:t,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:a.highlightedPlayer===i.value?14:12,fontWeight:a.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${t} ${s})`,children:i.value})}),e.jsx(H,{}),e.jsx(k,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const i=s[0].payload,n=i.isHighlightedAddition,o=a.highlightedPlayer===i.name;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,o&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:i.wins})]}),e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:i.participations})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]})]}),n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(z,{dataKey:"wins",name:"Victoires",fill:"var(--chart-color-2)",children:d.topPlayersByWins.map((t,s)=>{const i=a.highlightedPlayer===t.name,n=j===t.name,o=t.isHighlightedAddition;return e.jsx(C,{fill:i?"var(--accent-primary)":o?"var(--accent-secondary)":V(t.name),stroke:i?"var(--accent-primary)":n?"var(--text-primary)":"none",strokeWidth:i?3:n?2:0,strokeDasharray:o?"5,5":"none",opacity:o?.8:1,onMouseEnter:()=>m(t.name),onMouseLeave:()=>m(null),style:{cursor:"pointer"}},`cell-wins-${s}`)})})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Taux de Victoire"}),d.highlightedPlayerInWinRate&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-br-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-br-select",value:h,onChange:t=>I(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsx(w,{title:"Taux de Victoire - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(F,{width:"100%",height:400,children:e.jsxs(B,{data:d.topPlayersByWinRate,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:t,y:s,payload:i})=>e.jsx("text",{x:t,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:a.highlightedPlayer===i.value?14:12,fontWeight:a.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${t} ${s})`,children:i.value})}),e.jsx(H,{}),e.jsx(k,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const i=s[0].payload,n=i.isHighlightedAddition,o=a.highlightedPlayer===i.name,g=i.participations>=h;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,o&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:i.wins})," / ",i.participations]})]}),n&&!g&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",h," partie",h>1?"s":"",")"]}),n&&g&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(z,{dataKey:"winRate",name:"Taux de victoire (%)",children:d.topPlayersByWinRate.map((t,s)=>{const i=a.highlightedPlayer===t.name,n=j===t.name,o=t.isHighlightedAddition;return e.jsx(C,{fill:i?"var(--accent-primary)":o?"var(--accent-secondary)":f[s%f.length],stroke:i?"var(--accent-primary)":n?"var(--text-primary)":"none",strokeWidth:i?3:n?2:0,strokeDasharray:o?"5,5":"none",opacity:o?.8:1,onMouseEnter:()=>m(t.name),onMouseLeave:()=>m(null),style:{cursor:"pointer"}},`cell-winrate-${s}`)})})]})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",d.topPlayersByWinRate.length," des joueurs (sur ",d.totalEligiblePlayers," ayant au moins ",h," partie",h>1?"s":"",")"]})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{te as BRWinRateChart};
