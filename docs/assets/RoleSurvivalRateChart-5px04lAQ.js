import{r as n,j as o}from"./index-CnTU5U0S.js";import{af as E,a6 as re,ag as ie,ah as ne,a2 as B,ai as se,c as U,aj as oe,ak as Y,al as J,am as le,an as ce,ao as de,ap as ue,v as X,D as pe,aq as ve,y as me,ar as ye,z as H,E as he,G as fe,b as xe,a5 as ge,F as be,as as I,H as C,at as Ae,au as Se,k as R,av as F,O as je,P as Ee,U as K,x as z,V as Ie,W as Pe,Z as _e,_ as Te,$ as Oe,a0 as Ce,a1 as De,aw as we,ax as Ke,a3 as Re,ay as ke,ae as ze,R as W,B as Ne,C as V,X as $,Y as q,T as Z,L as Le,a as Me}from"./BarChart-BdkmPsts.js";function Q(e,a,t){return(a=Be(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function Be(e){var a=Fe(e,"string");return typeof a=="symbol"?a:a+""}function Fe(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function We(e){var a=re();return n.useEffect(()=>(a(ie(e)),()=>{a(ne(e))}),[e,a]),null}class k extends n.Component{render(){return n.createElement(We,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:E.allowDuplicatedCategory,allowDataOverflow:E.allowDataOverflow,reversed:E.reversed,includeHidden:E.includeHidden})}}Q(k,"displayName","ZAxis");Q(k,"defaultProps",{zAxisId:0,range:E.range,scale:E.scale,type:E.type});var Ve=["option","isActive"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},O.apply(null,arguments)}function $e(e,a){if(e==null)return{};var t,r,i=qe(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function qe(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Ze(e){var{option:a,isActive:t}=e,r=$e(e,Ve);return typeof a=="string"?n.createElement(B,O({option:n.createElement(se,O({type:a},r)),isActive:t,shapeType:"symbols"},r)):n.createElement(B,O({option:a,isActive:t,shapeType:"symbols"},r))}var Ge=(e,a,t,r,i,s,l)=>Y(e,"xAxis",a,l),Ue=(e,a,t,r,i,s,l)=>J(e,"xAxis",a,l),Ye=(e,a,t,r,i,s,l)=>Y(e,"yAxis",t,l),Je=(e,a,t,r,i,s,l)=>J(e,"yAxis",t,l),Xe=(e,a,t,r)=>le(e,"zAxis",r,!1),He=(e,a,t,r,i)=>i,Qe=(e,a,t,r,i,s)=>s,ea=(e,a,t,r,i,s,l)=>oe(e,a,t,l),aa=U([ce,He],(e,a)=>{if(e.some(t=>t.type==="scatter"&&a.dataKey===t.dataKey&&a.data===t.data))return a}),ta=U([ea,Ge,Ue,Ye,Je,Xe,aa,Qe],(e,a,t,r,i,s,l,v)=>{var{chartData:d,dataStartIndex:u,dataEndIndex:h}=e;if(l!=null){var m;if(l?.data!=null&&l.data.length>0?m=l.data:m=d?.slice(u,h+1),!(m==null||a==null||r==null||t==null||i==null||t?.length===0||i?.length===0))return va({displayedData:m,xAxis:a,yAxis:r,zAxis:s,scatterSettings:l,xAxisTicks:t,yAxisTicks:i,cells:v})}}),ra=["onMouseEnter","onClick","onMouseLeave"],ia=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function ee(e,a){if(e==null)return{};var t,r,i=na(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function na(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function P(){return P=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},P.apply(null,arguments)}function G(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function b(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?G(Object(t),!0).forEach(function(r){N(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function N(e,a,t){return(a=sa(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function sa(e){var a=oa(e,"string");return typeof a=="symbol"?a:a+""}function oa(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var la=e=>{var{dataKey:a,name:t,fill:r,legendType:i,hide:s}=e;return[{inactive:s,dataKey:a,type:i,color:r,value:X(t,a),payload:e}]};function ca(e){var{points:a,props:t}=e,{line:r,lineType:i,lineJointType:s}=t;if(!r)return null;var l=z(t,!1),v=z(r,!1),d,u;if(i==="joint")d=a.map(c=>({x:c.cx,y:c.cy}));else if(i==="fitting"){var{xmin:h,xmax:m,a:p,b:x}=Ke(a),f=c=>p*c+x;d=[{x:h,y:f(h)},{x:m,y:f(m)}]}var g=b(b(b({},l),{},{fill:"none",stroke:l&&l.fill},v),{},{points:d});return n.isValidElement(r)?u=n.cloneElement(r,g):typeof r=="function"?u=r(g):u=n.createElement(Re,P({},g,{type:s})),n.createElement(C,{className:"recharts-scatter-line",key:"recharts-scatter-line"},u)}function ae(e){var{points:a,showLabels:t,allOtherScatterProps:r}=e,{shape:i,activeShape:s,dataKey:l}=r,v=z(r,!1),d=H(Ie),{onMouseEnter:u,onClick:h,onMouseLeave:m}=r,p=ee(r,ra),x=Pe(u,r.dataKey),f=_e(m),g=Te(h,r.dataKey);return a==null?null:n.createElement(n.Fragment,null,n.createElement(ca,{points:a,props:r}),a.map((c,y)=>{var j=s&&d===String(y),A=j?s:i,S=b(b(b({key:"symbol-".concat(y)},v),c),{},{[Ce]:y,[Oe]:String(l)});return n.createElement(C,P({className:"recharts-scatter-symbol"},De(p,c,y),{onMouseEnter:x(c,y),onMouseLeave:f(c,y),onClick:g(c,y),key:"symbol-".concat(c?.cx,"-").concat(c?.cy,"-").concat(c?.size,"-").concat(y)}),n.createElement(Ze,P({option:A,isActive:j},S)))}),t&&we.renderCallByParent(r,a))}function da(e){var{previousPointsRef:a,props:t}=e,{points:r,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:v}=t,d=a.current,u=je(t,"recharts-scatter-"),[h,m]=n.useState(!1),p=n.useCallback(()=>{m(!1)},[]),x=n.useCallback(()=>{m(!0)},[]);return n.createElement(Ee,{begin:s,duration:l,isActive:i,easing:v,from:{t:0},to:{t:1},onAnimationEnd:p,onAnimationStart:x,key:u},f=>{var{t:g}=f,c=g===1?r:r.map((y,j)=>{var A=d&&d[j];if(A){var S=K(A.cx,y.cx),D=K(A.cy,y.cy),_=K(A.size,y.size);return b(b({},y),{},{cx:S(g),cy:D(g),size:_(g)})}var T=K(0,y.size);return b(b({},y),{},{size:T(g)})});return g>0&&(a.current=c),n.createElement(C,null,n.createElement(ae,{points:c,allOtherScatterProps:t,showLabels:!h}))})}function ua(e){var{points:a,isAnimationActive:t}=e,r=n.useRef(null),i=r.current;return t&&a&&a.length&&(!i||i!==a)?n.createElement(da,{props:e,previousPointsRef:r}):n.createElement(ae,{points:a,allOtherScatterProps:e,showLabels:!0})}function pa(e){var{dataKey:a,points:t,stroke:r,strokeWidth:i,fill:s,name:l,hide:v,tooltipType:d}=e;return{dataDefinedOnItem:t?.map(u=>u.tooltipPayload),positions:t?.map(u=>u.tooltipPosition),settings:{stroke:r,strokeWidth:i,fill:s,nameKey:void 0,dataKey:a,name:X(l,a),hide:v,type:d,color:s,unit:""}}}function va(e){var{displayedData:a,xAxis:t,yAxis:r,zAxis:i,scatterSettings:s,xAxisTicks:l,yAxisTicks:v,cells:d}=e,u=I(t.dataKey)?s.dataKey:t.dataKey,h=I(r.dataKey)?s.dataKey:r.dataKey,m=i&&i.dataKey,p=i?i.range:k.defaultProps.range,x=p&&p[0],f=t.scale.bandwidth?t.scale.bandwidth():0,g=r.scale.bandwidth?r.scale.bandwidth():0;return a.map((c,y)=>{var j=R(c,u),A=R(c,h),S=!I(m)&&R(c,m)||"-",D=[{name:I(t.dataKey)?s.name:t.name||t.dataKey,unit:t.unit||"",value:j,payload:c,dataKey:u,type:s.tooltipType},{name:I(r.dataKey)?s.name:r.name||r.dataKey,unit:r.unit||"",value:A,payload:c,dataKey:h,type:s.tooltipType}];S!=="-"&&D.push({name:i.name||i.dataKey,unit:i.unit||"",value:S,payload:c,dataKey:m,type:s.tooltipType});var _=F({axis:t,ticks:l,bandSize:f,entry:c,index:y,dataKey:u}),T=F({axis:r,ticks:v,bandSize:g,entry:c,index:y,dataKey:h}),M=S!=="-"?i.scale(S):x,w=Math.sqrt(Math.max(M,0)/Math.PI);return b(b({},c),{},{cx:_,cy:T,x:_-w,y:T-w,width:2*w,height:2*w,size:M,node:{x:j,y:A,z:S},tooltipPayload:D,tooltipPosition:{x:_,y:T},payload:c},d&&d[y]&&d[y].props)})}var ma=(e,a,t)=>({x:e.cx,y:e.cy,value:t==="x"?+e.node.x:+e.node.y,errorVal:R(e,a)});function ya(e){var a=n.useRef(ge("recharts-scatter-")),{hide:t,points:r,className:i,needClip:s,xAxisId:l,yAxisId:v,id:d,children:u}=e;if(t)return null;var h=be("recharts-scatter",i),m=I(d)?a.current:d;return n.createElement(C,{className:h,clipPath:s?"url(#clipPath-".concat(m,")"):null},s&&n.createElement("defs",null,n.createElement(Ae,{clipPathId:m,xAxisId:l,yAxisId:v})),n.createElement(Se,{xAxisId:l,yAxisId:v,data:r,dataPointFormatter:ma,errorBarOffset:0},u),n.createElement(C,{key:"recharts-scatter-symbols"},n.createElement(ua,e)))}var te={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!fe.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function ha(e){var a=pe(e,te),{animationBegin:t,animationDuration:r,animationEasing:i,hide:s,isAnimationActive:l,legendType:v,lineJointType:d,lineType:u,shape:h,xAxisId:m,yAxisId:p,zAxisId:x}=a,f=ee(a,ia),{needClip:g}=ve(m,p),c=n.useMemo(()=>me(e.children,xe),[e.children]),y=n.useMemo(()=>({name:e.name,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey}),[e.data,e.dataKey,e.name,e.tooltipType]),j=ye(),A=H(S=>ta(S,m,p,x,y,c,j));return g==null?null:n.createElement(n.Fragment,null,n.createElement(he,{fn:pa,args:b(b({},e),{},{points:A})}),n.createElement(ya,P({},f,{xAxisId:m,yAxisId:p,zAxisId:x,lineType:u,lineJointType:d,legendType:v,shape:h,hide:s,isAnimationActive:l,animationBegin:t,animationDuration:r,animationEasing:i,points:A,needClip:g})))}class L extends n.Component{render(){return n.createElement(de,{type:"scatter",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:this.props.zAxisId,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},n.createElement(ue,{legendPayload:la(this.props)}),n.createElement(ha,this.props))}}N(L,"displayName","Scatter");N(L,"defaultProps",te);var fa=["item"],xa=n.forwardRef((e,a)=>n.createElement(ke,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:fa,tooltipPayloadSearcher:ze,categoricalChartProps:e,ref:a}));function ga(){const[e,a]=n.useState(null),[t,r]=n.useState(!0),[i,s]=n.useState(null);return n.useEffect(()=>{(async()=>{try{r(!0),s(null);const d=await fetch("https://script.google.com/macros/s/AKfycbw7amBQVger2k8MpFhueGGtAMUsYioIvdU2yVcixtFuk66a2DRWEpZ_c3xf2nncKjuHPg/exec?action=roleSurvivalStats");if(!d.ok)throw new Error(`Erreur de requête: ${d.status}`);const u=await d.json();if(u.error)throw new Error(u.error);a(u)}catch(v){console.error("Problème lors de la récupération des stats de survie des rôles:",v),s(v instanceof Error?v.message:"Erreur lors du chargement")}finally{r(!1)}})()},[]),{roleSurvivalStats:e,dataLoading:t,fetchError:i}}function Sa(){const{roleSurvivalStats:e,dataLoading:a,fetchError:t}=ga(),[r,i]=n.useState("roles");if(a)return o.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques de survie des rôles..."});if(t)return o.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",t]});if(!e)return o.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de survie disponible"});const s=()=>{switch(r){case"roles":return{data:e.roleStats||[],keyField:"role",label:"Rôle",minAppearances:3};case"camps":return{data:e.campStats||[],keyField:"camp",label:"Camp",minAppearances:1};case"secondaryRoles":return{data:e.secondaryRoleStats||[],keyField:"secondaryRole",label:"Rôle Secondaire",minAppearances:3};case"thirdRoles":return{data:e.thirdRoleStats||[],keyField:"thirdRole",label:"Rôle Spécifique",minAppearances:3}}},{data:l,keyField:v,label:d,minAppearances:u}=s(),h=l.filter(p=>p.appearances>=u),m=h.map(p=>({nom:p[v],tauxSurvie:parseFloat(p.survivalRate),dureeVie:parseFloat(p.avgLifespan),apparitions:p.appearances}));return h.length===0?o.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée disponible pour cette catégorie"}):o.jsxs("div",{className:"lycans-roles-survie",children:[o.jsx("h2",{children:"Statistiques de Survie des Rôles"}),o.jsxs("div",{className:"lycans-categories-selection",children:[o.jsx("button",{className:`lycans-categorie-btn ${r==="roles"?"active":""}`,onClick:()=>i("roles"),children:"Rôles principaux"}),o.jsx("button",{className:`lycans-categorie-btn ${r==="camps"?"active":""}`,onClick:()=>i("camps"),children:"Camps"}),o.jsx("button",{className:`lycans-categorie-btn ${r==="secondaryRoles"?"active":""}`,onClick:()=>i("secondaryRoles"),children:"Rôles secondaires"}),o.jsx("button",{className:`lycans-categorie-btn ${r==="thirdRoles"?"active":""}`,onClick:()=>i("thirdRoles"),children:"Rôles spécifiques"})]}),o.jsxs("div",{className:"lycans-graphiques-groupe",children:[o.jsxs("div",{className:"lycans-graphique-section",children:[o.jsxs("h3",{children:["Taux de Survie par ",d]}),o.jsx("div",{style:{height:400},children:o.jsx(W,{width:"100%",height:"120%",children:o.jsxs(Ne,{data:h,margin:{top:20,right:30,left:20,bottom:70},layout:"vertical",children:[o.jsx(V,{strokeDasharray:"3 3"}),o.jsx($,{type:"number",domain:[0,100]}),o.jsx(q,{dataKey:v,type:"category",width:150}),o.jsx(Z,{content:({active:p,payload:x})=>{if(p&&x&&x.length>0){const f=x[0].payload;return o.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[o.jsxs("div",{style:{fontWeight:"bold",marginBottom:4},children:[d,": ",f[v]]}),o.jsxs("div",{children:["Taux de Survie : ",f.survivalRate,"%"]}),o.jsxs("div",{children:["Apparitions : ",f.appearances]}),o.jsxs("div",{children:["Durée de Vie Moyenne : ",f.avgLifespan," jours"]})]})}return null}}),o.jsx(Le,{formatter:p=>p==="survivalRate"?"Taux de Survie":p}),o.jsx(Me,{dataKey:"survivalRate",name:"survivalRate",fill:"var(--chart-color-2)",background:{fill:"var(--bg-tertiary)"}})]})})})]}),o.jsxs("div",{className:"lycans-graphique-section",children:[o.jsx("h3",{children:"Durée de Vie Moyenne vs Taux de Survie"}),o.jsx("div",{style:{height:400},children:o.jsx(W,{width:"100%",height:"100%",children:o.jsxs(xa,{margin:{top:20,right:30,left:20,bottom:10},children:[o.jsx(V,{}),o.jsx($,{type:"number",dataKey:"dureeVie",name:"Durée de Vie Moyenne (jours)",label:{value:"Durée de Vie Moyenne (jours)",position:"insideBottom",offset:-10}}),o.jsx(q,{type:"number",dataKey:"tauxSurvie",name:"Taux de Survie (%)",label:{value:"Taux de Survie (%)",angle:-90,position:"insideLeft"}}),o.jsx(k,{type:"number",dataKey:"apparitions",range:[50,400],name:"Nombre d'Apparitions"}),o.jsx(Z,{cursor:{strokeDasharray:"3 3"},content:({active:p,payload:x})=>{if(p&&x&&x.length>0){const f=x[0].payload;return o.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[o.jsxs("div",{style:{fontWeight:"bold",marginBottom:4},children:[d,": ",f.nom]}),o.jsxs("div",{children:["Durée de Vie Moyenne : ",f.dureeVie," jours"]}),o.jsxs("div",{children:["Taux de Survie : ",f.tauxSurvie,"%"]}),o.jsxs("div",{children:["Apparitions : ",f.apparitions]})]})}return null}}),o.jsx(L,{name:d,data:m,fill:"var(--chart-color-5)"})]})})})]})]})]})}export{Sa as RoleSurvivalRateChart};
