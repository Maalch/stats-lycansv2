import{u as L}from"./baseStatsHook-OvWDU9WG.js";import{g as R,a as C}from"./datasyncExport-BirWLS1z.js";import{i as v,D as e}from"./deathTypes-gHH1w6_X.js";import{e as K}from"./api-SpRv-SBp.js";import{g as N,h as k}from"./index-3ij-MxWK.js";function V(o){return o?o===e.SURVIVALIST_NOT_SAVED?e.BY_WOLF:o:e.UNKNOWN}function U(o){const u=new Set;o.forEach(i=>{i.PlayerStats.forEach(t=>{const a=R(t.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});u.add(a)})});const l=Array.from(u);return[...K.filter(i=>l.includes(i)),...l.filter(i=>!K.includes(i)).sort()]}function Y(o){switch(o){case e.VOTED:return"Mort aux votes";case e.BY_WOLF:case e.SURVIVALIST_NOT_SAVED:return"Kill en Loup";case e.BY_ZOMBIE:return"Kill en Zombie";case e.BY_BEAST:return"Kill en Bête";case e.BY_AVATAR_CHAIN:return"Mort d'Avatar";case e.BULLET:return"Tir de Chasseur";case e.BULLET_HUMAN:return"Kill de Chasseur (sur humain)";case e.BULLET_WOLF:return"Kill de Chasseur (sur loup)";case e.SHERIF_SUCCESS:return"Kill de Shérif";case e.OTHER_AGENT:return"Kill d'Agent";case e.AVENGER:return"Kill de Vengeur";case e.SEER:return"Kill de Devin";case e.HANTED:return"Kill avec Potion hantée";case e.ASSASSIN:return"Kill avec Potion (Assassin)";case e.LOVER_DEATH:return"Kill d'amoureux";case e.BOMB:return"Explosion";case e.CRUSHED:return"Écrasement";case e.STARVATION:return"Famine";case e.STARVATION_AS_BEAST:return"Tuerie bestiale";case e.FALL:return"Chute mortelle";case e.UNKNOWN:return"Kill inconnu";case e.SMUGGLER_HUNT_KILL:return"Kill sur Contrebandier";default:return""}}function j(o){const u=new Set;o.forEach(i=>{i.PlayerStats.forEach(t=>{if(t.DeathType&&v(t.DeathType)){const a=V(t.DeathType);a&&u.add(a)}})});const l=Array.from(u),m=[e.BY_WOLF,e.VOTED,e.BULLET,e.BULLET_HUMAN,e.BULLET_WOLF,e.BY_ZOMBIE,e.ASSASSIN,e.AVENGER,e.LOVER_DEATH,e.SHERIF_SUCCESS];return[...m.filter(i=>l.includes(i)),...l.filter(i=>!m.includes(i)).sort()]}function M(o,u){return o.PlayerStats.filter(l=>l.DeathType&&v(l.DeathType)&&(l.DeathTiming||l.DeathType)).map(l=>{let m=null,i=null;if(l.KillerName){const t=o.PlayerStats.find(a=>a.Username===l.KillerName);if(t){i=N(t);const a=C(t.MainRoleInitial,t.MainRoleChanges||[]);m=R(a,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1}),a&&a!==t.MainRoleInitial&&(a==="Loup"?m="Loup":a==="Zombie"&&(m="Vaudou"))}}return{playerId:N(l),playerName:l.Username,deathType:V(l.DeathType),killerId:i,killerName:l.KillerName,killerCamp:m}}).filter(l=>{if(!u||u==="Tous les camps")return!0;const m=o.PlayerStats.find(t=>t.Username===l.playerName);return m?R(m.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===u:!1})}function _(o,u,l){const m=[];o.PlayerStats.forEach(t=>{if(t.KillerName&&t.DeathType){if(t.DeathType===e.VOTED||t.DeathType===e.STARVATION||t.DeathType===e.FALL||t.DeathType===e.BY_AVATAR_CHAIN)return;const a=o.PlayerStats.find(c=>c.Username===t.KillerName);if(!a)return;let E=R(a.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});const I=C(a.MainRoleInitial,a.MainRoleChanges||[]);I&&I!==a.MainRoleInitial&&(I==="Loup"?E="Loup":I==="Zombie"&&(E="Vaudou"));const p=R(t.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0});m.push({killerId:N(a),killerName:a.Username,victimId:N(t),victimName:t.Username,deathType:V(t.DeathType),killerCamp:E,victimCamp:p})}});let i=m;return u&&u!=="Tous les camps"&&(i=i.filter(t=>t.killerCamp===u)),l&&l!=="Tous les camps"&&(i=i.filter(t=>l==="Roles solo"?t.victimCamp!=="Villageois"&&t.victimCamp!=="Loup":t.victimCamp===l)),i}function O(o,u,l){if(o.length===0||o.length===0)return null;const m=[],i={},t={};o.forEach(r=>{M(r,u).forEach(s=>{m.push({...s,gameId:r.Id})}),r.PlayerStats.forEach(s=>{const g=N(s),D=s.Username;t[g]=D,(!u||u==="Tous les camps"||R(s.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===u)&&(i[g]=(i[g]||0)+1)})});const a=m.length,E=o.length,I=E>0?a/E:0,p={};m.forEach(r=>{p[r.deathType]=(p[r.deathType]||0)+1});const c=Object.entries(p).map(([r,n])=>({type:r,count:n||0,percentage:a>0?(n||0)/a*100:0})).sort((r,n)=>n.count-r.count),h={};o.forEach(r=>{_(r,u,l).forEach(s=>{t[s.killerId]=s.killerName,t[s.victimId]=s.victimName,h[s.killerId]||(h[s.killerId]={kills:0,victims:new Set,killsByDeathType:{}}),h[s.killerId].kills++,h[s.killerId].victims.add(s.victimId),h[s.killerId].killsByDeathType[s.deathType]=(h[s.killerId].killsByDeathType[s.deathType]||0)+1})});const d=Object.entries(h).map(([r,n])=>{const s=i[r]||0,g=s>0?n.kills/s:0;return{killerName:t[r]||r,kills:n.kills,victims:Array.from(n.victims).map(D=>t[D]||D),percentage:a>0?n.kills/a*100:0,gamesPlayed:s,averageKillsPerGame:g,killsByDeathType:n.killsByDeathType}}).sort((r,n)=>n.kills-r.kills),y={};m.forEach(r=>{y[r.playerId]||(y[r.playerId]={totalDeaths:0,deathsByType:{},killedById:{},deathDays:[]});const n=y[r.playerId];n.totalDeaths++,n.deathsByType[r.deathType]=(n.deathsByType[r.deathType]||0)+1,r.killerId&&(n.killedById[r.killerId]=(n.killedById[r.killerId]||0)+1)});const T=[];Object.entries(y).forEach(([r,n])=>{const s=t[r]||r,g={};Object.entries(n.killedById).forEach(([D,A])=>{const P=t[D]||D;g[P]=(g[P]||0)+A}),T.push({playerName:s,totalDeaths:n.totalDeaths,deathsByType:n.deathsByType,killedBy:g,deathRate:i[r]>0?n.totalDeaths/i[r]:0,gamesPlayed:i[r]||0})}),Object.entries(i).forEach(([r,n])=>{y[r]||T.push({playerName:t[r]||r,totalDeaths:0,deathsByType:{},killedBy:{},deathRate:0,gamesPlayed:n})});const f=T.sort((r,n)=>n.totalDeaths-r.totalDeaths),S=c.length>0?c[0].type:null,B=d.length>0?d[0].killerName:null;return{totalDeaths:a,totalGames:E,averageDeathsPerGame:I,deathsByType:c,killerStats:d,playerDeathStats:f,mostCommonDeathType:S,mostDeadlyKiller:B}}function b(o,u){const l={},m={},i=o.length,t=[e.BULLET,e.BULLET_HUMAN,e.BULLET_WOLF];o.forEach(p=>{const c=new Set;p.PlayerStats.forEach(h=>{const d=h.MainRoleInitial,y=C(h.MainRoleInitial,h.MainRoleChanges||[]);if(d==="Chasseur"||y==="Chasseur"||d==="Villageois Élite"&&h.Power==="Chasseur"){const f=N(h);m[f]=h.Username,c.add(f),l[f]||(l[f]={kills:[],gamesPlayed:0,victimsCamps:[],gameVersions:[],gameModded:[]}),l[f].gamesPlayed++}}),p.PlayerStats.forEach(h=>{const d=h.DeathType,y=h.KillerName,T=y?p.PlayerStats.find(S=>S.Username===y):null,f=T?N(T):null;if(f&&T&&(m[f]=T.Username),d&&t.includes(d)&&f&&c.has(f)){const S=R(h.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});l[f].kills.push(d),l[f].victimsCamps.push(S),l[f].gameVersions.push(p.Version),l[f].gameModded.push(p.Modded)}})});const a=Object.entries(l).map(([p,c])=>{const h=c.kills.length,d={};c.kills.forEach(s=>{d[s]=(d[s]||0)+1});const y={};c.victimsCamps.forEach(s=>{y[s]=(y[s]||0)+1});let T=0,f=0;const S={},B={};c.victimsCamps.forEach((s,g)=>{const D=c.gameVersions[g],A=c.gameModded[g];s==="Idiot du Village"?A&&k(D,"0.202")?(f++,B[s]=(B[s]||0)+1):(T++,S[s]=(S[s]||0)+1):s==="Villageois"?(f++,B[s]=(B[s]||0)+1):(T++,S[s]=(S[s]||0)+1)});const r=c.gamesPlayed>0?h/c.gamesPlayed:0,n=c.gamesPlayed>0?T/c.gamesPlayed:0;return{hunterName:m[p]||p,totalKills:h,nonVillageoisKills:T,villageoisKills:f,gamesPlayedAsHunter:c.gamesPlayed,averageKillsPerGame:r,averageNonVillageoisKillsPerGame:n,killsByDeathType:d,victimsByCamp:y,goodVictimsByCamp:S,badVictimsByCamp:B}}).sort((p,c)=>c.totalKills-p.totalKills),E=a.length>0?a[0].hunterName:null,I=a.length>0?a.sort((p,c)=>c.averageNonVillageoisKillsPerGame-p.averageNonVillageoisKillsPerGame)[0].hunterName:null;return{totalHunters:a.length,totalGames:i,hunterStats:a,bestHunter:E,bestAverageHunter:I}}function x(o,u){return L(l=>O(l,o,u))}function Z(){return L(o=>U(o))}function z(o){return L(u=>b(u))}export{x as a,z as b,j as c,Y as g,Z as u};
