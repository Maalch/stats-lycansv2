import{u as F,a as W,r as R,j as e,c as Z}from"./index-B0qrVTjy.js";import{D as l,g as K,a as _,u as I}from"./datasyncExport-DroQWsm0.js";import{b as U,m as w,a as $,u as J}from"./api-SWF0uUNr.js";import{F as k,B as L,C as M,X as H,Y as C,a as V,b as G}from"./FullscreenChart-D3KCDQoz.js";import{R as z,T as O}from"./CategoricalChart-BH9JEESN.js";import{u as X}from"./useJoueursData-CAZwuEfR.js";function Q(h){const m=new Set;h.filter(u=>!u.LegacyData||u.LegacyData.deathInformationFilled===!0).forEach(u=>{u.PlayerStats.forEach(f=>{const S=K(f.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});m.add(S)})});const y=Array.from(m);return[...U.filter(u=>y.includes(u)),...y.filter(u=>!U.includes(u)).sort()]}function q(h){switch(h){case l.VOTED:return"Mort aux votes";case l.BY_WOLF:return"Tué par un loup";case l.BY_WOLF_REZ:return"Tué par un loup ressuscité";case l.BY_WOLF_LOVER:return"Tué par un loup amoureux";case l.BY_ZOMBIE:return"Tué par un zombie";case l.BY_BEAST:return"Dévoré par la Bête";case l.BY_AVATAR_CHAIN:return"Mort liée à l'Avatar";case l.BULLET:return"Abattu par un chasseur";case l.BULLET_HUMAN:return"Tué par un chasseur en humain";case l.BULLET_WOLF:return"Tué par un chasseur en loup";case l.BULLET_BOUNTYHUNTER:return"Tué par un chasseur de primes";case l.SHERIF:return"Abattu par le Shérif";case l.OTHER_AGENT:return"Éliminé par l'Agent";case l.AVENGER:return"Tué par un vengeur";case l.SEER:return"Rôle deviné par un loup";case l.HANTED:return"Tué par une potion hantée";case l.ASSASSIN:return"Tué par une potion (Assassin)";case l.LOVER_DEATH:return"Mort par amoureux";case l.LOVER_DEATH_OWN:return"Tué par son amoureux";case l.BOMB:return"Mort dans une explosion";case l.CRUSHED:return"Écrasé";case l.STARVATION:return"Mort de faim";case l.STARVATION_AS_BEAST:return"Mort bestiale";case l.FALL:return"Mort de chute";case l.UNKNOWN:return"Mort inconnue";default:return""}}function Y(h){switch(h){case l.VOTED:return"Mort aux votes";case l.BY_WOLF:return"Kill en Loup";case l.BY_WOLF_REZ:return"Kill en Loup ressuscité";case l.BY_WOLF_LOVER:return"Kill en Loup amoureux";case l.BY_ZOMBIE:return"Kill en Zombie";case l.BY_BEAST:return"Kill en Bête";case l.BY_AVATAR_CHAIN:return"Mort d'Avatar";case l.BULLET:return"Tir de Chasseur";case l.BULLET_HUMAN:return"Kill en Chasseur (sur humain)";case l.BULLET_WOLF:return"Kill en Chasseur (sur loup)";case l.BULLET_BOUNTYHUNTER:return"Kill en Chasseur de primes";case l.SHERIF:return"Kill en Shérif";case l.OTHER_AGENT:return"Kill en Agent";case l.AVENGER:return"Kill en Vengeur";case l.SEER:return"Kill en Devin";case l.HANTED:return"Kill avec Potion hantée";case l.ASSASSIN:return"Kill avec Potion (Assassin)";case l.LOVER_DEATH:return"Kill de son amoureux";case l.LOVER_DEATH_OWN:return"Kill de son propre amoureux";case l.BOMB:return"Explosion";case l.CRUSHED:return"Écrasement";case l.STARVATION:return"Famine";case l.STARVATION_AS_BEAST:return"Tuerie bestiale";case l.FALL:return"Chute mortelle";case l.UNKNOWN:return"Kill inconnu";default:return""}}function ee(h){const m=new Set;h.forEach(s=>{s.PlayerStats.forEach(u=>{u.DeathType&&u.DeathType!==""&&m.add(u.DeathType)})});const g=Array.from(m),y=[l.BY_WOLF,l.VOTED,l.BULLET,l.BULLET_HUMAN,l.BULLET_WOLF,l.BY_ZOMBIE,l.ASSASSIN,l.AVENGER,l.LOVER_DEATH];return[...y.filter(s=>g.includes(s)),...g.filter(s=>!y.includes(s)).sort()]}function te(h,m){return h.PlayerStats.filter(g=>g.DeathType&&g.DeathType!==""&&(g.DeathTiming||g.DeathType)).map(g=>{let y=null;if(g.KillerName){const s=h.PlayerStats.find(u=>u.Username===g.KillerName);if(s){const u=_(s.MainRoleInitial,s.MainRoleChanges||[]);y=K(u,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1}),u&&u!==s.MainRoleInitial&&(u==="Loup"?y="Loup":u==="Zombie"&&(y="Vaudou"))}}return{playerName:g.Username,deathType:g.DeathType,killerName:g.KillerName,killerCamp:y}}).filter(g=>{if(!m||m==="Tous les camps")return!0;const y=h.PlayerStats.find(u=>u.Username===g.playerName);return y?K(y.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===m:!1})}function re(h,m){const g=[];return h.PlayerStats.forEach(y=>{if(y.KillerName&&y.DeathType){if(y.DeathType===l.VOTED||y.DeathType===l.STARVATION||y.DeathType===l.FALL||y.DeathType===l.BY_AVATAR_CHAIN||y.DeathType==="")return;const s=h.PlayerStats.find(S=>S.Username===y.KillerName);if(!s)return;let u=K(s.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});const f=_(s.MainRoleInitial,s.MainRoleChanges||[]);f&&f!==s.MainRoleInitial&&(f==="Loup"?u="Loup":f==="Zombie"&&(u="Vaudou")),g.push({killerName:y.KillerName,victimName:y.Username,deathType:y.DeathType,killerCamp:u})}}),m&&m!=="Tous les camps"?g.filter(y=>y.killerCamp===m):g}function ie(h,m){if(h.length===0)return null;const g=h.filter(t=>!t.LegacyData||t.LegacyData.deathInformationFilled===!0);if(g.length===0)return null;const y=[],s={};g.forEach(t=>{te(t,m).forEach(o=>{y.push({...o,gameId:t.Id})}),t.PlayerStats.forEach(o=>{const N=o.Username;(!m||m==="Tous les camps"||K(o.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===m)&&(s[N]=(s[N]||0)+1)})});const u=y.length,f=g.length,S=f>0?u/f:0,P={};y.forEach(t=>{P[t.deathType]=(P[t.deathType]||0)+1});const T=Object.entries(P).map(([t,i])=>({type:t,count:i||0,percentage:u>0?(i||0)/u*100:0})).sort((t,i)=>i.count-t.count),A={};g.forEach(t=>{re(t,m).forEach(o=>{A[o.killerName]||(A[o.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),A[o.killerName].kills++,A[o.killerName].victims.add(o.victimName),A[o.killerName].killsByDeathType[o.deathType]=(A[o.killerName].killsByDeathType[o.deathType]||0)+1})});const D=Object.entries(A).map(([t,i])=>{const o=s[t]||0,N=o>0?i.kills/o:0;return{killerName:t,kills:i.kills,victims:Array.from(i.victims),percentage:u>0?i.kills/u*100:0,gamesPlayed:o,averageKillsPerGame:N,killsByDeathType:i.killsByDeathType}}).sort((t,i)=>i.kills-t.kills),b={};y.forEach(t=>{b[t.playerName]||(b[t.playerName]={totalDeaths:0,deathsByType:{},killedBy:{},deathDays:[]});const i=b[t.playerName];i.totalDeaths++,i.deathsByType[t.deathType]=(i.deathsByType[t.deathType]||0)+1,t.killerName&&(i.killedBy[t.killerName]=(i.killedBy[t.killerName]||0)+1)});const E=[];Object.entries(b).forEach(([t,i])=>{E.push({playerName:t,totalDeaths:i.totalDeaths,deathsByType:i.deathsByType,killedBy:i.killedBy,deathRate:s[t]>0?i.totalDeaths/s[t]:0,gamesPlayed:s[t]||0})}),Object.entries(s).forEach(([t,i])=>{b[t]||E.push({playerName:t,totalDeaths:0,deathsByType:{},killedBy:{},deathRate:0,gamesPlayed:i})});const v=E.sort((t,i)=>i.totalDeaths-t.totalDeaths),c=T.length>0?T[0].type:null,a=D.length>0?D[0].killerName:null;return{totalDeaths:u,totalGames:f,averageDeathsPerGame:S,deathsByType:T,killerStats:D,playerDeathStats:v,mostCommonDeathType:c,mostDeadlyKiller:a}}function ae(h,m){const g=h.filter(T=>!T.LegacyData||T.LegacyData.deathInformationFilled===!0),y={},s=g.length,u=[l.BULLET,l.BULLET_HUMAN,l.BULLET_WOLF,l.BULLET_BOUNTYHUNTER];g.forEach(T=>{const A=new Set;T.PlayerStats.forEach(D=>{const b=D.MainRoleInitial,E=_(D.MainRoleInitial,D.MainRoleChanges||[]);(b==="Chasseur"||E==="Chasseur")&&(A.add(D.Username),y[D.Username]||(y[D.Username]={kills:[],gamesPlayed:0,victimsCamps:[]}),y[D.Username].gamesPlayed++)}),T.PlayerStats.forEach(D=>{const b=D.DeathType,E=D.KillerName;if(b&&u.includes(b)&&E&&A.has(E)){const v=K(D.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});y[E].kills.push(b),y[E].victimsCamps.push(v)}})});const f=Object.entries(y).map(([T,A])=>{const D=A.kills.length,b={};A.kills.forEach(i=>{b[i]=(b[i]||0)+1});const E={};A.victimsCamps.forEach(i=>{E[i]=(E[i]||0)+1});const v=A.victimsCamps.filter(i=>i!=="Villageois").length,c=A.victimsCamps.filter(i=>i==="Villageois").length,a=A.gamesPlayed>0?D/A.gamesPlayed:0,t=A.gamesPlayed>0?v/A.gamesPlayed:0;return{hunterName:T,totalKills:D,nonVillageoisKills:v,villageoisKills:c,gamesPlayedAsHunter:A.gamesPlayed,averageKillsPerGame:a,averageNonVillageoisKillsPerGame:t,killsByDeathType:b,victimsByCamp:E}}).sort((T,A)=>A.totalKills-T.totalKills),S=f.length>0?f[0].hunterName:null,P=f.length>0?f.sort((T,A)=>A.averageNonVillageoisKillsPerGame-T.averageNonVillageoisKillsPerGame)[0].hunterName:null;return{totalHunters:f.length,totalGames:s,hunterStats:f,bestHunter:S,bestAverageHunter:P}}function se(h){return I(m=>ie(m,h))}function le(){return I(h=>Q(h))}function ne(h){return I(m=>ae(m))}function oe({deathStats:h,selectedCamp:m,minGamesForAverage:g,onMinGamesChange:y,availableDeathTypes:s,deathTypeColors:u,totalEligibleForAverage:f}){const{navigateToGameDetails:S}=F(),{settings:P}=W(),{totalKillsData:T,averageKillsData:A,highlightedPlayerAddedToTotal:D,highlightedPlayerAddedToAverage:b}=R.useMemo(()=>{if(!h)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const c=h.killerStats.sort((r,x)=>x.kills-r.kills).slice(0,15),a=P.highlightedPlayer&&c.some(r=>r.killerName===P.highlightedPlayer),t=c.map(r=>{const x={name:r.killerName,value:r.kills,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!1};return s.forEach(d=>{x[d]=r.killsByDeathType[d]||0}),x});let i=!1;if(P.highlightedPlayer&&!a){const r=h.killerStats.find(x=>x.killerName===P.highlightedPlayer);if(r){const x={name:r.killerName,value:r.kills,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!0};s.forEach(d=>{x[d]=r.killsByDeathType[d]||0}),t.push(x),i=!0}}const N=h.killerStats.filter(r=>r.gamesPlayed>=g).sort((r,x)=>x.averageKillsPerGame-r.averageKillsPerGame).slice(0,15),B=P.highlightedPlayer&&N.some(r=>r.killerName===P.highlightedPlayer),j=N.map(r=>{const x={name:r.killerName,value:r.averageKillsPerGame,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!1};return s.forEach(d=>{const p=r.killsByDeathType[d]||0;x[d]=r.gamesPlayed>0?p/r.gamesPlayed:0}),x});let n=!1;if(P.highlightedPlayer&&!B){const r=h.killerStats.find(x=>x.killerName===P.highlightedPlayer);if(r){const x={name:r.killerName,value:r.averageKillsPerGame,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!0};s.forEach(d=>{const p=r.killsByDeathType[d]||0;x[d]=r.gamesPlayed>0?p/r.gamesPlayed:0}),j.push(x),n=!0}}return{totalKillsData:t,averageKillsData:j,highlightedPlayerAddedToTotal:i,highlightedPlayerAddedToAverage:n}},[h,P.highlightedPlayer,g,s]),E=({active:c,payload:a,label:t})=>{if(c&&a&&a.length){const i=a[0].payload,o=i.isHighlightedAddition,N=P.highlightedPlayer===i.name,B=s.reduce((j,n)=>j+(i[n]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[t,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",B]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),s.map(j=>{const n=i[j]||0;return n===0?null:e.jsxs("p",{style:{color:u[j],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[Y(j),":"]})," ",n]},j)})]}),o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),N&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},v=({active:c,payload:a,label:t})=>{if(c&&a&&a.length){const i=a[0].payload,o=i.isHighlightedAddition,N=P.highlightedPlayer===i.name,B=i.gamesPlayed>=g,j=h?.killerStats.find(x=>x.killerName===i.name),n=s.reduce((x,d)=>x+(i[d]||0),0),r=j?j.kills:Math.round(n*i.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[t,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",n.toFixed(2)," (",r," kills /",i.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),s.map(x=>{const d=i[x]||0;if(d===0)return null;const p=j?j.killsByDeathType[x]||0:Math.round(d*i.gamesPlayed);return e.jsxs("p",{style:{color:u[x],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[Y(x),":"]})," ",d.toFixed(2)," (",p," kills /",i.gamesPlayed," games)"]},x)})]}),o&&!B&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",g," parties)"]}),o&&B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),N&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:m==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${m} (Total)`}),D&&P.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',P.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:m==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${m} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:a,payload:t})=>e.jsx("text",{x:c,y:a,dy:10,fill:P.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:P.highlightedPlayer===t.value?14:12,fontWeight:P.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${a})`,children:t.value})}),e.jsx(C,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(E,{})}),s.map(c=>e.jsx(V,{dataKey:c,name:c,stackId:"kills",fill:u[c],onClick:a=>{const t={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(t.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),S(t)}},c))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(c=>!c.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:m==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${m} (Moyenne par partie)`}),b&&P.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',P.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:g,onChange:c=>y(Number(c.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:w.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsx(k,{title:m==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${m} (Moyenne par partie)`,children:e.jsx("div",{style:{height:400},children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(L,{data:A,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:a,payload:t})=>e.jsx("text",{x:c,y:a,dy:10,fill:P.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:P.highlightedPlayer===t.value?14:12,fontWeight:P.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${a})`,children:t.value})}),e.jsx(C,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(v,{})}),s.map(c=>e.jsx(V,{dataKey:c,name:c,stackId:"averageKills",fill:u[c],onClick:a=>{const t={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(t.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),S(t)}},c))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,A.filter(c=>!c.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",f," ayant au moins ",g," partie",g>1?"s":"",")"]})]})]})}function ce({deathStats:h,selectedCamp:m,minGamesForAverage:g,onMinGamesChange:y,availableDeathTypes:s,deathTypeColors:u}){const{navigateToGameDetails:f}=F(),{settings:S}=W(),{totalDeathsData:P,survivalRateData:T,highlightedPlayerAddedToDeaths:A,highlightedPlayerAddedToSurvival:D}=R.useMemo(()=>{if(!h)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const v=h.playerDeathStats.sort((n,r)=>r.totalDeaths-n.totalDeaths).slice(0,15),c=S.highlightedPlayer&&v.some(n=>n.playerName===S.highlightedPlayer),a=v.map(n=>{const r=n.gamesPlayed,x=r>0?(r-n.totalDeaths)/r*100:0,d={name:n.playerName,value:n.totalDeaths,totalDeaths:n.totalDeaths,gamesPlayed:r,deathRate:n.deathRate,survivalRate:x,isHighlightedAddition:!1};return s.forEach(p=>{d[p]=n.deathsByType[p]||0}),d});let t=!1;if(S.highlightedPlayer&&!c){const n=h.playerDeathStats.find(r=>r.playerName===S.highlightedPlayer);if(n){const r=n.gamesPlayed,x=r>0?(r-n.totalDeaths)/r*100:0,d={name:n.playerName,value:n.totalDeaths,totalDeaths:n.totalDeaths,gamesPlayed:r,deathRate:n.deathRate,survivalRate:x,isHighlightedAddition:!0};s.forEach(p=>{d[p]=n.deathsByType[p]||0}),a.push(d),t=!0}}const o=h.playerDeathStats.filter(n=>n.gamesPlayed>=g).map(n=>({...n,survivalRate:n.gamesPlayed>0?(n.gamesPlayed-n.totalDeaths)/n.gamesPlayed*100:0})).sort((n,r)=>r.survivalRate-n.survivalRate).slice(0,15),N=S.highlightedPlayer&&o.some(n=>n.playerName===S.highlightedPlayer),B=o.map(n=>{const r={name:n.playerName,value:n.survivalRate,totalDeaths:n.totalDeaths,gamesPlayed:n.gamesPlayed,deathRate:n.deathRate,survivalRate:n.survivalRate,isHighlightedAddition:!1};return s.forEach(x=>{const d=n.deathsByType[x]||0;r[x]=n.gamesPlayed>0?d/n.gamesPlayed*100:0}),r});let j=!1;if(S.highlightedPlayer&&!N){const n=h.playerDeathStats.find(r=>r.playerName===S.highlightedPlayer);if(n){const r=n.gamesPlayed>0?(n.gamesPlayed-n.totalDeaths)/n.gamesPlayed*100:0,x={name:n.playerName,value:r,totalDeaths:n.totalDeaths,gamesPlayed:n.gamesPlayed,deathRate:n.deathRate,survivalRate:r,isHighlightedAddition:!0};s.forEach(d=>{const p=n.deathsByType[d]||0;x[d]=n.gamesPlayed>0?p/n.gamesPlayed*100:0}),B.push(x),j=!0}}return{totalDeathsData:a,survivalRateData:B,highlightedPlayerAddedToDeaths:t,highlightedPlayerAddedToSurvival:j}},[h,S.highlightedPlayer,g,s]),b=({active:v,payload:c,label:a})=>{if(v&&c&&c.length){const t=c[0].payload,i=t.isHighlightedAddition,o=S.highlightedPlayer===t.name,N=s.reduce((B,j)=>B+(t[j]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:o?"var(--accent-primary)":"var(--text-primary)"},children:[a,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",N]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",t.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",t.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),s.map(B=>{const j=t[B]||0;return j===0?null:e.jsxs("p",{style:{color:u[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[q(B),":"]})," ",j]},B)})]}),i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),o&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},E=({active:v,payload:c,label:a})=>{if(v&&c&&c.length){const t=c[0].payload,i=t.isHighlightedAddition,o=S.highlightedPlayer===t.name,N=t.gamesPlayed>=g;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:o?"var(--accent-primary)":"var(--text-primary)"},children:[a,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",t.survivalRate.toFixed(1),"% (",t.gamesPlayed-t.totalDeaths," survies / ",t.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",t.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",t.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),s.map(B=>{const j=t[B]||0;return j===0?null:e.jsxs("p",{style:{color:u[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[q(B),":"]})," ",j.toFixed(1),"%"]},B)})]}),i&&!N&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",g," parties)"]}),i&&N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),o&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:m==="Tous les camps"?"Morts (Total)":`Morts en ${m} (Total)`}),A&&S.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',S.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:m==="Tous les camps"?"Morts (Total)":`Morts en ${m} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(L,{data:P,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:v,y:c,payload:a})=>e.jsx("text",{x:v,y:c,dy:10,fill:S.highlightedPlayer===a.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:S.highlightedPlayer===a.value?14:12,fontWeight:S.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${v} ${c})`,children:a.value})}),e.jsx(C,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(b,{})}),s.map(v=>e.jsx(V,{dataKey:v,name:v,stackId:"deaths",fill:u[v],onClick:c=>{const a={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(a.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),f(a)}},v))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,P.filter(v=>!v.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",m==="Tous les camps"?"(Total)":` en ${m}`]}),D&&S.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',S.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:g,onChange:v=>y(Number(v.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:w.map(v=>e.jsx("option",{value:v,children:v},v))})]}),e.jsx(k,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:v,y:c,payload:a})=>e.jsx("text",{x:v,y:c,dy:10,fill:S.highlightedPlayer===a.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:S.highlightedPlayer===a.value?14:12,fontWeight:S.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${v} ${c})`,children:a.value})}),e.jsx(C,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(E,{})}),s.map(v=>e.jsx(V,{dataKey:v,name:v,stackId:"survivalRate",fill:u[v],onClick:c=>{const a={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(a.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),f(a)}},v))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(v=>!v.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",g," partie",g>1?"s":"",")"]})]})]})}function he({hunterStats:h,isLoading:m,error:g}){const{navigateToGameDetails:y}=F(),{settings:s}=W(),u=$(),{joueursData:f}=X(),S=J(f),[P,T]=R.useState(null);if(m)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(g)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",g]});if(!h||h.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnée Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:A,highlightedPlayerAddedToBest:D,finalBadHuntersData:b,highlightedPlayerAddedToBad:E}=(()=>{const t=h.hunterStats.filter(d=>d.gamesPlayedAsHunter>=5).sort((d,p)=>p.averageNonVillageoisKillsPerGame-d.averageNonVillageoisKillsPerGame).slice(0,15),i=s.highlightedPlayer&&t.some(d=>d.hunterName===s.highlightedPlayer);let o=[...t],N=!1;if(s.highlightedPlayer&&!i){const d=h.hunterStats.find(p=>p.hunterName===s.highlightedPlayer);d&&(o.push({...d,isHighlightedAddition:!0}),N=!0)}const B=h.hunterStats.filter(d=>d.gamesPlayedAsHunter>=5).map(d=>({name:d.hunterName,averageVillageoisKills:Number((d.villageoisKills/d.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:d.villageoisKills,totalNonVillageoisKills:d.nonVillageoisKills,totalKills:d.totalKills,gamesPlayed:d.gamesPlayedAsHunter,victimsByCamp:d.victimsByCamp,hunterName:d.hunterName})),j=B.sort((d,p)=>p.averageVillageoisKills-d.averageVillageoisKills).slice(0,15),n=s.highlightedPlayer&&j.some(d=>d.hunterName===s.highlightedPlayer);let r=[...j],x=!1;if(s.highlightedPlayer&&!n){const d=B.find(p=>p.hunterName===s.highlightedPlayer);d&&(r.push({...d,isHighlightedAddition:!0}),x=!0)}return{finalBestHuntersData:o,highlightedPlayerAddedToBest:N,finalBadHuntersData:r,highlightedPlayerAddedToBad:x}})(),v=({active:a,payload:t,label:i})=>{if(a&&t&&t.length){const o=t[0].payload,N=o.isHighlightedAddition,B=s.highlightedPlayer===o.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[i,N&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",o.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tués:"})," ",o.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",o.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",o.totalKills]}),o.victimsByCamp&&Object.keys(o.victimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Victimes par camp:"}),Object.entries(o.victimsByCamp).map(([j,n])=>e.jsxs("p",{style:{color:u[j]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[j,":"]})," ",n]},j))]}),N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},c=({active:a,payload:t,label:i})=>{if(a&&t&&t.length){const o=t[0].payload,N=o.isHighlightedAddition,B=s.highlightedPlayer===o.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[i,N&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tués/partie:"})," ",o.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tués:"})," ",o.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tués:"})," ",o.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",o.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",o.totalKills]}),o.victimsByCamp&&Object.keys(o.victimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Victimes par camp:"}),Object.entries(o.victimsByCamp).map(([j,n])=>e.jsxs("p",{style:{color:u[j]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[j,":"]})," ",n]},j))]}),N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Meilleurs Chasseurs"}),D&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',s.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:"Meilleurs Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(L,{data:A,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:t,payload:i})=>e.jsx("text",{x:a,y:t,dy:10,fill:s.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===i.value?14:12,fontWeight:s.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${t})`,children:i.value})}),e.jsx(C,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(v,{})}),e.jsx(V,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:a=>{a?.hunterName&&y({selectedPlayer:a.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Meilleurs Chasseurs"})},onMouseEnter:a=>T(a?.hunterName||null),onMouseLeave:()=>T(null),style:{cursor:"pointer"},children:A.map((a,t)=>{const i=s.highlightedPlayer===a.hunterName,o=a.isHighlightedAddition;return e.jsx(G,{fill:S[a.hunterName]||u.Chasseur||"#8884d8",stroke:i?"var(--accent-primary)":P===a.hunterName?"var(--text-primary)":"none",strokeWidth:i?3:P===a.hunterName?2:0,strokeDasharray:o?"5,5":"none",opacity:o?.8:1},`cell-${t}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,A.filter(a=>!a.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),E&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',s.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(L,{data:b,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:t,payload:i})=>e.jsx("text",{x:a,y:t,dy:10,fill:s.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===i.value?14:12,fontWeight:s.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${t})`,children:i.value})}),e.jsx(C,{label:{value:"Moyenne Villageois tués/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(c,{})}),e.jsx(V,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:a=>{a?.hunterName&&y({selectedPlayer:a.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:a=>T(a?.hunterName||null),onMouseLeave:()=>T(null),style:{cursor:"pointer"},children:b.map((a,t)=>{const i=s.highlightedPlayer===a.hunterName,o=a.isHighlightedAddition;return e.jsx(G,{fill:S[a.hunterName]||u.Chasseur||"#8884d8",stroke:i?"var(--accent-primary)":P===a.hunterName?"var(--text-primary)":"none",strokeWidth:i?3:P===a.hunterName?2:0,strokeDasharray:o?"5,5":"none",opacity:o?.8:1},`cell-${t}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,b.filter(a=>!a.isHighlightedAddition).length)," des chasseurs ayant le plus tué de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function xe(){const{navigationState:h,updateNavigationState:m}=F(),[g,y]=R.useState(h.deathStatisticsState?.selectedCamp||h.deathStatsSelectedCamp||"Tous les camps"),[s,u]=R.useState(h.deathStatisticsState?.minGamesForAverage||10),[f,S]=R.useState(h.deathStatisticsState?.selectedView||"killers"),{data:P}=le(),{data:T,isLoading:A,error:D}=se(g),{data:b,isLoading:E,error:v}=ne(),{data:c}=Z(),a=$();R.useEffect(()=>{(!h.deathStatisticsState||h.deathStatisticsState.selectedCamp!==g||h.deathStatisticsState.minGamesForAverage!==s||h.deathStatisticsState.selectedView!==f)&&m({deathStatisticsState:{selectedCamp:g,minGamesForAverage:s,selectedView:f,focusChart:h.deathStatisticsState?.focusChart}})},[g,s,f,h.deathStatisticsState,m]);const t=R.useMemo(()=>c?ee(c):[],[c]),i=R.useMemo(()=>{const r={};t.forEach(p=>{p===l.BY_WOLF||p===l.BY_WOLF_REZ||p===l.BY_WOLF_LOVER?r[p]=a.Loup:p===l.VOTED?r[p]="var(--chart-color-1)":p===l.BULLET||p===l.BULLET_BOUNTYHUNTER||p===l.BULLET_HUMAN||p===l.BULLET_WOLF?r[p]=a.Chasseur:p===l.BY_ZOMBIE?r[p]=a.Vaudou:p===l.ASSASSIN?r[p]=a.Alchimiste:p===l.AVENGER?r[p]="var(--chart-color-2)":p===l.LOVER_DEATH||p===l.LOVER_DEATH_OWN?r[p]=a.Amoureux:p===l.BY_BEAST?r[p]="var(--chart-color-3)":p===l.SHERIF&&(r[p]="var(--chart-color-4)")});const x=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let d=0;return t.forEach(p=>{r[p]||(r[p]=x[d%x.length],d++)}),r},[t,a]),o=r=>{y(r),m({deathStatsSelectedCamp:r,deathStatisticsState:{selectedCamp:r,minGamesForAverage:s,selectedView:f,focusChart:h.deathStatisticsState?.focusChart}})},N=r=>{u(r),m({deathStatisticsState:{selectedCamp:g,minGamesForAverage:r,selectedView:f,focusChart:h.deathStatisticsState?.focusChart}})},B=r=>{S(r),m({deathStatisticsState:{selectedCamp:g,minGamesForAverage:s,selectedView:r,focusChart:h.deathStatisticsState?.focusChart}})},{gamesWithKillers:j,totalEligibleForAverage:n}=R.useMemo(()=>{if(!T)return{gamesWithKillers:0,totalEligibleForAverage:0};const r=T.killerStats.filter(x=>x.gamesPlayed>=s);return{gamesWithKillers:T.totalGames,totalEligibleForAverage:r.length}},[T,s]);return A?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):D?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",D]}):T?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${f==="killers"?"active":""}`,onClick:()=>B("killers"),children:"Tueurs"}),e.jsx("button",{className:`lycans-categorie-btn ${f==="deaths"?"active":""}`,onClick:()=>B("deaths"),children:"Morts"}),e.jsx("button",{className:`lycans-categorie-btn ${f==="hunter"?"active":""}`,onClick:()=>B("hunter"),children:"Chasseur"})]}),(f==="killers"||f==="deaths")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:g,onChange:r=>o(r.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),P?.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),(f==="killers"||f==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:T.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:T.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:j})]})]}),f==="killers"&&e.jsx(oe,{deathStats:T,selectedCamp:g,minGamesForAverage:s,onMinGamesChange:N,availableDeathTypes:t,deathTypeColors:i,totalEligibleForAverage:n}),f==="deaths"&&e.jsx(ce,{deathStats:T,selectedCamp:g,minGamesForAverage:s,onMinGamesChange:N,availableDeathTypes:t,deathTypeColors:i}),f==="hunter"&&e.jsx(he,{hunterStats:b,isLoading:E,error:v}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"})}export{xe as DeathStatisticsChart};
