import{a as ae,r as D,g as te,f as be,u as Z,j as e,c as he,m as Ce}from"./index-BA0rguXe.js";import{u as re}from"./useJoueursData-BTtfDLik.js";import{u as ge}from"./baseStatsHook-wEmoScaf.js";import{g as we}from"./gameUtils-DYpUb-C5.js";import{a as xe,g as se,c as Re}from"./datasyncExport-CjB7UYqV.js";import{u as le,g as Se,a as ie,l as fe}from"./api-fDp4NTmd.js";import{d as ke}from"./durationFormatters-C9UyWcKX.js";import{F as K,C as H,X as O,Y as _,a as U}from"./FullscreenChart-Bcfwjqnq.js";import{R as E,T as G}from"./CategoricalChart-BMYA4qbO.js";import{L as Ne,a as Te}from"./LineChart-CmZbQIjs.js";import{B as X,a as J}from"./BarChart-D7IL8P2n.js";import{P as Pe,a as Me}from"./PieChart-BjQhN0eQ.js";import{u as De}from"./useDeathStatisticsFromRaw-FNGtZdBY.js";import{R as oe}from"./ReferenceLine-D35L0L9J.js";import{g as ee}from"./deathTypes-gHH1w6_X.js";import{i as ce,g as de,V as Fe}from"./roleUtils-C8smGkiJ.js";import{e as ue,a as Ae,b as $e,d as ze,R as Ie}from"./deathLocationUtils-C4AwYkeB.js";import{S as We,a as Le}from"./ScatterChart-Dve8NzR1.js";import{a as qe,u as Ee}from"./useClips-n0pnI0Ot.js";import{C as Ge,f as pe,a as Ve}from"./ClipViewer-DwXeOBJq.js";import"./ActivePoints-V8DXPCab.js";import"./PolarChart-DAoz2Nzd.js";function Be(l){const{settings:k}=ae(),{joueursData:b}=re(),[j,N]=D.useState(null),[f,C]=D.useState(!1),[v,c]=D.useState(null);D.useEffect(()=>{let r=!0;return(async()=>{try{C(!0),c(null);const a=k.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",o=await fetch(a);if(!o.ok)throw new Error(`Failed to load achievements: ${o.status} ${o.statusText}`);const i=await o.json();r&&N(i)}catch(a){r&&c(a instanceof Error?a.message:"Failed to load achievements")}finally{r&&C(!1)}})(),()=>{r=!1}},[k.dataSource]);const u=(()=>{if(!l||!j)return null;const s=b?.Players?.find(a=>a.Joueur===l)?.SteamID;return s?j.achievements[s]||null:(console.warn(`âš ï¸ No Steam ID found for player: ${l}`),null)})();return D.useEffect(()=>{l&&j&&b&&b.Players?.find(a=>a.Joueur===l)?.SteamID},[l,j,b,k.dataSource]),{data:u,isLoading:f,error:v,metadata:{generatedAt:j?.generatedAt||null,totalPlayers:j?.totalPlayers||0,totalGames:j?.totalGames||0,totalModdedGames:j?.totalModdedGames||0}}}function Ke(l,k,b){if(!l||l.trim()===""||k.length===0)return null;const j=[];let N=l;k.forEach(s=>{const a=s.PlayerStats.find(o=>te(o)===l||o.Username.toLowerCase()===l.toLowerCase());if(a){N=a.Username;const o=a.MainRoleInitial==="Louveteau"?a.MainRoleInitial:xe(a.MainRoleInitial,a.MainRoleChanges||[]),i=se(o);if(b&&b!=="Tous les camps"&&i!==b)return;const g=we(s),n=a.Victorious,w=be(new Date(s.StartDate)),S=Re(s.StartDate,s.EndDate)||0;j.push({gameId:s.Id,date:w,camp:i,won:n,winnerCamp:g,playersInGame:s.PlayerStats.length,mapName:s.MapName,duration:S})}}),j.sort((s,a)=>{const o=i=>{const g=i.split("/");return g.length===3?new Date(parseInt(g[2]),parseInt(g[1])-1,parseInt(g[0])):new Date(i)};return o(a.date).getTime()-o(s.date).getTime()});const f=j.length,C=j.filter(s=>s.won).length,v=f>0?(C/f*100).toFixed(2):"0.00",c={};j.forEach(s=>{c[s.camp]||(c[s.camp]={appearances:0,wins:0,winRate:"0.00"}),c[s.camp].appearances++,s.won&&c[s.camp].wins++}),Object.keys(c).forEach(s=>{const a=c[s];a.winRate=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00"});const u={};j.forEach(s=>{u[s.mapName]||(u[s.mapName]={appearances:0,wins:0,winRate:"0.00"}),u[s.mapName].appearances++,s.won&&u[s.mapName].wins++}),Object.keys(u).forEach(s=>{const a=u[s];a.winRate=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00"});const r=j.reduce((s,a)=>s+a.duration,0);return{playerName:N,totalGames:f,totalWins:C,winRate:v,totalPlayTime:r,games:j,campStats:c,mapStats:u}}function He(l){const k={};let b=0,j=0;return Object.entries(l).forEach(([N,f])=>{N==="Village"||N==="ChÃ¢teau"?k[N]={...f}:(b+=f.appearances,j+=f.wins)}),b>=10&&(k.Autres={appearances:b,wins:j,winRate:b>0?(j/b*100).toFixed(2):"0.00"}),k}function ne(l,k){const{data:b,isLoading:j,error:N}=ge(f=>l?Ke(l,f,k):null);return{data:b,isLoading:j,error:N}}function Oe({achievements:l,title:k,emptyMessage:b,achievementType:j="all"}){const{navigateToTab:N,updateNavigationState:f,clearNavigation:C}=Z(),{settings:v,updateSettings:c}=ae(),{joueursData:u}=re(),r=le(u),s=(t,y)=>{if(y.stopPropagation(),!t.redirectTo)return;C();const T=v.highlightedPlayer;if(c(j==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:T,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:T,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),t.category==="comparison"&&t.redirectTo.subTab==="comparison"){const d=v.highlightedPlayer||"",m=a(t.description,d);m&&f({playerComparisonState:{selectedPlayer1:d,selectedPlayer2:m,showDetailedStats:!0}})}if(t.category==="comparison"&&t.redirectTo.subTab==="pairing"){const d=t.description.toLowerCase().includes("loup");f({selectedPairingTab:d?"wolves":"lovers"})}if(t.category==="kills"&&t.redirectTo.subTab==="deathStats"){const d=t.description.match(/(Villageois|Loups|Autres)/i);d&&f({deathStatsSelectedCamp:d[1]});let m=10;const R=t.description.match(/min\.\s*(\d+)/);R&&(m=parseInt(R[1],10));let P="totalKills",F="killers";const $=t.redirectTo.chartSection;$&&($==="killers-total"?(P="totalKills",F="killers"):$==="killers-average"?(P="averageKills",F="killers"):$==="deaths-total"?(P="totalDeaths",F="deaths"):$==="survivors-average"?(P="survivalRate",F="deaths"):($==="hunters-good"||$==="hunters-bad")&&(F="hunter",P="averageKills")),f({deathStatisticsState:{selectedCamp:d?.[1]||"Tous les camps",minGamesForAverage:m,selectedView:F,focusChart:P}})}if(t.category==="map"&&t.redirectTo.subTab==="playersGeneral"){const d=t.redirectTo.mapFilter||"all";let m=10;const R=t.description.match(/min\.\s*(\d+)/);R&&(m=parseInt(R[1])),c(j==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:d,playerFilter:{mode:"none",players:[]},highlightedPlayer:T,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:d,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:d,playerFilter:{mode:"none",players:[]},highlightedPlayer:T,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:d,playerFilter:{mode:"none",players:[]}}}),f({playersGeneralState:{minGamesForWinRate:m,winRateOrder:"best",focusChart:"winRate"}}),N("players","playersGeneral");return}if(t.category==="history"&&t.redirectTo.subTab==="history"&&f({selectedPlayerName:v.highlightedPlayer||"",groupingMethod:"session"}),t.category==="series"&&t.redirectTo.subTab==="series"){let d="wins";const m=t.title.toLowerCase(),R=t.description.toLowerCase();m.includes("dÃ©faite")||R.includes("dÃ©faite")?d="losses":m.includes("loup")||R.includes("loup")?d="loup":m.includes("villageois")||R.includes("villageois")?d="villageois":(m.includes("victoire")||R.includes("victoire"))&&(d="wins"),f({selectedSeriesType:d})}if(t.category==="general"&&t.redirectTo.subTab==="playersGeneral"){let d=10;const m=t.description.match(/min\.\s*(\d+)/);m&&(d=parseInt(m[1],10));let R="winRate",P="best";const F=t.title.toLowerCase(),$=t.description.toLowerCase();F.includes("participation")||$.includes("participation")?R="participation":(F.includes("taux de victoire")||$.includes("taux de victoire"))&&(R="winRate",(F.includes("moins bon")||F.includes("mauvais")||$.includes("moins bon")||$.includes("mauvais"))&&(P="worst")),f({playersGeneralState:{minGamesForWinRate:d,winRateOrder:P,focusChart:R}})}if(t.category==="performance"&&t.redirectTo.subTab==="campStats"){const d=t.redirectTo.chartSection;let m="Villageois",R=1;d&&(d==="camp-loup"?m="Loup":d==="camp-villageois"?m="Villageois":d==="camp-idiot"?m="Idiot du Village":d==="camp-amoureux"?m="Amoureux":(d==="solo-roles"||d==="hall-of-fame")&&(m="Villageois"));const P=t.description.match(/min\.\s*(\d+)/);P&&(R=parseInt(P[1],10)),d==="solo-roles"?m="RÃ´les spÃ©ciaux":d==="hall-of-fame"&&(m="Tous les camps"),f({campPerformanceState:{selectedCampPerformanceCamp:m,selectedCampPerformanceMinGames:R,viewMode:"performance"}})}if(t.category==="voting"&&t.redirectTo.subTab==="votingStats"){const d=t.title.toLowerCase();let m="overview",R="behavior";d.includes("agressivitÃ©")?(m="overview",R="behavior"):d.includes("taux de vote")?(m="behavior",R="voteRate"):d.includes("prÃ©cision")&&(m="overview",R="accuracy"),f({votingStatsState:{selectedCategory:m,selectedView:R}})}N(t.redirectTo.tab,t.redirectTo.subTab)},a=(t,y)=>{const T=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const d of T){const m=t.match(d);if(m&&m[1]){const R=m[1].trim();if(R!==y)return R}}return null},o=t=>{if(!t.redirectTo)return"Aucune navigation disponible";switch(t.category){case"general":if(t.redirectTo.subTab==="playersGeneral"){const d=t.description.match(/min\.\s*(\d+)/),m=d?parseInt(d[1],10):10,R=t.title.toLowerCase(),P=j==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return R.includes("taux de victoire")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${m} parties)${P}`:R.includes("participation")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les participations${P}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${P}`}break;case"map":if(t.redirectTo.subTab==="playersGeneral"){const d=t.redirectTo.mapFilter,m=d==="village"?"Village":d==="chateau"?"ChÃ¢teau":"map",R=j==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${m}${R}`}break;case"history":if(t.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(t.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${a(t.description,v.highlightedPlayer||"")||"ce joueur"}`;if(t.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(t.redirectTo.subTab==="deathStats"){const d=t.description.match(/(Villageois|Loups|Autres)/i),m=t.description.match(/min\.\s*(\d+)/),R=m?parseInt(m[1],10):10,P=d?.[1]||"Tous les camps",F=t.redirectTo.chartSection;let $="kills et morts";return F==="killers-total"?$="total des kills":F==="killers-average"?$=`moyenne des kills (min. ${R} parties)`:F==="deaths-total"?$="total des morts":F==="survivors-average"&&($=`taux de survie (min. ${R} parties)`),`Cliquez pour voir les statistiques de ${$} ${P!=="Tous les camps"?`en ${P}`:""}`}break;case"series":if(t.redirectTo.subTab==="series"){const d=t.title.toLowerCase(),m=t.description.toLowerCase();return d.includes("dÃ©faite")||m.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":d.includes("loup")||m.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":d.includes("villageois")||m.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":d.includes("victoire")||m.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(t.redirectTo.subTab==="campStats"){const d=t.redirectTo.chartSection,m=j==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return d==="camp-loup"?`Cliquez pour voir les performances camp Loup${m}`:d==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${m}`:d==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${m}`:d==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${m}`:d==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${m}`:d==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${m}`:`Cliquez pour voir les performances par camp${m}`}break;case"voting":if(t.redirectTo.subTab==="votingStats"){const d=t.description.match(/min\.\s*(\d+)/),m=d?parseInt(d[1],10):25,R=j==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",P=t.title.toLowerCase();return P.includes("agressivitÃ©")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${m} meetings)${R}`:P.includes("taux de vote")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${m} meetings)${R}`:P.includes("prÃ©cision")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${R}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${R}`}break}return`Cliquez pour voir ${t.redirectTo.subTab}`+(j==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},i=t=>r[t]||Se(t),g=t=>{const y=[/avec ([^:]+?):/,/contre ([^:]+?):/];let T=t;return y.forEach(d=>{const m=t.match(d);if(m&&m[1]){const R=m[1].trim(),F=`<span class="player-name-highlight" style="color: ${i(R)};">${R}</span>`;T=T.replace(R,F)}}),T};if(l.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:k}),e.jsx("p",{children:b||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const n=t=>t===1?"ðŸ¥‡":t===2?"ðŸ¥ˆ":t===3?"ðŸ¥‰":"",w=t=>t===1?"rank-1":t===2?"rank-2":t===3?"rank-3":t&&t<=10?"rank-top-10":"",S=(t,y)=>{if(!t||t<=3||!y)return;const T=t-3,d=y-3;return d<=1?"hsl(120, 70%, 50%)":`hsl(${120*(1-(T-1)/(d-1))}, 70%, 50%)`},z=t=>{if(!t)return;const y=t.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(y){const[,T,d]=y;return`hsl(${T}, ${d}%, 40%)`}return t},M=l.filter(t=>t.category!=="comparison"&&(t.type==="good"||t.type==="neutral")).sort((t,y)=>(t.rank??999)-(y.rank??999)),I=l.filter(t=>t.category!=="comparison"&&t.type==="bad").sort((t,y)=>(t.rank??999)-(y.rank??999)),x=l.filter(t=>t.category==="comparison"),p=M.filter(t=>t.rank&&t.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:k}),p>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:M.filter(t=>t.rank&&t.rank<=3).map((t,y)=>e.jsxs("div",{className:`top3-card ${w(t.rank)} animate-slide-in`,style:{animationDelay:`${y*.15}s`},onClick:T=>s(t,T),title:o(t),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:n(t.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:t.title}),e.jsx("p",{className:"top3-achievement-description",children:t.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},t.id))})]}),M.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:M.filter(t=>!t.rank||t.rank>3).map((t,y)=>{const T=S(t.rank,t.totalRanked),d=z(T);return e.jsxs("div",{className:`achievement-card good ${w(t.rank)}`,onClick:m=>s(t,m),title:o(t),style:{animationDelay:`${y*.05}s`,borderLeftColor:d,...T&&{borderLeftWidth:"4px"}},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",style:T?{backgroundColor:T}:{},children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id)})})]}),I.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:I.map(t=>{const y=S(t.rank,t.totalRanked),T=z(y);return e.jsxs("div",{className:`achievement-card bad rank-${t.rank}`,onClick:d=>s(t,d),title:o(t),style:{borderLeftColor:T,...y&&{borderLeftWidth:"4px"}},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",style:y?{backgroundColor:y}:{},children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id)})})]}),x.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:x.map(t=>e.jsxs("div",{className:"achievement-card comparison",onClick:y=>s(t,y),title:o(t),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:t.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:g(t.description)}})]},t.id))})]})]})}function _e({selectedPlayerName:l,groupingMethod:k,campFilter:b="all"}){const{navigateToGameDetails:j}=Z(),{data:N,isLoading:f,error:C}=ne(l),v=D.useMemo(()=>{switch(k){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[k]),c=D.useMemo(()=>{if(!N?.games)return new Map;const a=new Map;return N.games.forEach(o=>{if(!a.has(o.date)){const i=o.date.split("/");i.length===3?a.set(o.date,new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])).getTime()):a.set(o.date,new Date(o.date).getTime())}}),a},[N?.games]),u=D.useMemo(()=>{if(!N?.games)return[];const a={};return N.games.forEach(o=>{if(b!=="all"){if(b==="solo"){if(o.camp==="Villageois"||o.camp==="Loup")return}else if(o.camp!==b)return}let i;const g=o.date.split("/");if(k==="month")if(g.length===3)i=`${g[1].padStart(2,"0")}/${g[2]}`;else{const n=new Date(o.date);i=`${String(n.getMonth()+1).padStart(2,"0")}/${n.getFullYear()}`}else if(k==="quarter")if(g.length===3){const n=parseInt(g[1],10);i=`T${Math.floor((n-1)/3)+1}/${g[2]}`}else{const n=new Date(o.date);i=`T${Math.floor(n.getMonth()/3)+1}/${n.getFullYear()}`}else k==="year"?g.length===3?i=`${g[2]}`:i=`${new Date(o.date).getFullYear()}`:i=o.date;a[i]||(a[i]={games:[],wins:0,total:0}),a[i].games.push(o),a[i].total++,o.won&&a[i].wins++}),Object.entries(a).map(([o,i])=>({period:o,totalGames:i.total,victories:i.wins,defeats:i.total-i.wins,winRate:i.total>0?(i.wins/i.total*100).toFixed(1):"0.0",winRateNum:i.total>0?i.wins/i.total*100:0})).sort((o,i)=>{if(k==="month"){const[g,n]=o.period.split("/"),[w,S]=i.period.split("/"),z=new Date(parseInt(n),parseInt(g)-1,1),M=new Date(parseInt(S),parseInt(w)-1,1);return z.getTime()-M.getTime()}else if(k==="quarter"){const[g,n]=o.period.split("/"),[w,S]=i.period.split("/"),z=parseInt(g.replace(/\D/g,""),10)||1,M=parseInt(w.replace(/\D/g,""),10)||1,I=new Date(parseInt(n,10),(z-1)*3,1),x=new Date(parseInt(S,10),(M-1)*3,1);return I.getTime()-x.getTime()}else if(k==="year"){const g=parseInt(o.period,10),n=parseInt(i.period,10);return g-n}else{const g=c.get(o.period)||0,n=c.get(i.period)||0;return g-n}})},[N,k,c,b]),s=(a=>a<=15?{fontSize:12,angle:-45,height:80,interval:0}:a<=30?{fontSize:12,angle:-45,height:85,interval:1}:a<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(a/12)})(u.length);return f?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):C?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",C]}):N?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",v]}),e.jsx(K,{title:`Ã‰volution des Performances ${v}`,children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(Ne,{data:u,margin:{top:20,right:30,left:20,bottom:20},onClick:a=>{if(a&&a.activeLabel){const o=u.find(i=>i.period===a.activeLabel);o&&j({selectedPlayer:l,selectedDate:o.period,fromComponent:`Ã‰volution des Performances ${v}`})}},style:{cursor:"pointer"},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"period",angle:s.angle,textAnchor:"end",height:s.height,interval:s.interval,fontSize:s.fontSize}),e.jsx(_,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:a,payload:o})=>{if(a&&o&&o.length>0){const i=o[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Parties: ",i.totalGames]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(Te,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",v]}),e.jsx(K,{title:`RÃ©partition Victoires/DÃ©faites ${v}`,children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:u,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"period",angle:s.angle,textAnchor:"end",height:s.height,interval:s.interval,fontSize:s.fontSize}),e.jsx(_,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:a,payload:o})=>{if(a&&o&&o.length>0){const i=o[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Total: ",i.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["DÃ©faites: ",i.defeats]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(J,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:u.map((a,o)=>e.jsx(U,{fill:"var(--accent-tertiary)",onClick:()=>{j({selectedPlayer:l,selectedDate:a.period,fromComponent:`Historique Joueur - Victoires ${v}`})},style:{cursor:"pointer"}},`cell-victories-${o}`))}),e.jsx(J,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:u.map((a,o)=>e.jsx(U,{fill:"var(--chart-color-4)",onClick:()=>{j({selectedPlayer:l,selectedDate:a.period,fromComponent:`Historique Joueur - DÃ©faites ${v}`})},style:{cursor:"pointer"}},`cell-defeats-${o}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Ue({selectedPlayerName:l}){const{navigateToGameDetails:k}=Z(),{data:b,isLoading:j,error:N}=ne(l),f=ie(),C=D.useMemo(()=>b?.campStats?Object.entries(b.campStats).map(([c,u])=>({name:c,value:u.appearances,winRate:u.winRate,winRateDisplay:Math.max(parseFloat(u.winRate),1),wins:u.wins,percentage:(u.appearances/b.totalGames*100).toFixed(1)})):[],[b]),v=D.useMemo(()=>{if(!C.length)return[];const c=5;let u=0;const r=[],s=[];if(C.forEach(a=>{parseFloat(a.percentage)<c?(u+=Number(a.value),r.push(a)):s.push(a)}),u>0){const a=C.reduce((o,i)=>o+Number(i.value),0);s.push({name:"Autres",value:u,winRate:"0.0",winRateDisplay:1,wins:r.reduce((o,i)=>o+i.wins,0),percentage:(u/a*100).toFixed(1),_details:r})}return s},[C]);return j?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):N?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",N]}):b?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(Pe,{children:[e.jsx(Me,{data:v,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:c=>{const u=c.percent!==void 0?c.percent:0;return c.name==="Autres"?`Autres : ${c.value} (${(u*100).toFixed(1)}%)`:`${c.name}: ${c.value} (${(u*100).toFixed(1)}%)`},children:v.map((c,u)=>e.jsx(U,{fill:c.name==="Autres"?fe:f[c.name]||`var(--chart-color-${u%6+1})`,onClick:()=>{if(c.name==="Autres"){const r=c._details?.map(s=>s.name)||[];k({selectedPlayer:l,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:r},fromComponent:"Distribution par Camps"})}else c.name==="TraÃ®tre"||c.name==="Louveteau"?k({selectedPlayer:l,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):c.name==="Loup"?k({selectedPlayer:l,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):k({selectedPlayer:l,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${u}`))}),e.jsx(G,{content:({active:c,payload:u})=>{if(c&&u&&u.length>0){const r=u[0].payload;if(r.name==="Autres"&&r._details){const s=[...r._details].sort((a,o)=>o.value-a.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{children:s.map((a,o)=>e.jsxs("div",{children:[a.name,": ",a.value," parties (",a.percentage,"%)"]},o))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[r.name," - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(K,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:C,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(_,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:c,payload:u})=>{if(c&&u&&u.length>0){const r=u[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.value]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(J,{dataKey:"winRateDisplay",children:C.map((c,u)=>e.jsx(U,{fill:parseFloat(c.winRate)===0?`${f[c.name]||`var(--chart-color-${u%6+1})`}50`:f[c.name]||`var(--chart-color-${u%6+1})`,onClick:()=>{c.name==="TraÃ®tre"||c.name==="Louveteau"?k({selectedPlayer:l,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):c.name==="Loup"?k({selectedPlayer:l,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):k({selectedPlayer:l,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${u}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Ye({selectedPlayerName:l}){const{navigateToGameDetails:k,navigationState:b,updateNavigationState:j}=Z(),[N,f]=D.useState(b.playerHistoryMapState?.selectedCamp||"Tous les camps"),{data:C}=De(),{data:v,isLoading:c,error:u}=ne(l,N);D.useEffect(()=>{(!b.playerHistoryMapState||b.playerHistoryMapState.selectedCamp!==N)&&j({playerHistoryMapState:{selectedCamp:N}})},[N,b.playerHistoryMapState,j]);const r=a=>{f(a),j({playerHistoryMapState:{selectedCamp:a}})},s=D.useMemo(()=>{if(!v?.mapStats)return[];const a=He(v.mapStats);return Object.entries(a).map(([o,i])=>({name:o,value:i.appearances,winRate:i.winRate,winRateDisplay:Math.max(parseFloat(i.winRate),.1),wins:i.wins,percentage:(i.appearances/v.totalGames*100).toFixed(1)}))},[v]);return c?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):u?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]}):v?e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Performance par Carte",N!=="Tous les camps"?` (${N})`:""]}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select-map",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select-map",value:N,onChange:a=>r(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),C?.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),s.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur avec le camp sÃ©lectionnÃ©."})]}):e.jsx(K,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:s,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(_,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(oe,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(s.length>0){const a=s.reduce((g,n)=>g+n.value,0),o=s.reduce((g,n)=>g+n.wins,0),i=a>0?o/a*100:0;if(i!==50)return e.jsx(oe,{y:i,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${i.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(G,{content:({active:a,payload:o})=>{if(a&&o&&o.length>0){const i=o[0].payload,g=[];return s.forEach(n=>{if(n.name!==i.name&&n.value>=5){const w=parseFloat(i.winRate)-parseFloat(n.winRate);Math.abs(w)>=2&&g.push({map:n.name,diff:w,better:w>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Parties: ",i.value]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",i.winRate,"%"]})}),g.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),g.map((n,w)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:n.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[n.better?"â†—":"â†˜"," ",Math.abs(n.diff).toFixed(1),"% vs ",n.map]},w))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(J,{dataKey:"winRateDisplay",label:a=>{const{x:o,y:i,width:g,payload:n}=a;if(o===void 0||i===void 0||g===void 0||!n)return null;const w=n.winRate||"0";return e.jsxs("text",{x:o+g/2,y:i-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[w,"%"]})},onClick:a=>{if(a&&a.name){const o={selectedPlayer:l,selectedMapName:a.name,fromComponent:"Performance par Carte"};N!=="Tous les camps"&&(o.campFilter={selectedCamp:N,campFilterMode:"all-assignments"}),k(o)}},children:s.map((a,o)=>{let i;a.name==="Village"?i="var(--accent-secondary)":a.name==="ChÃ¢teau"?i="var(--accent-tertiary)":a.name==="Autres"?i=fe:i=`var(--chart-color-${o%6+1})`;const g=Math.max(...s.map(w=>parseFloat(w.winRate))),n=parseFloat(a.winRate)===g&&g>0;return e.jsx(U,{fill:parseFloat(a.winRate)===0?`${i}30`:i,stroke:"transparent",strokeWidth:n?3:1,style:{cursor:"pointer"}},`cell-map-${o}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Je({selectedPlayerName:l}){const{gameData:k}=he(),{joueursData:b}=re(),j=le(b),N=ie(),f=D.useMemo(()=>{if(!k||!l)return{playersKilled:[],killedBy:[],deathTypes:[],availableDeathTypes:[]};const v={},c={},u={},r=new Set;k.forEach(g=>{const n=g.PlayerStats.find(w=>w.Username.toLowerCase()===l.toLowerCase());if(n&&(g.PlayerStats.forEach(w=>{w.KillerName?.toLowerCase()===l.toLowerCase()&&(v[w.Username]=(v[w.Username]||0)+1)}),n.KillerName&&(c[n.KillerName]=(c[n.KillerName]||0)+1),n.DeathType)){const w=n.DeathType,S=ee(w);u[S]||(u[S]={count:0,byDeathType:{}}),u[S].count+=1,u[S].byDeathType[w]=(u[S].byDeathType[w]||0)+1,r.add(w)}});const s=Object.entries(v).map(([g,n])=>({player:g,kills:n})).sort((g,n)=>n.kills-g.kills).slice(0,10),a=Object.entries(c).map(([g,n])=>({player:g,kills:n})).sort((g,n)=>n.kills-g.kills).slice(0,10),o=Object.entries(u).map(([g,n])=>{const w={deathType:g,count:n.count};return w[g]=n.count,w}).sort((g,n)=>n.count-g.count).slice(0,10),i=Object.keys(u);return{playersKilled:s,killedBy:a,deathTypes:o,availableDeathTypes:i}},[k,l]),C=D.useMemo(()=>{const v={};f.availableDeathTypes.forEach(r=>{r==="TuÃ© par Loup"?v[r]=N.Loup:r==="Mort aux votes"?v[r]="var(--chart-color-1)":r.includes("Chasseur")?v[r]=N.Chasseur:r==="TuÃ© par Zombie"?v[r]=N.Vaudou:r==="TuÃ© par potion assassin"?v[r]=N.Alchimiste:r==="TuÃ© par Vengeur"?v[r]="var(--chart-color-2)":r==="Amoureux mort"?v[r]=N.Amoureux:r==="TuÃ© par La BÃªte"?v[r]="var(--chart-color-3)":r==="TuÃ© par ShÃ©rif"&&(v[r]="var(--chart-color-4)")});const c=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let u=0;return f.availableDeathTypes.forEach(r=>{v[r]||(v[r]=c[u%c.length],u++)}),v},[f.availableDeathTypes,N]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[f.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Victimes"}),e.jsx(K,{title:"Les Victimes",children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:f.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(_,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:v,payload:c})=>{if(v&&c&&c.length>0){const u=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:u.player})}),e.jsxs("div",{children:["TuÃ© ",u.kills," fois par ",l]})]})}return null}}),e.jsx(J,{dataKey:"kills",children:f.playersKilled.map((v,c)=>e.jsx(U,{fill:j[v.player]||"var(--chart-color-3)"},`cell-killed-${c}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[l," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),f.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Tueurs"}),e.jsx(K,{title:"Les Tueurs",children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:f.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(_,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:v,payload:c})=>{if(v&&c&&c.length>0){const u=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:u.player})}),e.jsxs("div",{children:["A tuÃ© ",l," ",u.kills," fois"]})]})}return null}}),e.jsx(J,{dataKey:"kills",children:f.killedBy.map((v,c)=>e.jsx(U,{fill:j[v.player]||"var(--chart-color-4)"},`cell-killer-${c}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[l," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]}),f.deathTypes.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Mort les Plus FrÃ©quents"}),e.jsx(K,{title:"Types de Mort les Plus FrÃ©quents",children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:f.deathTypes,margin:{top:20,right:30,left:20,bottom:90},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"deathType",angle:-45,textAnchor:"end",height:120,interval:0,fontSize:12}),e.jsx(_,{label:{value:"Nombre de morts",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:v,payload:c})=>{if(v&&c&&c.length>0){const u=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:u.deathType})}),e.jsxs("div",{children:[l," est mort ",u.count," fois ainsi"]})]})}return null}}),f.availableDeathTypes.map(v=>e.jsx(J,{dataKey:v,name:v,stackId:"deaths",fill:C[v]||"var(--chart-color-5)"},v))]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de mort"}),e.jsxs("p",{children:["Aucune information de mort disponible pour ",l,"."]})]})]})}function Xe(l,k){if(!l||l.trim()===""||k.length===0)return null;const b=new Map,j=new Map,N=new Map;k.forEach(u=>{if(!u.Modded)return;const r=u.PlayerStats.find(s=>te(s)===l||s.Username.toLowerCase()===l.toLowerCase());if(r){if(r.MainRoleInitial==="Inconnu")return;const s=r.Victorious,o=xe(r.MainRoleInitial,r.MainRoleChanges||[])!==r.MainRoleInitial,i=se(r.MainRoleInitial),g=i==="Loup"||i==="TraÃ®tre"||i==="Louveteau";if(i==="Villageois"&&ce(r)){const n=de(r);if(n&&Fe.includes(n)){const w=b.get(n)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};b.set(n,{appearances:w.appearances+1,wins:w.wins+(s?1:0),winsWithoutRoleChange:w.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:w.gamesWithoutRoleChange+(o?0:1)})}}else if(r.Power&&r.Power.trim()!==""&&r.Power!=="Inconnu"){if(i==="Villageois"){const n=b.get(r.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};b.set(r.Power,{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1)})}else if(g){const n=j.get(r.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},w=n.roleBreakdown;w.set(r.MainRoleInitial,(w.get(r.MainRoleInitial)||0)+1),j.set(r.Power,{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1),roleBreakdown:w})}}else if((i==="Villageois"||g)&&r.Power!=="Inconnu")if(i==="Villageois"){const n=b.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};b.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1)})}else{const n=j.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},w=n.roleBreakdown;w.set(r.MainRoleInitial,(w.get(r.MainRoleInitial)||0)+1),j.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1),roleBreakdown:w})}if(r.SecondaryRole&&r.SecondaryRole.trim()!==""&&r.SecondaryRole!=="Inconnu"){const n=N.get(r.SecondaryRole)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};N.set(r.SecondaryRole,{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1)})}}});const f=new Map;k.forEach(u=>{const r=u.PlayerStats.find(s=>te(s)===l||s.Username.toLowerCase()===l.toLowerCase());if(r&&ce(r)){const s=de(r);s&&f.set(s,(f.get(s)||0)+1)}});const C=u=>Array.from(u.entries()).map(([r,s])=>({name:r,appearances:s.appearances,wins:s.wins,winsWithoutRoleChange:s.winsWithoutRoleChange,gamesWithoutRoleChange:s.gamesWithoutRoleChange,winRate:s.gamesWithoutRoleChange>0?(s.winsWithoutRoleChange/s.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Villageois",...f.has(r)&&{totalGamesAllModes:f.get(r)}})).sort((r,s)=>s.appearances-r.appearances),v=u=>Array.from(u.entries()).map(([r,s])=>({name:r,appearances:s.appearances,wins:s.wins,winsWithoutRoleChange:s.winsWithoutRoleChange,gamesWithoutRoleChange:s.gamesWithoutRoleChange,winRate:s.gamesWithoutRoleChange>0?(s.winsWithoutRoleChange/s.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Loup",roleBreakdown:Array.from(s.roleBreakdown.entries()).map(([a,o])=>({role:a,count:o})).sort((a,o)=>o.count-a.count)})).sort((r,s)=>s.appearances-r.appearances),c=u=>Array.from(u.entries()).map(([r,s])=>({name:r,appearances:s.appearances,wins:s.wins,winsWithoutRoleChange:s.winsWithoutRoleChange,gamesWithoutRoleChange:s.gamesWithoutRoleChange,winRate:s.gamesWithoutRoleChange>0?(s.winsWithoutRoleChange/s.gamesWithoutRoleChange*100).toFixed(1):"0.0"})).sort((r,s)=>s.appearances-r.appearances);return{villageoisPowers:C(b),loupPowers:v(j),secondaryRoles:c(N)}}function Ze({selectedPlayerName:l}){const{navigateToGameDetails:k,navigationState:b,updateNavigationState:j}=Z(),{settings:N}=ae(),f=ie(),[C,v]=D.useState(b.playerHistoryRolesState?.chartMode||"appearances"),{data:c,isLoading:u,error:r}=ge(S=>Xe(l,S));D.useEffect(()=>{(!b.playerHistoryRolesState||b.playerHistoryRolesState.chartMode!==C)&&j({playerHistoryRolesState:{chartMode:C}})},[C,b.playerHistoryRolesState,j]);const s=S=>{v(S),j({playerHistoryRolesState:{chartMode:S}})},a=D.useMemo(()=>{if(!c)return{villageoisPowers:[],loupPowers:[],secondaryRoles:[]};const S=1,z=1,M=15,I=C==="winRate"?(p,t)=>parseFloat(t.winRate)-parseFloat(p.winRate):(p,t)=>t.appearances-p.appearances,x=p=>({...p,winRateDisplay:Math.max(parseFloat(p.winRate),1)});return{villageoisPowers:c.villageoisPowers.filter(p=>p.appearances>=S).map(x).sort(I).slice(0,M),loupPowers:c.loupPowers.filter(p=>p.appearances>=S).map(x).sort(I).slice(0,M),secondaryRoles:c.secondaryRoles.filter(p=>p.appearances>=z).map(x).sort(I).slice(0,M)}},[c,C]);if(u)return e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique des rÃ´les..."});if(r)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",r]});if(!c)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de rÃ´le disponible"});const o=a.villageoisPowers.length>0,i=a.loupPowers.length>0,g=a.secondaryRoles.length>0;if(!o&&!i&&!g)return e.jsx("div",{className:"donnees-manquantes",children:"Aucun pouvoir ou rÃ´le secondaire trouvÃ©"});const n=({active:S,payload:z})=>{if(S&&z&&z.length>0){const M=z[0].payload,I=M.gamesWithoutRoleChange<M.appearances;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:M.name})}),e.jsxs("div",{children:["Apparitions: ",M.appearances]}),I&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"0.25rem"},children:["dont ",M.appearances-M.gamesWithoutRoleChange," avec changement de rÃ´le (exclu du calcul)"]}),e.jsxs("div",{children:["Victoires: ",M.winsWithoutRoleChange]}),e.jsx("div",{children:e.jsxs("strong",{children:["Taux de victoire: ",M.winRate,"%"]})}),M.totalGamesAllModes&&M.totalGamesAllModes!==M.appearances&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic"},children:["(Total avec parties non moddÃ©es: ",M.totalGamesAllModes,")"]}),M.roleBreakdown&&M.roleBreakdown.length>0&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:[e.jsx("div",{style:{fontStyle:"italic"},children:"RÃ©partition par rÃ´le:"}),M.roleBreakdown.map((x,p)=>e.jsxs("div",{style:{marginLeft:"0.5rem"},children:["â€¢ ",x.role,": ",x.count]},p))]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},w=(S,z,M,I,x)=>{const p=C==="appearances"?"appearances":"winRateDisplay",t=C==="appearances"?"Nombre d'apparitions":"Taux de victoire (%)",y=C==="winRate"?[0,100]:void 0;return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:z}),e.jsx(K,{title:z,children:e.jsx("div",{style:{height:400},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(X,{data:S,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:12,tick:({x:T,y:d,payload:m})=>e.jsx("text",{x:T,y:d,textAnchor:"end",transform:`rotate(-45, ${T}, ${d})`,fill:N.highlightedPlayer===l?"var(--text-primary)":"var(--text-secondary)",fontSize:12,children:m.value})}),e.jsx(_,{label:{value:t,angle:270,position:"left",style:{textAnchor:"middle"}},domain:y}),e.jsx(G,{content:e.jsx(n,{})}),e.jsx(J,{dataKey:p,label:C==="winRate"?T=>{const{x:d,y:m,width:R,payload:P}=T;if(d===void 0||m===void 0||R===void 0||!P)return null;const F=P.winRate||"0";return e.jsxs("text",{x:d+R/2,y:m-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[F,"%"]})}:void 0,children:S.map((T,d)=>e.jsx(U,{fill:x?x(T.name,d):M,onClick:()=>I(T.name),style:{cursor:"pointer"}},`cell-${d}`))})]})})})})]})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"chart-mode-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Affichage :"}),e.jsxs("select",{id:"chart-mode-select",value:C,onChange:S=>s(S.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"180px"},children:[e.jsx("option",{value:"appearances",children:"Apparitions"}),e.jsx("option",{value:"winRate",children:"Taux de victoire"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[o&&w(a.villageoisPowers,"Camp Villageois","var(--chart-color-1)",S=>{k({selectedPlayer:l,campFilter:{selectedCamp:"Villageois",campFilterMode:C==="winRate"?"wins-only":"all-assignments"},selectedPower:S,fromComponent:`Historique des RÃ´les - Pouvoir: ${S}`})},S=>S==="Chasseur"&&f.Chasseur?f.Chasseur:S==="Alchimiste"&&f.Alchimiste?f.Alchimiste:S==="Protecteur"&&f.Protecteur?f.Protecteur:S==="Disciple"&&f.Disciple?f.Disciple:"var(--chart-color-1)"),i&&w(a.loupPowers,"Camp Loups","var(--chart-color-2)",S=>{k({selectedPlayer:l,campFilter:{selectedCamp:"Loup",campFilterMode:C==="winRate"?"wins-only":"all-assignments"},selectedPower:S,fromComponent:`Historique des RÃ´les - Pouvoir: ${S}`})},()=>f.Loup||"var(--chart-color-2)"),g&&w(a.secondaryRoles,"RÃ´les Secondaires","var(--chart-color-3)",S=>{k({selectedPlayer:l,selectedSecondaryRole:S,fromComponent:`Historique des RÃ´les - RÃ´le Secondaire: ${S}`})}),e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"16px",padding:"8px",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)"},children:"â„¹ï¸ Les victoires et le taux de victoire excluent les parties oÃ¹ le rÃ´le principal a changÃ© en cours de partie (ex: Garde en Chasseur, rÃ©ssucitÃ© en Zombie par un Vaudou, etc...)."})]})]})}function me(l){return l==="SURVIVALIST_NOT_SAVED"?"BY_WOLF":l}function Qe({selectedPlayerName:l}){const{navigateToGameDetails:k}=Z(),{gameData:b,isLoading:j,error:N}=he(),f=ie(),[C,v]=D.useState("deaths"),[c,u]=D.useState(""),[r,s]=D.useState(0),a=D.useMemo(()=>{if(!b)return[];const x=new Set;return b.forEach(p=>{const t=p.PlayerStats.find(y=>y.Username.toLowerCase()===l.toLowerCase());t&&(t.DeathPosition!==null&&p.MapName&&x.add(p.MapName),p.PlayerStats.forEach(y=>{y.KillerName?.toLowerCase()===l.toLowerCase()&&y.DeathPosition!==null&&p.MapName&&x.add(p.MapName)}))}),Array.from(x).filter(p=>p==="Village"||p==="ChÃ¢teau").sort((p,t)=>p==="Village"?-1:t==="Village"?1:p.localeCompare(t))},[b,l]),o=a.length>0?a[0]:"";c===""&&o!==""&&u(o);const i=D.useMemo(()=>{if(!b||!l)return[];const x=[];return b.forEach(p=>{if(c&&p.MapName!==c)return;const t=p.PlayerStats.find(y=>y.Username.toLowerCase()===l.toLowerCase());if(t)if(C==="deaths"){if(t.DeathPosition){const y=se(t.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0}),T=ue(t.DeathPosition.x,t.DeathPosition.z,p.MapName);x.push({x:T.x,z:T.z,victimName:t.Username,killerName:t.KillerName||null,deathType:me(t.DeathType),mapName:p.MapName,camp:y,gameId:p.DisplayedId,displayedGameId:p.DisplayedId})}}else p.PlayerStats.forEach(y=>{if(y.KillerName?.toLowerCase()===l.toLowerCase()&&y.DeathPosition){const T=se(y.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0}),d=ue(y.DeathPosition.x,y.DeathPosition.z,p.MapName);x.push({x:d.x,z:d.z,victimName:y.Username,killerName:l,deathType:me(y.DeathType),mapName:p.MapName,camp:T,gameId:p.DisplayedId,displayedGameId:p.DisplayedId})}})}),x},[b,l,C,c]),g=D.useMemo(()=>Ae(i,r).map((p,t)=>{const y=p.items[0],T=$e(p.items);return{x:p.centroidX,z:p.centroidZ,count:p.items.length,allLocations:p.items,victimName:p.items.length===1?y.victimName:null,killerName:p.items.length===1?y.killerName:null,deathType:T,mapName:y.mapName,camp:y.camp,gameId:p.items.length===1?y.gameId:null,displayedGameId:p.items.length===1?y.displayedGameId:null,clusterIndex:t}}),[i,r]),n=D.useMemo(()=>ze(c),[c]),{xDomain:w,zDomain:S}=D.useMemo(()=>{if(n)return{xDomain:[n.xMin,n.xMax],zDomain:[n.zMin,n.zMax]};if(g.length===0)return{xDomain:[0,100],zDomain:[0,100]};const x=g.map(P=>P.x),p=g.map(P=>P.z),t=Math.min(...x),y=Math.max(...x),T=Math.min(...p),d=Math.max(...p),m=(y-t)*.1||10,R=(d-T)*.1||10;return{xDomain:[t-m,y+m],zDomain:[T-R,d+R]}},[g,n]),z=x=>x?x==="BY_WOLF"||x==="SURVIVALIST_NOT_SAVED"?f.Loup:x==="VOTED"?"var(--chart-color-1)":x==="BULLET"||x==="BULLET_HUMAN"||x==="BULLET_WOLF"?f.Chasseur:x==="BY_ZOMBIE"?f.Vaudou:x==="ASSASSIN"?f.Alchimiste:x==="AVENGER"?"var(--chart-color-2)":x==="LOVER_DEATH"?f.Amoureux:x==="BY_BEAST"?"var(--chart-color-3)":x==="SHERIF_SUCCESS"?"var(--chart-color-4)":x==="SMUGGLER_HUNT_KILL"?f.Contrebandier:"var(--accent-primary)":"var(--text-secondary)",M=({active:x,payload:p})=>{if(!x||!p||p.length===0)return null;const t=p[0].payload,y=t.allLocations||[t];if(y.length>1){const m=new Map,R=new Map,P=new Set;y.forEach(W=>{m.set(W.victimName,(m.get(W.victimName)||0)+1);const L=W.deathType?ee(W.deathType):"Inconnu";R.set(L,(R.get(L)||0)+1),P.add(W.gameId)});const F=Array.from(m.entries()).sort((W,L)=>L[1]-W[1]).slice(0,3),$=Array.from(R.entries()).sort((W,L)=>L[1]-W[1]).slice(0,3);return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"350px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[C==="deaths"?"ðŸ’€":"âš”ï¸"," ",y.length," ",C==="deaths"?"morts":"kills"," Ã  cet endroit"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:C==="deaths"?"Par:":"Victimes:"}),F.map(([W,L])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",W," (",L,"x)"]},W)),m.size>3&&e.jsxs("div",{style:{paddingLeft:"0.5rem",color:"var(--text-secondary)"},children:["+",m.size-3," autres..."]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Types de mort:"}),$.map(([W,L])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",W," (",L,"x)"]},W))]}),e.jsxs("div",{style:{marginTop:"8px",color:"var(--text-secondary)"},children:["ðŸ“ ",P.size," partie",P.size>1?"s":""," diffÃ©rente",P.size>1?"s":""]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les parties concernÃ©es"})]})}const d=y[0];return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[C==="deaths"?"ðŸ’€":"âš”ï¸"," ",C==="deaths"?"Mort de":"Kill de"," ",l]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[C==="deaths"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"TuÃ© par:"})," ",d.killerName||"Inconnu"]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",d.deathType?ee(d.deathType):"Inconnue"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"Victime:"})," ",d.victimName]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",d.deathType?ee(d.deathType):"Inconnue"]}),e.jsxs("div",{children:["ðŸ‘¥ ",e.jsx("strong",{children:"Camp victime:"})," ",d.camp]})]}),e.jsxs("div",{children:["ðŸ—ºï¸ ",e.jsx("strong",{children:"Carte:"})," ",d.mapName]}),e.jsxs("div",{children:["ðŸŽ® ",e.jsx("strong",{children:"Partie:"})," #",d.gameId]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les dÃ©tails de la partie"})]})},I=x=>{if(!x)return;const p=x.allLocations||[x];if(p.length===1)k({selectedGame:p[0].gameId,fromComponent:"Player Death Map"});else{const t=p.map(y=>y.gameId).filter(y=>y);k({selectedGameIds:t,fromComponent:"Player Death Map"})}};return j?e.jsx("div",{className:"donnees-attente",children:"Chargement des donnÃ©es..."}):N?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",N]}):b?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{style:{flex:"1 1 100%",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Afficher :"}),e.jsxs("div",{style:{display:"flex",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)",overflow:"hidden"},children:[e.jsx("button",{type:"button",onClick:()=>v("deaths"),style:{background:C==="deaths"?"var(--accent-primary)":"transparent",color:C==="deaths"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:C==="deaths"?"bold":"normal",transition:"all 0.2s"},children:"ðŸ’€ Morts"}),e.jsx("button",{type:"button",onClick:()=>v("kills"),style:{background:C==="kills"?"var(--accent-primary)":"transparent",color:C==="kills"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:C==="kills"?"bold":"normal",transition:"all 0.2s"},children:"âš”ï¸ Kills"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-map-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Carte :"}),e.jsx("select",{id:"player-map-select",value:c,onChange:x=>u(x.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:a.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"cluster-slider",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Regroupement :"}),e.jsx("input",{id:"cluster-slider",type:"range",min:"0",max:"50",step:"5",value:r,onChange:x=>s(parseInt(x.target.value)),style:{width:"80px"}}),e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",minWidth:"60px"},children:r===0?"Aucun":`${r} unitÃ©${r>1?"s":""}`})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{flex:"1 1 100%",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:C==="deaths"?"Morts localisÃ©es":"Kills localisÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:C==="deaths"?"var(--accent-secondary)":"var(--accent-primary)"},children:i.length}),r>0&&g.length<i.length&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginTop:"4px"},children:["â†’ ",g.length," points groupÃ©s"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Carte"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-2)",fontSize:"1.2rem"},children:c||"Aucune"})]})]}),e.jsx("div",{className:"lycans-graphique-section",style:{flex:"1 1 100%",minWidth:"100%"},children:i.length>0?e.jsx(K,{title:C==="deaths"?`Carte des Morts de ${l}`:`Carte des Kills de ${l}`,children:e.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto",aspectRatio:"1640 / 922"},children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(We,{margin:{top:20,right:30,left:60,bottom:60},children:[n&&e.jsx(Ie,{x1:n.zMin,x2:n.zMax,y1:n.xMin,y2:n.xMax,fill:"transparent",stroke:"none",shape:x=>{const{x:p,y:t,width:y,height:T}=x;return e.jsx("image",{x:p,y:t,width:y,height:T,href:n.src,preserveAspectRatio:"xMidYMid slice",style:{opacity:.85}})}}),e.jsx(H,{strokeDasharray:"3 3",stroke:n?"rgba(255,255,255,0.3)":"var(--border-color)"}),e.jsx(O,{dataKey:"z",type:"number",name:"Position Z",label:{value:"Position Z",position:"bottom",offset:10,style:{fill:"var(--text-secondary)"}},domain:S,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:x=>Math.round(x).toString()}),e.jsx(_,{dataKey:"x",type:"number",name:"Position X",label:{value:"Position X",angle:-90,position:"left",offset:20,style:{fill:"var(--text-secondary)"}},domain:w,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:x=>Math.round(x).toString()}),e.jsx(G,{content:e.jsx(M,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(Le,{data:g,onClick:x=>I(x),style:{cursor:"pointer"},isAnimationActive:!1,children:g.map((x,p)=>{const t=Math.min(Math.log2(x.count+1)*3+5,18),y=Math.round(t);return e.jsx(U,{fill:z(x.deathType),stroke:x.count>1?"white":"rgba(255,255,255,0.5)",strokeWidth:x.count>1?2:1,opacity:.85,r:y},`cell-${p}`)})})]})})})}):e.jsxs("div",{className:"donnees-manquantes",style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"0.5rem"},children:C==="deaths"?`Aucune mort localisÃ©e pour ${l} sur cette carte.`:`Aucun kill localisÃ© pour ${l} sur cette carte.`}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Les donnÃ©es de position ne sont disponibles que pour les parties rÃ©centes."})]})}),e.jsxs("div",{className:"lycans-section-description",style:{flex:"1 1 100%",marginTop:"1.5rem"},children:[e.jsx("h4",{children:"Ã€ propos de cette carte"}),e.jsxs("p",{children:["Cette carte affiche ",C==="deaths"?`les emplacements oÃ¹ ${l} est mort`:`les emplacements oÃ¹ ${l} a Ã©liminÃ© d'autres joueurs`," au cours des parties. Les couleurs indiquent le type de mort. Cliquez sur un point pour voir les dÃ©tails de la partie."]}),e.jsxs("p",{style:{marginTop:"0.5rem"},children:["Les points regroupÃ©s ont une petite bordure blanche.",e.jsx("br",{}),e.jsx("strong",{children:"ðŸ’€ Morts:"})," OÃ¹ le joueur a Ã©tÃ© Ã©liminÃ©",e.jsx("br",{}),e.jsx("strong",{children:"âš”ï¸ Kills:"})," OÃ¹ le joueur a Ã©liminÃ© d'autres joueurs"]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e disponible"})}function wt(){const{settings:l,updateSettings:k}=ae(),{navigateToGameDetails:b,navigationState:j,updateNavigationState:N}=Z(),{data:f,isLoading:C,error:v}=Ce(),{joueursData:c,isLoading:u}=re(),{data:r,isLoading:s,error:a}=Be(l.highlightedPlayer),o=le(c),[i,g]=D.useState(""),[n,w]=D.useState(null),{clips:S}=qe(l.highlightedPlayer),{clips:z}=Ee(),[M,I]=D.useState(()=>l.useIndependentFilters&&l.independentFilters?.gameTypeEnabled?l.independentFilters.gameFilter==="modded"?"modded":"all":l.gameFilter==="modded"?"modded":"all"),x=D.useMemo(()=>l.useIndependentFilters&&l.independentFilters?.gameTypeEnabled?l.independentFilters.gameFilter==="modded":l.gameFilter==="modded",[l.useIndependentFilters,l.independentFilters?.gameTypeEnabled,l.independentFilters?.gameFilter,l.gameFilter]),[p,t]=D.useState(j.selectedPlayerSelectionView||"achievements"),[y,T]=D.useState("session"),[d,m]=D.useState("all");D.useEffect(()=>{if(l.useIndependentFilters&&l.independentFilters?.gameTypeEnabled){const h=l.independentFilters.gameFilter==="modded"?"modded":"all";I(h)}else if(!l.useIndependentFilters){const h=l.gameFilter==="modded"?"modded":"all";I(h)}},[l.gameFilter,l.useIndependentFilters,l.independentFilters?.gameTypeEnabled,l.independentFilters?.gameFilter]),D.useEffect(()=>{x&&M!=="modded"&&I("modded")},[x,M]),D.useEffect(()=>{j.selectedPlayerSelectionView&&t(j.selectedPlayerSelectionView)},[j.selectedPlayerSelectionView]);const{data:R}=ne(l.highlightedPlayer||""),P=D.useMemo(()=>{if(!f||!f.GameStats)return[];const h=x?f.GameStats.filter(V=>V.Modded===!0):f.GameStats,A=new Map;return h.forEach(V=>{const q=new Date(V.StartDate);V.PlayerStats.forEach(B=>{const Y=te(B),ve=c?.Players?.find(je=>je.SteamID===Y)?.Joueur||B.Username;A.has(Y)||A.set(Y,{games:0,wins:0,firstDate:q,lastDate:q,displayName:ve});const Q=A.get(Y);Q.games++,B.Victorious&&Q.wins++,q<Q.firstDate&&(Q.firstDate=q),q>Q.lastDate&&(Q.lastDate=q)})}),Array.from(A.entries()).map(([V,q])=>{let B=c?.Players?.find(Y=>Y.SteamID===V);return B||(B=c?.Players?.find(Y=>Y.Joueur===q.displayName)),{id:V,name:q.displayName,totalGames:q.games,totalWins:q.wins,winRate:q.games>0?q.wins/q.games*100:0,firstGameDate:q.firstDate.toLocaleDateString("fr-FR"),lastGameDate:q.lastDate.toLocaleDateString("fr-FR"),isHighlighted:q.displayName===l.highlightedPlayer,image:B?.Image||null,twitch:B?.Twitch||null,youtube:B?.Youtube||null}})},[f,l.highlightedPlayer,c,x]),F=D.useMemo(()=>{if(!i.trim())return P;const h=i.toLowerCase();return P.filter(A=>A.name.toLowerCase().includes(h))},[P,i]),$=D.useMemo(()=>[...F].sort((h,A)=>A.totalGames-h.totalGames),[F]),W=h=>{k({highlightedPlayer:h}),g("")},L=h=>{t(h),N({selectedPlayerSelectionView:h})},ye=()=>{if(S.length===0)return;const h=Math.floor(Math.random()*S.length);w(S[h])};return C||u?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):v?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",v]})]}):!f||P.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!l.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:i,onChange:h=>g(h.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[F.length," joueur",F.length!==1?"s":"",i&&` (filtrÃ©${F.length!==1?"s":""} de ${P.length})`]})]})]}),e.jsx("div",{className:"player-display",children:i?F.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{type:"button",className:"clear-search-btn",onClick:()=>g(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:$.map(h=>e.jsxs("button",{type:"button",className:`suggestion-btn ${h.isHighlighted?"highlighted":""}`,onClick:()=>W(h.name),children:[h.image?e.jsx("img",{src:h.image,alt:`Photo de profil de ${h.name}`,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":o[h.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[h.name,h.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[h.totalGames," parties â€¢ ",h.winRate.toFixed(1),"% victoires"]})]})]},h.id))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',i,'"']}),e.jsx("button",{type:"button",className:"clear-search-btn",onClick:()=>g(""),children:"Effacer la recherche"})]}):l.highlightedPlayer?(()=>{const h=P.find(A=>A.name===l.highlightedPlayer);return h?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:h.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[h.image?e.jsx("img",{src:h.image,alt:`Photo de profil de ${h.name}`,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":o[h.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[h.totalGames," parties â€¢ ",h.totalWins," victoires â€¢ ",h.winRate.toFixed(1),"% taux de victoire"]}),(h.twitch||h.youtube||S.length>0)&&e.jsxs("div",{className:"social-links",children:[h.twitch&&e.jsx("a",{href:h.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),h.youtube&&e.jsx("a",{href:h.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"}),S.length>0&&e.jsxs("button",{type:"button",className:"social-link clips-btn",onClick:A=>{A.stopPropagation(),ye()},title:`${S.length} clip${S.length>1?"s":""} disponible${S.length>1?"s":""}`,children:["ðŸŽ¬ Clip alÃ©atoire (",S.length,")"]})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="achievements"?"active":""}`,onClick:()=>L("achievements"),children:"Classement"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="evolution"?"active":""}`,onClick:()=>L("evolution"),children:"Ã‰volution"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="camps"?"active":""}`,onClick:()=>L("camps"),children:"Camps"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="roles"?"active":""}`,onClick:()=>L("roles"),children:"RÃ´les"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="maps"?"active":""}`,onClick:()=>L("maps"),children:"Maps"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="kills"?"active":""}`,onClick:()=>L("kills"),children:"Kills"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="deathmap"?"active":""}`,onClick:()=>L("deathmap"),children:"Carte"})]}),p==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[s?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):a?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",a]})}):r?e.jsx(Oe,{achievements:M==="all"?r.allGamesAchievements:r.moddedOnlyAchievements,title:M==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:M}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[!x&&e.jsx("button",{type:"button",className:`filter-btn ${M==="all"?"active":""}`,onClick:A=>{A.stopPropagation(),I("all")},children:"Toutes les parties"}),e.jsx("button",{type:"button",className:`filter-btn ${M==="modded"?"active":""}`,onClick:A=>{A.stopPropagation(),I("modded")},disabled:x,children:"Parties moddÃ©es"})]})]}),p==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[R&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{b({selectedPlayer:h.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${h.name}`,style:{fontSize:"1.3rem"},children:R.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Temps de jeu cumulÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:ke(R.totalPlayTime)}),e.jsx("p",{children:"temps total de jeu"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{b({selectedPlayer:h.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${h.name}`,style:{fontSize:"1.3rem"},children:R.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:[R.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:y,onChange:A=>T(A.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-filter-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsxs("select",{id:"camp-filter-select",value:d,onChange:A=>m(A.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"all",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loups"}),e.jsx("option",{value:"solo",children:"RÃ´les solo"})]})]})]}),e.jsx(_e,{selectedPlayerName:h.name,groupingMethod:y,campFilter:d})]}),p==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ue,{selectedPlayerName:h.name})}),p==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ye,{selectedPlayerName:h.name})}),p==="roles"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ze,{selectedPlayerName:h.name})}),p==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Je,{selectedPlayerName:h.name})}),p==="deathmap"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Qe,{selectedPlayerName:h.name})}),e.jsx("button",{type:"button",className:"highlight-btn active",onClick:A=>{A.stopPropagation(),k({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[h.firstGameDate," - ",h.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',l.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{type:"button",className:"clear-selection-btn",onClick:()=>k({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:$.map(h=>e.jsxs("div",{className:`character-card ${h.isHighlighted?"highlighted":""}`,onClick:()=>W(h.name),title:`${h.name} - ${h.totalGames} parties, ${h.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:h.image?e.jsx("img",{src:h.image,alt:`Photo de profil de ${h.name}`,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":o[h.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:h.name}),(h.twitch||h.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[h.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),h.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},h.id))})})}),n&&e.jsx(Ge,{clip:n,onClose:()=>w(null),relatedClips:Ve(n,z),nextClip:pe(n,z),onNextClip:()=>{const h=pe(n,z);h&&w(h)},onRelatedClip:h=>{const A=z.find(V=>V.ClipId===h);A&&w(A)}})]})}export{wt as PlayerSelectionPage};
