import{r as u,j as e}from"./index-DJ3PBwNF.js";import{u as D}from"./usePlayerStats-Cv1WSt_s.js";import{p as j,l as R,g as w}from"./api-BWHeASPZ.js";import{R as o,T as c,C as m}from"./CategoricalChart-BK7sFmA8.js";import{B as g,C as y,X as v,Y as f,a as b}from"./BarChart-DD7UOfS6.js";import{P as N,a as T}from"./PieChart-DH6AVHh-.js";import{L as F}from"./Legend-CpZ3tnzx.js";function E(){const{playerStatsData:t,dataLoading:P,fetchError:h}=D(),[i]=u.useState(null),[l,C]=u.useState(10),S=[5,8,10,15,20,25,30,50,100];if(P)return e.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques des joueurs..."});if(h)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",h]});if(!t)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de joueur disponible"});const p=t.playerStats.filter(a=>a.gamesPlayed>2).sort((a,s)=>s.gamesPlayed-a.gamesPlayed).slice(0,20),d=t.playerStats.filter(a=>a.gamesPlayed>=l).sort((a,s)=>parseFloat(s.winPercent)-parseFloat(a.winPercent)).slice(0,20),x=i?(a=>{const s=t.playerStats.find(r=>r.player===a);return s?Object.entries(s.camps).filter(([r,n])=>n>0).map(([r,n])=>({name:r,value:n,percentage:(n/s.gamesPlayed*100).toFixed(1)})):[]})(i):[];return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques des Joueurs"}),e.jsxs("p",{className:"lycans-stats-info",children:["Total de ",t.totalGames," parties analysées avec ",t.playerStats.length," joueurs"]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Top Participations"}),e.jsx("div",{style:{height:400},children:e.jsx(o,{width:"100%",height:"100%",children:e.jsxs(g,{data:p,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(y,{strokeDasharray:"3 3"}),e.jsx(v,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(f,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),e.jsx(c,{content:({active:a,payload:s})=>{if(a&&s&&s.length>0){const r=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:r.player})}),e.jsxs("div",{children:["Parties jouées : ",r.gamesPlayed]}),e.jsxs("div",{children:["Pourcentage : ",r.gamesPlayedPercent,"%"]})]})}return null}}),e.jsx(b,{dataKey:"gamesPlayed",name:"Parties jouées",fill:"#00C49F",children:p.map(a=>e.jsx(m,{fill:j[a.player]||"#00C49F"},`cell-participation-${a.player}`))})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Meilleurs Taux de Victoire"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:l,onChange:a=>C(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:S.map(a=>e.jsx("option",{value:a,children:a},a))})]})]}),e.jsx("div",{style:{height:400},children:e.jsx(o,{width:"100%",height:"100%",children:e.jsxs(g,{data:d,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(y,{strokeDasharray:"3 3"}),e.jsx(v,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(f,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(c,{content:({active:a,payload:s})=>{if(a&&s&&s.length>0){const r=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:r.player})}),e.jsxs("div",{children:["Taux de victoire : ",r.winPercent,"%"]}),e.jsxs("div",{children:["Victoires : ",r.wins," / ",r.gamesPlayed]})]})}return null}}),e.jsx(b,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:d.map(a=>e.jsx(m,{fill:j[a.player]||"#8884d8"},`cell-winrate-${a.player}`))})]})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:[d.length," joueur(s) avec au moins ",l," partie(s)"]})]})]}),i&&e.jsxs("div",{className:"lycans-graphique-section lycans-joueur-details",children:[e.jsxs("h3",{children:["Distribution des Camps - ",i]}),e.jsx("div",{style:{height:300},children:e.jsx(o,{width:"100%",height:"100%",children:e.jsxs(N,{children:[e.jsx(T,{data:x,cx:"50%",cy:"50%",labelLine:!0,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:a,percentage:s})=>`${a}: ${s}%`,children:x.map((a,s)=>e.jsx(m,{fill:R[a.name]||w(a.name)},`cell-${s}`))}),e.jsx(c,{content:({active:a,payload:s})=>{if(a&&s&&s.length>0){const r=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:[r.value," parties (",r.percentage,"%)"]})]})}return null}}),e.jsx(F,{})]})})})]})]})}export{E as PlayersGeneralStatisticsChart};
