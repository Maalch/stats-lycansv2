import{g as ae,b as oe,j as e,u as le,a as ce,r as D}from"./index-CaVB44cS.js";import{u as me}from"./baseStatsHook-EUXl_jjh.js";import{a as K,b as se,g as pe}from"./datasyncExport-CjB7UYqV.js";import{g as U}from"./roleUtils-CLjkiQQc.js";import{u as ue}from"./useJoueursData-BOP9fVTi.js";import{a as fe,u as ge,m as de}from"./api-CVoWvPlV.js";import{F as he,C as ye,X as Pe,Y as xe,a as je}from"./FullscreenChart-BmJy4nZb.js";import{R as ve,T as Ce}from"./CategoricalChart-5YoyURLu.js";import{B as Re,a as we}from"./BarChart-DZsLhw_j.js";function O(n,a){const l=K(n.MainRoleInitial,n.MainRoleChanges||[]),i=U(n);return pe(l,a,i)}function Z(n,a=!1,l=!1){const i={};return n.forEach(m=>{const c=new Set;m.PlayerStats.forEach(s=>{const f=O(s,{regroupWolfSubRoles:a,regroupVillagers:l});c.add(f)}),c.forEach(s=>{i[s]||(i[s]={totalGames:0,wins:0,winRate:0,players:{}}),i[s].totalGames++});const d=new Set;m.PlayerStats.forEach(s=>{if(s.Victorious){const f=O(s,{regroupWolfSubRoles:a,regroupVillagers:l});d.add(f)}}),d.forEach(s=>{i[s]&&i[s].wins++})}),i}function _(n,a,l=!1,i=!1){const m={};return n.forEach(c=>{c.PlayerStats.forEach(d=>{const s=ae(d),f=d.Username,o=O(d,{regroupWolfSubRoles:l,regroupVillagers:i}),g=o==="Autres"?"R√¥les sp√©ciaux":o;a[g].players[s]||(a[g].players[s]={games:0,wins:0,winRate:0,displayName:f}),a[g].players[s].games++,a[g].players[s].displayName=f,d.Victorious&&a[g].players[s].wins++,m[s]||(m[s]={totalGames:0,camps:{},displayName:f}),m[s].displayName=f,m[s].camps[g]||(m[s].camps[g]={games:0,wins:0,winRate:0,performance:0}),m[s].totalGames++,m[s].camps[g].games++,d.Victorious&&m[s].camps[g].wins++})}),m}function be(n){const a={};return a["R√¥les sp√©ciaux"]={totalGames:0,wins:0,winRate:0,players:{}},n.forEach(l=>{l.PlayerStats.forEach(i=>{const m=U(i),c=K(i.MainRoleInitial,i.MainRoleChanges||[]);se(c,m)==="Autres"&&(a["R√¥les sp√©ciaux"].totalGames++,i.Victorious&&a["R√¥les sp√©ciaux"].wins++)})}),a}function Te(n,a){const l={};return n.forEach(i=>{i.PlayerStats.forEach(m=>{const c=ae(m),d=m.Username,s=U(m);if(se(K(m.MainRoleInitial,m.MainRoleChanges||[]),s)==="Autres"){const o="R√¥les sp√©ciaux";a[o].players[c]||(a[o].players[c]={games:0,wins:0,winRate:0,displayName:d}),a[o].players[c].games++,a[o].players[c].displayName=d,m.Victorious&&a[o].players[c].wins++,l[c]||(l[c]={totalGames:0,camps:{},displayName:d}),l[c].displayName=d,l[c].camps[o]||(l[c].camps[o]={games:0,wins:0,winRate:0,performance:0}),l[c].totalGames++,l[c].camps[o].games++,m.Victorious&&l[c].camps[o].wins++}})}),l}function J(n){Object.keys(n).forEach(a=>{n[a].totalGames>0&&(n[a].winRate=parseFloat((n[a].wins/n[a].totalGames*100).toFixed(2))),Object.keys(n[a].players).forEach(l=>{const i=n[a].players[l];i.games>0&&(i.winRate=parseFloat((i.wins/i.games*100).toFixed(2)))})})}function z(n,a){Object.keys(n).forEach(l=>{Object.keys(n[l].camps).forEach(i=>{const m=n[l].camps[i];m.games>0&&(m.winRate=parseFloat((m.wins/m.games*100).toFixed(2)),a[i]&&a[i].winRate!==void 0?m.performance=parseFloat((m.winRate-a[i].winRate).toFixed(2)):m.performance=0)})})}function Ae(n,a,l){const i=[];return Object.keys(n).forEach(c=>{const d=n[c],s=[];Object.keys(d.camps).forEach(f=>{const o=d.camps[f];if(o.games>=l){const g=a[f]&&a[f].winRate!==void 0?a[f].winRate.toFixed(2):"0.00";s.push({camp:f,games:o.games,wins:o.wins,winRate:o.winRate.toFixed(2),campAvgWinRate:g,performance:o.performance.toFixed(2)})}}),s.sort((f,o)=>parseFloat(o.performance)-parseFloat(f.performance)),s.length>0&&i.push({player:d.displayName,totalGames:d.totalGames,campPerformance:s})}),i.sort((c,d)=>d.totalGames-c.totalGames),{campAverages:Object.keys(a).map(c=>({camp:c,totalGames:a[c].totalGames,wins:a[c].wins,winRate:a[c].winRate.toFixed(2)})),playerPerformanceArray:i}}function Fe(n){if(n.length===0)return null;const a=Z(n,!1,!1),l=Z(n,!0,!0),i=be(n),m=_(n,a,!1,!1),c=_(n,l,!0,!0),d=Te(n,i);J(a),J(l),J(i),z(m,a),z(c,l),z(d,i);const s={...a},f={...m};l.Loup&&(s["Camp Loup"]=l.Loup,Object.keys(c).forEach(y=>{f[y]||(f[y]=c[y]),c[y].camps.Loup&&(f[y].camps["Camp Loup"]=c[y].camps.Loup)})),l.Villageois&&(s["Camp Villageois"]=l.Villageois,Object.keys(c).forEach(y=>{f[y]||(f[y]=c[y]),c[y].camps.Villageois&&(f[y].camps["Camp Villageois"]=c[y].camps.Villageois)})),i["R√¥les sp√©ciaux"]&&(s["R√¥les sp√©ciaux"]=i["R√¥les sp√©ciaux"],Object.keys(d).forEach(y=>{f[y]||(f[y]=d[y]),d[y].camps["R√¥les sp√©ciaux"]&&(f[y].camps["R√¥les sp√©ciaux"]=d[y].camps["R√¥les sp√©ciaux"])}));const o=3,{campAverages:g,playerPerformanceArray:b}=Ae(f,s,o);return{campAverages:g,playerPerformance:b,minGamesRequired:o}}function Ne(){const{data:n,isLoading:a,error:l}=me(Fe);return{playerCampPerformance:n,isLoading:a,error:l}}function Le({infoId:n,title:a,children:l}){const{activeInfo:i,toggleInfo:m}=oe(),c=i===n;return e.jsxs("div",{className:"info-bubble-container",children:[e.jsx("button",{className:"info-bubble-trigger",onClick:()=>m(n),"aria-label":"Afficher les informations",title:"Informations sur ce graphique",children:"‚ÑπÔ∏è"}),c&&e.jsxs("div",{className:"info-bubble-content",children:[e.jsxs("div",{className:"info-bubble-header",children:[e.jsx("h4",{children:a}),e.jsx("button",{className:"info-bubble-close",onClick:()=>m(n),"aria-label":"Fermer",children:"‚úï"})]}),e.jsx("div",{className:"info-bubble-body",children:l})]})]})}function ee({viewMode:n,selectedCamp:a,minGames:l,chartData:i,highlightedPlayer:m,lycansColorScheme:c,playersColor:d,onBarClick:s}){return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("h3",{style:{margin:0},children:n==="performance"?a==="Tous les camps"?"Meilleures performances - Tous les camps":`Meilleurs joueurs en ${a}`:a==="Tous les camps"?"Plus grand % de parties - Tous les camps":`Plus grand % de parties en ${a}`}),e.jsx(Le,{infoId:`bar-chart-${n}-${a}`,title:"√Ä propos de ce graphique",children:n==="performance"?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Filtres actuels :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affichage :"})," Meilleures Performances"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Camp/R√¥le :"})," ",a]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Minimum de parties :"})," ",l]})]}),(a==="Tous les camps"||a==="Camp Villageois"||a==="Camp Loup"||a==="R√¥les sp√©ciaux")&&e.jsxs("p",{style:{background:"var(--bg-primary)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.5rem"},children:[e.jsxs("strong",{children:["‚ÑπÔ∏è ",a," :"]})," ",a==="Tous les camps"&&"Affiche le meilleur r√¥le de chaque joueur (toutes cat√©gories confondues).",a==="Camp Villageois"&&"Inclut Villageois, Chasseur, Alchimiste, Protecteur et Disciple.",a==="Camp Loup"&&"Inclut Loup, Tra√Ætre et Louveteau.",a==="R√¥les sp√©ciaux"&&"Inclut les r√¥les solo comme Amoureux, Idiot du Village, Agent, etc."]}),e.jsx("p",{children:e.jsx("strong",{children:"Comment √ßa marche :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Taux personnel"})," : Le pourcentage de victoires du joueur dans ce camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Moyenne du camp"})," : Le taux de victoire moyen de tous les joueurs dans ce camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Performance"})," : La diff√©rence entre le taux personnel et la moyenne du camp"]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Interpr√©tation :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Performance positive (+)"})," : Le joueur performe mieux que la moyenne"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Performance n√©gative (-)"})," : Le joueur performe moins bien que la moyenne"]})]}),e.jsxs("p",{children:[e.jsx("em",{children:"Exemple :"})," Si un joueur a 60% de victoires en Camp Villageois et que la moyenne est 45%, sa performance est de ",e.jsx("code",{children:"+15%"}),"."]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Filtres actuels :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affichage :"})," Pourcentage de Parties Jou√©es"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Camp/R√¥le :"})," ",a]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Minimum de parties :"})," ",l]})]}),(a==="Tous les camps"||a==="Camp Villageois"||a==="Camp Loup"||a==="R√¥les sp√©ciaux")&&e.jsxs("p",{style:{background:"var(--bg-primary)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.5rem"},children:[e.jsxs("strong",{children:["‚ÑπÔ∏è ",a," :"]})," ",a==="Tous les camps"&&"Affiche le r√¥le le plus jou√© par chaque joueur (toutes cat√©gories confondues).",a==="Camp Villageois"&&"Inclut Villageois, Chasseur, Alchimiste, Protecteur et Disciple.",a==="Camp Loup"&&"Inclut Loup, Tra√Ætre et Louveteau.",a==="R√¥les sp√©ciaux"&&"Inclut les r√¥les solo comme Amoureux, Idiot du Village, Agent, etc."]}),e.jsx("p",{children:e.jsx("strong",{children:"Comment √ßa marche :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Parties dans ce r√¥le"})," : Nombre de parties jou√©es avec ce r√¥le/camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Total parties"})," : Nombre total de parties jou√©es par le joueur"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Pourcentage"})," : (Parties dans ce r√¥le / Total parties) √ó 100"]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Interpr√©tation :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Un ",e.jsx("strong",{children:"pourcentage √©lev√©"})," indique que le joueur a souvent eu ce r√¥le"]}),e.jsxs("li",{children:["Permet d'identifier les ",e.jsx("strong",{children:"r√¥les r√©currents"})," pour chaque joueur"]}),e.jsxs("li",{children:["Utile pour comprendre l'",e.jsx("strong",{children:"exp√©rience de jeu"})," de chacun"]})]})]})})]}),e.jsx(he,{title:n==="performance"?a==="Tous les camps"?"Meilleures Performances - Tous les camps":`Meilleurs Joueurs - ${a}`:a==="Tous les camps"?"Pourcentage de Parties Jou√©es - Tous les camps":`Pourcentage de Parties Jou√©es - ${a}`,children:e.jsx("div",{style:{height:500},children:e.jsx(ve,{width:"100%",height:"100%",children:e.jsxs(Re,{data:i,margin:{top:20,right:30,left:20,bottom:0},children:[e.jsx(ye,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:a==="Tous les camps"?"uniqueKey":"player",angle:-45,textAnchor:"end",height:110,interval:0,fontSize:15,tick:({x:f,y:o,payload:g,index:b})=>{const y=i[b],k=y?.player||g.value,E=m===(y?.player||g.value);return e.jsx("text",{x:f,y:o,dy:16,textAnchor:"end",fill:E?"var(--accent-primary)":"var(--text-secondary)",fontSize:E?14:13,fontWeight:E?"bold":"italic",transform:`rotate(-45 ${f} ${o})`,children:k})}}),e.jsx(xe,{domain:["auto","auto"],label:{value:n==="performance"?"Performance vs moyenne (%)":"Pourcentage de parties jou√©es (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(Ce,{content:({active:f,payload:o})=>{if(f&&o&&o.length>0){const g=o[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a==="Tous les camps"?`${g.player} - ${g.camp}`:g.player})}),n==="performance"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties: ",g.games]}),e.jsxs("div",{children:["Victoires: ",g.wins]}),e.jsxs("div",{children:["Taux personnel: ",g.winRate,"%"]}),a!=="Tous les camps"&&e.jsxs("div",{children:["Moyenne camp: ",g.campAvgWinRate,"%"]}),e.jsxs("div",{children:["Performance: ",g.performance>0?"+":"",g.performance]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties dans ce r√¥le: ",g.games]}),e.jsxs("div",{children:["Total parties: ",g.totalGames]}),e.jsxs("div",{children:["Pourcentage: ",g.playPercentage?.toFixed(1),"%"]}),e.jsxs("div",{children:["Moyenne tous joueurs: ",g.campAvgPlayPercentage?.toFixed(1),"%"]}),e.jsxs("div",{children:["Taux de victoire: ",g.winRate,"%"]})]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(we,{dataKey:n==="performance"?"performanceNum":"playPercentage",style:{cursor:"pointer"},onClick:s,children:i.map((f,o)=>{const g=m===f.player,b=f.isHighlightedAddition;let y;return a==="Tous les camps"?y=c[f.camp]||`var(--chart-color-${o%6+1})`:y=d[f.player]||"var(--accent-primary)",e.jsx(je,{fill:y,stroke:g?"var(--accent-primary)":"transparent",strokeWidth:g?3:0,strokeDasharray:b?"5,5":"none",opacity:b?.8:1},`cell-${o}`)})})]})})})})]})}function He(){const{navigateToGameDetails:n,navigationState:a,updateNavigationState:l}=le(),{settings:i}=ce(),m=fe(),{joueursData:c}=ue(),d=ge(c),[s,f]=D.useState(a.campPerformanceState?.selectedCampPerformanceCamp||"Camp Villageois"),[o,g]=D.useState(a.campPerformanceState?.selectedCampPerformanceMinGames||50),{playerCampPerformance:b,isLoading:y,error:k}=Ne();D.useEffect(()=>{a.campPerformanceState||l({campPerformanceState:{viewMode:"performance",selectedCampPerformanceCamp:s,selectedCampPerformanceMinGames:o}})},[s,o,a.campPerformanceState,l]);const E=D.useMemo(()=>{if(!b?.campAverages)return["Tous les camps"];const r=b.campAverages.map(L=>L.camp),u=["Tous les camps"];r.includes("Camp Villageois")&&u.push("Camp Villageois"),r.includes("Villageois")&&u.push("Villageois"),r.includes("Chasseur")&&u.push("Chasseur"),r.includes("Alchimiste")&&u.push("Alchimiste"),r.includes("Protecteur")&&u.push("Protecteur"),r.includes("Disciple")&&u.push("Disciple"),r.includes("Camp Loup")&&u.push("Camp Loup"),r.includes("Loup")&&u.push("Loup"),r.includes("Tra√Ætre")&&u.push("Tra√Ætre"),r.includes("Louveteau")&&u.push("Louveteau"),r.includes("R√¥les sp√©ciaux")&&u.push("R√¥les sp√©ciaux");const v=["Camp Villageois","Camp Loup","R√¥les sp√©ciaux"],N=[...["Camp Villageois","Villageois","Chasseur","Alchimiste","Protecteur","Disciple","Camp Loup","Loup","Tra√Ætre","Louveteau"],...v],G=r.filter(L=>!N.includes(L)).sort();return[...u,...G]},[b]),{campPlayPercentageData:re,topPlayPercentageData:ie}=D.useMemo(()=>{if(!b?.playerPerformance)return{campPlayPercentageData:[],topPlayPercentageData:[],totalPlayPercentagePlayers:0};const{playerPerformance:r}=b,u=new Map,v=new Map;for(const p of r){const x=p.campPerformance.reduce((t,j)=>t+j.games,0);v.set(p.player,x);for(const t of p.campPerformance)if(t.games>=o){const j=u.get(t.camp)||{totalGames:0,totalPlayersWithCamp:0};j.totalGames+=t.games,j.totalPlayersWithCamp+=1,u.set(t.camp,j)}}const A=new Map;for(const[p,x]of u.entries()){const t=x.totalGames/x.totalPlayersWithCamp,j=x.totalPlayersWithCamp;let R=0;for(const h of r)h.campPerformance.find(V=>V.camp===p&&V.games>=o)&&(R+=v.get(h.player)||0);const w=R/j,M=t/w*100;A.set(p,M)}const N=[],G=[],L=new Map;for(const p of r){const x=v.get(p.player)||0;for(const t of p.campPerformance)if(t.games>=o){const j=A.get(t.camp)||0,R=t.games/x*100,w=`${p.player}-${t.camp}`,M={player:p.player,camp:t.camp,games:t.games,wins:t.wins,winRate:t.winRate,performance:t.performance,winRateNum:parseFloat(t.winRate),performanceNum:parseFloat(t.performance),campAvgWinRateNum:parseFloat(t.campAvgWinRate),totalGames:x,playPercentage:R,campAvgPlayPercentage:j,isHighlightedAddition:!1,uniqueKey:w,playerCamp:w},h=L.get(p.player);(!h||M.playPercentage>h.playPercentage)&&L.set(p.player,M),s!=="Tous les camps"&&t.camp===s&&N.push(M)}}G.push(...L.values());const q=(p,x,t=!1)=>{if(!i.highlightedPlayer||p.some(h=>h.player===i.highlightedPlayer&&(!x||h.camp===x)))return p;const R=r.find(h=>h.player===i.highlightedPlayer);if(!R)return p;const w=v.get(i.highlightedPlayer)||R.campPerformance.reduce((h,T)=>h+T.games,0);if(t){let h=null;for(const T of R.campPerformance)if(T.games>=1){const V=T.games/w*100,B=A.get(T.camp)||0,Y=`${R.player}-${T.camp}`,Q={player:R.player,camp:T.camp,games:T.games,wins:T.wins,winRate:T.winRate,performance:T.performance,winRateNum:parseFloat(T.winRate),performanceNum:parseFloat(T.performance),campAvgWinRateNum:parseFloat(T.campAvgWinRate),totalGames:w,playPercentage:V,campAvgPlayPercentage:B,isHighlightedAddition:!0,uniqueKey:Y,playerCamp:Y};(!h||Q.playPercentage>h.playPercentage)&&(h=Q)}return h?[...p,h]:p}const M=[];for(const h of R.campPerformance)if((!x||h.camp===x)&&h.games>=1){const T=h.games/w*100,V=A.get(h.camp)||0,B=`${R.player}-${h.camp}`;M.push({player:R.player,camp:h.camp,games:h.games,wins:h.wins,winRate:h.winRate,performance:h.performance,winRateNum:parseFloat(h.winRate),performanceNum:parseFloat(h.performance),campAvgWinRateNum:parseFloat(h.campAvgWinRate),totalGames:w,playPercentage:T,campAvgPlayPercentage:V,isHighlightedAddition:!0,uniqueKey:B,playerCamp:B})}return[...p,...M]},I=s!=="Tous les camps"?q(N,s,!1):[],H=q(G,void 0,!0),$=I.sort((p,x)=>x.playPercentage-p.playPercentage),C=H.sort((p,x)=>x.playPercentage-p.playPercentage),P=(p,x)=>{const t=p.slice(0,x);if(t.some(w=>w.player===i.highlightedPlayer)||!i.highlightedPlayer)return t;const R=p.find(w=>w.player===i.highlightedPlayer);if(R){const w={...R,isHighlightedAddition:!0};return[...t,w]}return t},F=P($,15),W=P(C,15);return{campPlayPercentageData:F,topPlayPercentageData:W}},[b,s,o,i.highlightedPlayer]),{campPlayerData:ne,topPerformersData:te,totalMatchingPlayers:S}=D.useMemo(()=>{if(!b?.playerPerformance)return{campPlayerData:[],topPerformersData:[],totalMatchingPlayers:0};const{playerPerformance:r}=b,u=[],v=[],A=new Map;for(const C of r)for(const P of C.campPerformance)if(P.games>=o){const F=`${C.player}-${P.camp}`,W={player:C.player,camp:P.camp,games:P.games,wins:P.wins,winRate:P.winRate,performance:P.performance,winRateNum:parseFloat(P.winRate),performanceNum:parseFloat(P.performance),campAvgWinRateNum:parseFloat(P.campAvgWinRate),isHighlightedAddition:!1,uniqueKey:F,playerCamp:F},p=A.get(C.player);(!p||W.performanceNum>p.performanceNum)&&A.set(C.player,W),s!=="Tous les camps"&&P.camp===s&&u.push({player:C.player,...P,winRateNum:parseFloat(P.winRate),performanceNum:parseFloat(P.performance),campAvgWinRateNum:parseFloat(P.campAvgWinRate),isHighlightedAddition:!1,uniqueKey:F,playerCamp:F})}v.push(...A.values());const N=(C,P,F=!1)=>{if(!i.highlightedPlayer||C.some(t=>t.player===i.highlightedPlayer&&(!P||t.camp===P)))return C;const p=r.find(t=>t.player===i.highlightedPlayer);if(!p)return C;if(F){let t=null;for(const j of p.campPerformance)if(j.games>=1){const R=`${p.player}-${j.camp}`,w={player:p.player,camp:j.camp,games:j.games,wins:j.wins,winRate:j.winRate,performance:j.performance,winRateNum:parseFloat(j.winRate),performanceNum:parseFloat(j.performance),campAvgWinRateNum:parseFloat(j.campAvgWinRate),isHighlightedAddition:!0,uniqueKey:R,playerCamp:R};(!t||w.performanceNum>t.performanceNum)&&(t=w)}return t?[...C,t]:C}const x=[];for(const t of p.campPerformance)if((!P||t.camp===P)&&t.games>=1){const j=`${p.player}-${t.camp}`;x.push({player:p.player,camp:t.camp,games:t.games,wins:t.wins,winRate:t.winRate,performance:t.performance,winRateNum:parseFloat(t.winRate),performanceNum:parseFloat(t.performance),campAvgWinRateNum:parseFloat(t.campAvgWinRate),isHighlightedAddition:!0,uniqueKey:j,playerCamp:j})}return[...C,...x]},G=s!=="Tous les camps"?N(u,s,!1):[],L=N(v,void 0,!0),q=G.sort((C,P)=>P.performanceNum-C.performanceNum),I=L.sort((C,P)=>P.performanceNum-C.performanceNum),H=(C,P)=>{const F=C.slice(0,P);if(F.some(x=>x.player===i.highlightedPlayer)||!i.highlightedPlayer)return F;const p=C.find(x=>x.player===i.highlightedPlayer);if(p){const x={...p,isHighlightedAddition:!0};return[...F,x]}return F};let $=0;return s==="Tous les camps"?$=A.size:$=u.length,{campPlayerData:H(q,15),topPerformersData:H(I,15),totalMatchingPlayers:$}},[b,s,o,i.highlightedPlayer]),X=r=>{r&&r.player&&(s!=="Tous les camps"?n(s==="Camp Loup"?{selectedPlayer:r.player,campFilter:{selectedCamp:"Camp Loup",campFilterMode:"wins-only",excludeWolfSubRoles:!1},fromComponent:`Performance des Joueurs - ${s}`}:s==="Camp Villageois"?{selectedPlayer:r.player,campFilter:{selectedCamp:"Villageois",campFilterMode:"wins-only",excludeVillagers:!1},fromComponent:`Performance des Joueurs - ${s}`}:s==="R√¥les sp√©ciaux"?{selectedPlayer:r.player,fromComponent:`Performance des Joueurs - ${s}`}:{selectedPlayer:r.player,campFilter:{selectedCamp:s,campFilterMode:"wins-only",excludeWolfSubRoles:s==="Tra√Ætre"||s==="Louveteau",excludeVillagers:s==="Chasseur"||s==="Alchimiste"||s==="Protecteur"||s==="Disciple"},fromComponent:`Performance des Joueurs - ${s}`}):r.camp==="Camp Loup"?n({selectedPlayer:r.player,campFilter:{selectedCamp:"Loup",campFilterMode:"wins-only",excludeWolfSubRoles:!1},fromComponent:"Performance des Joueurs - Tous les camps"}):r.camp==="Camp Villageois"?n({selectedPlayer:r.player,campFilter:{selectedCamp:"Villageois",campFilterMode:"wins-only",excludeWolfSubRoles:!0},fromComponent:"Performance des Joueurs - Tous les camps"}):r.camp==="R√¥les sp√©ciaux"?n({selectedPlayer:r.player,fromComponent:"Performance des Joueurs - Tous les camps"}):n({selectedPlayer:r.player,campFilter:{selectedCamp:r.camp,campFilterMode:"wins-only",excludeWolfSubRoles:r.camp==="Tra√Ætre"||r.camp==="Louveteau",excludeVillagers:r.camp==="Chasseur"||r.camp==="Alchimiste"||r.camp==="Protecteur"||r.camp==="Disciple"},fromComponent:"Performance des Joueurs - Tous les camps"}))};return y?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de performance par camp..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):b?e.jsxs("div",{className:"lycans-player-camp-performance",children:[e.jsx("h2",{children:"Comparaison des Camps"}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsx("select",{id:"camp-select",value:s,onChange:r=>{const u=r.target.value;f(u),l({campPerformanceState:{viewMode:"performance",selectedCampPerformanceCamp:u,selectedCampPerformanceMinGames:o}})},style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"200px"},children:E.map(r=>{let u=r,v=!1,A=!1,N=!1;return r==="Tous les camps"?(u="üìä Tous les camps",N=!0):r==="Camp Villageois"?(u="   üèòÔ∏è Camp Villageois",v=!0,A=!0):r==="Villageois"?(u="   Villageois",v=!0):r==="Chasseur"?(u="     Chasseur",v=!0):r==="Alchimiste"?(u="     Alchimiste",v=!0):r==="Protecteur"?(u="     Protecteur",v=!0):r==="Disciple"?(u="     Disciple",v=!0):r==="Camp Loup"?(u="   üê∫ Camp Loup",v=!0,A=!0):r==="Loup"?(u="     Loup",v=!0):r==="Tra√Ætre"?(u="     Tra√Ætre",v=!0):r==="Louveteau"?(u="     Louveteau",v=!0):r==="R√¥les sp√©ciaux"?(u="   ‚≠ê R√¥les sp√©ciaux",v=!0,A=!0):(u=`     ${r}`,v=!0),e.jsx("option",{value:r,style:{fontFamily:"monospace",fontSize:v?"0.85rem":"0.9rem",fontWeight:A?"bold":"normal",color:A?"var(--accent-primary)":N?"var(--accent-secondary)":"inherit"},children:u},r)})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:o,onChange:r=>{const u=Number(r.target.value);g(u),l({campPerformanceState:{viewMode:"performance",selectedCampPerformanceCamp:s,selectedCampPerformanceMinGames:u}})},style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",width:"90px"},children:de.map(r=>e.jsx("option",{value:r,children:r},r))})]})]}),e.jsx("div",{style:{textAlign:"center",marginBottom:"1.5rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:e.jsxs("span",{style:{color:"var(--text-secondary)",fontSize:"0.95rem",fontWeight:"500"},children:[S," joueur",S!==1?"s":""," ",S!==1?"correspondent":"correspond"," aux crit√®res"]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{textAlign:"center",marginBottom:"1rem"},children:"Meilleures Performances par Camp"}),e.jsx(ee,{viewMode:"performance",selectedCamp:s,minGames:o,chartData:s==="Tous les camps"?te:ne,highlightedPlayer:i.highlightedPlayer,lycansColorScheme:m,playersColor:d,onBarClick:X})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{textAlign:"center",marginBottom:"1rem"},children:"Pourcentage de Parties Jou√©es par R√¥le"}),e.jsx(ee,{viewMode:"playPercentage",selectedCamp:s,minGames:o,chartData:s==="Tous les camps"?ie:re,highlightedPlayer:i.highlightedPlayer,lycansColorScheme:m,playersColor:d,onBarClick:X})]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e de performance par camp disponible"})}export{He as PlayerCampChart};
