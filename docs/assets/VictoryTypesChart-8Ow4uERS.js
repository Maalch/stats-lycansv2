import{r as u,j as e}from"./index-ClHBFAaT.js";import{u as R}from"./useCampWinStatsFromRaw-CvUADS7A.js";import{a as m}from"./api-DftpR04q.js";import{F as x}from"./FullscreenChart-CaXaPtiE.js";import{R as y,B as v,C as g,X as j,Y as f,T,o as b}from"./useRawGameData-DKu6upLQ.js";import{L as N}from"./Legend-CAMai6os.js";function L(){const{campWinStats:n,isLoading:C,errorInfo:V}=R(),o=u.useMemo(()=>n?.victoryTypes?n.victoryTypes.map(s=>({...s,percentageNum:parseFloat(s.percentage)})):[],[n?.victoryTypes]),{mainVictoryTypes:c,rareVictoryTypes:d}=u.useMemo(()=>{if(!o.length)return{mainVictoryTypes:[],rareVictoryTypes:[]};const s=Math.max(5,Math.ceil(o[0].count*.1)),i=o.filter(t=>t.count>=s),l=o.filter(t=>t.count<s);return{mainVictoryTypes:i,rareVictoryTypes:l}},[o]),k=C,p=V;return k?e.jsx("div",{className:"donnees-attente",children:"Chargement des types de victoire..."}):p?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",p]}):n?e.jsxs("div",{className:"lycans-victory-types-container",children:[e.jsx("h2",{children:"Types de Victoire"}),n&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Types Principaux"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.length}),e.jsx("p",{children:"types fréquents"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Types Spéciaux"}),e.jsx("div",{className:"lycans-valeur-principale",children:d.length}),e.jsx("p",{children:"types rares"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale",children:n?.totalGames||0}),e.jsx("p",{children:"parties analysées"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[c.length>0&&e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Victoire Principaux par Camp"}),e.jsxs("p",{className:"lycans-stats-info",children:["Types de victoire les plus fréquents (",c.reduce((s,i)=>s+i.count,0)," parties sur ",n?.totalGames,")"]}),e.jsx(x,{title:"Types de Victoire Principaux par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(v,{data:c,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(g,{strokeDasharray:"3 3"}),e.jsx(j,{dataKey:"type",angle:-45,textAnchor:"end",height:80,interval:0,fontSize:11}),e.jsx(f,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),e.jsx(T,{content:({active:s,payload:i,label:l})=>{if(s&&i&&i.length>0){const t=i.reduce((r,a)=>r+(a.value||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:300},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:8},children:l}),e.jsxs("div",{style:{marginBottom:4},children:["Total: ",t," parties"]}),i.filter(r=>r.value&&r.value>0).sort((r,a)=>(a.value||0)-(r.value||0)).map((r,a)=>{const h=t>0?((r.value||0)/t*100).toFixed(1):"0.0";return e.jsxs("div",{style:{marginBottom:2},children:[e.jsx("span",{style:{display:"inline-block",width:12,height:12,backgroundColor:r.color,marginRight:8,borderRadius:2}}),r.dataKey,": ",r.value," (",h,"%)"]},a)})]})}return null}}),e.jsx(N,{}),n?.winningCamps?.map((s,i)=>e.jsx(b,{dataKey:s,stackId:"victory",fill:m[s]||`var(--chart-color-${i%6+1})`,name:s},s))]})})})})]}),d.length>0&&e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Victoire Spéciaux par Camp"}),e.jsxs("p",{className:"lycans-stats-info",children:["Types de victoire moins fréquents (",d.reduce((s,i)=>s+i.count,0)," parties sur ",n?.totalGames,")"]}),e.jsx(x,{title:"Types de Victoire Spéciaux par Camp",children:e.jsx("div",{style:{height:500},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(v,{data:d,margin:{top:20,right:30,left:20,bottom:120},children:[e.jsx(g,{strokeDasharray:"3 3"}),e.jsx(j,{dataKey:"type",angle:-45,textAnchor:"end",height:120,interval:0,fontSize:10}),e.jsx(f,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"},domain:[0,"dataMax"]}),e.jsx(T,{content:({active:s,payload:i,label:l})=>{if(s&&i&&i.length>0){const t=i.reduce((r,a)=>r+(a.value||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:300},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:8},children:l}),e.jsxs("div",{style:{marginBottom:4},children:["Total: ",t," parties"]}),i.filter(r=>r.value&&r.value>0).sort((r,a)=>(a.value||0)-(r.value||0)).map((r,a)=>{const h=t>0?((r.value||0)/t*100).toFixed(1):"0.0";return e.jsxs("div",{style:{marginBottom:2},children:[e.jsx("span",{style:{display:"inline-block",width:12,height:12,backgroundColor:r.color,marginRight:8,borderRadius:2}}),r.dataKey,": ",r.value," (",h,"%)"]},a)})]})}return null}}),e.jsx(N,{}),n?.winningCamps?.map((s,i)=>e.jsx(b,{dataKey:s,stackId:"victory",fill:m[s]||`var(--chart-color-${i%6+1})`,name:s},s))]})})})})]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de victoire disponible"})}export{L as VictoryTypesChart};
