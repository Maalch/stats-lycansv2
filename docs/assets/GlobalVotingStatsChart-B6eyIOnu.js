import{r as c,j as e}from"./index-CzlnCdE0.js";import{u as R}from"./baseStatsHook-D0szqeat.js";import{b as V}from"./votingStatsUtils-Ctc-Am3N.js";import{F as m}from"./FullscreenChart-CLGClBjG.js";import{b as F,l as C}from"./api-DVRtv9JY.js";import{R as p,T as x}from"./CategoricalChart-BWWDkf3y.js";import{L as k,a as u}from"./LineChart-DWM9zK47.js";import{C as y,X as v,Y as f}from"./CartesianChart-Dubm-Vi4.js";import{L as g}from"./Legend-CqoWGMkE.js";import{B as T,a as j}from"./BarChart-nLMBq0aS.js";import{P as A,a as N}from"./PieChart-Duri4XM4.js";import"./datasyncExport-BirWLS1z.js";import"./deathTypes-gHH1w6_X.js";import"./ActivePoints-CqmQG4dj.js";import"./PolarChart-B4u2KS1o.js";function L(){return R(a=>{if(!a||a.length===0)return null;const s=a.filter(l=>l.PlayerStats.some(o=>o.Votes&&o.Votes.length>0));return s.length===0?null:V(s)})}function Y(){const{data:a,isLoading:s,error:l}=L(),o=F(),b=c.useMemo(()=>a?.meetingDayStats?a.meetingDayStats.map(t=>({...t,meetingLabel:`Meeting ${t.meetingDay}`,votingRate:parseFloat(t.averageVotingRate.toFixed(1)),skipRate:parseFloat(t.averageSkipRate.toFixed(1)),abstentionRate:parseFloat(t.averageAbstentionRate.toFixed(1))})):[],[a]),S=c.useMemo(()=>{if(!a?.campVotingStats)return[];const t=["Villageois","Loup"];return a.campVotingStats.filter(r=>t.includes(r.campName)).map(r=>({camp:r.campName,accuracyRate:parseFloat(r.accuracyRate.toFixed(1)),friendlyFireRate:parseFloat(r.friendlyFireRate.toFixed(1)),totalVotes:r.totalVotes}))},[a]),d=c.useMemo(()=>a?.campEliminationStats?a.campEliminationStats.map(t=>({name:t.campName,value:t.eliminations,percentage:t.percentage,fill:t.campName==="Villageois"?o.Villageois:t.campName==="Loup"?o.Loup:C})):[],[a,o]);return s?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Chargement des statistiques de vote..."}):l?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-error)"},children:["Erreur lors du chargement : ",l]}):a?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem",padding:"1rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsx(n,{title:"Meetings Totaux",value:a.totalMeetings,color:o.Villageois}),e.jsx(n,{title:"Votes Totaux",value:a.totalVotes,color:o.Loup}),e.jsx(n,{title:"Passes Totales",value:a.totalSkips,color:"#FF9800"}),e.jsx(n,{title:"Non-Votes Totaux",value:a.totalAbstentions,color:"#9E9E9E"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsx(n,{title:"Taux de Vote Moyen",value:`${a.averageVotingRate.toFixed(1)}%`,color:o.Villageois,subtitle:"% de joueurs votant activement"}),e.jsx(n,{title:"Taux de Passe Moyen",value:`${a.averageSkipRate.toFixed(1)}%`,color:"#FF9800",subtitle:"% de joueurs passant"}),e.jsx(n,{title:"Taux de Non-Vote Moyen",value:`${a.averageAbstentionRate.toFixed(1)}%`,color:"#9E9E9E",subtitle:"% de joueurs ne participant pas"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"üìÖ √âvolution des Comportements par Jour de Meeting"})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:"Tendance moyenne des comportements de vote au fil des meetings successifs d'une partie: activit√© de vote, passes et non-votes."}),e.jsx(m,{title:"√âvolution des Comportements par Jour de Meeting",children:e.jsx(p,{width:"100%",height:400,children:e.jsxs(k,{data:b,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"var(--chart-grid)"}),e.jsx(v,{dataKey:"meetingLabel",angle:-45,textAnchor:"end",height:100,stroke:"var(--text-secondary)",tick:({x:t,y:r,payload:i})=>e.jsx("text",{x:t,y:r,dy:16,textAnchor:"end",fill:"var(--text-secondary)",fontSize:13,transform:`rotate(-45 ${t} ${r})`,children:i.value})}),e.jsx(f,{label:{value:"Taux (%)",angle:-90,position:"insideLeft"},stroke:"var(--text-secondary)"}),e.jsx(x,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"10px",color:"var(--text-primary)"},labelStyle:{color:"var(--text-primary)",fontWeight:"bold"},itemStyle:{color:"var(--text-primary)"},formatter:t=>{const r=typeof t=="number"?t:Number(t);return Number.isNaN(r)?`${t}%`:`${r.toFixed(1)}%`}}),e.jsx(g,{wrapperStyle:{paddingTop:"20px"},iconType:"line"}),e.jsx(u,{type:"monotone",dataKey:"votingRate",name:"Taux de Vote",stroke:o.Villageois,strokeWidth:2,dot:{r:4},activeDot:{r:6}}),e.jsx(u,{type:"monotone",dataKey:"skipRate",name:"Taux de Passe",stroke:"#FF9800",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),e.jsx(u,{type:"monotone",dataKey:"abstentionRate",name:"Taux de Non-Vote",stroke:"#9E9E9E",strokeWidth:2,dot:{r:4},activeDot:{r:6}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"üõ°Ô∏è Pr√©cision de Vote par Camp"})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:'Pourcentage moyen de votes dirig√©s contre un camp adverse compar√© au taux de "tir alli√©" (votes contre son propre camp) pour chaque camp.'}),e.jsx(m,{title:"Pr√©cision de Vote par Camp",children:e.jsx(p,{width:"100%",height:400,children:e.jsxs(T,{data:S,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"var(--chart-grid)"}),e.jsx(v,{dataKey:"camp",angle:-45,textAnchor:"end",height:100,stroke:"var(--text-secondary)",tick:({x:t,y:r,payload:i})=>e.jsx("text",{x:t,y:r,dy:16,textAnchor:"end",fill:"var(--text-secondary)",fontSize:16,transform:`rotate(-45 ${t} ${r})`,children:i.value})}),e.jsx(f,{label:{value:"Taux (%)",angle:-90,position:"insideLeft"},stroke:"var(--text-secondary)"}),e.jsx(x,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"10px",color:"var(--text-primary)"},labelStyle:{color:"var(--text-primary)",fontWeight:"bold"},itemStyle:{color:"var(--text-primary)"},formatter:(t,r)=>{const i=typeof t=="number"?t:Number(t),h=r==="accuracyRate"?"Vote Camp Oppos√©":"Tir Alli√©";return Number.isNaN(i)?[`${t}%`,h]:[`${i.toFixed(1)}%`,h]}}),e.jsx(g,{wrapperStyle:{paddingTop:"20px"},formatter:t=>t==="accuracyRate"?"Vote Camp Oppos√©":t==="friendlyFireRate"?"Tir Alli√©":t}),e.jsx(j,{dataKey:"accuracyRate",name:"accuracyRate",fill:o.Villageois,radius:[8,8,0,0]}),e.jsx(j,{dataKey:"friendlyFireRate",name:"friendlyFireRate",fill:o.Loup,radius:[8,8,0,0]})]})})})]}),d.length>0&&e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"‚ö∞Ô∏è R√©partition des √âliminations par Camp"})}),e.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:["Distribution des ",a?.totalEliminations||0,' joueurs √©limin√©s par vote selon leur camp. Les r√¥les solo (Amoureux, Agent, etc.) sont regroup√©s en "Solo R√¥les".']}),e.jsx(m,{title:"R√©partition des √âliminations par Camp",children:e.jsx(p,{width:"100%",height:400,children:e.jsxs(A,{children:[e.jsx(N,{data:d,cx:"50%",cy:"50%",outerRadius:140,dataKey:"value",label:({payload:t})=>{const r=t;return`${r.name}: ${r.percentage.toFixed(1)}%`},labelLine:!0}),e.jsx(x,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const i=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:i.name}),e.jsxs("div",{children:["√âliminations: ",e.jsx("strong",{children:i.value})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[i.percentage.toFixed(1),"%"]})]})]})}return null}}),e.jsx(g,{wrapperStyle:{paddingTop:"20px"},formatter:t=>{const r=d.find(i=>i.name===t);return`${t} (${r?.value||0})`}})]})})})]})]}):e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Aucune donn√©e de vote disponible"})}function n({title:a,value:s,color:l,subtitle:o}){return e.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--background-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginBottom:"0.5rem"},children:a}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:l,marginBottom:o?"0.25rem":"0"},children:s}),o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",fontStyle:"italic"},children:o})]})}export{Y as GlobalVotingStatsChart};
