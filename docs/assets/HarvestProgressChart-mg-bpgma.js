import{r as o,j as e}from"./index-CTJiOXKa.js";import{ah as x,R as d,p as v,T as h,B as j,C as y,X as g,Y as p,o as f}from"./statsApi-DxKULtf6.js";import{F as b}from"./FullscreenChart-CFOjBQ4F.js";import{P as R,a as N}from"./PieChart-CMMoo3pY.js";import{L as m}from"./Legend-hzxUMFaX.js";function D(){const[t,l]=o.useState(null),[i,a]=o.useState(!0),[c,r]=o.useState(null);return o.useEffect(()=>{(async()=>{a(!0),r(null);try{const n=await x();l(n)}catch(n){r(n instanceof Error?n.message:"Une erreur est survenue"),console.error("Error fetching harvest stats:",n)}finally{a(!1)}})()},[]),{harvestStats:t,isLoading:i,errorInfo:c}}const u=["#d32f2f","#f57c00","#fbc02d","#388e3c","#1976d2"];function E(){const{harvestStats:t,isLoading:l,errorInfo:i}=D();if(l)return e.jsx("div",{className:"donnees-chargement",children:"Récupération des données de récolte..."});if(i)return e.jsxs("div",{className:"donnees-erreur",children:["Problème: ",i]});if(!t)return e.jsx("div",{className:"donnees-absentes",children:"Données de récolte non disponibles"});const a=[{nom:"0-25%",valeur:t.harvestDistribution["0-25%"]},{nom:"26-50%",valeur:t.harvestDistribution["26-50%"]},{nom:"51-75%",valeur:t.harvestDistribution["51-75%"]},{nom:"76-99%",valeur:t.harvestDistribution["76-99%"]},{nom:"100%",valeur:t.harvestDistribution["100%"]}],c=Object.entries(t.harvestByWinner).map(([r,s])=>({camp:r,moyenne:parseFloat(s.average)})).sort((r,s)=>s.moyenne-r.moyenne);return e.jsxs("div",{className:"lycans-recolte-stats",children:[e.jsx("h2",{children:"Statistiques de Récolte"}),e.jsxs("div",{className:"lycans-recolte-sommaire",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Moyenne de Récolte"}),e.jsxs("p",{className:"lycans-nombre-grand",children:[t.averageHarvestPercent,"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre total de parties"}),e.jsx("p",{className:"lycans-nombre-grand",children:t.gamesWithHarvest})]})]}),e.jsxs("div",{className:"lycans-graphiques-conteneur",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Distribution des Récoltes"}),e.jsx("div",{style:{height:300},children:e.jsx(d,{width:"100%",height:"100%",children:e.jsxs(R,{children:[e.jsx(N,{data:a,cx:"50%",cy:"50%",labelLine:!0,label:({nom:r,percent:s})=>`${r}: ${((s??0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"valeur",nameKey:"nom",children:a.map((r,s)=>e.jsx(v,{fill:u[s%u.length]},`cellule-${s}`))}),e.jsx(h,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const n=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:n.nom})}),e.jsxs("div",{children:["Nombre de parties : ",n.valeur]})]})}return null}}),e.jsx(m,{})]})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Moyenne de Récolte au Moment de la Victoire"}),e.jsx(b,{title:"Moyenne de Récolte au Moment de la Victoire",children:e.jsx("div",{style:{height:300},children:e.jsx(d,{width:"100%",height:"100%",children:e.jsxs(j,{data:c,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(y,{strokeDasharray:"3 3"}),e.jsx(g,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(p,{label:{value:"Moyenne de Récolte (%)",angle:-90,position:"insideLeft"}}),e.jsx(h,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const n=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:n.camp}),e.jsxs("div",{children:["Moyenne de Récolte : ",n.moyenne,"%"]})]})}return null}}),e.jsx(m,{}),e.jsx(f,{dataKey:"moyenne",name:"Moyenne de Récolte",fill:"#388e3c"})]})})})})]})]})]})}export{E as HarvestProgressChart};
