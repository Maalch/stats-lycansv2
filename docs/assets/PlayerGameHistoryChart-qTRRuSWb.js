import{g as U,b as X,f as Y,u as Q,a as Z,r as P,c as ee,j as e}from"./index-DWCOAc4B.js";import{g as ae,a as te,u as re}from"./datasyncExport-r4T41qeV.js";import{g as se}from"./gameUtils-BJhAb1O8.js";import{u as ie}from"./usePlayerStatsFromRaw-DvqLOwPJ.js";import{u as le}from"./useJoueursData-DhbQzNOz.js";import{a as ne,u as oe,l as I}from"./api-B0MIFrjR.js";import{F,C as M,X as T,Y as $,B as q,a as z,b as k}from"./FullscreenChart-Zxl0-j3d.js";import{R as S,T as R}from"./CategoricalChart-BRobycMl.js";import{L as ce,a as de}from"./LineChart-EF2GZlTH.js";import{P as pe,a as me}from"./PieChart-D37PFNqm.js";import{R as O}from"./ReferenceLine-DYAvf_a9.js";import"./ActivePoints-D9jYD6q9.js";import"./PolarChart-CnTegEDh.js";function he(c,u){if(!c||c.trim()===""||u.length===0)return null;const d=[];let h=c;u.forEach(o=>{const i=o.PlayerStats.find(p=>U(p)===c||p.Username.toLowerCase()===c.toLowerCase());if(i){h=X(i);const p=ae(te(i.MainRoleInitial,i.MainRoleChanges||[])),x=se(o),w=i.Victorious,G=Y(new Date(o.StartDate));d.push({gameId:o.Id,date:G,camp:p,won:w,winnerCamp:x,playersInGame:o.PlayerStats.length,mapName:o.MapName})}}),d.sort((o,i)=>{const p=x=>{const w=x.split("/");return w.length===3?new Date(parseInt(w[2]),parseInt(w[1])-1,parseInt(w[0])):new Date(x)};return p(i.date).getTime()-p(o.date).getTime()});const g=d.length,b=d.filter(o=>o.won).length,W=g>0?(b/g*100).toFixed(2):"0.00",f={};d.forEach(o=>{f[o.camp]||(f[o.camp]={appearances:0,wins:0,winRate:"0.00"}),f[o.camp].appearances++,o.won&&f[o.camp].wins++}),Object.keys(f).forEach(o=>{const i=f[o];i.winRate=i.appearances>0?(i.wins/i.appearances*100).toFixed(2):"0.00"});const v={};return d.forEach(o=>{v[o.mapName]||(v[o.mapName]={appearances:0,wins:0,winRate:"0.00"}),v[o.mapName].appearances++,o.won&&v[o.mapName].wins++}),Object.keys(v).forEach(o=>{const i=v[o];i.winRate=i.appearances>0?(i.wins/i.appearances*100).toFixed(2):"0.00"}),{playerName:h,totalGames:g,totalWins:b,winRate:W,games:d,campStats:f,mapStats:v}}function ue(c){const u={};let d=0,h=0;return Object.entries(c).forEach(([g,b])=>{g==="Village"||g==="Château"?u[g]={...b}:(d+=b.appearances,h+=b.wins)}),d>=10&&(u.Autres={appearances:d,wins:h,winRate:d>0?(h/d*100).toFixed(2):"0.00"}),u}function xe(c){const{data:u,isLoading:d,error:h}=re(g=>c?he(c,g):null);return{data:u,isLoading:d,error:h}}function Ae(){const{navigateToGameDetails:c,navigationState:u,updateNavigationState:d}=Q(),{settings:h}=Z(),g=ne(),{joueursData:b}=le(),W=oe(b),{data:f}=ie(),v=P.useMemo(()=>{if(!f?.playerStats)return["Ponce"];const a=f.playerStats.filter(t=>t.gamesPlayed>0).map(t=>t.player).sort();return h.highlightedPlayer&&!a.includes(h.highlightedPlayer)&&f.playerStats.some(t=>t.player===h.highlightedPlayer&&t.gamesPlayed>0)&&(a.push(h.highlightedPlayer),a.sort()),a},[f,h.highlightedPlayer]),i=u.selectedPlayerName&&v.includes(u.selectedPlayerName)?u.selectedPlayerName:h.highlightedPlayer&&v.includes(h.highlightedPlayer)?h.highlightedPlayer:v.includes("Ponce")?"Ponce":v[0]||"",p=u.groupingMethod||"session",x=u.selectedViewType||"performance",w=a=>{d({selectedPlayerName:a})},G=a=>{d({groupingMethod:a})},K=a=>{d({selectedViewType:a})},{data:m,isLoading:H,error:B}=xe(i),L=P.useMemo(()=>{if(!m?.games)return new Map;const a=new Map;return m.games.forEach(t=>{if(!a.has(t.date)){const r=t.date.split("/");r.length===3?a.set(t.date,new Date(parseInt(r[2]),parseInt(r[1])-1,parseInt(r[0])).getTime()):a.set(t.date,new Date(t.date).getTime())}}),a},[m?.games]),N=P.useMemo(()=>{if(!m?.games)return[];const a={};return m.games.forEach(t=>{let r;if(p==="month"){const n=t.date.split("/");n.length===3?r=`${n[1]}/${n[2]}`:r=t.date}else r=t.date;a[r]||(a[r]={games:[],wins:0,total:0}),a[r].games.push(t),a[r].total++,t.won&&a[r].wins++}),Object.entries(a).map(([t,r])=>({period:t,totalGames:r.total,victories:r.wins,defeats:r.total-r.wins,winRate:r.total>0?(r.wins/r.total*100).toFixed(1):"0.0",winRateNum:r.total>0?r.wins/r.total*100:0})).sort((t,r)=>{if(p==="month"){const[n,s]=t.period.split("/"),[l,y]=r.period.split("/"),J=new Date(parseInt(s),parseInt(n)-1,1),_=new Date(parseInt(y),parseInt(l)-1,1);return J.getTime()-_.getTime()}else{const n=L.get(t.period)||0,s=L.get(r.period)||0;return n-s}})},[m,p,L]),D=P.useMemo(()=>m?.campStats?Object.entries(m.campStats).map(([a,t])=>({name:a,value:t.appearances,winRate:t.winRate,winRateDisplay:Math.max(parseFloat(t.winRate),1),wins:t.wins,percentage:(t.appearances/m.totalGames*100).toFixed(1)})):[],[m]),E=P.useMemo(()=>{if(!D.length)return[];const a=5;let t=0;const r=[],n=[];if(D.forEach(s=>{parseFloat(s.percentage)<a?(t+=Number(s.value),r.push(s)):n.push(s)}),t>0){const s=D.reduce((l,y)=>l+Number(y.value),0);n.push({name:"Autres",value:t,winRate:"0.0",wins:r.reduce((l,y)=>l+y.wins,0),percentage:(t/s*100).toFixed(1),_details:r})}return n},[D]),j=P.useMemo(()=>{if(!m?.mapStats)return[];const a=ue(m.mapStats);return Object.entries(a).map(([t,r])=>({name:t,value:r.appearances,winRate:r.winRate,winRateDisplay:Math.max(parseFloat(r.winRate),.1),wins:r.wins,percentage:(r.appearances/m.totalGames*100).toFixed(1)}))},[m]),{gameData:V}=ee(),A=P.useMemo(()=>{if(!V||!i)return{playersKilled:[],killedBy:[]};const a={},t={};V.forEach(s=>{const l=s.PlayerStats.find(y=>y.Username.toLowerCase()===i.toLowerCase());l&&(s.PlayerStats.forEach(y=>{y.KillerName?.toLowerCase()===i.toLowerCase()&&(a[y.Username]=(a[y.Username]||0)+1)}),l.KillerName&&(t[l.KillerName]=(t[l.KillerName]||0)+1))});const r=Object.entries(a).map(([s,l])=>({player:s,kills:l})).sort((s,l)=>l.kills-s.kills).slice(0,10),n=Object.entries(t).map(([s,l])=>({player:s,kills:l})).sort((s,l)=>l.kills-s.kills).slice(0,10);return{playersKilled:r,killedBy:n}},[V,i]),C=(a=>a<=15?{fontSize:12,angle:-45,height:80,interval:0}:a<=30?{fontSize:12,angle:-45,height:85,interval:1}:a<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(a/12)})(N.length);return H?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):B?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",B]}):m?e.jsxs("div",{className:"lycans-player-history",children:[e.jsx("h2",{children:"Historique Détaillé d'un Joueur"}),e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Joueur:"}),e.jsx("select",{id:"player-select",value:i,onChange:a=>w(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:v.map(a=>e.jsx("option",{value:a,children:a},a))})]})}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${x==="performance"?"active":""}`,onClick:()=>K("performance"),children:"Évolution"}),e.jsx("button",{className:`lycans-categorie-btn ${x==="camp"?"active":""}`,onClick:()=>K("camp"),children:"Camp"}),e.jsx("button",{className:`lycans-categorie-btn ${x==="map"?"active":""}`,onClick:()=>K("map"),children:"Map"}),e.jsx("button",{className:`lycans-categorie-btn ${x==="kills"?"active":""}`,onClick:()=>K("kills"),children:"Kills"})]}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{c({selectedPlayer:i,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${i}`,children:m.totalGames}),e.jsx("p",{children:"parties jouées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{c({selectedPlayer:i,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${i}`,children:m.totalWins}),e.jsx("p",{children:"parties gagnées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",children:[m.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),x==="performance"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:p,onChange:a=>G(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"})]})]})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Évolution des Performances ",p==="month"?"par Mois":"par Session"]}),e.jsx(F,{title:`Évolution des Performances ${p==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(ce,{data:N,margin:{top:20,right:30,left:20,bottom:20},onClick:a=>{if(a&&a.activeLabel){const t=N.find(r=>r.period===a.activeLabel);t&&c({selectedPlayer:i,selectedDate:t.period,fromComponent:`Évolution des Performances ${p==="month"?"par Mois":"par Session"}`})}},style:{cursor:"pointer"},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"period",angle:C.angle,textAnchor:"end",height:C.height,interval:C.interval,fontSize:C.fontSize}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.period})}),e.jsxs("div",{children:["Parties: ",r.totalGames]}),e.jsxs("div",{children:["Victoires: ",r.victories]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(de,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Répartition Victoires/Défaites ",p==="month"?"par Mois":"par Session"]}),e.jsx(F,{title:`Répartition Victoires/Défaites ${p==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:N,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"period",angle:C.angle,textAnchor:"end",height:C.height,interval:C.interval,fontSize:C.fontSize}),e.jsx($,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.period})}),e.jsxs("div",{children:["Total: ",r.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",r.victories]}),e.jsxs("div",{children:["Défaites: ",r.defeats]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:N.map((a,t)=>e.jsx(k,{fill:"var(--accent-tertiary)",onClick:()=>{c({selectedPlayer:i,selectedDate:a.period,fromComponent:`Historique Joueur - Victoires ${p==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-victories-${t}`))}),e.jsx(z,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"Défaites",children:N.map((a,t)=>e.jsx(k,{fill:"var(--chart-color-4)",onClick:()=>{c({selectedPlayer:i,selectedDate:a.period,fromComponent:`Historique Joueur - Défaites ${p==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-defeats-${t}`))})]})})})})]})]})]}),x==="camp"&&e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(pe,{children:[e.jsx(me,{data:E,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:a=>{const t=a.percent!==void 0?a.percent:0;return a.name==="Autres"?`Autres : ${a.value} (${(t*100).toFixed(1)}%)`:`${a.name}: ${a.value} (${(t*100).toFixed(1)}%)`},children:E.map((a,t)=>e.jsx(k,{fill:a.name==="Autres"?I:g[a.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{if(a.name==="Autres"){const r=a._details?.map(n=>n.name)||[];c({selectedPlayer:i,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:r},fromComponent:"Distribution par Camps"})}else a.name==="Traître"||a.name==="Louveteau"?c({selectedPlayer:i,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):a.name==="Loup"?c({selectedPlayer:i,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):c({selectedPlayer:i,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${t}`))}),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;if(r.name==="Autres"&&r._details){const n=[...r._details].sort((s,l)=>l.value-s.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{children:n.map((s,l)=>e.jsxs("div",{children:[s.name,": ",s.value," parties (",s.percentage,"%)"]},l))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[r.name," (",r.percentage,"%)"]})}),e.jsxs("div",{children:["Apparitions: ",r.value]}),e.jsxs("div",{children:["Victoires: ",r.wins," (",r.winRate,"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(F,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:D,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.value]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"winRateDisplay",children:D.map((a,t)=>e.jsx(k,{fill:parseFloat(a.winRate)===0?`${g[a.name]||`var(--chart-color-${t%6+1})`}50`:g[a.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{a.name==="Traître"||a.name==="Louveteau"?c({selectedPlayer:i,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):a.name==="Loup"?c({selectedPlayer:i,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):c({selectedPlayer:i,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${t}`))})]})})})})]})]}),x==="kills"&&e.jsxs("div",{className:"lycans-graphiques-groupe",children:[A.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Joueurs les plus souvent tués"}),e.jsx(F,{title:"Joueurs les plus souvent tués",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:A.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.player})}),e.jsxs("div",{children:["Tué ",r.kills," fois par ",i]})]})}return null}}),e.jsx(z,{dataKey:"kills",children:A.playersKilled.map((a,t)=>e.jsx(k,{fill:W[a.player]||"var(--chart-color-3)"},`cell-killed-${t}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistré"}),e.jsxs("p",{children:[i," n'a tué aucun joueur dans les parties enregistrées."]})]}),A.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Le plus souvent tué par"}),e.jsx(F,{title:"Le plus souvent tué par",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:A.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.player})}),e.jsxs("div",{children:["A tué ",i," ",r.kills," fois"]})]})}return null}}),e.jsx(z,{dataKey:"kills",children:A.killedBy.map((a,t)=>e.jsx(k,{fill:W[a.player]||"var(--chart-color-4)"},`cell-killer-${t}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[i," n'a jamais été tué par un autre joueur dans les parties enregistrées."]})]})]}),x==="map"&&j.length>0&&e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Carte"}),e.jsx(F,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:j,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(O,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(j.length>0){const a=j.reduce((n,s)=>n+s.value,0),t=j.reduce((n,s)=>n+s.wins,0),r=a>0?t/a*100:0;if(r!==50)return e.jsx(O,{y:r,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${r.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(R,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload,n=[];return j.forEach(s=>{if(s.name!==r.name&&s.value>=5){const l=parseFloat(r.winRate)-parseFloat(s.winRate);Math.abs(l)>=2&&n.push({map:s.name,diff:l,better:l>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Parties: ",r.value]}),e.jsxs("div",{children:["Victoires: ",r.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",r.winRate,"%"]})}),n.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),n.map((s,l)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:s.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[s.better?"↗":"↘"," ",Math.abs(s.diff).toFixed(1),"% vs ",s.map]},l))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"winRateDisplay",label:a=>{const{x:t,y:r,width:n,payload:s}=a;if(t===void 0||r===void 0||n===void 0||!s)return null;const l=s.winRate||"0";return e.jsxs("text",{x:t+n/2,y:r-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[l,"%"]})},onClick:a=>{a&&a.name&&c({selectedPlayer:i,selectedMapName:a.name,fromComponent:"Performance par Carte"})},children:j.map((a,t)=>{let r;a.name==="Village"?r="var(--accent-secondary)":a.name==="Château"?r="var(--accent-tertiary)":a.name==="Autres"?r=I:r=`var(--chart-color-${t%6+1})`;const n=Math.max(...j.map(l=>parseFloat(l.winRate))),s=parseFloat(a.winRate)===n&&n>0;return e.jsx(k,{fill:parseFloat(a.winRate)===0?`${r}30`:r,stroke:"transparent",strokeWidth:s?3:1,style:{cursor:"pointer"}},`cell-map-${t}`)})})]})})})})]})}),x==="map"&&j.length===0&&e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnée de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée d'historique disponible"})}export{Ae as PlayerGameHistoryChart};
