import{a as me,r as D,g as X,f as Me,u as ae,j as e,c as we,d as oe,m as Fe}from"./index-FyftBKPn.js";import{u as de}from"./useJoueursData-DSsZePre.js";import{u as he}from"./baseStatsHook-DOMbVm0Q.js";import{g as Ee}from"./gameUtils-DYpUb-C5.js";import{a as Re,g as ce,c as ge,b as Ie}from"./datasyncExport-CjB7UYqV.js";import{u as xe,g as Le,a as ne,l as ke}from"./api-RThRCcoZ.js";import{f as ie,d as $e}from"./durationFormatters-C9UyWcKX.js";import{F as q,C as B,X as _,Y as O,a as H}from"./FullscreenChart-BQwHNysl.js";import{R as W,T as G}from"./CategoricalChart-CNJs8mbn.js";import{L as ze,a as Ve}from"./LineChart-CNUfTa_o.js";import{B as Z,a as K}from"./BarChart-e6p_w7Z4.js";import{P as Ae,a as Te}from"./PieChart-DnAYJhDQ.js";import{u as We}from"./useDeathStatisticsFromRaw-BW8pPrPS.js";import{R as fe}from"./ReferenceLine-Dg74o9X3.js";import{g as le}from"./deathTypes-gHH1w6_X.js";import{i as ye,g as ve,V as Ge,a as qe}from"./roleUtils-CLjkiQQc.js";import{e as je,a as Be,b as _e,d as Oe,R as Ke}from"./deathLocationUtils-C3Fbeu_S.js";import{S as He,a as Ue}from"./ScatterChart-CrJE9pMv.js";import{L as Ye}from"./Legend-BanKwUgn.js";import{a as Xe,u as Je}from"./useClips-CR3_qJZ9.js";import{C as Ze,f as be,a as Qe}from"./ClipViewer-CREt3NkW.js";import"./ActivePoints-Pj9zlmY2.js";import"./PolarChart-CuT5oOis.js";function et(a){const{settings:l}=me(),{joueursData:b}=de(),[p,u]=D.useState(null),[m,k]=D.useState(!1),[x,d]=D.useState(null);D.useEffect(()=>{let c=!0;return(async()=>{try{k(!0),d(null);const o=l.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",s=await fetch(o);if(!s.ok)throw new Error(`Failed to load achievements: ${s.status} ${s.statusText}`);const i=await s.json();c&&u(i)}catch(o){c&&d(o instanceof Error?o.message:"Failed to load achievements")}finally{c&&k(!1)}})(),()=>{c=!1}},[l.dataSource]);const h=(()=>{if(!a||!p)return null;const r=b?.Players?.find(o=>o.Joueur===a)?.SteamID;return r?p.achievements[r]||null:(console.warn(`âš ï¸ No Steam ID found for player: ${a}`),null)})();return D.useEffect(()=>{a&&p&&b&&b.Players?.find(o=>o.Joueur===a)?.SteamID},[a,p,b,l.dataSource]),{data:h,isLoading:m,error:x,metadata:{generatedAt:p?.generatedAt||null,totalPlayers:p?.totalPlayers||0,totalGames:p?.totalGames||0,totalModdedGames:p?.totalModdedGames||0}}}function tt(a,l,b){if(!a||a.trim()===""||l.length===0)return null;const p=[];let u=a;l.forEach(r=>{const o=r.PlayerStats.find(s=>X(s)===a||s.Username.toLowerCase()===a.toLowerCase());if(o){u=o.Username;const s=o.MainRoleInitial==="Louveteau"?o.MainRoleInitial:Re(o.MainRoleInitial,o.MainRoleChanges||[]),i=ce(s);if(b&&b!=="Tous les camps"&&i!==b)return;const v=Ee(r),n=o.Victorious,y=Me(new Date(r.StartDate)),N=ge(r.StartDate,r.EndDate)||0;p.push({gameId:r.Id,date:y,camp:i,won:n,winnerCamp:v,playersInGame:r.PlayerStats.length,mapName:r.MapName,duration:N})}}),p.sort((r,o)=>{const s=i=>{const v=i.split("/");return v.length===3?new Date(parseInt(v[2]),parseInt(v[1])-1,parseInt(v[0])):new Date(i)};return s(o.date).getTime()-s(r.date).getTime()});const m=p.length,k=p.filter(r=>r.won).length,x=m>0?(k/m*100).toFixed(2):"0.00",d={};p.forEach(r=>{d[r.camp]||(d[r.camp]={appearances:0,wins:0,winRate:"0.00"}),d[r.camp].appearances++,r.won&&d[r.camp].wins++}),Object.keys(d).forEach(r=>{const o=d[r];o.winRate=o.appearances>0?(o.wins/o.appearances*100).toFixed(2):"0.00"});const h={};p.forEach(r=>{h[r.mapName]||(h[r.mapName]={appearances:0,wins:0,winRate:"0.00"}),h[r.mapName].appearances++,r.won&&h[r.mapName].wins++}),Object.keys(h).forEach(r=>{const o=h[r];o.winRate=o.appearances>0?(o.wins/o.appearances*100).toFixed(2):"0.00"});const c=p.reduce((r,o)=>r+o.duration,0);return{playerName:u,totalGames:m,totalWins:k,winRate:x,totalPlayTime:c,games:p,campStats:d,mapStats:h}}function at(a){const l={};let b=0,p=0;return Object.entries(a).forEach(([u,m])=>{u==="Village"||u==="ChÃ¢teau"?l[u]={...m}:(b+=m.appearances,p+=m.wins)}),b>=10&&(l.Autres={appearances:b,wins:p,winRate:b>0?(p/b*100).toFixed(2):"0.00"}),l}function ue(a,l){const{data:b,isLoading:p,error:u}=he(m=>a?tt(a,m,l):null);return{data:b,isLoading:p,error:u}}function st({achievements:a,title:l,emptyMessage:b,achievementType:p="all"}){const{navigateToTab:u,updateNavigationState:m,clearNavigation:k}=ae(),{settings:x,updateSettings:d}=me(),{joueursData:h}=de(),c=xe(h),r=(t,S)=>{if(S.stopPropagation(),!t.redirectTo)return;k();const P=x.highlightedPlayer;if(d(p==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),t.category==="comparison"&&t.redirectTo.subTab==="comparison"){const g=x.highlightedPlayer||"",C=o(t.description,g);C&&m({playerComparisonState:{selectedPlayer1:g,selectedPlayer2:C,showDetailedStats:!0}})}if(t.category==="comparison"&&t.redirectTo.subTab==="pairing"){const g=t.description.toLowerCase().includes("loup");m({selectedPairingTab:g?"wolves":"lovers"})}if(t.category==="kills"&&t.redirectTo.subTab==="deathStats"){const g=t.description.match(/(Villageois|Loups|Autres)/i);g&&m({deathStatsSelectedCamp:g[1]});let C=10;const T=t.description.match(/min\.\s*(\d+)/);T&&(C=parseInt(T[1],10));let A="totalKills",w="killers";const E=t.redirectTo.chartSection;E&&(E==="killers-total"?(A="totalKills",w="killers"):E==="killers-average"?(A="averageKills",w="killers"):E==="deaths-total"?(A="totalDeaths",w="deaths"):E==="survivors-average"?(A="survivalRate",w="deaths"):(E==="hunters-good"||E==="hunters-bad")&&(w="hunter",A="averageKills")),m({deathStatisticsState:{selectedCamp:g?.[1]||"Tous les camps",minGamesForAverage:C,selectedView:w,focusChart:A}})}if(t.category==="map"&&t.redirectTo.subTab==="playersGeneral"){const g=t.redirectTo.mapFilter||"all";let C=10;const T=t.description.match(/min\.\s*(\d+)/);T&&(C=parseInt(T[1])),d(p==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:g,playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:g,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:g,playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:g,playerFilter:{mode:"none",players:[]}}}),m({playersGeneralState:{minGamesForWinRate:C,winRateOrder:"best",focusChart:"winRate"}}),u("players","playersGeneral");return}if(t.category==="history"&&t.redirectTo.subTab==="history"&&m({selectedPlayerName:x.highlightedPlayer||"",groupingMethod:"session"}),t.category==="series"&&t.redirectTo.subTab==="series"){let g="wins";const C=t.title.toLowerCase(),T=t.description.toLowerCase();C.includes("dÃ©faite")||T.includes("dÃ©faite")?g="losses":C.includes("loup")||T.includes("loup")?g="loup":C.includes("villageois")||T.includes("villageois")?g="villageois":(C.includes("victoire")||T.includes("victoire"))&&(g="wins"),m({selectedSeriesType:g})}if(t.category==="general"&&t.redirectTo.subTab==="playersGeneral"){let g=10;const C=t.description.match(/min\.\s*(\d+)/);C&&(g=parseInt(C[1],10));let T="winRate",A="best";const w=t.title.toLowerCase(),E=t.description.toLowerCase();w.includes("participation")||E.includes("participation")?T="participation":(w.includes("taux de victoire")||E.includes("taux de victoire"))&&(T="winRate",(w.includes("moins bon")||w.includes("mauvais")||E.includes("moins bon")||E.includes("mauvais"))&&(A="worst")),m({playersGeneralState:{minGamesForWinRate:g,winRateOrder:A,focusChart:T}})}if(t.category==="performance"&&t.redirectTo.subTab==="campStats"){const g=t.redirectTo.chartSection;let C="Villageois",T=1;g&&(g==="camp-loup"?C="Loup":g==="camp-villageois"?C="Villageois":g==="camp-idiot"?C="Idiot du Village":g==="camp-amoureux"?C="Amoureux":(g==="solo-roles"||g==="hall-of-fame")&&(C="Villageois"));const A=t.description.match(/min\.\s*(\d+)/);A&&(T=parseInt(A[1],10)),g==="solo-roles"?C="RÃ´les spÃ©ciaux":g==="hall-of-fame"&&(C="Tous les camps"),m({campPerformanceState:{selectedCampPerformanceCamp:C,selectedCampPerformanceMinGames:T,viewMode:"performance"}})}if(t.category==="voting"&&t.redirectTo.subTab==="votingStats"){const g=t.title.toLowerCase();let C="overview",T="behavior";g.includes("agressivitÃ©")?(C="overview",T="behavior"):g.includes("taux de vote")?(C="behavior",T="voteRate"):g.includes("prÃ©cision")&&(C="overview",T="accuracy"),m({votingStatsState:{selectedCategory:C,selectedView:T}})}u(t.redirectTo.tab,t.redirectTo.subTab)},o=(t,S)=>{const P=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const g of P){const C=t.match(g);if(C&&C[1]){const T=C[1].trim();if(T!==S)return T}}return null},s=t=>{if(!t.redirectTo)return"Aucune navigation disponible";switch(t.category){case"general":if(t.redirectTo.subTab==="playersGeneral"){const g=t.description.match(/min\.\s*(\d+)/),C=g?parseInt(g[1],10):10,T=t.title.toLowerCase(),A=p==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return T.includes("taux de victoire")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${C} parties)${A}`:T.includes("participation")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les participations${A}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${A}`}break;case"map":if(t.redirectTo.subTab==="playersGeneral"){const g=t.redirectTo.mapFilter,C=g==="village"?"Village":g==="chateau"?"ChÃ¢teau":"map",T=p==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${C}${T}`}break;case"history":if(t.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(t.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${o(t.description,x.highlightedPlayer||"")||"ce joueur"}`;if(t.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(t.redirectTo.subTab==="deathStats"){const g=t.description.match(/(Villageois|Loups|Autres)/i),C=t.description.match(/min\.\s*(\d+)/),T=C?parseInt(C[1],10):10,A=g?.[1]||"Tous les camps",w=t.redirectTo.chartSection;let E="kills et morts";return w==="killers-total"?E="total des kills":w==="killers-average"?E=`moyenne des kills (min. ${T} parties)`:w==="deaths-total"?E="total des morts":w==="survivors-average"&&(E=`taux de survie (min. ${T} parties)`),`Cliquez pour voir les statistiques de ${E} ${A!=="Tous les camps"?`en ${A}`:""}`}break;case"series":if(t.redirectTo.subTab==="series"){const g=t.title.toLowerCase(),C=t.description.toLowerCase();return g.includes("dÃ©faite")||C.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":g.includes("loup")||C.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":g.includes("villageois")||C.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":g.includes("victoire")||C.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(t.redirectTo.subTab==="campStats"){const g=t.redirectTo.chartSection,C=p==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return g==="camp-loup"?`Cliquez pour voir les performances camp Loup${C}`:g==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${C}`:g==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${C}`:g==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${C}`:g==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${C}`:g==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${C}`:`Cliquez pour voir les performances par camp${C}`}break;case"voting":if(t.redirectTo.subTab==="votingStats"){const g=t.description.match(/min\.\s*(\d+)/),C=g?parseInt(g[1],10):25,T=p==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",A=t.title.toLowerCase();return A.includes("agressivitÃ©")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${C} meetings)${T}`:A.includes("taux de vote")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${C} meetings)${T}`:A.includes("prÃ©cision")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${T}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${T}`}break}return`Cliquez pour voir ${t.redirectTo.subTab}`+(p==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},i=t=>c[t]||Le(t),v=t=>{const S=[/avec ([^:]+?):/,/contre ([^:]+?):/];let P=t;return S.forEach(g=>{const C=t.match(g);if(C&&C[1]){const T=C[1].trim(),w=`<span class="player-name-highlight" style="color: ${i(T)};">${T}</span>`;P=P.replace(T,w)}}),P};if(a.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:l}),e.jsx("p",{children:b||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const n=t=>t===1?"ðŸ¥‡":t===2?"ðŸ¥ˆ":t===3?"ðŸ¥‰":"",y=t=>t===1?"rank-1":t===2?"rank-2":t===3?"rank-3":t&&t<=10?"rank-top-10":"",N=(t,S)=>{if(!t||t<=3||!S)return;const P=t-3,g=S-3;return g<=1?"hsl(120, 70%, 50%)":`hsl(${120*(1-(P-1)/(g-1))}, 70%, 50%)`},F=t=>{if(!t)return;const S=t.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(S){const[,P,g]=S;return`hsl(${P}, ${g}%, 40%)`}return t},I=a.filter(t=>t.category!=="comparison"&&(t.type==="good"||t.type==="neutral")).sort((t,S)=>(t.rank??999)-(S.rank??999)),$=a.filter(t=>t.category!=="comparison"&&t.type==="bad").sort((t,S)=>(t.rank??999)-(S.rank??999)),j=a.filter(t=>t.category==="comparison"),R=I.filter(t=>t.rank&&t.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:l}),R>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:I.filter(t=>t.rank&&t.rank<=3).map((t,S)=>e.jsxs("div",{className:`top3-card ${y(t.rank)} animate-slide-in`,style:{animationDelay:`${S*.15}s`},onClick:P=>r(t,P),title:s(t),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:n(t.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:t.title}),e.jsx("p",{className:"top3-achievement-description",children:t.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},t.id))})]}),I.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:I.filter(t=>!t.rank||t.rank>3).map((t,S)=>{const P=N(t.rank,t.totalRanked),g=F(P);return e.jsxs("div",{className:`achievement-card good ${y(t.rank)}`,onClick:C=>r(t,C),title:s(t),style:{animationDelay:`${S*.05}s`,borderLeftColor:g,...P&&{borderLeftWidth:"4px"}},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",style:P?{backgroundColor:P}:{},children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id)})})]}),$.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:$.map(t=>{const S=N(t.rank,t.totalRanked),P=F(S);return e.jsxs("div",{className:`achievement-card bad rank-${t.rank}`,onClick:g=>r(t,g),title:s(t),style:{borderLeftColor:P,...S&&{borderLeftWidth:"4px"}},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",style:S?{backgroundColor:S}:{},children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id)})})]}),j.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:j.map(t=>e.jsxs("div",{className:"achievement-card comparison",onClick:S=>r(t,S),title:s(t),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:t.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:v(t.description)}})]},t.id))})]})]})}function rt({selectedPlayerName:a,groupingMethod:l,campFilter:b="all"}){const{navigateToGameDetails:p}=ae(),{data:u,isLoading:m,error:k}=ue(a),x=D.useMemo(()=>{switch(l){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[l]),d=D.useMemo(()=>{if(!u?.games)return new Map;const o=new Map;return u.games.forEach(s=>{if(!o.has(s.date)){const i=s.date.split("/");i.length===3?o.set(s.date,new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])).getTime()):o.set(s.date,new Date(s.date).getTime())}}),o},[u?.games]),h=D.useMemo(()=>{if(!u?.games)return[];const o={};return u.games.forEach(s=>{if(b!=="all"){if(b==="solo"){if(s.camp==="Villageois"||s.camp==="Loup")return}else if(s.camp!==b)return}let i;const v=s.date.split("/");if(l==="month")if(v.length===3)i=`${v[1].padStart(2,"0")}/${v[2]}`;else{const n=new Date(s.date);i=`${String(n.getMonth()+1).padStart(2,"0")}/${n.getFullYear()}`}else if(l==="quarter")if(v.length===3){const n=parseInt(v[1],10);i=`T${Math.floor((n-1)/3)+1}/${v[2]}`}else{const n=new Date(s.date);i=`T${Math.floor(n.getMonth()/3)+1}/${n.getFullYear()}`}else l==="year"?v.length===3?i=`${v[2]}`:i=`${new Date(s.date).getFullYear()}`:i=s.date;o[i]||(o[i]={games:[],wins:0,total:0}),o[i].games.push(s),o[i].total++,s.won&&o[i].wins++}),Object.entries(o).map(([s,i])=>({period:s,totalGames:i.total,victories:i.wins,defeats:i.total-i.wins,winRate:i.total>0?(i.wins/i.total*100).toFixed(1):"0.0",winRateNum:i.total>0?i.wins/i.total*100:0})).sort((s,i)=>{if(l==="month"){const[v,n]=s.period.split("/"),[y,N]=i.period.split("/"),F=new Date(parseInt(n),parseInt(v)-1,1),I=new Date(parseInt(N),parseInt(y)-1,1);return F.getTime()-I.getTime()}else if(l==="quarter"){const[v,n]=s.period.split("/"),[y,N]=i.period.split("/"),F=parseInt(v.replace(/\D/g,""),10)||1,I=parseInt(y.replace(/\D/g,""),10)||1,$=new Date(parseInt(n,10),(F-1)*3,1),j=new Date(parseInt(N,10),(I-1)*3,1);return $.getTime()-j.getTime()}else if(l==="year"){const v=parseInt(s.period,10),n=parseInt(i.period,10);return v-n}else{const v=d.get(s.period)||0,n=d.get(i.period)||0;return v-n}})},[u,l,d,b]),r=(o=>o<=15?{fontSize:12,angle:-45,height:80,interval:0}:o<=30?{fontSize:12,angle:-45,height:85,interval:1}:o<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(o/12)})(h.length);return m?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):u?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",x]}),e.jsx(q,{title:`Ã‰volution des Performances ${x}`,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(ze,{data:h,margin:{top:20,right:30,left:20,bottom:20},onClick:o=>{if(o&&o.activeLabel){const s=h.find(i=>i.period===o.activeLabel);s&&p({selectedPlayer:a,selectedDate:s.period,fromComponent:`Ã‰volution des Performances ${x}`})}},style:{cursor:"pointer"},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"period",angle:r.angle,textAnchor:"end",height:r.height,interval:r.interval,fontSize:r.fontSize}),e.jsx(O,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:o,payload:s})=>{if(o&&s&&s.length>0){const i=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Parties: ",i.totalGames]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(Ve,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",x]}),e.jsx(q,{title:`RÃ©partition Victoires/DÃ©faites ${x}`,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:h,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"period",angle:r.angle,textAnchor:"end",height:r.height,interval:r.interval,fontSize:r.fontSize}),e.jsx(O,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:o,payload:s})=>{if(o&&s&&s.length>0){const i=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Total: ",i.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["DÃ©faites: ",i.defeats]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(K,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:h.map((o,s)=>e.jsx(H,{fill:"var(--accent-tertiary)",onClick:()=>{p({selectedPlayer:a,selectedDate:o.period,fromComponent:`Historique Joueur - Victoires ${x}`})},style:{cursor:"pointer"}},`cell-victories-${s}`))}),e.jsx(K,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:h.map((o,s)=>e.jsx(H,{fill:"var(--chart-color-4)",onClick:()=>{p({selectedPlayer:a,selectedDate:o.period,fromComponent:`Historique Joueur - DÃ©faites ${x}`})},style:{cursor:"pointer"}},`cell-defeats-${s}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function it({selectedPlayerName:a}){const{navigateToGameDetails:l}=ae(),{data:b,isLoading:p,error:u}=ue(a),m=ne(),k=D.useMemo(()=>b?.campStats?Object.entries(b.campStats).map(([d,h])=>({name:d,value:h.appearances,winRate:h.winRate,winRateDisplay:Math.max(parseFloat(h.winRate),1),wins:h.wins,percentage:(h.appearances/b.totalGames*100).toFixed(1)})):[],[b]),x=D.useMemo(()=>{if(!k.length)return[];const d=5;let h=0;const c=[],r=[];if(k.forEach(o=>{parseFloat(o.percentage)<d?(h+=Number(o.value),c.push(o)):r.push(o)}),h>0){const o=k.reduce((s,i)=>s+Number(i.value),0);r.push({name:"Autres",value:h,winRate:"0.0",winRateDisplay:1,wins:c.reduce((s,i)=>s+i.wins,0),percentage:(h/o*100).toFixed(1),_details:c})}return r},[k]);return p?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):u?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]}):b?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Ae,{children:[e.jsx(Te,{data:x,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:d=>{const h=d.percent!==void 0?d.percent:0;return d.name==="Autres"?`Autres : ${d.value} (${(h*100).toFixed(1)}%)`:`${d.name}: ${d.value} (${(h*100).toFixed(1)}%)`},children:x.map((d,h)=>e.jsx(H,{fill:d.name==="Autres"?ke:m[d.name]||`var(--chart-color-${h%6+1})`,onClick:()=>{if(d.name==="Autres"){const c=d._details?.map(r=>r.name)||[];l({selectedPlayer:a,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:c},fromComponent:"Distribution par Camps"})}else d.name==="TraÃ®tre"||d.name==="Louveteau"?l({selectedPlayer:a,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):d.name==="Loup"?l({selectedPlayer:a,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):l({selectedPlayer:a,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${h}`))}),e.jsx(G,{content:({active:d,payload:h})=>{if(d&&h&&h.length>0){const c=h[0].payload;if(c.name==="Autres"&&c._details){const r=[...c._details].sort((o,s)=>s.value-o.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",c.value," parties (",c.percentage,"%)"]})}),e.jsx("div",{children:r.map((o,s)=>e.jsxs("div",{children:[o.name,": ",o.value," parties (",o.percentage,"%)"]},s))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[c.name," - ",c.value," parties (",c.percentage,"%)"]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(q,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:k,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:d,payload:h})=>{if(d&&h&&h.length>0){const c=h[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:c.name})}),e.jsxs("div",{children:["Victoires: ",c.wins," / ",c.value]}),e.jsxs("div",{children:["Taux: ",c.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(K,{dataKey:"winRateDisplay",children:k.map((d,h)=>e.jsx(H,{fill:parseFloat(d.winRate)===0?`${m[d.name]||`var(--chart-color-${h%6+1})`}50`:m[d.name]||`var(--chart-color-${h%6+1})`,onClick:()=>{d.name==="TraÃ®tre"||d.name==="Louveteau"?l({selectedPlayer:a,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):d.name==="Loup"?l({selectedPlayer:a,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):l({selectedPlayer:a,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${h}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function nt({selectedPlayerName:a}){const{navigateToGameDetails:l,navigationState:b,updateNavigationState:p}=ae(),[u,m]=D.useState(b.playerHistoryMapState?.selectedCamp||"Tous les camps"),{data:k}=We(),{data:x,isLoading:d,error:h}=ue(a,u);D.useEffect(()=>{(!b.playerHistoryMapState||b.playerHistoryMapState.selectedCamp!==u)&&p({playerHistoryMapState:{selectedCamp:u}})},[u,b.playerHistoryMapState,p]);const c=o=>{m(o),p({playerHistoryMapState:{selectedCamp:o}})},r=D.useMemo(()=>{if(!x?.mapStats)return[];const o=at(x.mapStats);return Object.entries(o).map(([s,i])=>({name:s,value:i.appearances,winRate:i.winRate,winRateDisplay:Math.max(parseFloat(i.winRate),.1),wins:i.wins,percentage:(i.appearances/x.totalGames*100).toFixed(1)}))},[x]);return d?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):h?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",h]}):x?e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Performance par Carte",u!=="Tous les camps"?` (${u})`:""]}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select-map",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select-map",value:u,onChange:o=>c(o.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),k?.map(o=>e.jsx("option",{value:o,children:o},o))]})]}),r.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur avec le camp sÃ©lectionnÃ©."})]}):e.jsx(q,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:r,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(fe,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(r.length>0){const o=r.reduce((v,n)=>v+n.value,0),s=r.reduce((v,n)=>v+n.wins,0),i=o>0?s/o*100:0;if(i!==50)return e.jsx(fe,{y:i,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${i.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(G,{content:({active:o,payload:s})=>{if(o&&s&&s.length>0){const i=s[0].payload,v=[];return r.forEach(n=>{if(n.name!==i.name&&n.value>=5){const y=parseFloat(i.winRate)-parseFloat(n.winRate);Math.abs(y)>=2&&v.push({map:n.name,diff:y,better:y>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Parties: ",i.value]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",i.winRate,"%"]})}),v.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),v.map((n,y)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:n.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[n.better?"â†—":"â†˜"," ",Math.abs(n.diff).toFixed(1),"% vs ",n.map]},y))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(K,{dataKey:"winRateDisplay",label:o=>{const{x:s,y:i,width:v,payload:n}=o;if(s===void 0||i===void 0||v===void 0||!n)return null;const y=n.winRate||"0";return e.jsxs("text",{x:s+v/2,y:i-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[y,"%"]})},onClick:o=>{if(o&&o.name){const s={selectedPlayer:a,selectedMapName:o.name,fromComponent:"Performance par Carte"};u!=="Tous les camps"&&(s.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),l(s)}},children:r.map((o,s)=>{let i;o.name==="Village"?i="var(--accent-secondary)":o.name==="ChÃ¢teau"?i="var(--accent-tertiary)":o.name==="Autres"?i=ke:i=`var(--chart-color-${s%6+1})`;const v=Math.max(...r.map(y=>parseFloat(y.winRate))),n=parseFloat(o.winRate)===v&&v>0;return e.jsx(H,{fill:parseFloat(o.winRate)===0?`${i}30`:i,stroke:"transparent",strokeWidth:n?3:1,style:{cursor:"pointer"}},`cell-map-${s}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ot({selectedPlayerName:a}){const{gameData:l}=we(),{joueursData:b}=de(),p=xe(b),u=ne(),m=D.useMemo(()=>{if(!l||!a)return{playersKilled:[],killedBy:[],deathTypes:[],availableDeathTypes:[]};const x={},d={},h={},c=new Set;l.forEach(v=>{const n=v.PlayerStats.find(y=>y.Username.toLowerCase()===a.toLowerCase());if(n&&(v.PlayerStats.forEach(y=>{y.KillerName?.toLowerCase()===a.toLowerCase()&&(x[y.Username]=(x[y.Username]||0)+1)}),n.KillerName&&(d[n.KillerName]=(d[n.KillerName]||0)+1),n.DeathType)){const y=n.DeathType,N=le(y);h[N]||(h[N]={count:0,byDeathType:{}}),h[N].count+=1,h[N].byDeathType[y]=(h[N].byDeathType[y]||0)+1,c.add(y)}});const r=Object.entries(x).map(([v,n])=>({player:v,kills:n})).sort((v,n)=>n.kills-v.kills).slice(0,10),o=Object.entries(d).map(([v,n])=>({player:v,kills:n})).sort((v,n)=>n.kills-v.kills).slice(0,10),s=Object.entries(h).map(([v,n])=>{const y={deathType:v,count:n.count};return y[v]=n.count,y}).sort((v,n)=>n.count-v.count).slice(0,10),i=Object.keys(h);return{playersKilled:r,killedBy:o,deathTypes:s,availableDeathTypes:i}},[l,a]),k=D.useMemo(()=>{const x={};m.availableDeathTypes.forEach(c=>{c==="TuÃ© par Loup"?x[c]=u.Loup:c==="Mort aux votes"?x[c]="var(--chart-color-1)":c.includes("Chasseur")?x[c]=u.Chasseur:c==="TuÃ© par Zombie"?x[c]=u.Vaudou:c==="TuÃ© par potion assassin"?x[c]=u.Alchimiste:c==="TuÃ© par Vengeur"?x[c]="var(--chart-color-2)":c==="Amoureux mort"?x[c]=u.Amoureux:c==="TuÃ© par La BÃªte"?x[c]="var(--chart-color-3)":c==="TuÃ© par ShÃ©rif"&&(x[c]="var(--chart-color-4)")});const d=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let h=0;return m.availableDeathTypes.forEach(c=>{x[c]||(x[c]=d[h%d.length],h++)}),x},[m.availableDeathTypes,u]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[m.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Victimes"}),e.jsx(q,{title:"Les Victimes",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:m.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:x,payload:d})=>{if(x&&d&&d.length>0){const h=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:h.player})}),e.jsxs("div",{children:["TuÃ© ",h.kills," fois par ",a]})]})}return null}}),e.jsx(K,{dataKey:"kills",children:m.playersKilled.map((x,d)=>e.jsx(H,{fill:p[x.player]||"var(--chart-color-3)"},`cell-killed-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[a," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),m.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Tueurs"}),e.jsx(q,{title:"Les Tueurs",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:m.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:x,payload:d})=>{if(x&&d&&d.length>0){const h=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:h.player})}),e.jsxs("div",{children:["A tuÃ© ",a," ",h.kills," fois"]})]})}return null}}),e.jsx(K,{dataKey:"kills",children:m.killedBy.map((x,d)=>e.jsx(H,{fill:p[x.player]||"var(--chart-color-4)"},`cell-killer-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[a," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]}),m.deathTypes.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Mort les Plus FrÃ©quents"}),e.jsx(q,{title:"Types de Mort les Plus FrÃ©quents",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:m.deathTypes,margin:{top:20,right:30,left:20,bottom:90},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"deathType",angle:-45,textAnchor:"end",height:120,interval:0,fontSize:12}),e.jsx(O,{label:{value:"Nombre de morts",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:x,payload:d})=>{if(x&&d&&d.length>0){const h=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:h.deathType})}),e.jsxs("div",{children:[a," est mort ",h.count," fois ainsi"]})]})}return null}}),m.availableDeathTypes.map(x=>e.jsx(K,{dataKey:x,name:x,stackId:"deaths",fill:k[x]||"var(--chart-color-5)"},x))]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de mort"}),e.jsxs("p",{children:["Aucune information de mort disponible pour ",a,"."]})]})]})}function lt(a,l){if(!a||a.trim()===""||l.length===0)return null;const b=new Map,p=new Map,u=new Map;l.forEach(h=>{if(!h.Modded)return;const c=h.PlayerStats.find(r=>X(r)===a||r.Username.toLowerCase()===a.toLowerCase());if(c){if(c.MainRoleInitial==="Inconnu")return;const r=c.Victorious,s=Re(c.MainRoleInitial,c.MainRoleChanges||[])!==c.MainRoleInitial,i=ce(c.MainRoleInitial),v=i==="Loup"||i==="TraÃ®tre"||i==="Louveteau";if(i==="Villageois"&&ye(c)){const n=ve(c);if(n&&Ge.includes(n)){const y=b.get(n)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};b.set(n,{appearances:y.appearances+1,wins:y.wins+(r?1:0),winsWithoutRoleChange:y.winsWithoutRoleChange+(!s&&r?1:0),gamesWithoutRoleChange:y.gamesWithoutRoleChange+(s?0:1)})}}else if(c.Power&&c.Power.trim()!==""&&c.Power!=="Inconnu"){if(i==="Villageois"){const n=b.get(c.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};b.set(c.Power,{appearances:n.appearances+1,wins:n.wins+(r?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!s&&r?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(s?0:1)})}else if(v){const n=p.get(c.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},y=n.roleBreakdown;y.set(c.MainRoleInitial,(y.get(c.MainRoleInitial)||0)+1),p.set(c.Power,{appearances:n.appearances+1,wins:n.wins+(r?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!s&&r?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(s?0:1),roleBreakdown:y})}}else if((i==="Villageois"||v)&&c.Power!=="Inconnu")if(i==="Villageois"){const n=b.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};b.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(r?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!s&&r?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(s?0:1)})}else{const n=p.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},y=n.roleBreakdown;y.set(c.MainRoleInitial,(y.get(c.MainRoleInitial)||0)+1),p.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(r?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!s&&r?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(s?0:1),roleBreakdown:y})}if(c.SecondaryRole&&c.SecondaryRole.trim()!==""&&c.SecondaryRole!=="Inconnu"){const n=u.get(c.SecondaryRole)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};u.set(c.SecondaryRole,{appearances:n.appearances+1,wins:n.wins+(r?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!s&&r?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(s?0:1)})}}});const m=new Map;l.forEach(h=>{const c=h.PlayerStats.find(r=>X(r)===a||r.Username.toLowerCase()===a.toLowerCase());if(c&&ye(c)){const r=ve(c);r&&m.set(r,(m.get(r)||0)+1)}});const k=h=>Array.from(h.entries()).map(([c,r])=>({name:c,appearances:r.appearances,wins:r.wins,winsWithoutRoleChange:r.winsWithoutRoleChange,gamesWithoutRoleChange:r.gamesWithoutRoleChange,winRate:r.gamesWithoutRoleChange>0?(r.winsWithoutRoleChange/r.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Villageois",...m.has(c)&&{totalGamesAllModes:m.get(c)}})).sort((c,r)=>r.appearances-c.appearances),x=h=>Array.from(h.entries()).map(([c,r])=>({name:c,appearances:r.appearances,wins:r.wins,winsWithoutRoleChange:r.winsWithoutRoleChange,gamesWithoutRoleChange:r.gamesWithoutRoleChange,winRate:r.gamesWithoutRoleChange>0?(r.winsWithoutRoleChange/r.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Loup",roleBreakdown:Array.from(r.roleBreakdown.entries()).map(([o,s])=>({role:o,count:s})).sort((o,s)=>s.count-o.count)})).sort((c,r)=>r.appearances-c.appearances),d=h=>Array.from(h.entries()).map(([c,r])=>({name:c,appearances:r.appearances,wins:r.wins,winsWithoutRoleChange:r.winsWithoutRoleChange,gamesWithoutRoleChange:r.gamesWithoutRoleChange,winRate:r.gamesWithoutRoleChange>0?(r.winsWithoutRoleChange/r.gamesWithoutRoleChange*100).toFixed(1):"0.0"})).sort((c,r)=>r.appearances-c.appearances);return{villageoisPowers:k(b),loupPowers:x(p),secondaryRoles:d(u)}}function ct({selectedPlayerName:a}){const{navigateToGameDetails:l,navigationState:b,updateNavigationState:p}=ae(),u=ne(),[m,k]=D.useState(b.playerHistoryRolesState?.chartMode||"appearances"),{data:x,isLoading:d,error:h}=he(y=>lt(a,y));D.useEffect(()=>{(!b.playerHistoryRolesState||b.playerHistoryRolesState.chartMode!==m)&&p({playerHistoryRolesState:{chartMode:m}})},[m,b.playerHistoryRolesState,p]);const c=y=>{k(y),p({playerHistoryRolesState:{chartMode:y}})},r=D.useMemo(()=>{if(!x)return{villageoisPowers:[],loupPowers:[],secondaryRoles:[]};const y=1,N=1,F=15,I=m==="winRate"?(j,R)=>parseFloat(R.winRate)-parseFloat(j.winRate):(j,R)=>R.appearances-j.appearances,$=j=>({...j,winRateDisplay:Math.max(parseFloat(j.winRate),1)});return{villageoisPowers:x.villageoisPowers.filter(j=>j.appearances>=y).map($).sort(I).slice(0,F),loupPowers:x.loupPowers.filter(j=>j.appearances>=y).map($).sort(I).slice(0,F),secondaryRoles:x.secondaryRoles.filter(j=>j.appearances>=N).map($).sort(I).slice(0,F)}},[x,m]);if(d)return e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique des rÃ´les..."});if(h)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",h]});if(!x)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de rÃ´le disponible"});const o=r.villageoisPowers.length>0,s=r.loupPowers.length>0,i=r.secondaryRoles.length>0;if(!o&&!s&&!i)return e.jsx("div",{className:"donnees-manquantes",children:"Aucun pouvoir ou rÃ´le secondaire trouvÃ©"});const v=({active:y,payload:N})=>{if(y&&N&&N.length>0){const F=N[0].payload,I=F.gamesWithoutRoleChange<F.appearances;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:F.name})}),e.jsxs("div",{children:["Apparitions: ",F.appearances]}),I&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"0.25rem"},children:["dont ",F.appearances-F.gamesWithoutRoleChange," avec changement de rÃ´le (exclu du calcul)"]}),e.jsxs("div",{children:["Victoires: ",F.winsWithoutRoleChange]}),e.jsx("div",{children:e.jsxs("strong",{children:["Taux de victoire: ",F.winRate,"%"]})}),F.totalGamesAllModes&&F.totalGamesAllModes!==F.appearances&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic"},children:["(Total avec parties non moddÃ©es: ",F.totalGamesAllModes,")"]}),F.roleBreakdown&&F.roleBreakdown.length>0&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:[e.jsx("div",{style:{fontStyle:"italic"},children:"RÃ©partition par rÃ´le:"}),F.roleBreakdown.map(($,j)=>e.jsxs("div",{style:{marginLeft:"0.5rem"},children:["â€¢ ",$.role,": ",$.count]},j))]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},n=(y,N,F,I,$)=>{const j=m==="appearances"?"appearances":"winRateDisplay",R=m==="appearances"?"Nombre d'apparitions":"Taux de victoire (%)",t=m==="winRate"?[0,100]:void 0;return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:N}),e.jsx(q,{title:N,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:y,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:R,angle:270,position:"left",style:{textAnchor:"middle"}},domain:t}),e.jsx(G,{content:e.jsx(v,{})}),e.jsx(K,{dataKey:j,label:m==="winRate"?S=>{const{x:P,y:g,width:C,payload:T}=S;if(P===void 0||g===void 0||C===void 0||!T)return null;const A=T.winRate||"0";return e.jsxs("text",{x:P+C/2,y:g-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[A,"%"]})}:void 0,children:y.map((S,P)=>e.jsx(H,{fill:$?$(S.name,P):F,onClick:()=>I(S.name),style:{cursor:"pointer"}},`cell-${P}`))})]})})})})]})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"chart-mode-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Affichage :"}),e.jsxs("select",{id:"chart-mode-select",value:m,onChange:y=>c(y.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"180px"},children:[e.jsx("option",{value:"appearances",children:"Apparitions"}),e.jsx("option",{value:"winRate",children:"Taux de victoire"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[o&&n(r.villageoisPowers,"Camp Villageois","var(--chart-color-1)",y=>{l({selectedPlayer:a,campFilter:{selectedCamp:"Villageois",campFilterMode:m==="winRate"?"wins-only":"all-assignments"},selectedPower:y,fromComponent:`Historique des RÃ´les - Pouvoir: ${y}`})},y=>y==="Chasseur"&&u.Chasseur?u.Chasseur:y==="Alchimiste"&&u.Alchimiste?u.Alchimiste:y==="Protecteur"&&u.Protecteur?u.Protecteur:y==="Disciple"&&u.Disciple?u.Disciple:"var(--chart-color-1)"),s&&n(r.loupPowers,"Camp Loups","var(--chart-color-2)",y=>{l({selectedPlayer:a,campFilter:{selectedCamp:"Loup",campFilterMode:m==="winRate"?"wins-only":"all-assignments"},selectedPower:y,fromComponent:`Historique des RÃ´les - Pouvoir: ${y}`})},()=>u.Loup||"var(--chart-color-2)"),i&&n(r.secondaryRoles,"RÃ´les Secondaires","var(--chart-color-3)",y=>{l({selectedPlayer:a,selectedSecondaryRole:y,fromComponent:`Historique des RÃ´les - RÃ´le Secondaire: ${y}`})}),e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"16px",padding:"8px",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)"},children:"â„¹ï¸ Les victoires et le taux de victoire excluent les parties oÃ¹ le rÃ´le principal a changÃ© en cours de partie (ex: Garde en Chasseur, rÃ©ssucitÃ© en Zombie par un Vaudou, etc...)."})]})]})}function Ce(a){return a==="SURVIVALIST_NOT_SAVED"?"BY_WOLF":a}function dt({selectedPlayerName:a}){const{navigateToGameDetails:l}=ae(),{gameData:b,isLoading:p,error:u}=we(),m=ne(),[k,x]=D.useState("deaths"),[d,h]=D.useState(""),[c,r]=D.useState(0),o=D.useMemo(()=>{if(!b)return[];const j=new Set;return b.forEach(R=>{const t=R.PlayerStats.find(S=>S.Username.toLowerCase()===a.toLowerCase());t&&(t.DeathPosition!==null&&R.MapName&&j.add(R.MapName),R.PlayerStats.forEach(S=>{S.KillerName?.toLowerCase()===a.toLowerCase()&&S.DeathPosition!==null&&R.MapName&&j.add(R.MapName)}))}),Array.from(j).filter(R=>R==="Village"||R==="ChÃ¢teau").sort((R,t)=>R==="Village"?-1:t==="Village"?1:R.localeCompare(t))},[b,a]),s=o.length>0?o[0]:"";d===""&&s!==""&&h(s);const i=D.useMemo(()=>{if(!b||!a)return[];const j=[];return b.forEach(R=>{if(d&&R.MapName!==d)return;const t=R.PlayerStats.find(S=>S.Username.toLowerCase()===a.toLowerCase());if(t)if(k==="deaths"){if(t.DeathPosition){const S=ce(t.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0}),P=je(t.DeathPosition.x,t.DeathPosition.z,R.MapName);j.push({x:P.x,z:P.z,victimName:t.Username,killerName:t.KillerName||null,deathType:Ce(t.DeathType),mapName:R.MapName,camp:S,gameId:R.DisplayedId,displayedGameId:R.DisplayedId})}}else R.PlayerStats.forEach(S=>{if(S.KillerName?.toLowerCase()===a.toLowerCase()&&S.DeathPosition){const P=ce(S.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0}),g=je(S.DeathPosition.x,S.DeathPosition.z,R.MapName);j.push({x:g.x,z:g.z,victimName:S.Username,killerName:a,deathType:Ce(S.DeathType),mapName:R.MapName,camp:P,gameId:R.DisplayedId,displayedGameId:R.DisplayedId})}})}),j},[b,a,k,d]),v=D.useMemo(()=>Be(i,c).map((R,t)=>{const S=R.items[0],P=_e(R.items);return{x:R.centroidX,z:R.centroidZ,count:R.items.length,allLocations:R.items,victimName:R.items.length===1?S.victimName:null,killerName:R.items.length===1?S.killerName:null,deathType:P,mapName:S.mapName,camp:S.camp,gameId:R.items.length===1?S.gameId:null,displayedGameId:R.items.length===1?S.displayedGameId:null,clusterIndex:t}}),[i,c]),n=D.useMemo(()=>Oe(d),[d]),{xDomain:y,zDomain:N}=D.useMemo(()=>{if(n)return{xDomain:[n.xMin,n.xMax],zDomain:[n.zMin,n.zMax]};if(v.length===0)return{xDomain:[0,100],zDomain:[0,100]};const j=v.map(A=>A.x),R=v.map(A=>A.z),t=Math.min(...j),S=Math.max(...j),P=Math.min(...R),g=Math.max(...R),C=(S-t)*.1||10,T=(g-P)*.1||10;return{xDomain:[t-C,S+C],zDomain:[P-T,g+T]}},[v,n]),F=j=>j?j==="BY_WOLF"||j==="SURVIVALIST_NOT_SAVED"?m.Loup:j==="VOTED"?"var(--chart-color-1)":j==="BULLET"||j==="BULLET_HUMAN"||j==="BULLET_WOLF"?m.Chasseur:j==="BY_ZOMBIE"?m.Vaudou:j==="ASSASSIN"?m.Alchimiste:j==="AVENGER"?"var(--chart-color-2)":j==="LOVER_DEATH"?m.Amoureux:j==="BY_BEAST"?"var(--chart-color-3)":j==="SHERIF_SUCCESS"?"var(--chart-color-4)":j==="SMUGGLER_HUNT_KILL"?m.Contrebandier:"var(--accent-primary-text)":"var(--text-secondary)",I=({active:j,payload:R})=>{if(!j||!R||R.length===0)return null;const t=R[0].payload,S=t.allLocations||[t];if(S.length>1){const C=new Map,T=new Map,A=new Set;S.forEach(L=>{C.set(L.victimName,(C.get(L.victimName)||0)+1);const z=L.deathType?le(L.deathType):"Inconnu";T.set(z,(T.get(z)||0)+1),A.add(L.gameId)});const w=Array.from(C.entries()).sort((L,z)=>z[1]-L[1]).slice(0,3),E=Array.from(T.entries()).sort((L,z)=>z[1]-L[1]).slice(0,3);return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"350px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary-text)"},children:[k==="deaths"?"ðŸ’€":"âš”ï¸"," ",S.length," ",k==="deaths"?"morts":"kills"," Ã  cet endroit"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:k==="deaths"?"Par:":"Victimes:"}),w.map(([L,z])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",L," (",z,"x)"]},L)),C.size>3&&e.jsxs("div",{style:{paddingLeft:"0.5rem",color:"var(--text-secondary)"},children:["+",C.size-3," autres..."]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Types de mort:"}),E.map(([L,z])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",L," (",z,"x)"]},L))]}),e.jsxs("div",{style:{marginTop:"8px",color:"var(--text-secondary)"},children:["ðŸ“ ",A.size," partie",A.size>1?"s":""," diffÃ©rente",A.size>1?"s":""]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les parties concernÃ©es"})]})}const g=S[0];return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary-text)"},children:[k==="deaths"?"ðŸ’€":"âš”ï¸"," ",k==="deaths"?"Mort de":"Kill de"," ",a]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[k==="deaths"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"TuÃ© par:"})," ",g.killerName||"Inconnu"]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",g.deathType?le(g.deathType):"Inconnue"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"Victime:"})," ",g.victimName]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",g.deathType?le(g.deathType):"Inconnue"]}),e.jsxs("div",{children:["ðŸ‘¥ ",e.jsx("strong",{children:"Camp victime:"})," ",g.camp]})]}),e.jsxs("div",{children:["ðŸ—ºï¸ ",e.jsx("strong",{children:"Carte:"})," ",g.mapName]}),e.jsxs("div",{children:["ðŸŽ® ",e.jsx("strong",{children:"Partie:"})," #",g.gameId]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les dÃ©tails de la partie"})]})},$=j=>{if(!j)return;const R=j.allLocations||[j];if(R.length===1)l({selectedGame:R[0].gameId,fromComponent:"Player Death Map"});else{const t=R.map(S=>S.gameId).filter(S=>S);l({selectedGameIds:t,fromComponent:"Player Death Map"})}};return p?e.jsx("div",{className:"donnees-attente",children:"Chargement des donnÃ©es..."}):u?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]}):b?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{style:{flex:"1 1 100%",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Afficher :"}),e.jsxs("div",{style:{display:"flex",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)",overflow:"hidden"},children:[e.jsx("button",{type:"button",onClick:()=>x("deaths"),style:{background:k==="deaths"?"var(--accent-primary)":"transparent",color:k==="deaths"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:k==="deaths"?"bold":"normal",transition:"all 0.2s"},children:"ðŸ’€ Morts"}),e.jsx("button",{type:"button",onClick:()=>x("kills"),style:{background:k==="kills"?"var(--accent-primary)":"transparent",color:k==="kills"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:k==="kills"?"bold":"normal",transition:"all 0.2s"},children:"âš”ï¸ Kills"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-map-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Carte :"}),e.jsx("select",{id:"player-map-select",value:d,onChange:j=>h(j.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:o.map(j=>e.jsx("option",{value:j,children:j},j))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"cluster-slider",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Regroupement :"}),e.jsx("input",{id:"cluster-slider",type:"range",min:"0",max:"50",step:"5",value:c,onChange:j=>r(parseInt(j.target.value)),style:{width:"80px"}}),e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",minWidth:"60px"},children:c===0?"Aucun":`${c} unitÃ©${c>1?"s":""}`})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{flex:"1 1 100%",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:k==="deaths"?"Morts localisÃ©es":"Kills localisÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:k==="deaths"?"var(--accent-secondary)":"var(--accent-primary-text)"},children:i.length}),c>0&&v.length<i.length&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginTop:"4px"},children:["â†’ ",v.length," points groupÃ©s"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Carte"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-2)",fontSize:"1.2rem"},children:d||"Aucune"})]})]}),e.jsx("div",{className:"lycans-graphique-section",style:{flex:"1 1 100%",minWidth:"100%"},children:i.length>0?e.jsx(q,{title:k==="deaths"?`Carte des Morts de ${a}`:`Carte des Kills de ${a}`,children:e.jsx("div",{style:{width:"100%",margin:"0 auto",aspectRatio:"1640 / 922"},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(He,{margin:{top:20,right:30,left:60,bottom:60},children:[n&&e.jsx(Ke,{x1:n.zMin,x2:n.zMax,y1:n.xMin,y2:n.xMax,fill:"transparent",stroke:"none",shape:j=>{const{x:R,y:t,width:S,height:P}=j;return e.jsx("image",{x:R,y:t,width:S,height:P,href:n.src,preserveAspectRatio:"xMidYMid slice",style:{opacity:.85}})}}),e.jsx(B,{strokeDasharray:"3 3",stroke:n?"rgba(255,255,255,0.3)":"var(--border-color)"}),e.jsx(_,{dataKey:"z",type:"number",name:"Position Z",domain:N,hide:!0}),e.jsx(O,{dataKey:"x",type:"number",name:"Position X",domain:y,hide:!0}),e.jsx(G,{content:e.jsx(I,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(Ue,{data:v,onClick:j=>$(j),style:{cursor:"pointer"},isAnimationActive:!1,children:v.map((j,R)=>{const t=Math.min(Math.log2(j.count+1)*3+5,18),S=Math.round(t);return e.jsx(H,{fill:F(j.deathType),stroke:j.count>1?"white":"rgba(255,255,255,0.5)",strokeWidth:j.count>1?2:1,opacity:.85,r:S},`cell-${R}`)})})]})})})}):e.jsxs("div",{className:"donnees-manquantes",style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"0.5rem"},children:k==="deaths"?`Aucune mort localisÃ©e pour ${a} sur cette carte.`:`Aucun kill localisÃ© pour ${a} sur cette carte.`}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Les donnÃ©es de position ne sont disponibles que pour les parties rÃ©centes."})]})}),e.jsxs("div",{className:"lycans-section-description",style:{flex:"1 1 100%",marginTop:"1.5rem"},children:[e.jsx("h4",{children:"Ã€ propos de cette carte"}),e.jsxs("p",{children:["Cette carte affiche ",k==="deaths"?`les emplacements oÃ¹ ${a} est mort`:`les emplacements oÃ¹ ${a} a Ã©liminÃ© d'autres joueurs`," au cours des parties. Les couleurs indiquent le type de mort. Cliquez sur un point pour voir les dÃ©tails de la partie."]}),e.jsxs("p",{style:{marginTop:"0.5rem"},children:["Les points regroupÃ©s ont une petite bordure blanche.",e.jsx("br",{}),e.jsx("strong",{children:"ðŸ’€ Morts:"})," OÃ¹ le joueur a Ã©tÃ© Ã©liminÃ©",e.jsx("br",{}),e.jsx("strong",{children:"âš”ï¸ Kills:"})," OÃ¹ le joueur a Ã©liminÃ© d'autres joueurs"]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e disponible"})}function Pe(a){return a.PlayerStats.some(l=>l.SecondsTalkedOutsideMeeting>0||l.SecondsTalkedDuringMeeting>0)}function pe(a,l){const b=l.DeathDateIrl||a.EndDate,p=ge(a.StartDate,b);return p&&p>0?p:0}function ut(a){const l=a.filter(Pe),b=new Map;return l.forEach(p=>{p.PlayerStats.forEach(u=>{const m=X(u),k=oe(u),x=pe(p,u);if(x<=0)return;b.has(m)||b.set(m,{displayName:k,gamesPlayed:0,totalSecondsAll:0,totalGameDuration:0});const d=b.get(m);d.gamesPlayed++,d.totalSecondsAll+=(u.SecondsTalkedOutsideMeeting||0)+(u.SecondsTalkedDuringMeeting||0),d.totalGameDuration+=x})}),{playerStats:b,gamesWithTalkingData:l.length}}function pt(a,l){if(!l||l.length===0||!a)return null;const b=ut(l),p=l.filter(Pe);if(p.length===0||b.playerStats.size===0)return null;let u=null;for(const[A,w]of b.playerStats)if(w.displayName===a){u=A;break}if(!u)return null;let m=0,k=0,x=0,d=0;const h={Villageois:{gamesPlayed:0,secondsOutside:0,secondsDuring:0,gameDuration:0},Loup:{gamesPlayed:0,secondsOutside:0,secondsDuring:0,gameDuration:0},Autres:{gamesPlayed:0,secondsOutside:0,secondsDuring:0,gameDuration:0}},c=new Map;let r=0,o=0,s=0,i=0;if(p.forEach(A=>{const w=A.PlayerStats.find(Y=>X(Y)===u);if(!w)return;const E=pe(A,w);if(E<=0)return;m++;const L=w.SecondsTalkedOutsideMeeting||0,z=w.SecondsTalkedDuringMeeting||0,re=L+z;k+=L,x+=z,d+=E;const f=Ie(w.MainRoleInitial,w.Power);h[f].gamesPlayed++,h[f].secondsOutside+=L,h[f].secondsDuring+=z,h[f].gameDuration+=E;const M=qe(w);c.has(M)||c.set(M,{gamesPlayed:0,totalSecondsAll:0,totalGameDuration:0});const U=c.get(M);U.gamesPlayed++,U.totalSecondsAll+=re,U.totalGameDuration+=E}),m===0||d<=0)return null;const v=3600/d,n=k*v,y=x*v,N=(k+x)*v,F=k+x>0?x/(k+x)*100:0,I=[];for(const[A,w]of Object.entries(h)){if(w.gamesPlayed===0)continue;const E=w.gameDuration>0?3600/w.gameDuration:0,L=w.secondsOutside+w.secondsDuring;I.push({camp:A,gamesPlayed:w.gamesPlayed,totalSecondsOutside:w.secondsOutside,totalSecondsDuring:w.secondsDuring,totalSecondsAll:L,totalGameDurationSeconds:w.gameDuration,secondsOutsidePer60Min:w.secondsOutside*E,secondsDuringPer60Min:w.secondsDuring*E,secondsAllPer60Min:L*E,meetingRatio:L>0?w.secondsDuring/L*100:0})}I.sort((A,w)=>w.gamesPlayed-A.gamesPlayed);const $=Array.from(c.entries()).filter(([A,w])=>w.gamesPlayed>=1).map(([A,w])=>({role:A,gamesPlayed:w.gamesPlayed,secondsAllPer60Min:w.totalGameDuration>0?w.totalSecondsAll/w.totalGameDuration*3600:0,totalSecondsAll:w.totalSecondsAll})).sort((A,w)=>w.secondsAllPer60Min-A.secondsAllPer60Min),j=[];for(const[A,w]of b.playerStats)w.totalGameDuration>0&&j.push({id:A,name:w.displayName,per60:w.totalSecondsAll/w.totalGameDuration*3600});j.sort((A,w)=>w.per60-A.per60);const R=j.reduce((A,w)=>A+w.per60,0),t=j.length>0?R/j.length:0,S=j.findIndex(A=>A.id===u)+1,P=j.length,g=P>0?Math.round((1-(S-1)/P)*100):0,C=N;p.forEach(A=>{const w=A.PlayerStats.find(re=>X(re)===u);if(!w)return;const E=pe(A,w);if(E<=0)return;((w.SecondsTalkedOutsideMeeting||0)+(w.SecondsTalkedDuringMeeting||0))/E*3600>=C?(r++,w.Victorious&&o++):(s++,w.Victorious&&i++)});const T={gamesAboveAverage:r,winsAboveAverage:o,winRateAboveAverage:r>0?o/r*100:0,gamesBelowAverage:s,winsBelowAverage:i,winRateBelowAverage:s>0?i/s*100:0};return{playerName:a,gamesPlayed:m,gamesWithTalkingData:b.gamesWithTalkingData,totalSecondsOutside:k,totalSecondsDuring:x,totalSecondsAll:k+x,totalGameDurationSeconds:d,secondsOutsidePer60Min:n,secondsDuringPer60Min:y,secondsAllPer60Min:N,meetingRatio:F,campBreakdown:I,globalAverageSecondsAllPer60Min:t,playerRank:S,totalPlayersWithData:P,percentile:g,roleBreakdown:$,winCorrelation:T}}function mt(a,l){return a?a.roleBreakdown.slice(0,l):[]}function ht(a){const{data:l,isLoading:b,error:p}=he(u=>a?pt(a,u):null);return{data:l,isLoading:b,error:p}}const gt={Villageois:"var(--camp-villageois)",Loup:"var(--camp-loup)",Autres:"var(--camp-autres)"},xt={Villageois:"#4CAF50",Loup:"#F44336",Autres:"#9C27B0"};function ft({selectedPlayerName:a}){const{data:l,isLoading:b,error:p}=ht(a),u=ne(),m=D.useMemo(()=>l?.campBreakdown?l.campBreakdown.map(s=>({camp:s.camp,"Hors rÃ©union":Math.round(s.secondsOutsidePer60Min),"En rÃ©union":Math.round(s.secondsDuringPer60Min),total:Math.round(s.secondsAllPer60Min),gamesPlayed:s.gamesPlayed,meetingRatio:s.meetingRatio.toFixed(1)})):[],[l]),k=D.useMemo(()=>l?[{name:"En rÃ©union",value:l.totalSecondsDuring,color:"#2196F3"},{name:"Hors rÃ©union",value:l.totalSecondsOutside,color:"#FF9800"}]:[],[l]),x=s=>{const i=s;return u[s]||gt[i]||xt[i]||"#888888"},d=s=>{const i={Chasseur:u.Chasseur||"#FF5722",Alchimiste:u.Alchimiste||"#9C27B0",Protecteur:u.Protecteur||"#4CAF50",Disciple:u.Disciple||"#2196F3","Aucun pouvoir":u.Villageois||"#8BC34A",Villageois:u.Villageois||"#4CAF50",Loup:u.Loup||"#F44336","Idiot du Village":u["Idiot du Village"]||"#FFC107",TraÃ®tre:u.TraÃ®tre||"#E91E63",Louveteau:u.Louveteau||"#FF5722"};return s in u?u[s]||i[s]||u.Villageois||"#4CAF50":i[s]||u.Villageois||"#4CAF50"};if(b)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de temps de parole..."});if(p)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",p]});if(!l)return e.jsxs("div",{className:"donnees-manquantes",children:[e.jsx("p",{children:"Aucune donnÃ©e de temps de parole disponible pour ce joueur."}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Les donnÃ©es de temps de parole ne sont disponibles que pour les parties rÃ©centes."})]});const h=l.secondsAllPer60Min-l.globalAverageSecondsAllPer60Min,c=l.globalAverageSecondsAllPer60Min>0?(h/l.globalAverageSecondsAllPer60Min*100).toFixed(0):"0",r=h>0,o=l.winCorrelation.winRateAboveAverage-l.winCorrelation.winRateBelowAverage;return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"ðŸŽ¤ Temps de parole / 60min"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:ie(l.secondsAllPer60Min)}),e.jsxs("p",{style:{fontSize:"0.8rem",color:r?"var(--success-color, #4CAF50)":"var(--warning-color, #FF9800)"},children:[r?"+":"",c,"% vs moyenne"]})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"ðŸ“Š Classement"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:["#",l.playerRank," / ",l.totalPlayersWithData]}),e.jsxs("p",{children:["Top ",100-l.percentile+1,"% ",l.percentile>=50?"bavard":"discret"]})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"ðŸ“ˆ Parties analysÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:l.gamesPlayed}),e.jsxs("p",{children:["sur ",l.gamesWithTalkingData," avec donnÃ©es"]})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"ðŸ—£ï¸ Ratio en rÃ©union"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:[l.meetingRatio.toFixed(1),"%"]}),e.jsx("p",{children:"du temps de parole"})]})]}),m.length>0&&e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx(q,{title:"Temps de parole par camp (par 60min de jeu)",children:e.jsx("div",{style:{height:350},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:m,layout:"vertical",children:[e.jsx(B,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(_,{type:"number",tick:{fill:"var(--text-secondary)"},tickFormatter:s=>`${Math.floor(s/60)}m`}),e.jsx(O,{type:"category",dataKey:"camp",tick:{fill:"var(--text-primary)"},width:100}),e.jsx(G,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:(s,i)=>[ie(s),i],labelFormatter:s=>{const i=m.find(v=>v.camp===s);return`${s} (${i?.gamesPlayed||0} parties)`}}),e.jsx(Ye,{}),e.jsx(K,{dataKey:"Hors rÃ©union",stackId:"talk",fill:"#FF9800"}),e.jsx(K,{dataKey:"En rÃ©union",stackId:"talk",fill:"#2196F3"})]})})})}),e.jsx("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"8px",fontSize:"0.9rem"},children:m.length>=2&&(()=>{const s=[...m].sort((y,N)=>N.total-y.total),i=s[0],v=s[s.length-1],n=i.total-v.total;return e.jsxs("p",{children:["ðŸ’¡ ",e.jsx("strong",{children:a})," parle"," ",e.jsxs("strong",{style:{color:x(i.camp)},children:[ie(n)," de plus"]})," ","en tant que ",e.jsx("strong",{children:i.camp})," qu'en tant que"," ",e.jsx("strong",{children:v.camp})," (par heure de jeu)."]})})()})]}),e.jsx("div",{className:"lycans-graphique-section",children:e.jsx(q,{title:"RÃ©partition du temps de parole",children:e.jsx("div",{style:{height:300},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Ae,{children:[e.jsx(Te,{data:k,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,dataKey:"value",label:s=>`${s.name}: ${((s.percent||0)*100).toFixed(1)}%`,children:k.map((s,i)=>e.jsx(H,{fill:s.color},`cell-${i}`))}),e.jsx(G,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:s=>ie(s)})]})})})})}),l&&l.roleBreakdown.length>0&&e.jsx("div",{className:"lycans-graphique-section",children:e.jsx(q,{title:s=>s?"Top 15 rÃ´les les plus bavards (par 60min)":"Top 5 rÃ´les les plus bavards (par 60min)",children:s=>{const v=mt(l,s?15:5).map(n=>({role:n.role,secondsPer60Min:Math.round(n.secondsAllPer60Min),gamesPlayed:n.gamesPlayed}));return e.jsx("div",{style:{height:s?400:300},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Z,{data:v,children:[e.jsx(B,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(_,{dataKey:"role",tick:{fill:"var(--text-primary)",fontSize:12},interval:0,angle:-20,textAnchor:"end",height:60}),e.jsx(O,{tick:{fill:"var(--text-secondary)"},tickFormatter:n=>`${Math.floor(n/60)}m`}),e.jsx(G,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px"},formatter:n=>[ie(n),"Temps de parole"],labelFormatter:n=>{const y=v.find(N=>N.role===n);return`${n} (${y?.gamesPlayed||0} parties)`}}),e.jsx(K,{dataKey:"secondsPer60Min",fill:"var(--accent-primary, #8884d8)",children:v.map((n,y)=>e.jsx(H,{fill:d(n.role)},`cell-${y}`))})]})})})}})}),(l.winCorrelation.gamesAboveAverage>0||l.winCorrelation.gamesBelowAverage>0)&&e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"ðŸŽ¯ CorrÃ©lation avec les victoires"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"8px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Quand parle + que sa moyenne"}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--text-primary)"},children:[l.winCorrelation.winRateAboveAverage.toFixed(1),"%"]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:["de victoires (",l.winCorrelation.winsAboveAverage,"/",l.winCorrelation.gamesAboveAverage," parties)"]})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"8px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Quand parle - que sa moyenne"}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--text-primary)"},children:[l.winCorrelation.winRateBelowAverage.toFixed(1),"%"]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:["de victoires (",l.winCorrelation.winsBelowAverage,"/",l.winCorrelation.gamesBelowAverage," parties)"]})]})]}),Math.abs(o)>5&&e.jsx("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"8px",fontSize:"0.9rem"},children:e.jsxs("p",{children:["ðŸ’¡ ",e.jsx("strong",{children:a})," a un taux de victoire"," ",e.jsxs("strong",{style:{color:o>0?"var(--success-color, #4CAF50)":"var(--warning-color, #FF9800)"},children:[o>0?"supÃ©rieur":"infÃ©rieur"," de ",Math.abs(o).toFixed(1),"%"]})," ","quand il/elle parle plus que sa moyenne."]})})]})]})}const te={BAVARD:{id:"BAVARD",name:"Bavard",emoji:"ðŸ—£ï¸",color:"#4A90E2",description:"Parle beaucoup en jeu"},TUEUR:{id:"TUEUR",name:"Tueur",emoji:"ðŸ”ª",color:"#E74C3C",description:"Taux de kill Ã©levÃ©"},SURVIVANT:{id:"SURVIVANT",name:"Survivant",emoji:"ðŸ›¡ï¸",color:"#2ECC71",description:"Excellent taux de survie"},STRATEGE:{id:"STRATEGE",name:"StratÃ¨ge",emoji:"ðŸŽ¯",color:"#9B59B6",description:"Vote avec prÃ©cision"},VETERAN:{id:"VETERAN",name:"VÃ©tÃ©ran",emoji:"â­",color:"#F39C12",description:"Nombreuses parties jouÃ©es"},SILENCIEUX:{id:"SILENCIEUX",name:"Silencieux",emoji:"ðŸ¤",color:"#95A5A6",description:"Parle trÃ¨s peu"}},ee={MIN_GAMES_FOR_TITLES:10,BAVARD_SECONDS_PER_60MIN:1200,SILENCIEUX_SECONDS_PER_60MIN:300,TUEUR_KILLS_PER_GAME:.8,SURVIVANT_SURVIVAL_RATE:.7,STRATEGE_VOTE_ACCURACY:.6,STRATEGE_MIN_VOTES:20,VETERAN_GAMES:100};function yt(a){return a.PlayerStats.some(l=>l.SecondsTalkedOutsideMeeting>0||l.SecondsTalkedDuringMeeting>0)}function Se(a){return["Loup","Louveteau","TraÃ®tre","Infect","Loup Blanc"].includes(a)?"Loups":["Amoureux","Idiot du Village","Agent","Ange"].includes(a)?a:"Villageois"}function vt(a){const l=new Map,b=a.filter(yt);return a.forEach(p=>{p.PlayerStats.forEach(u=>{const m=X(u),k=oe(u);l.has(m)||l.set(m,{playerId:m,displayName:k,gamesPlayed:0,totalTalkingSeconds:0,totalGameDurationSeconds:0,talkingSecondsPer60Min:0,totalKills:0,killsPerGame:0,totalDeaths:0,survivalRate:0,totalVotes:0,accurateVotes:0,voteAccuracy:0});const x=l.get(m);if(x.gamesPlayed++,u.DeathType&&x.totalDeaths++,u.KillerName===k||u.DeathType&&["BY_WOLF","BY_ZOMBIE","BY_BEAST"].includes(u.DeathType),u.Votes&&u.Votes.length>0){const d=Se(u.MainRoleInitial);u.Votes.forEach(h=>{x.totalVotes++;const c=p.PlayerStats.find(r=>oe(r)===h.Target);if(c){const r=Se(c.MainRoleInitial);(d==="Villageois"&&r==="Loups"||d==="Loups"&&r==="Villageois")&&x.accurateVotes++}})}})}),b.forEach(p=>{p.PlayerStats.forEach(u=>{const m=X(u),k=l.get(m);if(!k)return;const x=u.DeathDateIrl||p.EndDate,d=ge(p.StartDate,x);d&&d>0&&(k.totalTalkingSeconds+=(u.SecondsTalkedOutsideMeeting||0)+(u.SecondsTalkedDuringMeeting||0),k.totalGameDurationSeconds+=d)})}),a.forEach(p=>{p.PlayerStats.forEach(u=>{if(u.KillerName){const m=p.PlayerStats.find(k=>oe(k)===u.KillerName);if(m){const k=X(m),x=l.get(k);x&&x.totalKills++}}})}),l.forEach(p=>{p.totalGameDurationSeconds>0&&(p.talkingSecondsPer60Min=p.totalTalkingSeconds/p.totalGameDurationSeconds*3600),p.gamesPlayed>0&&(p.killsPerGame=p.totalKills/p.gamesPlayed),p.gamesPlayed>0&&(p.survivalRate=(p.gamesPlayed-p.totalDeaths)/p.gamesPlayed),p.totalVotes>0&&(p.voteAccuracy=p.accurateVotes/p.totalVotes)}),l}function jt(a){const l=[];return a.gamesPlayed<ee.MIN_GAMES_FOR_TITLES||(a.totalGameDurationSeconds>0&&a.talkingSecondsPer60Min>=ee.BAVARD_SECONDS_PER_60MIN&&l.push(te.BAVARD),a.totalGameDurationSeconds>0&&a.talkingSecondsPer60Min>0&&a.talkingSecondsPer60Min<=ee.SILENCIEUX_SECONDS_PER_60MIN&&!l.includes(te.BAVARD)&&l.push(te.SILENCIEUX),a.killsPerGame>=ee.TUEUR_KILLS_PER_GAME&&l.push(te.TUEUR),a.survivalRate>=ee.SURVIVANT_SURVIVAL_RATE&&l.push(te.SURVIVANT),a.totalVotes>=ee.STRATEGE_MIN_VOTES&&a.voteAccuracy>=ee.STRATEGE_VOTE_ACCURACY&&l.push(te.STRATEGE),a.gamesPlayed>=ee.VETERAN_GAMES&&l.push(te.VETERAN)),l}function bt(a){const l=vt(a),b=new Map;return l.forEach((p,u)=>{const m=jt(p);b.set(u,m)}),b}function Kt(){const{settings:a,updateSettings:l}=me(),{navigateToGameDetails:b,navigationState:p,updateNavigationState:u}=ae(),{data:m,isLoading:k,error:x}=Fe(),{joueursData:d,isLoading:h}=de(),{data:c,isLoading:r,error:o}=et(a.highlightedPlayer),s=xe(d),[i,v]=D.useState(""),[n,y]=D.useState(null),{clips:N}=Xe(a.highlightedPlayer),{clips:F}=Je(),[I,$]=D.useState(()=>a.useIndependentFilters&&a.independentFilters?.gameTypeEnabled?a.independentFilters.gameFilter==="modded"?"modded":"all":a.gameFilter==="modded"?"modded":"all"),j=D.useMemo(()=>a.useIndependentFilters&&a.independentFilters?.gameTypeEnabled?a.independentFilters.gameFilter==="modded":a.gameFilter==="modded",[a.useIndependentFilters,a.independentFilters?.gameTypeEnabled,a.independentFilters?.gameFilter,a.gameFilter]),[R,t]=D.useState(p.selectedPlayerSelectionView||"achievements"),[S,P]=D.useState("session"),[g,C]=D.useState("all");D.useEffect(()=>{if(a.useIndependentFilters&&a.independentFilters?.gameTypeEnabled){const f=a.independentFilters.gameFilter==="modded"?"modded":"all";$(f)}else if(!a.useIndependentFilters){const f=a.gameFilter==="modded"?"modded":"all";$(f)}},[a.gameFilter,a.useIndependentFilters,a.independentFilters?.gameTypeEnabled,a.independentFilters?.gameFilter]),D.useEffect(()=>{j&&I!=="modded"&&$("modded")},[j,I]),D.useEffect(()=>{p.selectedPlayerSelectionView&&t(p.selectedPlayerSelectionView)},[p.selectedPlayerSelectionView]);const{data:T}=ue(a.highlightedPlayer||""),A=D.useMemo(()=>{if(!m||!m.GameStats)return[];const f=j?m.GameStats.filter(Y=>Y.Modded===!0):m.GameStats,M=bt(f),U=new Map;return f.forEach(Y=>{const V=new Date(Y.StartDate);Y.PlayerStats.forEach(J=>{const Q=X(J),Ne=d?.Players?.find(De=>De.SteamID===Q)?.Joueur||J.Username;U.has(Q)||U.set(Q,{games:0,wins:0,firstDate:V,lastDate:V,displayName:Ne});const se=U.get(Q);se.games++,J.Victorious&&se.wins++,V<se.firstDate&&(se.firstDate=V),V>se.lastDate&&(se.lastDate=V)})}),Array.from(U.entries()).map(([Y,V])=>{let J=d?.Players?.find(Q=>Q.SteamID===Y);return J||(J=d?.Players?.find(Q=>Q.Joueur===V.displayName)),{id:Y,name:V.displayName,totalGames:V.games,totalWins:V.wins,winRate:V.games>0?V.wins/V.games*100:0,firstGameDate:V.firstDate.toLocaleDateString("fr-FR"),lastGameDate:V.lastDate.toLocaleDateString("fr-FR"),isHighlighted:V.displayName===a.highlightedPlayer,image:J?.Image||null,twitch:J?.Twitch||null,youtube:J?.Youtube||null,titles:M.get(Y)||[]}})},[m,a.highlightedPlayer,d,j]),w=D.useMemo(()=>{if(!i.trim())return A;const f=i.toLowerCase();return A.filter(M=>M.name.toLowerCase().includes(f))},[A,i]),E=D.useMemo(()=>[...w].sort((f,M)=>M.totalGames-f.totalGames),[w]),L=f=>{l({highlightedPlayer:f}),v("")},z=f=>{t(f),u({selectedPlayerSelectionView:f})},re=()=>{if(N.length===0)return;const f=Math.floor(Math.random()*N.length);y(N[f])};return k||h?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):x?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",x]})]}):!m||A.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!a.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:i,onChange:f=>v(f.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[w.length," joueur",w.length!==1?"s":"",i&&` (filtrÃ©${w.length!==1?"s":""} de ${A.length})`]})]})]}),e.jsx("div",{className:"player-display",children:i?w.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{type:"button",className:"clear-search-btn",onClick:()=>v(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:E.map(f=>e.jsxs("button",{type:"button",className:`suggestion-btn ${f.isHighlighted?"highlighted":""}`,onClick:()=>L(f.name),children:[f.image?e.jsx("img",{src:f.image,alt:`Photo de profil de ${f.name}`,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":s[f.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[f.name,f.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),f.titles&&f.titles.length>0&&e.jsxs("div",{className:"player-titles-compact",children:[f.titles.slice(0,2).map(M=>e.jsxs("span",{className:"player-title-badge-compact",style:{backgroundColor:M.color},title:M.description,children:[M.emoji," ",M.name]},M.id)),f.titles.length>2&&e.jsxs("span",{className:"player-title-more",children:["+",f.titles.length-2]})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[f.totalGames," parties â€¢ ",f.winRate.toFixed(1),"% victoires"]})]})]},f.id))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',i,'"']}),e.jsx("button",{type:"button",className:"clear-search-btn",onClick:()=>v(""),children:"Effacer la recherche"})]}):a.highlightedPlayer?(()=>{const f=A.find(M=>M.name===a.highlightedPlayer);return f?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:f.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),f.titles&&f.titles.length>0&&e.jsx("div",{className:"player-titles",children:f.titles.map(M=>e.jsxs("span",{className:"player-title-badge",style:{backgroundColor:M.color},title:M.description,children:[M.emoji," ",M.name]},M.id))}),e.jsxs("div",{className:"player-info-row",children:[f.image?e.jsx("img",{src:f.image,alt:`Photo de profil de ${f.name}`,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":s[f.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[f.totalGames," parties â€¢ ",f.totalWins," victoires â€¢ ",f.winRate.toFixed(1),"% taux de victoire"]}),(f.twitch||f.youtube||N.length>0)&&e.jsxs("div",{className:"social-links",children:[f.twitch&&e.jsx("a",{href:f.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),f.youtube&&e.jsx("a",{href:f.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"}),N.length>0&&e.jsxs("button",{type:"button",className:"social-link clips-btn",onClick:M=>{M.stopPropagation(),re()},title:`${N.length} clip${N.length>1?"s":""} disponible${N.length>1?"s":""}`,children:["ðŸŽ¬ Clip alÃ©atoire (",N.length,")"]})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="achievements"?"active":""}`,onClick:()=>z("achievements"),children:"Classement"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="evolution"?"active":""}`,onClick:()=>z("evolution"),children:"Ã‰volution"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="camps"?"active":""}`,onClick:()=>z("camps"),children:"Camps"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="roles"?"active":""}`,onClick:()=>z("roles"),children:"RÃ´les"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="maps"?"active":""}`,onClick:()=>z("maps"),children:"Maps"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="kills"?"active":""}`,onClick:()=>z("kills"),children:"Kills"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="deathmap"?"active":""}`,onClick:()=>z("deathmap"),children:"Carte"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${R==="talkingtime"?"active":""}`,onClick:()=>z("talkingtime"),children:"Parole"})]}),R==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[r?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):o?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",o]})}):c?e.jsx(st,{achievements:I==="all"?c.allGamesAchievements:c.moddedOnlyAchievements,title:I==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:I}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[!j&&e.jsx("button",{type:"button",className:`filter-btn ${I==="all"?"active":""}`,onClick:M=>{M.stopPropagation(),$("all")},children:"Toutes les parties"}),e.jsx("button",{type:"button",className:`filter-btn ${I==="modded"?"active":""}`,onClick:M=>{M.stopPropagation(),$("modded")},disabled:j,children:"Parties moddÃ©es"})]})]}),R==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[T&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{b({selectedPlayer:f.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${f.name}`,style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:T.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Temps de jeu cumulÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:$e(T.totalPlayTime)}),e.jsx("p",{children:"temps total de jeu"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{b({selectedPlayer:f.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${f.name}`,style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:T.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem",color:"var(--accent-primary-text)"},children:[T.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:S,onChange:M=>P(M.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-filter-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsxs("select",{id:"camp-filter-select",value:g,onChange:M=>C(M.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"all",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loups"}),e.jsx("option",{value:"solo",children:"RÃ´les solo"})]})]})]}),e.jsx(rt,{selectedPlayerName:f.name,groupingMethod:S,campFilter:g})]}),R==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(it,{selectedPlayerName:f.name})}),R==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(nt,{selectedPlayerName:f.name})}),R==="roles"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ct,{selectedPlayerName:f.name})}),R==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ot,{selectedPlayerName:f.name})}),R==="deathmap"&&e.jsx("div",{className:"player-history-section",children:e.jsx(dt,{selectedPlayerName:f.name})}),R==="talkingtime"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ft,{selectedPlayerName:f.name})}),e.jsx("button",{type:"button",className:"highlight-btn active",onClick:M=>{M.stopPropagation(),l({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[f.firstGameDate," - ",f.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',a.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{type:"button",className:"clear-selection-btn",onClick:()=>l({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:E.map(f=>e.jsxs("div",{className:`character-card ${f.isHighlighted?"highlighted":""}`,onClick:()=>L(f.name),title:`${f.name} - ${f.totalGames} parties, ${f.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:f.image?e.jsx("img",{src:f.image,alt:`Photo de profil de ${f.name}`,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":s[f.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:f.name}),(f.twitch||f.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[f.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),f.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},f.id))})})}),n&&e.jsx(Ze,{clip:n,onClose:()=>y(null),relatedClips:Qe(n,F),nextClip:be(n,F),onNextClip:()=>{const f=be(n,F);f&&y(f)},onRelatedClip:f=>{const M=F.find(U=>U.ClipId===f);M&&y(M)}})]})}export{Kt as PlayerSelectionPage};
