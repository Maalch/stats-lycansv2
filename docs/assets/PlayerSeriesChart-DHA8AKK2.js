import{g as J,f as A,u as $,a as q,r as T,j as s}from"./index-LHyT3wYR.js";import{u as B}from"./baseStatsHook-D4wyJGym.js";import{a as H,b as U}from"./datasyncExport-CjB7UYqV.js";import{u as K}from"./useJoueursData-4LBfcudT.js";import{u as X}from"./api-D2Wwm1WI.js";import{F as Y,C as _,X as Q,Y as Z,a as ee}from"./FullscreenChart-DdlWv0Rh.js";import{R as se,T as re}from"./CategoricalChart-BTqevqmd.js";import{B as ie,a as ne}from"./BarChart-yZeU4Y6u.js";function oe(e){const t=new Map;return e.forEach(d=>{d.PlayerStats.forEach(c=>{const a=J(c),m=c.Username;t.set(a,m)})}),t}function le(e){const t={};return e.forEach((d,c)=>{t[c]={currentVillageoisSeries:0,currentLoupsSeries:0,currentNoWolfSeries:0,currentSoloSeries:0,longestVillageoisSeries:null,longestLoupsSeries:null,longestNoWolfSeries:null,longestSoloSeries:null,currentWinSeries:0,longestWinSeries:null,currentWinCamps:[],currentLossSeries:0,longestLossSeries:null,currentLossCamps:[],currentNoWolfCamps:[],currentSoloCamps:[],lastCamp:null,lastWon:!1,villageoisSeriesStart:null,loupsSeriesStart:null,noWolfSeriesStart:null,soloSeriesStart:null,winSeriesStart:null,lossSeriesStart:null,currentVillageoisGameIds:[],currentLoupsGameIds:[],currentNoWolfGameIds:[],currentSoloGameIds:[],currentWinGameIds:[],currentLossGameIds:[]}}),t}function te(e,t,d,c,a){if(d==="Villageois"||d==="Loup"?(d==="Villageois"&&(e.lastCamp==="Villageois"?(e.currentVillageoisSeries++,e.currentVillageoisGameIds.push(c)):(e.currentVillageoisSeries=1,e.villageoisSeriesStart={game:c,date:a},e.currentVillageoisGameIds=[c]),(!e.longestVillageoisSeries||e.currentVillageoisSeries>=e.longestVillageoisSeries.seriesLength)&&(e.longestVillageoisSeries={player:t,camp:"Villageois",seriesLength:e.currentVillageoisSeries,startGame:e.villageoisSeriesStart?.game||c,endGame:c,startDate:e.villageoisSeriesStart?.date||a,endDate:a,isOngoing:!1,gameIds:[...e.currentVillageoisGameIds]}),e.currentLoupsSeries=0,e.loupsSeriesStart=null,e.currentLoupsGameIds=[]),d==="Loup"&&(e.lastCamp==="Loup"?(e.currentLoupsSeries++,e.currentLoupsGameIds.push(c)):(e.currentLoupsSeries=1,e.loupsSeriesStart={game:c,date:a},e.currentLoupsGameIds=[c]),(!e.longestLoupsSeries||e.currentLoupsSeries>=e.longestLoupsSeries.seriesLength)&&(e.longestLoupsSeries={player:t,camp:"Loups",seriesLength:e.currentLoupsSeries,startGame:e.loupsSeriesStart?.game||c,endGame:c,startDate:e.loupsSeriesStart?.date||a,endDate:a,isOngoing:!1,gameIds:[...e.currentLoupsGameIds]}),e.currentVillageoisSeries=0,e.villageoisSeriesStart=null,e.currentVillageoisGameIds=[],e.currentNoWolfSeries=0,e.noWolfSeriesStart=null,e.currentNoWolfGameIds=[],e.currentNoWolfCamps=[]),e.lastCamp=d):(e.currentVillageoisSeries=0,e.currentLoupsSeries=0,e.villageoisSeriesStart=null,e.loupsSeriesStart=null,e.currentVillageoisGameIds=[],e.currentLoupsGameIds=[],e.lastCamp="Autres"),d!=="Loup"){e.currentNoWolfSeries>0?(e.currentNoWolfSeries++,e.currentNoWolfGameIds.push(c),e.currentNoWolfCamps.push(d)):(e.currentNoWolfSeries=1,e.noWolfSeriesStart={game:c,date:a},e.currentNoWolfGameIds=[c],e.currentNoWolfCamps=[d]);const m={};e.currentNoWolfCamps.forEach(g=>{m[g]=(m[g]||0)+1}),(!e.longestNoWolfSeries||e.currentNoWolfSeries>=e.longestNoWolfSeries.seriesLength)&&(e.longestNoWolfSeries={player:t,camp:"Sans Loups",seriesLength:e.currentNoWolfSeries,startGame:e.noWolfSeriesStart?.game||c,endGame:c,startDate:e.noWolfSeriesStart?.date||a,endDate:a,campCounts:m,isOngoing:!1,gameIds:[...e.currentNoWolfGameIds]})}}function ce(e,t,d,c,a,m){if(d==="Autres"){e.currentSoloSeries>0?(e.currentSoloSeries++,e.currentSoloGameIds.push(a),e.currentSoloCamps.push(c)):(e.currentSoloSeries=1,e.soloSeriesStart={game:a,date:m},e.currentSoloGameIds=[a],e.currentSoloCamps=[c]);const g={};e.currentSoloCamps.forEach(r=>{g[r]=(g[r]||0)+1}),(!e.longestSoloSeries||e.currentSoloSeries>=e.longestSoloSeries.seriesLength)&&(e.longestSoloSeries={player:t,camp:"R√¥les Solos",seriesLength:e.currentSoloSeries,startGame:e.soloSeriesStart?.game||a,endGame:a,startDate:e.soloSeriesStart?.date||m,endDate:m,campCounts:g,isOngoing:!1,gameIds:[...e.currentSoloGameIds]})}else e.currentSoloSeries=0,e.soloSeriesStart=null,e.currentSoloGameIds=[],e.currentSoloCamps=[]}function ae(e,t,d,c,a,m){if(d){if(e.lastWon?(e.currentWinSeries++,e.currentWinCamps.push(c),e.currentWinGameIds.push(a)):(e.currentWinSeries=1,e.currentWinCamps=[c],e.winSeriesStart={game:a,date:m},e.currentWinGameIds=[a]),!e.longestWinSeries||e.currentWinSeries>=e.longestWinSeries.seriesLength){const g={};e.currentWinCamps.forEach(r=>{g[r]=(g[r]||0)+1}),e.longestWinSeries={player:t,seriesLength:e.currentWinSeries,startGame:e.winSeriesStart?.game||a,endGame:a,startDate:e.winSeriesStart?.date||m,endDate:m,campCounts:g,isOngoing:!1,gameIds:[...e.currentWinGameIds]}}e.lastWon=!0}else e.currentWinSeries=0,e.currentWinCamps=[],e.winSeriesStart=null,e.currentWinGameIds=[],e.lastWon=!1}function ue(e,t,d,c,a,m){if(d)e.currentLossSeries=0,e.currentLossCamps=[],e.lossSeriesStart=null,e.currentLossGameIds=[];else if(e.currentLossSeries>0?(e.currentLossSeries++,e.currentLossCamps.push(c),e.currentLossGameIds.push(a)):(e.currentLossSeries=1,e.currentLossCamps=[c],e.lossSeriesStart={game:a,date:m},e.currentLossGameIds=[a]),!e.longestLossSeries||e.currentLossSeries>=e.longestLossSeries.seriesLength){const g={};e.currentLossCamps.forEach(r=>{g[r]=(g[r]||0)+1}),e.longestLossSeries={player:t,seriesLength:e.currentLossSeries,startGame:e.lossSeriesStart?.game||a,endGame:a,startDate:e.lossSeriesStart?.date||m,endDate:m,campCounts:g,isOngoing:!1,gameIds:[...e.currentLossGameIds]}}}function ge(e){const t=[],d=[],c=[],a=[],m=[],g=[];return Object.values(e).forEach(r=>{r.longestVillageoisSeries&&t.push(r.longestVillageoisSeries),r.longestLoupsSeries&&d.push(r.longestLoupsSeries),r.longestNoWolfSeries&&c.push(r.longestNoWolfSeries),r.longestSoloSeries&&a.push(r.longestSoloSeries),r.longestWinSeries&&m.push(r.longestWinSeries),r.longestLossSeries&&g.push(r.longestLossSeries)}),t.sort((r,x)=>x.seriesLength-r.seriesLength),d.sort((r,x)=>x.seriesLength-r.seriesLength),c.sort((r,x)=>x.seriesLength-r.seriesLength),a.sort((r,x)=>x.seriesLength-r.seriesLength),m.sort((r,x)=>x.seriesLength-r.seriesLength),g.sort((r,x)=>x.seriesLength-r.seriesLength),{allVillageoisSeries:t,allLoupsSeries:d,allNoWolfSeries:c,allSoloSeries:a,allWinSeries:m,allLossSeries:g}}function de(e,t){const d=[],c=[],a=[],m=[],g=[],r=[];Object.values(e).forEach(u=>{d.push(u.longestVillageoisSeries?.seriesLength||0),c.push(u.longestLoupsSeries?.seriesLength||0),a.push(u.longestNoWolfSeries?.seriesLength||0),m.push(u.longestSoloSeries?.seriesLength||0),g.push(u.longestWinSeries?.seriesLength||0),r.push(u.longestLossSeries?.seriesLength||0)});const x=t>0?d.reduce((u,v)=>u+v,0)/t:0,p=t>0?c.reduce((u,v)=>u+v,0)/t:0,P=t>0?a.reduce((u,v)=>u+v,0)/t:0,G=t>0?m.reduce((u,v)=>u+v,0)/t:0,b=t>0?g.reduce((u,v)=>u+v,0)/t:0,N=t>0?r.reduce((u,v)=>u+v,0)/t:0,V=d.filter(u=>u>=5).length,I=c.filter(u=>u>=3).length,C=a.filter(u=>u>=5).length,y=m.filter(u=>u>=3).length,W=g.filter(u=>u>=5).length,D=r.filter(u=>u>=5).length;return{averageVillageoisSeries:Math.round(x*10)/10,averageLoupsSeries:Math.round(p*10)/10,averageNoWolfSeries:Math.round(P*10)/10,averageSoloSeries:Math.round(G*10)/10,averageWinSeries:Math.round(b*10)/10,averageLossSeries:Math.round(N*10)/10,eliteVillageoisCount:V,eliteLoupsCount:I,eliteNoWolfCount:C,eliteSoloCount:y,eliteWinCount:W,eliteLossCount:D}}function he(e){if(e.length===0)return null;const t=[...e].sort((n,i)=>parseInt(n.DisplayedId)-parseInt(i.DisplayedId)),d=oe(t),c=le(d);t.forEach(n=>{const i=n.DisplayedId,L=new Date(n.StartDate).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"});n.PlayerStats.forEach(f=>{const j=J(f),O=f.Username;d.set(j,O);const z=c[j];if(!z)return;const R=H(f.MainRoleInitial,f.MainRoleChanges||[]),k=U(R,f.Power),M=f.Victorious;te(z,O,k,i,L),ce(z,O,k,R,i,L),ae(z,O,M,k,i,L),ue(z,O,M,k,i,L)})});const{allVillageoisSeries:a,allLoupsSeries:m,allNoWolfSeries:g,allSoloSeries:r,allWinSeries:x,allLossSeries:p}=ge(c);Object.values(c).forEach(n=>{n.longestVillageoisSeries&&n.currentVillageoisSeries===n.longestVillageoisSeries.seriesLength&&n.currentVillageoisSeries>0&&(n.longestVillageoisSeries.isOngoing=!0),n.longestLoupsSeries&&n.currentLoupsSeries===n.longestLoupsSeries.seriesLength&&n.currentLoupsSeries>0&&(n.longestLoupsSeries.isOngoing=!0),n.longestNoWolfSeries&&n.currentNoWolfSeries===n.longestNoWolfSeries.seriesLength&&n.currentNoWolfSeries>0&&(n.longestNoWolfSeries.isOngoing=!0),n.longestSoloSeries&&n.currentSoloSeries===n.longestSoloSeries.seriesLength&&n.currentSoloSeries>0&&(n.longestSoloSeries.isOngoing=!0),n.longestWinSeries&&n.currentWinSeries===n.longestWinSeries.seriesLength&&n.currentWinSeries>0&&(n.longestWinSeries.isOngoing=!0),n.longestLossSeries&&n.currentLossSeries===n.longestLossSeries.seriesLength&&n.currentLossSeries>0&&(n.longestLossSeries.isOngoing=!0)});const P=de(c,d.size);let G=0,b=0,N=0,V=0,I=0,C=0,y=0,W=0,D=0,u=0,v=0,w=0;const F=[],E=[],o=[],h=[],l=[],S=[];return Object.entries(c).forEach(([n,i])=>{const L=i.longestVillageoisSeries?.player||i.longestLoupsSeries?.player||i.longestNoWolfSeries?.player||i.longestWinSeries?.player||i.longestLossSeries?.player||n;if(i.currentVillageoisSeries>0&&(G++,F.push({player:L,camp:"Villageois",seriesLength:i.currentVillageoisSeries,startGame:i.villageoisSeriesStart?.game||"",endGame:i.currentVillageoisGameIds[i.currentVillageoisGameIds.length-1]||"",startDate:i.villageoisSeriesStart?.date||"",endDate:A(t[t.length-1]?.EndDate||""),isOngoing:!0,gameIds:[...i.currentVillageoisGameIds]})),i.currentLoupsSeries>0&&(b++,E.push({player:L,camp:"Loups",seriesLength:i.currentLoupsSeries,startGame:i.loupsSeriesStart?.game||"",endGame:i.currentLoupsGameIds[i.currentLoupsGameIds.length-1]||"",startDate:i.loupsSeriesStart?.date||"",endDate:A(t[t.length-1]?.EndDate||""),isOngoing:!0,gameIds:[...i.currentLoupsGameIds]})),i.currentNoWolfSeries>0){N++;const f={};i.currentNoWolfCamps.forEach(j=>{f[j]=(f[j]||0)+1}),o.push({player:L,camp:"Sans Loups",seriesLength:i.currentNoWolfSeries,startGame:i.noWolfSeriesStart?.game||"",endGame:i.currentNoWolfGameIds[i.currentNoWolfGameIds.length-1]||"",startDate:i.noWolfSeriesStart?.date||"",endDate:A(t[t.length-1]?.EndDate||""),campCounts:f,isOngoing:!0,gameIds:[...i.currentNoWolfGameIds]})}if(i.currentSoloSeries>0){V++;const f={};i.currentSoloCamps.forEach(j=>{f[j]=(f[j]||0)+1}),h.push({player:L,camp:"R√¥les Solos",seriesLength:i.currentSoloSeries,startGame:i.soloSeriesStart?.game||"",endGame:i.currentSoloGameIds[i.currentSoloGameIds.length-1]||"",startDate:i.soloSeriesStart?.date||"",endDate:A(t[t.length-1]?.EndDate||""),campCounts:f,isOngoing:!0,gameIds:[...i.currentSoloGameIds]})}if(i.currentWinSeries>0){I++;const f={};i.currentWinCamps.forEach(j=>{f[j]=(f[j]||0)+1}),l.push({player:L,seriesLength:i.currentWinSeries,startGame:i.winSeriesStart?.game||"",endGame:i.currentWinGameIds[i.currentWinGameIds.length-1]||"",startDate:i.winSeriesStart?.date||"",endDate:A(t[t.length-1]?.EndDate||""),campCounts:f,isOngoing:!0,gameIds:[...i.currentWinGameIds]})}if(i.currentLossSeries>0){C++;const f={};i.currentLossCamps.forEach(j=>{f[j]=(f[j]||0)+1}),S.push({player:L,seriesLength:i.currentLossSeries,startGame:i.lossSeriesStart?.game||"",endGame:i.currentLossGameIds[i.currentLossGameIds.length-1]||"",startDate:i.lossSeriesStart?.date||"",endDate:A(t[t.length-1]?.EndDate||""),campCounts:f,isOngoing:!0,gameIds:[...i.currentLossGameIds]})}i.longestVillageoisSeries?.isOngoing&&y++,i.longestLoupsSeries?.isOngoing&&W++,i.longestNoWolfSeries?.isOngoing&&D++,i.longestSoloSeries?.isOngoing&&u++,i.longestWinSeries?.isOngoing&&v++,i.longestLossSeries?.isOngoing&&w++}),F.sort((n,i)=>i.seriesLength-n.seriesLength),E.sort((n,i)=>i.seriesLength-n.seriesLength),o.sort((n,i)=>i.seriesLength-n.seriesLength),h.sort((n,i)=>i.seriesLength-n.seriesLength),l.sort((n,i)=>i.seriesLength-n.seriesLength),S.sort((n,i)=>i.seriesLength-n.seriesLength),{allVillageoisSeries:a,allLoupsSeries:m,allNoWolfSeries:g,allSoloSeries:r,allWinSeries:x,allLossSeries:p,currentVillageoisSeries:F,currentLoupsSeries:E,currentNoWolfSeries:o,currentSoloSeries:h,currentWinSeries:l,currentLossSeries:S,totalGamesAnalyzed:t.length,totalPlayersCount:d.size,activeVillageoisCount:G,activeLoupsCount:b,activeNoWolfCount:N,activeSoloCount:V,activeWinCount:I,activeLossCount:C,ongoingVillageoisCount:y,ongoingLoupsCount:W,ongoingNoWolfCount:D,ongoingSoloCount:u,ongoingWinCount:v,ongoingLossCount:w,...P}}function me(){const{data:e,isLoading:t,error:d}=B(c=>he(c));return{data:e,isLoading:t,error:d}}function We(){const{data:e,isLoading:t,error:d}=me(),{navigateToGameDetails:c,navigationState:a,updateNavigationState:m}=$(),{settings:g}=q(),[r,x]=T.useState(a.selectedSeriesType||"villageois"),[p,P]=T.useState(a.seriesViewMode||"best"),[G,b]=T.useState(null),N=T.useRef(null),{joueursData:V}=K(),I=X(V),C=o=>{x(o),m({selectedSeriesType:o})},y=o=>{P(o),m({seriesViewMode:o})},{currentData:W,highlightedPlayerAdded:D,fullDataset:u}=T.useMemo(()=>{if(!e)return{currentData:[],highlightedPlayerAdded:!1,fullDataset:[]};let o=[];if(p==="ongoing")switch(r){case"villageois":o=e.currentVillageoisSeries;break;case"loup":o=e.currentLoupsSeries;break;case"nowolf":o=e.currentNoWolfSeries;break;case"solo":o=e.currentSoloSeries;break;case"wins":o=e.currentWinSeries;break;case"losses":o=e.currentLossSeries;break;default:o=[]}else switch(r){case"villageois":o=e.allVillageoisSeries;break;case"loup":o=e.allLoupsSeries;break;case"nowolf":o=e.allNoWolfSeries;break;case"solo":o=e.allSoloSeries;break;case"wins":o=e.allWinSeries;break;case"losses":o=e.allLossSeries;break;default:o=[]}const h=o.slice(0,20),l=g.highlightedPlayer&&h.some(i=>i.player===g.highlightedPlayer);let S=[...h],n=!1;if(g.highlightedPlayer&&!l){const i=o.find(L=>L.player===g.highlightedPlayer);i&&(S.push({...i,isHighlightedAddition:!0}),n=!0)}return{currentData:S,highlightedPlayerAdded:n,fullDataset:o}},[e,r,p,g.highlightedPlayer]);if(t)return s.jsx("div",{className:"donnees-attente",children:"R√©cup√©ration des s√©ries de joueurs..."});if(d)return s.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",d]});if(!e)return s.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e de s√©rie disponible"});const v=o=>Object.entries(o).map(([h,l])=>`${h} (${l})`).join(", "),w=()=>{switch(r){case"villageois":return p==="ongoing"?"S√©ries Villageois En Cours":"Plus Longues S√©ries Villageois Cons√©cutives";case"loup":return p==="ongoing"?"S√©ries Loups En Cours":"Plus Longues S√©ries Loups Cons√©cutives";case"nowolf":return p==="ongoing"?"S√©ries Sans R√¥le Loup En Cours":"Plus Longues S√©ries Sans R√¥le Loup";case"solo":return p==="ongoing"?"S√©ries R√¥les Solos En Cours":"Plus Longues S√©ries R√¥les Solos";case"wins":return p==="ongoing"?"S√©ries de Victoires En Cours":"Plus Longues S√©ries de Victoires";case"losses":return p==="ongoing"?"S√©ries de D√©faites En Cours":"Plus Longues S√©ries de D√©faites";default:return""}},F=({active:o,payload:h})=>{if(!o||!h||h.length===0)return null;const l=h[0].payload,S=l.isHighlightedAddition,n=g.highlightedPlayer===l.player,i=p==="best"&&l.isOngoing;return r==="solo"?s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:l.player}),i&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"üî•"})]}),s.jsxs("div",{children:["S√©rie ",l.camp," : ",l.seriesLength," parties cons√©cutives ",i?"(En cours)":""]}),s.jsxs("div",{children:["Du ",l.startGame," au ",l.endGame]}),s.jsxs("div",{children:["Du ",l.startDate," au ",l.endDate]}),l.campCounts&&s.jsxs("div",{children:[s.jsx("strong",{children:"R√¥les jou√©s :"}),s.jsx("div",{style:{marginTop:"4px",fontSize:"0.9em"},children:Object.entries(l.campCounts).sort(([,L],[,f])=>f-L).map(([L,f])=>s.jsxs("div",{style:{marginLeft:"8px"},children:["‚Ä¢ ",L," (",f," ",(f>1,"fois"),")"]},L))})]}),S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence (hors top 20)"}),n&&!S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence"}),i&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"üî• S√©rie en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]}):r==="wins"?s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:l.player}),i&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"üî•"})]}),s.jsxs("div",{children:["S√©rie de victoires : ",l.seriesLength," parties ",i?"(En cours)":""]}),s.jsxs("div",{children:["Du ",l.startGame," au ",l.endGame]}),s.jsxs("div",{children:["Du ",l.startDate," au ",l.endDate]}),s.jsxs("div",{children:["Camps jou√©s : ",v(l.campCounts)]}),S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence (hors top 20)"}),n&&!S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence"}),i&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"üî• S√©rie en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]}):r==="losses"?s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:l.player}),i&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"üî•"})]}),s.jsxs("div",{children:["S√©rie de d√©faites : ",l.seriesLength," parties ",i?"(En cours)":""]}),s.jsxs("div",{children:["Du ",l.startGame," au ",l.endGame]}),s.jsxs("div",{children:["Du ",l.startDate," au ",l.endDate]}),s.jsxs("div",{children:["Camps jou√©s : ",v(l.campCounts)]}),S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence (hors top 20)"}),n&&!S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence"}),i&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"üî• S√©rie en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]}):s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:l.player}),i&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"üî•"})]}),s.jsxs("div",{children:["S√©rie ",l.camp," : ",l.seriesLength," parties cons√©cutives ",i?"(En cours)":""]}),s.jsxs("div",{children:["Du ",l.startGame," au ",l.endGame]}),s.jsxs("div",{children:["Du ",l.startDate," au ",l.endDate]}),l.campCounts&&s.jsxs("div",{children:["Camps jou√©s : ",v(l.campCounts)]}),S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence (hors top 20)"}),n&&!S&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"üéØ Joueur mis en √©vidence"}),i&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"üî• S√©rie en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})},E=o=>{if(r==="wins")c({selectedPlayer:o.player,selectedGameIds:o.gameIds,fromComponent:"S√©ries de Victoires"});else if(r==="losses")c({selectedPlayer:o.player,selectedGameIds:o.gameIds,fromComponent:"S√©ries de D√©faites"});else if(r==="nowolf")c({selectedPlayer:o.player,selectedGameIds:o.gameIds,fromComponent:"S√©ries Sans Loups"});else if(r==="solo")c({selectedPlayer:o.player,selectedGameIds:o.gameIds,fromComponent:"S√©ries R√¥les Solos"});else{const h=r==="villageois"?"Villageois":"Loup";c({selectedPlayer:o.player,selectedGameIds:o.gameIds,campFilter:{selectedCamp:h,campFilterMode:"all-assignments"},fromComponent:`S√©ries ${h}`})}};return s.jsxs("div",{className:"lycans-players-series",children:[s.jsx("h2",{children:"S√©ries des Joueurs"}),s.jsx("div",{className:"lycans-section-description",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Mode Meilleurs Records :"})," Affiche les meilleures s√©ries de tous les temps pour chaque joueur.",s.jsx("br",{}),s.jsx("strong",{children:"Mode S√©ries En Cours :"})," Affiche uniquement les s√©ries actuellement actives (tous les joueurs ayant une s√©rie en cours, pas seulement leur record personnel).",s.jsx("br",{}),s.jsx("br",{}),r==="villageois"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"S√©ries Villageois :"})," Parties cons√©cutives dans le camp Villageois. Jouer dans n'importe quel autre camp brise la s√©rie."]}),r==="loup"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"S√©ries Loups :"})," Parties cons√©cutives dans le camp Loups. Jouer dans n'importe quel autre camp brise la s√©rie."]}),r==="nowolf"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"S√©ries sans Loups :"})," Parties cons√©cutives o√π le joueur n'a PAS jou√© de r√¥le Loup. Jouer un r√¥le Loup brise la s√©rie."]}),r==="solo"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"S√©ries R√¥les Solos :"})," Parties cons√©cutives o√π le joueur a jou√© un r√¥le solo (ni Villageois ni Loup). Jouer un r√¥le Villageois ou Loup brise la s√©rie."]}),r==="wins"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"S√©ries de victoires :"})," Victoires cons√©cutives dans n'importe quel camp. Une d√©faite brise la s√©rie."]}),r==="losses"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"S√©ries de d√©faites :"})," D√©faites cons√©cutives dans n'importe quel camp. Une victoire brise la s√©rie."]}),s.jsx("br",{}),s.jsx("strong",{children:"üî• S√©ries en cours :"})," ",p==="ongoing"?"Toutes les s√©ries affich√©es sont actuellement actives":"Les s√©ries avec l'effet de flamme sont encore actives"]})}),s.jsxs("div",{className:"lycans-categories-selection",style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[s.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[s.jsx("button",{type:"button",className:`lycans-categorie-btn ${r==="villageois"?"active":""}`,onClick:()=>C("villageois"),children:"S√©ries Villageois"}),s.jsx("button",{type:"button",className:`lycans-categorie-btn ${r==="loup"?"active":""}`,onClick:()=>C("loup"),children:"S√©ries Loups"}),s.jsx("button",{type:"button",className:`lycans-categorie-btn ${r==="nowolf"?"active":""}`,onClick:()=>C("nowolf"),children:"S√©ries Sans Loups"}),s.jsx("button",{type:"button",className:`lycans-categorie-btn ${r==="solo"?"active":""}`,onClick:()=>C("solo"),children:"S√©ries R√¥les Solos"}),s.jsx("button",{type:"button",className:`lycans-categorie-btn ${r==="wins"?"active":""}`,onClick:()=>C("wins"),children:"S√©ries de Victoires"}),s.jsx("button",{type:"button",className:`lycans-categorie-btn ${r==="losses"?"active":""}`,onClick:()=>C("losses"),children:"S√©ries de D√©faites"})]}),s.jsx("button",{type:"button",className:"lycans-categorie-btn",onClick:()=>y(p==="best"?"ongoing":"best"),style:{marginLeft:"auto",backgroundColor:p==="ongoing"?"#FF8C00":"var(--accent-primary)",color:"white",fontWeight:"bold"},children:p==="best"?"üî• Focus S√©ries En Cours":"üìä Voir les Records"})]}),s.jsxs("div",{className:"lycans-graphique-section",children:[s.jsxs("div",{children:[s.jsx("h3",{children:w()}),D&&g.highlightedPlayer&&s.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['üéØ "',g.highlightedPlayer,'" affich√© en plus du top 20']})]}),s.jsx(Y,{title:w(),children:s.jsx("div",{ref:N,style:{height:500},children:s.jsx(se,{width:"100%",height:"100%",children:s.jsxs(ie,{data:W,margin:{top:20,right:30,left:20,bottom:10},children:[s.jsx(_,{strokeDasharray:"3 3"}),s.jsx(Q,{dataKey:"player",angle:-45,textAnchor:"end",height:120,interval:0,tick:({x:o,y:h,payload:l})=>s.jsx("text",{x:o,y:h,dy:16,textAnchor:"end",fill:g.highlightedPlayer===l.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:g.highlightedPlayer===l.value?14:13,fontWeight:g.highlightedPlayer===l.value?"bold":"italic",transform:`rotate(-45 ${o} ${h})`,children:l.value})}),s.jsx(Z,{allowDecimals:!1,label:{value:r==="wins"?"Victoires cons√©cutives":r==="losses"?"D√©faites cons√©cutives":r==="nowolf"?"Parties sans Loups cons√©cutives":r==="solo"?"Parties r√¥les solos cons√©cutives":"Parties cons√©cutives",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),s.jsx(re,{content:F}),s.jsx(ne,{dataKey:"seriesLength",name:r==="wins"?"Victoires cons√©cutives":r==="losses"?"D√©faites cons√©cutives":r==="solo"?"Parties r√¥les solos cons√©cutives":"Parties cons√©cutives",fill:r==="villageois"?"#82ca9d":r==="loup"?"#FF8042":r==="nowolf"?"#FFA500":r==="solo"?"#9C27B0":r==="wins"?"#8884d8":"#dc3545",children:W.map((o,h)=>{const l=g.highlightedPlayer===o.player,S=G===o.player,n=o.isHighlightedAddition,i=I[o.player]||(r==="villageois"?"#82ca9d":r==="loup"?"#FF8042":r==="nowolf"?"#FFA500":r==="solo"?"#9C27B0":r==="wins"?"#8884d8":"#dc3545");return s.jsx(ee,{fill:i,stroke:l?"var(--accent-primary)":S?"var(--text-primary)":"none",strokeWidth:l?3:S?2:0,strokeDasharray:n?"5,5":"none",opacity:n?.8:1,onClick:()=>E(o),onMouseEnter:()=>b(o.player),onMouseLeave:()=>b(null),style:{cursor:"pointer"},className:p==="best"&&o.isOngoing?"lycans-ongoing-series":""},`cell-${r}-${h}`)})})]})})})}),W.length>0&&(()=>{const o=W[0].seriesLength,h=W.filter(S=>S.seriesLength===o),l=h.some(S=>S.isOngoing);return s.jsxs("div",{className:"lycans-stats-grid",style:{marginTop:"0rem",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))"},children:[s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:p==="ongoing"?"üî• Plus Longue S√©rie Active":"üèÜ Record Absolu"}),s.jsxs("div",{className:"lycans-stat-value",children:[o,p==="ongoing"&&s.jsx("span",{style:{fontSize:"0.6em",marginLeft:"5px"},children:"üî•"}),p==="best"&&l&&s.jsx("span",{style:{fontSize:"0.6em",marginLeft:"5px"},children:"üî•"})]}),h.length===1?s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["par ",s.jsx("strong",{children:h[0].player}),p==="best"&&h[0].isOngoing&&s.jsx("span",{style:{color:"#FF8C00",fontWeight:"bold"},children:" (En cours)"})]}),h[0].campCounts?s.jsxs("p",{className:"lycans-h2h-description",children:["Camps jou√©s : ",v(h[0].campCounts)]}):s.jsxs("p",{className:"lycans-h2h-description",children:["Camp : ",h[0].camp]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["par ",s.jsxs("strong",{children:[h.length," joueurs"]}),p==="best"&&l&&s.jsxs("span",{style:{color:"#FF8C00",fontWeight:"bold"},children:[" (dont s√©rie",h.filter(S=>S.isOngoing).length>1?"s":""," en cours)"]})]}),s.jsx("p",{className:"lycans-h2h-description",style:{fontSize:"0.9rem",lineHeight:"1.4"},children:h.map((S,n)=>s.jsxs("span",{children:[s.jsx("strong",{children:S.player}),p==="best"&&S.isOngoing&&s.jsx("span",{style:{fontSize:"0.9em"},children:"üî•"}),n<h.length-1&&", "]},S.player))})]})]}),p==="best"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"üìä Meilleure s√©rie moyenne (tous les joueurs)"}),s.jsx("div",{className:"lycans-stat-value",children:r==="villageois"?e.averageVillageoisSeries:r==="loup"?e.averageLoupsSeries:r==="nowolf"?e.averageNoWolfSeries:r==="solo"?e.averageSoloSeries:r==="wins"?e.averageWinSeries:e.averageLossSeries}),s.jsx("p",{children:"parties en moyenne"}),s.jsxs("p",{className:"lycans-h2h-description",children:["Bas√© sur ",e.totalPlayersCount," joueurs"]})]}),s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"üî• S√©ries En Cours"}),s.jsx("div",{className:"lycans-stat-value",children:r==="villageois"?e.activeVillageoisCount:r==="loup"?e.activeLoupsCount:r==="nowolf"?e.activeNoWolfCount:r==="solo"?e.activeSoloCount:r==="wins"?e.activeWinCount:e.activeLossCount}),s.jsx("p",{children:"s√©ries encore actives"}),s.jsx("p",{className:"lycans-h2h-description",children:(r==="villageois"?e.activeVillageoisCount:r==="loup"?e.activeLoupsCount:r==="nowolf"?e.activeNoWolfCount:r==="solo"?e.activeSoloCount:r==="wins"?e.activeWinCount:e.activeLossCount)>0?"Joueurs actuellement dans une s√©rie de ce type":"Aucune s√©rie active de ce type"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"üìä S√©rie active moyenne"}),s.jsx("div",{className:"lycans-stat-value",children:u.length>0?(u.reduce((S,n)=>S+n.seriesLength,0)/u.length).toFixed(1):"0"}),s.jsx("p",{children:"parties en moyenne"}),s.jsxs("p",{className:"lycans-h2h-description",children:["Bas√© sur ",u.length," joueur",u.length>1?"s":""," en s√©rie active"]})]}),s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"üë• Joueurs Actifs"}),s.jsx("div",{className:"lycans-stat-value",children:u.length}),s.jsxs("p",{children:["joueur",u.length>1?"s":""," en s√©rie active"]}),s.jsx("p",{className:"lycans-h2h-description",children:u.length>0?`Sur ${e.totalPlayersCount} joueurs au total`:"Aucun joueur en s√©rie active"})]})]})]})})(),W.length===0&&s.jsxs("div",{className:"lycans-empty-section",children:[s.jsx("h3",{children:"Aucune s√©rie trouv√©e"}),s.jsx("p",{children:"Aucune s√©rie n'a √©t√© trouv√©e pour ce type avec les filtres actuels."})]})]})]})}export{We as PlayerSeriesChart};
