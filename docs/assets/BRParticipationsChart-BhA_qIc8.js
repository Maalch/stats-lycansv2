import{a as L,r as b,j as t}from"./index-CJj5Tz_g.js";import{F as S,C as N,X as R,Y as B}from"./FullscreenChart-EUGD-waH.js";import{u as W,a as I}from"./useRawBRData-Z0EXbyBr.js";import{u as K}from"./useJoueursData-C-JubL4M.js";import{u as M,g as O}from"./api-DE4zxPhP.js";import{R as w,T as A,a as C}from"./CategoricalChart-DZayLyH8.js";import{B as D,a as H}from"./BarChart-D4DgAwhU.js";function Z(){const{data:x,isLoading:F,error:v}=W(),{data:y,isLoading:k,error:j}=I(),{settings:n}=L(),{joueursData:z}=K(),[G,P]=b.useState(null),T=M(z),f=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],E=r=>T[r]||O(r),h=b.useMemo(()=>{if(!x||!y)return null;const r=y.length,i=x.length,e=x.filter(a=>a.Gagnant).length,c=x.reduce((a,s)=>{const o=s.Participants;return a[o]||(a[o]={name:o,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),a[o].participations++,a[o].totalScore+=s.Score,s.Gagnant&&a[o].wins++,a},{});Object.values(c).forEach(a=>{a.averageScore=a.totalScore/a.participations,a.winRate=a.wins/a.participations*100});const d=Object.values(c).sort((a,s)=>s.participations-a.participations),p=d.slice(0,15),l=n.highlightedPlayer&&p.some(a=>a.name===n.highlightedPlayer);let g=!1,m=[...p];if(n.highlightedPlayer&&!l){const a=d.find(s=>s.name===n.highlightedPlayer);a&&(m.push({...a,isHighlightedAddition:!0}),g=!0)}const u=y.reduce((a,s)=>{const o=s["Nombre de participants"];return a[o]||(a[o]=0),a[o]++,a},{}),q=Object.entries(u).map(([a,s])=>({participants:parseInt(a),games:s,percentage:(s/r*100).toFixed(1)})).sort((a,s)=>a.participants-s.participants);return{totalGames:r,totalParticipations:i,totalWins:e,winRate:(e/i*100).toFixed(1),averageParticipantsPerGame:(i/r).toFixed(1),topPlayersByParticipations:m,participantData:q,highlightedPlayerInParticipations:g}},[x,y,n.highlightedPlayer]);return F||k?t.jsx("div",{className:"statistiques-chargement",children:"Chargement des donn√©es Battle Royale..."}):v||j?t.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",v||j]}):h?t.jsxs("div",{className:"lycans-chart-container",children:[t.jsx("div",{className:"lycans-chart-header",children:t.jsx("h2",{children:"Participations - Battle Royale"})}),t.jsxs("div",{className:"lycans-stats-grid",children:[t.jsxs("div",{className:"lycans-stat-card",children:[t.jsx("h3",{children:"Parties totales"}),t.jsx("div",{className:"lycans-stat-value",children:h.totalGames})]}),t.jsxs("div",{className:"lycans-stat-card",children:[t.jsx("h3",{children:"Participations"}),t.jsx("div",{className:"lycans-stat-value",children:h.totalParticipations})]}),t.jsxs("div",{className:"lycans-stat-card",children:[t.jsx("h3",{children:"Moy. participants/partie"}),t.jsx("div",{className:"lycans-stat-value",children:h.averageParticipantsPerGame})]})]}),t.jsxs("div",{className:"lycans-graphiques-groupe",children:[t.jsxs("div",{className:"lycans-graphique-section",children:[t.jsx("h3",{children:"Participations"}),h.highlightedPlayerInParticipations&&n.highlightedPlayer&&t.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary-text)",margin:"0.5rem 0"},children:["üéØ ",n.highlightedPlayer," affich√© en plus du top 15"]}),t.jsx(S,{title:"Participations - Battle Royale",className:"lycans-chart-wrapper",children:t.jsx(w,{width:"100%",height:400,children:t.jsxs(D,{data:h.topPlayersByParticipations,children:[t.jsx(N,{strokeDasharray:"3 3"}),t.jsx(R,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:r,y:i,payload:e})=>t.jsx("text",{x:r,y:i,dy:16,textAnchor:"end",fill:n.highlightedPlayer===e.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===e.value?14:12,fontWeight:n.highlightedPlayer===e.value?"bold":"normal",transform:`rotate(-45 ${r} ${i})`,children:e.value})}),t.jsx(B,{}),t.jsx(A,{content:({active:r,payload:i})=>{if(r&&i&&i.length>0){const e=i[0].payload,c=e.isHighlightedAddition,d=n.highlightedPlayer===e.name;return t.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[t.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[e.name,d&&" üéØ"]}),t.jsx("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:t.jsxs("div",{children:["Participations: ",t.jsx("strong",{children:e.participations})]})}),c&&t.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"üéØ Affich√© via s√©lection (hors top 15)"})]})}return null}}),t.jsx(H,{dataKey:"participations",name:"Participations",shape:r=>{const{x:i,y:e,width:c,height:d,payload:p}=r,l=p,g=n.highlightedPlayer===l.name,m=G===l.name,u=l.isHighlightedAddition;return t.jsx(C,{x:i,y:e,width:c,height:d,fill:g?"var(--accent-primary)":u?"var(--accent-secondary)":E(l.name),stroke:g?"var(--accent-primary)":m?"var(--text-primary)":"none",strokeWidth:g?3:m?2:0,strokeDasharray:u?"5,5":"none",opacity:u?.8:1,onMouseEnter:()=>P(l.name),onMouseLeave:()=>P(null),style:{cursor:"pointer"}})}})]})})})]}),t.jsxs("div",{className:"lycans-graphique-section",children:[t.jsx("h3",{children:"R√©partition par Nombre de Participants"}),t.jsx(S,{title:"R√©partition par Nombre de Participants - Battle Royale",className:"lycans-chart-wrapper",children:t.jsx(w,{width:"100%",height:400,children:t.jsxs(D,{data:h.participantData,margin:{bottom:15},children:[t.jsx(N,{strokeDasharray:"3 3"}),t.jsx(R,{dataKey:"participants",label:{value:"Nombre de participants",position:"insideBottom",offset:-5}}),t.jsx(B,{}),t.jsx(A,{content:({active:r,payload:i})=>{if(r&&i&&i.length>0){const e=i[0].payload;return t.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[t.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[e.participants," ",e.participants===1?"participant":"participants"]}),t.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[t.jsxs("div",{children:["Nombre de parties: ",t.jsx("strong",{children:e.games})]}),t.jsxs("div",{children:["Pourcentage: ",t.jsxs("strong",{children:[e.percentage,"%"]})]})]})]})}return null}}),t.jsx(H,{dataKey:"games",name:"Nombre de parties",shape:r=>{const{x:i,y:e,width:c,height:d,index:p}=r,l=f[(p??0)%f.length];return t.jsx(C,{x:i,y:e,width:c,height:d,fill:l})}})]})})})]})]})]}):t.jsx("div",{className:"statistiques-vide",children:"Aucune donn√©e Battle Royale disponible"})}export{Z as BRParticipationsChart};
