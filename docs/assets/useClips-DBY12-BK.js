import{r as d,j as e,e as f}from"./index-gt-YMIUa.js";function x(s){if(!s)return null;try{const n=new URL(s);let l=null;if(n.hostname==="clips.twitch.tv")l=n.pathname.split("/")[1];else if(n.hostname.includes("twitch.tv")){const i=n.pathname.split("/"),r=i.indexOf("clip");r!==-1&&i[r+1]&&(l=i[r+1])}if(l)return`https://clips.twitch.tv/embed?clip=${l}&parent=${window.location.hostname}`}catch(n){console.warn("Failed to parse Twitch clip URL:",s,n)}return null}function o(s){return s.NewName?s.NewName:s.ClipName?s.ClipName:`Clip ${s.ClipId}`}function y(s){return s?s.split(",").map(n=>n.trim()).filter(n=>n.length>0):[]}function j(s){return s?s.split(",").map(n=>n.trim()).filter(n=>n.length>0):[]}function v(s){const n=[s.POVPlayer],l=y(s.OthersPlayers);return[...n,...l]}function N(s,n){const l=n.toLowerCase();return s.filter(i=>v(i).map(c=>c.toLowerCase()).includes(l))}function C(s,n){const l=j(s.RelatedClips);return n.filter(i=>l.includes(i.ClipId))}function P(s,n){return s.NextClip&&n.find(l=>l.ClipId===s.NextClip)||null}function b({clip:s,onClose:n,onNextClip:l,onRelatedClip:i,relatedClips:r=[],nextClip:c=null}){d.useEffect(()=>{const a=t=>{t.key==="Escape"&&n()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[n]);const p=x(s.ClipUrl),h=o(s),u=y(s.OthersPlayers),m=Array.isArray(s.Tags)&&s.Tags.some(a=>a.toLowerCase().includes("warning sonore"));return e.jsx("div",{className:"lycans-clip-viewer-overlay",onClick:n,children:e.jsxs("div",{className:"lycans-clip-viewer-container",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"lycans-clip-viewer-header",children:[e.jsxs("div",{className:"lycans-clip-viewer-title",children:[e.jsx("h2",{children:h}),Array.isArray(s.Tags)&&s.Tags.length>0&&e.jsx("div",{className:"lycans-clip-tags",children:s.Tags.map((a,t)=>e.jsx("span",{className:"lycans-clip-tag",children:a},t))})]}),e.jsx("button",{className:"lycans-clip-viewer-close",onClick:n,children:"âœ•"})]}),m&&e.jsxs("div",{className:"lycans-clip-warning-banner",children:[e.jsx("span",{className:"lycans-clip-warning-icon",children:"âš ï¸ ðŸ”Š"}),e.jsx("span",{className:"lycans-clip-warning-text",children:"Attention : Ce clip contient un son fort"})]}),e.jsxs("div",{className:"lycans-clip-viewer-content",children:[e.jsx("div",{className:"lycans-clip-player",children:p?e.jsx("iframe",{src:p,frameBorder:"0",allowFullScreen:!0,scrolling:"no",title:h}):e.jsxs("div",{className:"lycans-clip-no-video",children:[e.jsx("p",{children:"VidÃ©o non disponible"}),s.ClipUrl&&e.jsx("a",{href:s.ClipUrl,target:"_blank",rel:"noopener noreferrer",children:"Voir sur Twitch"})]})}),e.jsxs("div",{className:"lycans-clip-metadata",children:[e.jsxs("div",{className:"lycans-clip-info-section",children:[e.jsx("h3",{children:"Joueurs"}),e.jsxs("div",{className:"lycans-clip-players",children:[e.jsxs("div",{className:"lycans-clip-pov-player",children:[e.jsx("span",{className:"lycans-clip-pov-badge",children:"POV"}),e.jsx("span",{className:"lycans-clip-player-name",children:s.POVPlayer})]}),u.length>0&&e.jsx("div",{className:"lycans-clip-other-players",children:u.map((a,t)=>e.jsx("span",{className:"lycans-clip-player-name",children:a},t))})]})]}),s.AdditionalInfo&&e.jsxs("div",{className:"lycans-clip-info-section",children:[e.jsx("h3",{children:"Description"}),e.jsx("p",{className:"lycans-clip-description",children:s.AdditionalInfo})]}),(c||r.length>0)&&e.jsxs("div",{className:"lycans-clip-info-section",children:[e.jsx("h3",{children:"Clips liÃ©s"}),e.jsxs("div",{className:"lycans-clip-navigation",children:[c&&l&&e.jsxs("button",{className:"lycans-clip-nav-btn lycans-clip-next-btn",onClick:l,children:["â–¶ Suivant: ",o(c)]}),r.length>0&&i&&e.jsxs("div",{className:"lycans-clip-related-clips",children:[e.jsx("p",{className:"lycans-clip-related-label",children:"Autres POV:"}),r.map(a=>e.jsxs("button",{className:"lycans-clip-nav-btn lycans-clip-related-btn",onClick:()=>i(a.ClipId),children:[o(a)," (",a.POVPlayer,")"]},a.ClipId))]})]})]})]})]})]})})}function w(){const{data:s,isLoading:n,error:l}=f();return{clips:d.useMemo(()=>{if(!s)return[];const r=[];return s.forEach(c=>{c.Clips&&Array.isArray(c.Clips)&&r.push(...c.Clips)}),r},[s]),isLoading:n,error:l}}function A(s){const{clips:n,isLoading:l,error:i}=w();return{clips:d.useMemo(()=>s?N(n,s):[],[n,s]),isLoading:l,error:i}}export{b as C,C as a,A as b,P as f,o as g,w as u};
