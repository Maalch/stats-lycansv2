import{f as U,u as X,a as Y,r as P,b as Q,j as e}from"./index-DE0a4wJ1.js";import{g as Z,a as ee,u as te}from"./datasyncExport-CfTPzr1v.js";import{g as ae}from"./gameUtils-D1d7omwQ.js";import{u as re}from"./usePlayerStatsFromRaw-Bg_BcOTI.js";import{u as se}from"./useJoueursData-BhPXldXB.js";import{a as ie,u as ne,l as B}from"./api-Dz-Jih6e.js";import{F,C as M,X as T,Y as $,B as q,a as z,b as k}from"./FullscreenChart-DdpM8yO-.js";import{R as S,T as R}from"./CategoricalChart-DZb_FpFy.js";import{L as le,a as oe}from"./LineChart-B3jnAXhe.js";import{P as ce,a as de}from"./PieChart-BUdrekSR.js";import{R as E}from"./ReferenceLine-CHZOPOKJ.js";import"./ActivePoints-BmtTSpp3.js";import"./PolarChart-BXTGGEl9.js";function pe(c,g){if(!c||c.trim()===""||g.length===0)return null;const d=[];g.forEach(i=>{const h=i.PlayerStats.find(n=>n.Username.toLowerCase()===c.toLowerCase());if(h){const n=Z(ee(h.MainRoleInitial,h.MainRoleChanges||[])),u=ae(i),x=h.Victorious,K=U(new Date(i.StartDate));d.push({gameId:i.Id,date:K,camp:n,won:x,winnerCamp:u,playersInGame:i.PlayerStats.length,mapName:i.MapName})}}),d.sort((i,h)=>{const n=u=>{const x=u.split("/");return x.length===3?new Date(parseInt(x[2]),parseInt(x[1])-1,parseInt(x[0])):new Date(u)};return n(h.date).getTime()-n(i.date).getTime()});const p=d.length,v=d.filter(i=>i.won).length,C=p>0?(v/p*100).toFixed(2):"0.00",j={};d.forEach(i=>{j[i.camp]||(j[i.camp]={appearances:0,wins:0,winRate:"0.00"}),j[i.camp].appearances++,i.won&&j[i.camp].wins++}),Object.keys(j).forEach(i=>{const h=j[i];h.winRate=h.appearances>0?(h.wins/h.appearances*100).toFixed(2):"0.00"});const y={};return d.forEach(i=>{y[i.mapName]||(y[i.mapName]={appearances:0,wins:0,winRate:"0.00"}),y[i.mapName].appearances++,i.won&&y[i.mapName].wins++}),Object.keys(y).forEach(i=>{const h=y[i];h.winRate=h.appearances>0?(h.wins/h.appearances*100).toFixed(2):"0.00"}),{playerName:c,totalGames:p,totalWins:v,winRate:C,games:d,campStats:j,mapStats:y}}function me(c){const g={};let d=0,p=0;return Object.entries(c).forEach(([v,C])=>{v==="Village"||v==="Château"?g[v]={...C}:(d+=C.appearances,p+=C.wins)}),d>=10&&(g.Autres={appearances:d,wins:p,winRate:d>0?(p/d*100).toFixed(2):"0.00"}),g}function he(c){const{data:g,isLoading:d,error:p}=te(v=>c?pe(c,v):null);return{data:g,isLoading:d,error:p}}function De(){const{navigateToGameDetails:c,navigationState:g,updateNavigationState:d}=X(),{settings:p}=Y(),v=ie(),{joueursData:C}=se(),j=ne(C),{data:y}=re(),i=P.useMemo(()=>{if(!y?.playerStats)return["Ponce"];const t=y.playerStats.filter(r=>r.gamesPlayed>0).map(r=>r.player).sort();return p.highlightedPlayer&&!t.includes(p.highlightedPlayer)&&y.playerStats.some(r=>r.player===p.highlightedPlayer&&r.gamesPlayed>0)&&(t.push(p.highlightedPlayer),t.sort()),t},[y,p.highlightedPlayer]),n=g.selectedPlayerName&&i.includes(g.selectedPlayerName)?g.selectedPlayerName:p.highlightedPlayer&&i.includes(p.highlightedPlayer)?p.highlightedPlayer:i.includes("Ponce")?"Ponce":i[0]||"",u=g.groupingMethod||"session",x=g.selectedViewType||"performance",K=t=>{d({selectedPlayerName:t})},O=t=>{d({groupingMethod:t})},W=t=>{d({selectedViewType:t})},{data:m,isLoading:H,error:I}=he(n),G=P.useMemo(()=>{if(!m?.games)return new Map;const t=new Map;return m.games.forEach(r=>{if(!t.has(r.date)){const a=r.date.split("/");a.length===3?t.set(r.date,new Date(parseInt(a[2]),parseInt(a[1])-1,parseInt(a[0])).getTime()):t.set(r.date,new Date(r.date).getTime())}}),t},[m?.games]),D=P.useMemo(()=>{if(!m?.games)return[];const t={};return m.games.forEach(r=>{let a;if(u==="month"){const o=r.date.split("/");o.length===3?a=`${o[1]}/${o[2]}`:a=r.date}else a=r.date;t[a]||(t[a]={games:[],wins:0,total:0}),t[a].games.push(r),t[a].total++,r.won&&t[a].wins++}),Object.entries(t).map(([r,a])=>({period:r,totalGames:a.total,victories:a.wins,defeats:a.total-a.wins,winRate:a.total>0?(a.wins/a.total*100).toFixed(1):"0.0",winRateNum:a.total>0?a.wins/a.total*100:0})).sort((r,a)=>{if(u==="month"){const[o,s]=r.period.split("/"),[l,f]=a.period.split("/"),J=new Date(parseInt(s),parseInt(o)-1,1),_=new Date(parseInt(f),parseInt(l)-1,1);return J.getTime()-_.getTime()}else{const o=G.get(r.period)||0,s=G.get(a.period)||0;return o-s}})},[m,u,G]),N=P.useMemo(()=>m?.campStats?Object.entries(m.campStats).map(([t,r])=>({name:t,value:r.appearances,winRate:r.winRate,winRateDisplay:Math.max(parseFloat(r.winRate),1),wins:r.wins,percentage:(r.appearances/m.totalGames*100).toFixed(1)})):[],[m]),V=P.useMemo(()=>{if(!N.length)return[];const t=5;let r=0;const a=[],o=[];if(N.forEach(s=>{parseFloat(s.percentage)<t?(r+=Number(s.value),a.push(s)):o.push(s)}),r>0){const s=N.reduce((l,f)=>l+Number(f.value),0);o.push({name:"Autres",value:r,winRate:"0.0",wins:a.reduce((l,f)=>l+f.wins,0),percentage:(r/s*100).toFixed(1),_details:a})}return o},[N]),b=P.useMemo(()=>{if(!m?.mapStats)return[];const t=me(m.mapStats);return Object.entries(t).map(([r,a])=>({name:r,value:a.appearances,winRate:a.winRate,winRateDisplay:Math.max(parseFloat(a.winRate),.1),wins:a.wins,percentage:(a.appearances/m.totalGames*100).toFixed(1)}))},[m]),{gameData:L}=Q(),A=P.useMemo(()=>{if(!L||!n)return{playersKilled:[],killedBy:[]};const t={},r={};L.forEach(s=>{const l=s.PlayerStats.find(f=>f.Username.toLowerCase()===n.toLowerCase());l&&(s.PlayerStats.forEach(f=>{f.KillerName?.toLowerCase()===n.toLowerCase()&&(t[f.Username]=(t[f.Username]||0)+1)}),l.KillerName&&(r[l.KillerName]=(r[l.KillerName]||0)+1))});const a=Object.entries(t).map(([s,l])=>({player:s,kills:l})).sort((s,l)=>l.kills-s.kills).slice(0,10),o=Object.entries(r).map(([s,l])=>({player:s,kills:l})).sort((s,l)=>l.kills-s.kills).slice(0,10);return{playersKilled:a,killedBy:o}},[L,n]),w=(t=>t<=15?{fontSize:12,angle:-45,height:80,interval:0}:t<=30?{fontSize:12,angle:-45,height:85,interval:1}:t<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(t/12)})(D.length);return H?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):I?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",I]}):m?e.jsxs("div",{className:"lycans-player-history",children:[e.jsx("h2",{children:"Historique Détaillé d'un Joueur"}),e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Joueur:"}),e.jsx("select",{id:"player-select",value:n,onChange:t=>K(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:i.map(t=>e.jsx("option",{value:t,children:t},t))})]})}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${x==="performance"?"active":""}`,onClick:()=>W("performance"),children:"Évolution"}),e.jsx("button",{className:`lycans-categorie-btn ${x==="camp"?"active":""}`,onClick:()=>W("camp"),children:"Camp"}),e.jsx("button",{className:`lycans-categorie-btn ${x==="map"?"active":""}`,onClick:()=>W("map"),children:"Map"}),e.jsx("button",{className:`lycans-categorie-btn ${x==="kills"?"active":""}`,onClick:()=>W("kills"),children:"Kills"})]}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{c({selectedPlayer:n,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${n}`,children:m.totalGames}),e.jsx("p",{children:"parties jouées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{c({selectedPlayer:n,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${n}`,children:m.totalWins}),e.jsx("p",{children:"parties gagnées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",children:[m.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),x==="performance"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:u,onChange:t=>O(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"})]})]})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Évolution des Performances ",u==="month"?"par Mois":"par Session"]}),e.jsx(F,{title:`Évolution des Performances ${u==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(le,{data:D,margin:{top:20,right:30,left:20,bottom:20},onClick:t=>{if(t&&t.activeLabel){const r=D.find(a=>a.period===t.activeLabel);r&&c({selectedPlayer:n,selectedDate:r.period,fromComponent:`Évolution des Performances ${u==="month"?"par Mois":"par Session"}`})}},style:{cursor:"pointer"},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"period",angle:w.angle,textAnchor:"end",height:w.height,interval:w.interval,fontSize:w.fontSize}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.period})}),e.jsxs("div",{children:["Parties: ",a.totalGames]}),e.jsxs("div",{children:["Victoires: ",a.victories]}),e.jsxs("div",{children:["Taux: ",a.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(oe,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Répartition Victoires/Défaites ",u==="month"?"par Mois":"par Session"]}),e.jsx(F,{title:`Répartition Victoires/Défaites ${u==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:D,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"period",angle:w.angle,textAnchor:"end",height:w.height,interval:w.interval,fontSize:w.fontSize}),e.jsx($,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.period})}),e.jsxs("div",{children:["Total: ",a.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",a.victories]}),e.jsxs("div",{children:["Défaites: ",a.defeats]}),e.jsxs("div",{children:["Taux: ",a.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:D.map((t,r)=>e.jsx(k,{fill:"var(--accent-tertiary)",onClick:()=>{c({selectedPlayer:n,selectedDate:t.period,fromComponent:`Historique Joueur - Victoires ${u==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-victories-${r}`))}),e.jsx(z,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"Défaites",children:D.map((t,r)=>e.jsx(k,{fill:"var(--chart-color-4)",onClick:()=>{c({selectedPlayer:n,selectedDate:t.period,fromComponent:`Historique Joueur - Défaites ${u==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-defeats-${r}`))})]})})})})]})]})]}),x==="camp"&&e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(ce,{children:[e.jsx(de,{data:V,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:t=>{const r=t.percent!==void 0?t.percent:0;return t.name==="Autres"?`Autres : ${t.value} (${(r*100).toFixed(1)}%)`:`${t.name}: ${t.value} (${(r*100).toFixed(1)}%)`},children:V.map((t,r)=>e.jsx(k,{fill:t.name==="Autres"?B:v[t.name]||`var(--chart-color-${r%6+1})`,onClick:()=>{if(t.name==="Autres"){const a=t._details?.map(o=>o.name)||[];c({selectedPlayer:n,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:a},fromComponent:"Distribution par Camps"})}else t.name==="Traître"||t.name==="Louveteau"?c({selectedPlayer:n,campFilter:{selectedCamp:t.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):t.name==="Loup"?c({selectedPlayer:n,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):c({selectedPlayer:n,campFilter:{selectedCamp:t.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${r}`))}),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload;if(a.name==="Autres"&&a._details){const o=[...a._details].sort((s,l)=>l.value-s.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",a.value," parties (",a.percentage,"%)"]})}),e.jsx("div",{children:o.map((s,l)=>e.jsxs("div",{children:[s.name,": ",s.value," parties (",s.percentage,"%)"]},l))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[a.name," (",a.percentage,"%)"]})}),e.jsxs("div",{children:["Apparitions: ",a.value]}),e.jsxs("div",{children:["Victoires: ",a.wins," (",a.winRate,"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(F,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:N,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.name})}),e.jsxs("div",{children:["Victoires: ",a.wins," / ",a.value]}),e.jsxs("div",{children:["Taux: ",a.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"winRateDisplay",children:N.map((t,r)=>e.jsx(k,{fill:parseFloat(t.winRate)===0?`${v[t.name]||`var(--chart-color-${r%6+1})`}50`:v[t.name]||`var(--chart-color-${r%6+1})`,onClick:()=>{t.name==="Traître"||t.name==="Louveteau"?c({selectedPlayer:n,campFilter:{selectedCamp:t.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):t.name==="Loup"?c({selectedPlayer:n,campFilter:{selectedCamp:t.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):c({selectedPlayer:n,campFilter:{selectedCamp:t.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})})})]})]}),x==="kills"&&e.jsxs("div",{className:"lycans-graphiques-groupe",children:[A.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Joueurs les plus souvent tués"}),e.jsx(F,{title:"Joueurs les plus souvent tués",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:A.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.player})}),e.jsxs("div",{children:["Tué ",a.kills," fois par ",n]})]})}return null}}),e.jsx(z,{dataKey:"kills",children:A.playersKilled.map((t,r)=>e.jsx(k,{fill:j[t.player]||"var(--chart-color-3)"},`cell-killed-${r}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistré"}),e.jsxs("p",{children:[n," n'a tué aucun joueur dans les parties enregistrées."]})]}),A.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Le plus souvent tué par"}),e.jsx(F,{title:"Le plus souvent tué par",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:A.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.player})}),e.jsxs("div",{children:["A tué ",n," ",a.kills," fois"]})]})}return null}}),e.jsx(z,{dataKey:"kills",children:A.killedBy.map((t,r)=>e.jsx(k,{fill:j[t.player]||"var(--chart-color-4)"},`cell-killer-${r}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[n," n'a jamais été tué par un autre joueur dans les parties enregistrées."]})]})]}),x==="map"&&b.length>0&&e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Carte"}),e.jsx(F,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(S,{width:"100%",height:"100%",children:e.jsxs(q,{data:b,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(E,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(b.length>0){const t=b.reduce((o,s)=>o+s.value,0),r=b.reduce((o,s)=>o+s.wins,0),a=t>0?r/t*100:0;if(a!==50)return e.jsx(E,{y:a,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${a.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(R,{content:({active:t,payload:r})=>{if(t&&r&&r.length>0){const a=r[0].payload,o=[];return b.forEach(s=>{if(s.name!==a.name&&s.value>=5){const l=parseFloat(a.winRate)-parseFloat(s.winRate);Math.abs(l)>=2&&o.push({map:s.name,diff:l,better:l>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.name})}),e.jsxs("div",{children:["Parties: ",a.value]}),e.jsxs("div",{children:["Victoires: ",a.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",a.winRate,"%"]})}),o.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),o.map((s,l)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:s.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[s.better?"↗":"↘"," ",Math.abs(s.diff).toFixed(1),"% vs ",s.map]},l))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(z,{dataKey:"winRateDisplay",label:t=>{const{name:r,x:a,y:o,width:s}=t;if(a===void 0||o===void 0||s===void 0)return null;const l=b.find(f=>f.name===r)?.winRate||"0";return e.jsxs("text",{x:a+s/2,y:o-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[l,"%"]})},onClick:t=>{t&&t.name&&c({selectedPlayer:n,selectedMapName:t.name,fromComponent:"Performance par Carte"})},children:b.map((t,r)=>{let a;t.name==="Village"?a="var(--accent-secondary)":t.name==="Château"?a="var(--accent-tertiary)":t.name==="Autres"?a=B:a=`var(--chart-color-${r%6+1})`;const o=Math.max(...b.map(l=>parseFloat(l.winRate))),s=parseFloat(t.winRate)===o&&o>0;return e.jsx(k,{fill:parseFloat(t.winRate)===0?`${a}30`:a,stroke:"transparent",strokeWidth:s?3:1,style:{cursor:"pointer"}},`cell-map-${r}`)})})]})})})})]})}),x==="map"&&b.length===0&&e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnée de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée d'historique disponible"})}export{De as PlayerGameHistoryChart};
