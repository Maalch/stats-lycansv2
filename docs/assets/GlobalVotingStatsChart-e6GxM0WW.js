import{r as m,j as e}from"./index-CRVotvbE.js";import{u as R}from"./baseStatsHook-B0G-DkG5.js";import{b as S}from"./votingStatsUtils-R1FdFJ3a.js";import{F as p,C as x,X as u,Y as g}from"./FullscreenChart-CvK6X1_C.js";import{b as V}from"./api-BHqP4DlK.js";import{R as y,T as h}from"./CategoricalChart-I4QsiQeR.js";import{L as F,a as l}from"./LineChart-DfsmN5pZ.js";import{L as v}from"./Legend-8O679eCR.js";import{B as k,a as f}from"./BarChart-DqFoxfsr.js";import"./datasyncExport-BirWLS1z.js";import"./deathTypes-gHH1w6_X.js";import"./ActivePoints-CbVZDtmW.js";function C(){return R(r=>{if(!r||r.length===0)return null;const s=r.filter(n=>n.PlayerStats.some(a=>a.Votes&&a.Votes.length>0));return s.length===0?null:S(s)})}function w(){const{data:r,isLoading:s,error:n}=C(),a=V(),j=m.useMemo(()=>r?.meetingDayStats?r.meetingDayStats.map(t=>({...t,meetingLabel:`Meeting ${t.meetingDay}`,votingRate:parseFloat(t.averageVotingRate.toFixed(1)),skipRate:parseFloat(t.averageSkipRate.toFixed(1)),abstentionRate:parseFloat(t.averageAbstentionRate.toFixed(1))})):[],[r]),b=m.useMemo(()=>{if(!r?.campVotingStats)return[];const t=["Villageois","Loup"];return r.campVotingStats.filter(o=>t.includes(o.campName)).map(o=>({camp:o.campName,accuracyRate:parseFloat(o.accuracyRate.toFixed(1)),friendlyFireRate:parseFloat(o.friendlyFireRate.toFixed(1)),totalVotes:o.totalVotes}))},[r]);return s?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Chargement des statistiques de vote..."}):n?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-error)"},children:["Erreur lors du chargement : ",n]}):r?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem",padding:"1rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsx(i,{title:"Meetings Totaux",value:r.totalMeetings,color:a.Villageois}),e.jsx(i,{title:"Votes Totaux",value:r.totalVotes,color:a.Loup}),e.jsx(i,{title:"Passes Totales",value:r.totalSkips,color:"#FF9800"}),e.jsx(i,{title:"Non-Votes Totaux",value:r.totalAbstentions,color:"#9E9E9E"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsx(i,{title:"Taux de Vote Moyen",value:`${r.averageVotingRate.toFixed(1)}%`,color:a.Villageois,subtitle:"% de joueurs votant activement"}),e.jsx(i,{title:"Taux de Passe Moyen",value:`${r.averageSkipRate.toFixed(1)}%`,color:"#FF9800",subtitle:"% de joueurs passant"}),e.jsx(i,{title:"Taux de Non-Vote Moyen",value:`${r.averageAbstentionRate.toFixed(1)}%`,color:"#9E9E9E",subtitle:"% de joueurs ne participant pas"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"üìÖ √âvolution des Comportements par Jour de Meeting"})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:"Tendance moyenne des comportements de vote au fil des meetings successifs d'une partie: activit√© de vote, passes et non-votes."}),e.jsx(p,{title:"√âvolution des Comportements par Jour de Meeting",children:e.jsx(y,{width:"100%",height:400,children:e.jsxs(F,{data:j,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"var(--chart-grid)"}),e.jsx(u,{dataKey:"meetingLabel",angle:-45,textAnchor:"end",height:100,stroke:"var(--text-secondary)"}),e.jsx(g,{label:{value:"Taux (%)",angle:-90,position:"insideLeft"},stroke:"var(--text-secondary)"}),e.jsx(h,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"10px",color:"var(--text-primary)"},labelStyle:{color:"var(--text-primary)",fontWeight:"bold"},itemStyle:{color:"var(--text-primary)"},formatter:t=>{const o=typeof t=="number"?t:Number(t);return Number.isNaN(o)?`${t}%`:`${o.toFixed(1)}%`}}),e.jsx(v,{wrapperStyle:{paddingTop:"20px"},iconType:"line"}),e.jsx(l,{type:"monotone",dataKey:"votingRate",name:"Taux de Vote",stroke:a.Villageois,strokeWidth:2,dot:{r:4},activeDot:{r:6}}),e.jsx(l,{type:"monotone",dataKey:"skipRate",name:"Taux de Passe",stroke:"#FF9800",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),e.jsx(l,{type:"monotone",dataKey:"abstentionRate",name:"Taux de Non-Vote",stroke:"#9E9E9E",strokeWidth:2,dot:{r:4},activeDot:{r:6}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"üõ°Ô∏è Pr√©cision de Vote par Camp"})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:'Pourcentage moyen de votes dirig√©s contre un camp adverse compar√© au taux de "tir alli√©" (votes contre son propre camp) pour chaque camp.'}),e.jsx(p,{title:"Pr√©cision de Vote par Camp",children:e.jsx(y,{width:"100%",height:400,children:e.jsxs(k,{data:b,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"var(--chart-grid)"}),e.jsx(u,{dataKey:"camp",angle:-45,textAnchor:"end",height:100,stroke:"var(--text-secondary)"}),e.jsx(g,{label:{value:"Taux (%)",angle:-90,position:"insideLeft"},stroke:"var(--text-secondary)"}),e.jsx(h,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"10px",color:"var(--text-primary)"},labelStyle:{color:"var(--text-primary)",fontWeight:"bold"},itemStyle:{color:"var(--text-primary)"},formatter:(t,o)=>{const d=typeof t=="number"?t:Number(t),c=o==="accuracyRate"?"Vote Camp Oppos√©":"Tir Alli√©";return Number.isNaN(d)?[`${t}%`,c]:[`${d.toFixed(1)}%`,c]}}),e.jsx(v,{wrapperStyle:{paddingTop:"20px"},formatter:t=>t==="accuracyRate"?"Vote Camp Oppos√©":t==="friendlyFireRate"?"Tir Alli√©":t}),e.jsx(f,{dataKey:"accuracyRate",name:"accuracyRate",fill:a.Villageois,radius:[8,8,0,0]}),e.jsx(f,{dataKey:"friendlyFireRate",name:"friendlyFireRate",fill:a.Loup,radius:[8,8,0,0]})]})})})]})]}):e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Aucune donn√©e de vote disponible"})}function i({title:r,value:s,color:n,subtitle:a}){return e.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--background-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginBottom:"0.5rem"},children:r}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:n,marginBottom:a?"0.25rem":"0"},children:s}),a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",fontStyle:"italic"},children:a})]})}export{w as GlobalVotingStatsChart};
