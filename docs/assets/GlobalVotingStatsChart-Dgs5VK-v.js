import{r as d,j as e}from"./index-Cda3yNwj.js";import{u as b}from"./baseStatsHook-BXKZ7Et5.js";import{a as R}from"./votingStatsUtils-zRGhjDdO.js";import{F as c,C as m,X as p,Y as x}from"./FullscreenChart-D1JI6UZQ.js";import{a as S}from"./api-9EQCjivi.js";import{R as u,T as g}from"./CategoricalChart-CgjhO7c-.js";import{L as F,a as l}from"./LineChart-CGLIcDnR.js";import{L as y}from"./Legend-DfG-0hiI.js";import{B as V,a as v}from"./BarChart-rUy-BGfr.js";import"./datasyncExport-CjB7UYqV.js";import"./deathTypes-gHH1w6_X.js";import"./ActivePoints-Jdk5txHo.js";function k(){return b(t=>{if(!t||t.length===0)return null;const s=t.filter(n=>n.PlayerStats.some(a=>a.Votes&&a.Votes.length>0));return s.length===0?null:R(s)})}function w(){const{data:t,isLoading:s,error:n}=k(),a=S(),h=d.useMemo(()=>t?.meetingDayStats?t.meetingDayStats.map(r=>({...r,meetingLabel:`Meeting ${r.meetingDay}`,votingRate:parseFloat(r.averageVotingRate.toFixed(1)),skipRate:parseFloat(r.averageSkipRate.toFixed(1)),abstentionRate:parseFloat(r.averageAbstentionRate.toFixed(1))})):[],[t]),f=d.useMemo(()=>{if(!t?.campVotingStats)return[];const r=["Villageois","Loup"];return t.campVotingStats.filter(o=>r.includes(o.campName)).map(o=>({camp:o.campName,accuracyRate:parseFloat(o.accuracyRate.toFixed(1)),friendlyFireRate:parseFloat(o.friendlyFireRate.toFixed(1)),totalVotes:o.totalVotes}))},[t]);return s?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Chargement des statistiques de vote..."}):n?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--color-error)"},children:["Erreur lors du chargement : ",n]}):t?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2rem",padding:"1rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsx(i,{title:"Meetings Totales",value:t.totalMeetings,color:a.Villageois}),e.jsx(i,{title:"Votes Totaux",value:t.totalVotes,color:a.Loup}),e.jsx(i,{title:"Passes Totales",value:t.totalSkips,color:"#FF9800"}),e.jsx(i,{title:"Non-Votes Totaux",value:t.totalAbstentions,color:"#9E9E9E"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsx(i,{title:"Taux de Vote Moyen",value:`${t.averageVotingRate.toFixed(1)}%`,color:a.Villageois,subtitle:"% de joueurs votant activement"}),e.jsx(i,{title:"Taux de Passe Moyen",value:`${t.averageSkipRate.toFixed(1)}%`,color:"#FF9800",subtitle:"% de joueurs passant"}),e.jsx(i,{title:"Taux de Non-Vote Moyen",value:`${t.averageAbstentionRate.toFixed(1)}%`,color:"#9E9E9E",subtitle:"% de joueurs ne participant pas"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"üìÖ √âvolution des Comportements par Jour de Meeting"})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:"Tendance moyenne des comportements de vote au fil des meetings successifs d'une partie: activit√© de vote, passes et non-votes."}),e.jsx(c,{title:"√âvolution des Comportements par Jour de Meeting",children:e.jsx(u,{width:"100%",height:400,children:e.jsxs(F,{data:h,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(m,{strokeDasharray:"3 3",stroke:"var(--chart-grid)"}),e.jsx(p,{dataKey:"meetingLabel",angle:-45,textAnchor:"end",height:100,stroke:"var(--text-secondary)"}),e.jsx(x,{label:{value:"Taux (%)",angle:-90,position:"insideLeft"},stroke:"var(--text-secondary)"}),e.jsx(g,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"10px",color:"var(--text-primary)"},labelStyle:{color:"var(--text-primary)",fontWeight:"bold"},itemStyle:{color:"var(--text-primary)"},formatter:r=>`${r.toFixed(1)}%`}),e.jsx(y,{wrapperStyle:{paddingTop:"20px"},iconType:"line"}),e.jsx(l,{type:"monotone",dataKey:"votingRate",name:"Taux de Vote",stroke:a.Villageois,strokeWidth:2,dot:{r:4},activeDot:{r:6}}),e.jsx(l,{type:"monotone",dataKey:"skipRate",name:"Taux de Passe",stroke:"#FF9800",strokeWidth:2,dot:{r:4},activeDot:{r:6}}),e.jsx(l,{type:"monotone",dataKey:"abstentionRate",name:"Taux de Non-Vote",stroke:"#9E9E9E",strokeWidth:2,dot:{r:4},activeDot:{r:6}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("div",{children:e.jsx("h3",{children:"üõ°Ô∏è Pr√©cision de Vote par Camp"})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",textAlign:"center",marginBottom:"1rem"},children:'Pourcentage moyen de votes dirig√©s contre un camp adverse compar√© au taux de "tir alli√©" (votes contre son propre camp) pour chaque camp.'}),e.jsx(c,{title:"Pr√©cision de Vote par Camp",children:e.jsx(u,{width:"100%",height:400,children:e.jsxs(V,{data:f,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(m,{strokeDasharray:"3 3",stroke:"var(--chart-grid)"}),e.jsx(p,{dataKey:"camp",angle:-45,textAnchor:"end",height:100,stroke:"var(--text-secondary)"}),e.jsx(x,{label:{value:"Taux (%)",angle:-90,position:"insideLeft"},stroke:"var(--text-secondary)"}),e.jsx(g,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"10px",color:"var(--text-primary)"},labelStyle:{color:"var(--text-primary)",fontWeight:"bold"},itemStyle:{color:"var(--text-primary)"},formatter:(r,o)=>{const j=o==="accuracyRate"?"Vote Camp Oppos√©":"Tir Alli√©";return[`${r.toFixed(1)}%`,j]}}),e.jsx(y,{wrapperStyle:{paddingTop:"20px"},formatter:r=>r==="accuracyRate"?"Vote Camp Oppos√©":r==="friendlyFireRate"?"Tir Alli√©":r}),e.jsx(v,{dataKey:"accuracyRate",name:"accuracyRate",fill:a.Villageois,radius:[8,8,0,0]}),e.jsx(v,{dataKey:"friendlyFireRate",name:"friendlyFireRate",fill:a.Loup,radius:[8,8,0,0]})]})})})]})]}):e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Aucune donn√©e de vote disponible"})}function i({title:t,value:s,color:n,subtitle:a}){return e.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"var(--background-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginBottom:"0.5rem"},children:t}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:n,marginBottom:a?"0.25rem":"0"},children:s}),a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",fontStyle:"italic"},children:a})]})}export{w as GlobalVotingStatsChart};
