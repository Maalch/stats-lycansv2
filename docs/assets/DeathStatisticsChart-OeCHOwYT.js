import{u as ue,r as V,c as pe,a as ye,j as e}from"./index-CSZAeSSc.js";import{u as se}from"./baseStatsHook-DmWk4u8p.js";import{g as C}from"./gameUtils-Ch4K7k0-.js";import{F as U,B as z,C as G,X as w,Y as q,a as $}from"./FullscreenChart-DhgrrTWK.js";import{a as ve,m as re}from"./api-DJ9h34ie.js";import{R as Z,T as X}from"./CategoricalChart-Kb8idueg.js";const r={SURVIVOR:"SURVIVOR",VOTE:"VOTE",WEREWOLF_KILL:"WEREWOLF_KILL",HUNTER_SHOT:"HUNTER_SHOT",BOUNTY_HUNTER:"BOUNTY_HUNTER",LOVER_DEATH:"LOVER_DEATH",LOVER_WEREWOLF:"LOVER_WEREWOLF",BEAST_KILL:"BEAST_KILL",ASSASSIN_POTION:"ASSASSIN_POTION",HAUNTED_POTION:"HAUNTED_POTION",ZOMBIE_KILL:"ZOMBIE_KILL",RESURRECTED_WEREWOLF:"RESURRECTED_WEREWOLF",AVENGER_KILL:"AVENGER_KILL",AGENT_KILL:"AGENT_KILL",SHERIFF_KILL:"SHERIFF_KILL",EXPLOSION:"EXPLOSION",CRUSHED:"CRUSHED",STARVATION:"STARVATION",FALL_DEATH:"FALL_DEATH",BESTIAL_DEATH:"BESTIAL_DEATH",AVATAR_DEATH:"AVATAR_DEATH",DISCONNECT:"DISCONNECT",UNKNOWN:"UNKNOWN"};function xe(v){const n=new Set;v.filter(E=>!E.LegacyData||E.LegacyData.deathInformationFilled===!0).forEach(E=>{E.PlayerStats.forEach(H=>{const A=C(H.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});n.add(A)})});const s=Array.from(n),S=["Villageois","Loup","Amoureux"];return[...S.filter(E=>s.includes(E)),...s.filter(E=>!S.includes(E)).sort()]}function M(v){if(!v||v==="N/A")return r.SURVIVOR;const n=v.trim().toLowerCase();if(n.includes("vote"))return r.VOTE;if(n.includes("tué par loup")||n.includes("tué par un loup")||n.includes("tué par loup ressuscité"))return n.includes("ressuscité")?r.RESURRECTED_WEREWOLF:r.WEREWOLF_KILL;if(n.includes("amoureux")||n.includes("son amoureux"))return n.includes("tué par loup amoureux")?r.LOVER_WEREWOLF:r.LOVER_DEATH;if(n.includes("chasseur")||n.includes("balle"))return n.includes("primes")?r.BOUNTY_HUNTER:r.HUNTER_SHOT;if(n.includes("potion")){if(n.includes("assassin"))return r.ASSASSIN_POTION;if(n.includes("hanté"))return r.HAUNTED_POTION}return n.includes("la bête")?r.BEAST_KILL:n.includes("zombie")?r.ZOMBIE_KILL:n.includes("vengeur")?r.AVENGER_KILL:n.includes("l'agent")?r.AGENT_KILL:n.includes("shérif")?r.SHERIFF_KILL:n.includes("explosé")?r.EXPLOSION:n.includes("écrasé")?r.CRUSHED:n.includes("faim")?r.STARVATION:n.includes("chute")?r.FALL_DEATH:n.includes("bestiale")?r.BESTIAL_DEATH:n.includes("avatar")?r.AVATAR_DEATH:n==="déco"?r.DISCONNECT:r.UNKNOWN}function ae(v){switch(v){case r.SURVIVOR:return"Survivant";case r.VOTE:return"Mort aux votes";case r.WEREWOLF_KILL:return"Tué par un loup";case r.HUNTER_SHOT:return"Abattu par un chasseur";case r.BOUNTY_HUNTER:return"Tué par un chasseur de primes";case r.LOVER_DEATH:return"Mort par amoureux";case r.LOVER_WEREWOLF:return"Tué par son amoureux loup";case r.BEAST_KILL:return"Dévoré par la Bête";case r.ASSASSIN_POTION:return"Tué par une potion (Assassin)";case r.HAUNTED_POTION:return"Tué par une potion (Hanté)";case r.ZOMBIE_KILL:return"Tué par un zombie";case r.RESURRECTED_WEREWOLF:return"Tué par un loup ressuscité";case r.AVENGER_KILL:return"Tué par un vengeur";case r.AGENT_KILL:return"Éliminé par l'Agent";case r.SHERIFF_KILL:return"Abattu par le Shérif";case r.EXPLOSION:return"Mort dans une explosion";case r.CRUSHED:return"Écrasé";case r.STARVATION:return"Mort de faim";case r.FALL_DEATH:return"Mort de chute";case r.BESTIAL_DEATH:return"Mort bestiale";case r.AVATAR_DEATH:return"Mort liée à l'Avatar";case r.DISCONNECT:return"Déconnexion";case r.UNKNOWN:default:return"Mort inconnue"}}function ie(v){switch(v){case r.SURVIVOR:return"Survivant";case r.VOTE:return"Mort aux votes";case r.WEREWOLF_KILL:return"Kill en Loup";case r.HUNTER_SHOT:return"Tir de Chasseur";case r.BOUNTY_HUNTER:return"Kill en Chasseur de primes";case r.LOVER_DEATH:return"Kill de son amoureux";case r.LOVER_WEREWOLF:return"Kill en Loup amoureux";case r.BEAST_KILL:return"Kill en Bête";case r.ASSASSIN_POTION:return"Kill avec Potion (Assassin)";case r.HAUNTED_POTION:return"Kill avec Potion (Hanté)";case r.ZOMBIE_KILL:return"Kill en Zombie";case r.RESURRECTED_WEREWOLF:return"Kill en Loup ressuscité";case r.AVENGER_KILL:return"Kill en Vengeur";case r.AGENT_KILL:return"Kill en Agent";case r.SHERIFF_KILL:return"Kill en Shérif";case r.EXPLOSION:return"Explosion";case r.CRUSHED:return"Écrasement";case r.STARVATION:return"Famine";case r.FALL_DEATH:return"Chute mortelle";case r.BESTIAL_DEATH:return"Tuerie bestiale";case r.AVATAR_DEATH:return"Mort d'Avatar";case r.DISCONNECT:return"Déconnexion";case r.UNKNOWN:default:return"Kill inconnu"}}function fe(v){const n=new Set;v.forEach(S=>{S.PlayerStats.forEach(u=>{if(u.DeathType){const E=M(u.DeathType);n.add(E)}})});const T=Array.from(n),s=[r.WEREWOLF_KILL,r.VOTE,r.HUNTER_SHOT,r.ZOMBIE_KILL,r.ASSASSIN_POTION,r.HAUNTED_POTION,r.AVENGER_KILL,r.LOVER_DEATH,r.SURVIVOR];return[...s.filter(S=>T.includes(S)),...T.filter(S=>!s.includes(S)).sort()]}function Te(v,n){const T=[];return v.PlayerStats.forEach(s=>{if(!s.KilledNames||s.KilledNames.length===0)return;const S=C(s.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});n&&n!=="Tous les camps"&&S!==n||s.KilledNames.forEach(u=>{const E=v.PlayerStats.find(A=>A.Username===u);if(!E||!E.DeathType)return;const H=M(E.DeathType);H!==r.SURVIVOR&&T.push({killerName:s.Username,victimName:u,deathType:H,killerCamp:S})})}),T}function Se(v,n){return v.PlayerStats.filter(T=>M(T.DeathType)!=="SURVIVOR"&&(T.DeathTiming||T.DeathType)).map(T=>{let s=null;if(T.KillerName){const u=v.PlayerStats.find(E=>E.Username===T.KillerName);u&&(s=C(u.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1}))}const S=M(T.DeathType);return{playerName:T.Username,deathType:S,killerName:T.KillerName,killerCamp:s}}).filter(T=>{if(!n||n==="Tous les camps")return!0;const s=v.PlayerStats.find(u=>u.Username===T.playerName);return s?C(s.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===n:!1})}function Ee(v,n){if(v.length===0)return null;const T=v.filter(m=>!m.LegacyData||m.LegacyData.deathInformationFilled===!0);if(T.length===0)return null;const s=[],S={};T.forEach(m=>{Se(m,n).forEach(D=>{s.push({...D,gameId:m.Id})}),m.PlayerStats.forEach(D=>{const B=D.Username;(!n||n==="Tous les camps"||C(D.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===n)&&(S[B]=(S[B]||0)+1)})});const u=s.length,E=T.length,H=E>0?u/E:0,A={};s.forEach(m=>{A[m.deathType]=(A[m.deathType]||0)+1});const W=Object.entries(A).map(([m,p])=>({type:m,count:p,percentage:u>0?p/u*100:0})).sort((m,p)=>p.count-m.count),K={};T.forEach(m=>{Te(m,n).forEach(D=>{K[D.killerName]||(K[D.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),K[D.killerName].kills++,K[D.killerName].victims.add(D.victimName),K[D.killerName].killsByDeathType[D.deathType]=(K[D.killerName].killsByDeathType[D.deathType]||0)+1})});const _=Object.entries(K).map(([m,p])=>{const D=S[m]||0,B=D>0?p.kills/D:0;return{killerName:m,kills:p.kills,victims:Array.from(p.victims),percentage:u>0?p.kills/u*100:0,gamesPlayed:D,averageKillsPerGame:B,killsByDeathType:p.killsByDeathType}}).sort((m,p)=>p.kills-m.kills),o={};s.forEach(m=>{o[m.playerName]||(o[m.playerName]={totalDeaths:0,deathsByType:{},killedBy:{},deathDays:[]});const p=o[m.playerName];p.totalDeaths++,p.deathsByType[m.deathType]=(p.deathsByType[m.deathType]||0)+1,m.killerName&&(p.killedBy[m.killerName]=(p.killedBy[m.killerName]||0)+1)});const F=Object.entries(o).map(([m,p])=>({playerName:m,totalDeaths:p.totalDeaths,deathsByType:p.deathsByType,killedBy:p.killedBy,averageDeathDay:p.deathDays.length>0?p.deathDays.reduce((D,B)=>D+B,0)/p.deathDays.length:null,deathRate:S[m]>0?p.totalDeaths/S[m]:0})).sort((m,p)=>p.totalDeaths-m.totalDeaths),f=W.length>0?W[0].type:null,b=_.length>0?_[0].killerName:null;return{totalDeaths:u,totalGames:E,averageDeathsPerGame:H,deathsByType:W,killerStats:_,playerDeathStats:F,mostCommonDeathType:f,mostDeadlyKiller:b}}function Ae(v){return se(n=>Ee(n,v))}function De(){return se(v=>xe(v))}function be(){const{navigateToGameDetails:v,navigationState:n,updateNavigationState:T}=ue(),[s,S]=V.useState(n.deathStatsSelectedCamp||"Tous les camps"),[u,E]=V.useState(5),{data:H}=De(),{data:A,isLoading:W,error:K}=Ae(s),{data:_}=pe(),{settings:o}=ye(),F=ve(),f=V.useMemo(()=>_?fe(_.GameStats):[],[_]),b=V.useMemo(()=>{const t={};f.forEach(a=>{a==="WEREWOLF_KILL"?t[a]=F.Loup:a==="VOTE"?t[a]="var(--chart-color-1)":a==="HUNTER_SHOT"?t[a]=F.Chasseur:a==="ZOMBIE_KILL"?t[a]=F.Vaudou:a==="ASSASSIN_POTION"||a==="HAUNTED_POTION"?t[a]=F.Alchimiste:a==="AVENGER_KILL"?t[a]="var(--chart-color-2)":a==="LOVER_DEATH"||a==="LOVER_WEREWOLF"?t[a]=F.Amoureux:a==="DISCONNECT"?t[a]="var(--chart-color-3)":a==="SURVIVOR"&&(t[a]="var(--chart-color-4)")});const d=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let c=0;return f.forEach(a=>{t[a]||(t[a]=d[c%d.length],c++)}),t},[f,F]),m=t=>{S(t),T({deathStatsSelectedCamp:t})},{totalKillsData:p,averageKillsData:D,highlightedPlayerAddedToTotal:B,highlightedPlayerAddedToAverage:Q,gamesWithKillers:le,totalEligibleForAverage:ne}=V.useMemo(()=>{if(!A)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1,gamesWithKillers:0,totalEligibleForAverage:0};const t=A.killerStats.sort((l,y)=>y.kills-l.kills).slice(0,15),d=o.highlightedPlayer&&t.some(l=>l.killerName===o.highlightedPlayer),c=t.map(l=>{const y={name:l.killerName,value:l.kills,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!1};return f.forEach(R=>{y[R]=l.killsByDeathType[R]||0}),y});let a=!1;if(o.highlightedPlayer&&!d){const l=A.killerStats.find(y=>y.killerName===o.highlightedPlayer);if(l){const y={name:l.killerName,value:l.kills,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!0};f.forEach(R=>{y[R]=l.killsByDeathType[R]||0}),c.push(y),a=!0}}const j=A.killerStats.filter(l=>l.gamesPlayed>=u),L=j.sort((l,y)=>y.averageKillsPerGame-l.averageKillsPerGame).slice(0,15),O=o.highlightedPlayer&&L.some(l=>l.killerName===o.highlightedPlayer),g=L.map(l=>{const y={name:l.killerName,value:l.averageKillsPerGame,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!1};return f.forEach(R=>{const k=l.killsByDeathType[R]||0;y[R]=l.gamesPlayed>0?k/l.gamesPlayed:0}),y});let N=!1;if(o.highlightedPlayer&&!O){const l=A.killerStats.find(y=>y.killerName===o.highlightedPlayer);if(l){const y={name:l.killerName,value:l.averageKillsPerGame,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!0};f.forEach(R=>{const k=l.killsByDeathType[R]||0;y[R]=l.gamesPlayed>0?k/l.gamesPlayed:0}),g.push(y),N=!0}}return{totalKillsData:c,averageKillsData:g,highlightedPlayerAddedToTotal:a,highlightedPlayerAddedToAverage:N,gamesWithKillers:A.totalGames,totalEligibleForAverage:j.length}},[A,o.highlightedPlayer,u,f]),{totalDeathsData:ee,survivalRateData:te,highlightedPlayerAddedToDeaths:oe,highlightedPlayerAddedToSurvival:ce}=V.useMemo(()=>{if(!A||!_)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const t={},d=_.GameStats.filter(i=>!i.LegacyData||i.LegacyData.deathInformationFilled===!0);d.forEach(i=>{i.PlayerStats.forEach(h=>{const x=h.Username;(!s||s==="Tous les camps"||C(h.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!0})===s)&&(t[x]=(t[x]||0)+1)})});const c=A.playerDeathStats.sort((i,h)=>h.totalDeaths-i.totalDeaths).slice(0,15),a=o.highlightedPlayer&&c.some(i=>i.playerName===o.highlightedPlayer),j=c.map(i=>{const h=t[i.playerName]||0,x=h>0?(h-i.totalDeaths)/h*100:0,P={name:i.playerName,value:i.totalDeaths,totalDeaths:i.totalDeaths,gamesPlayed:h,deathRate:i.deathRate,survivalRate:x,isHighlightedAddition:!1};return f.forEach(I=>{P[I]=i.deathsByType[I]||0}),P});let L=!1;if(o.highlightedPlayer&&!a){const i=A.playerDeathStats.find(h=>h.playerName===o.highlightedPlayer);if(i){const h=t[i.playerName]||0,x=h>0?(h-i.totalDeaths)/h*100:0,P={name:i.playerName,value:i.totalDeaths,totalDeaths:i.totalDeaths,gamesPlayed:h,deathRate:i.deathRate,survivalRate:x,isHighlightedAddition:!0};f.forEach(I=>{P[I]=i.deathsByType[I]||0}),j.push(P),L=!0}}const O={},g={};d.forEach(i=>{i.PlayerStats.forEach(h=>{const x=h.Username;if((!s||s==="Tous les camps"||C(h.MainRoleFinal,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!0})===s)&&h.DeathType&&h.DeathType!=="N/A"){g[x]||(g[x]={totalDeaths:0,deathsByType:{}}),g[x].totalDeaths++;const I=M(h.DeathType);g[x].deathsByType[I]=(g[x].deathsByType[I]||0)+1}})}),Object.entries(t).forEach(([i,h])=>{if(h>=u){const x=g[i],P=x?x.totalDeaths:0,I=x?x.deathsByType:{},Y=h>0?(h-P)/h*100:0,J=h>0?P/h:0;O[i]={playerName:i,totalDeaths:P,deathsByType:I,gamesPlayed:h,survivalRate:Y,deathRate:J}}});const l=Object.values(O).sort((i,h)=>h.survivalRate-i.survivalRate).slice(0,15),y=o.highlightedPlayer&&l.some(i=>i.playerName===o.highlightedPlayer),R=l.map(i=>{const h={name:i.playerName,value:i.survivalRate,totalDeaths:i.totalDeaths,gamesPlayed:i.gamesPlayed,deathRate:i.deathRate,survivalRate:i.survivalRate,isHighlightedAddition:!1};return f.forEach(x=>{const P=i.deathsByType[x]||0;h[x]=i.gamesPlayed>0?P/i.gamesPlayed*100:0}),h});let k=!1;if(o.highlightedPlayer&&!y){let i=O[o.highlightedPlayer];if(!i){const h=t[o.highlightedPlayer]||0,x=g[o.highlightedPlayer],P=x?x.totalDeaths:0,I=x?x.deathsByType:{},Y=h>0?(h-P)/h*100:0,J=h>0?P/h:0;i={playerName:o.highlightedPlayer,totalDeaths:P,deathsByType:I,gamesPlayed:h,survivalRate:Y,deathRate:J}}if(i){const h={name:i.playerName,value:i.survivalRate,totalDeaths:i.totalDeaths,gamesPlayed:i.gamesPlayed,deathRate:i.deathRate,survivalRate:i.survivalRate,isHighlightedAddition:!0};f.forEach(x=>{const P=i.deathsByType[x]||0;h[x]=i.gamesPlayed>0?P/i.gamesPlayed*100:0}),R.push(h),k=!0}}return{totalDeathsData:j,survivalRateData:R,highlightedPlayerAddedToDeaths:L,highlightedPlayerAddedToSurvival:k}},[A,_,o.highlightedPlayer,u,f,s]);if(W)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."});if(K)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",K]});if(!A)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"});const he=({active:t,payload:d,label:c})=>{if(t&&d&&d.length){const a=d[0].payload,j=a.isHighlightedAddition,L=o.highlightedPlayer===a.name,O=f.reduce((g,N)=>g+(a[N]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:L?"var(--accent-primary)":"var(--text-primary)"},children:[c,j&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",O]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",a.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),f.map(g=>{const N=a[g]||0;return N===0?null:e.jsxs("p",{style:{color:b[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:b[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ie(g),":"]})," ",N]},g)})]}),j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),L&&!j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},de=({active:t,payload:d,label:c})=>{if(t&&d&&d.length){const a=d[0].payload,j=a.isHighlightedAddition,L=o.highlightedPlayer===a.name,O=a.gamesPlayed>=u,g=A?.killerStats.find(y=>y.killerName===a.name),N=f.reduce((y,R)=>y+(a[R]||0),0),l=g?g.kills:Math.round(N*a.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:L?"var(--accent-primary)":"var(--text-primary)"},children:[c,j&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",N.toFixed(2)," (",l," kills /",a.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",a.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),f.map(y=>{const R=a[y]||0;if(R===0)return null;const k=g?g.killsByDeathType[y]||0:Math.round(R*a.gamesPlayed);return e.jsxs("p",{style:{color:b[y],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:b[y],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ie(y),":"]})," ",R.toFixed(2)," (",k," kills /",a.gamesPlayed," games)"]},y)})]}),j&&!O&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",u," parties)"]}),j&&O&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),L&&!j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},me=({active:t,payload:d,label:c})=>{if(t&&d&&d.length){const a=d[0].payload,j=a.isHighlightedAddition,L=o.highlightedPlayer===a.name,O=f.reduce((g,N)=>g+(a[N]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:L?"var(--accent-primary)":"var(--text-primary)"},children:[c,j&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",O]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",a.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",a.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),f.map(g=>{const N=a[g]||0;return N===0?null:e.jsxs("p",{style:{color:b[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:b[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ae(g),":"]})," ",N]},g)})]}),j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),L&&!j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},ge=({active:t,payload:d,label:c})=>{if(t&&d&&d.length){const a=d[0].payload,j=a.isHighlightedAddition,L=o.highlightedPlayer===a.name,O=a.gamesPlayed>=u;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:L?"var(--accent-primary)":"var(--text-primary)"},children:[c,j&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",a.survivalRate.toFixed(1),"% (",a.gamesPlayed-a.totalDeaths," survies / ",a.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",a.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",a.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),f.map(g=>{const N=a[g]||0;return N===0?null:e.jsxs("p",{style:{color:b[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:b[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ae(g),":"]})," ",N.toFixed(1),"%"]},g)})]}),j&&!O&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",u," parties)"]}),j&&O&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),L&&!j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:s,onChange:t=>m(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),H?.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:A.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:A.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:le})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:s==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${s} (Total)`}),B&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(U,{title:s==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${s} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(z,{data:p,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:c})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:o.highlightedPlayer===c.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===c.value?14:13,fontWeight:o.highlightedPlayer===c.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:c.value})}),e.jsx(q,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(he,{})}),f.map(t=>e.jsx($,{dataKey:t,name:t,stackId:"kills",fill:b[t],onClick:d=>{const c={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};s!=="Tous les camps"&&(c.campFilter={selectedCamp:s,campFilterMode:"all-assignments"}),v(c)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,p.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:s==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${s} (Moyenne par partie)`}),Q&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:u,onChange:t=>E(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:re.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(U,{title:s==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${s} (Moyenne par partie)`,children:e.jsx("div",{style:{height:400},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(z,{data:D,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:c})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:o.highlightedPlayer===c.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===c.value?14:13,fontWeight:o.highlightedPlayer===c.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:c.value})}),e.jsx(q,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(de,{})}),f.map(t=>e.jsx($,{dataKey:t,name:t,stackId:"averageKills",fill:b[t],onClick:d=>{const c={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};s!=="Tous les camps"&&(c.campFilter={selectedCamp:s,campFilterMode:"all-assignments"}),v(c)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,D.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",ne," ayant au moins ",u," partie",u>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:s==="Tous les camps"?"Morts (Total)":`Morts en ${s} (Total)`}),oe&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(U,{title:s==="Tous les camps"?"Morts (Total)":`Morts en ${s} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(z,{data:ee,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:c})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:o.highlightedPlayer===c.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===c.value?14:13,fontWeight:o.highlightedPlayer===c.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:c.value})}),e.jsx(q,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(me,{})}),f.map(t=>e.jsx($,{dataKey:t,name:t,stackId:"deaths",fill:b[t],onClick:d=>{const c={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};s!=="Tous les camps"&&(c.campFilter={selectedCamp:s,campFilterMode:"all-assignments"}),v(c)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,ee.filter(t=>!t.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",s==="Tous les camps"?"(Total)":` en ${s}`]}),ce&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:u,onChange:t=>E(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:re.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(U,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(z,{data:te,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:c})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:o.highlightedPlayer===c.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===c.value?14:13,fontWeight:o.highlightedPlayer===c.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:c.value})}),e.jsx(q,{label:{value:"Taux de mort (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(ge,{})}),f.map(t=>e.jsx($,{dataKey:t,name:t,stackId:"survivalRate",fill:b[t],onClick:d=>{const c={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};s!=="Tous les camps"&&(c.campFilter={selectedCamp:s,campFilterMode:"all-assignments"}),v(c)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,te.filter(t=>!t.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",u," partie",u>1?"s":"",")"]})]})]}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]})}export{be as DeathStatisticsChart};
