import{a as B,r as k,g as Y,b as U,m as ee,u as V,j as e,d as se,n as ae}from"./index-BFqE2SDi.js";import{g as te,a as re,u as ie}from"./datasyncExport-BT3K6FYd.js";import{g as le}from"./gameUtils-DB0z7ysM.js";import{u as O}from"./useJoueursData-hYHiJD6J.js";import{u as _,g as ne,a as oe,l as X}from"./api-Dze-v7qe.js";import{F as M,C as z,X as I,Y as E,B as K,a as W,b as A}from"./FullscreenChart-BLEy3N5u.js";import{R as q,T as G}from"./CategoricalChart-BDJLMO5O.js";import{L as ce,a as de}from"./LineChart-BUEPFi5q.js";import{P as ue,a as me}from"./PieChart-DR8TV0-v.js";import{R as J}from"./ReferenceLine-DYDcf3vm.js";import"./ActivePoints-Rstme_0W.js";import"./PolarChart-B2u8Fb99.js";function pe(m){const{settings:f}=B(),[h,x]=k.useState(null),[j,p]=k.useState(!1),[d,g]=k.useState(null);k.useEffect(()=>{let t=!0;return(async()=>{try{p(!0),g(null);const n=f.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",c=await fetch(n);if(!c.ok)throw new Error(`Failed to load achievements: ${c.status} ${c.statusText}`);const o=await c.json();t&&x(o)}catch(n){t&&g(n instanceof Error?n.message:"Failed to load achievements")}finally{t&&p(!1)}})(),()=>{t=!1}},[f.dataSource]);const i=m&&h?.achievements[m]||null;return k.useEffect(()=>{if(m&&h){const t=h.achievements[m];t?console.log(`ðŸ† Achievements for ${m} (${f.dataSource}):`,{allGames:t.allGamesAchievements.length,moddedOnly:t.moddedOnlyAchievements.length,categories:[...new Set([...t.allGamesAchievements.map(r=>r.category),...t.moddedOnlyAchievements.map(r=>r.category)])]}):console.log(`âŒ No achievements found for ${m} in ${f.dataSource} data source`)}},[m,h,f.dataSource]),{data:i,isLoading:j,error:d,metadata:{generatedAt:h?.generatedAt||null,totalPlayers:h?.totalPlayers||0,totalGames:h?.totalGames||0,totalModdedGames:h?.totalModdedGames||0}}}function he(m,f){if(!m||m.trim()===""||f.length===0)return null;const h=[];let x=m;f.forEach(t=>{const r=t.PlayerStats.find(n=>Y(n)===m||n.Username.toLowerCase()===m.toLowerCase());if(r){x=U(r);const n=te(re(r.MainRoleInitial,r.MainRoleChanges||[])),c=le(t),o=r.Victorious,y=ee(new Date(t.StartDate));h.push({gameId:t.Id,date:y,camp:n,won:o,winnerCamp:c,playersInGame:t.PlayerStats.length,mapName:t.MapName})}}),h.sort((t,r)=>{const n=c=>{const o=c.split("/");return o.length===3?new Date(parseInt(o[2]),parseInt(o[1])-1,parseInt(o[0])):new Date(c)};return n(r.date).getTime()-n(t.date).getTime()});const j=h.length,p=h.filter(t=>t.won).length,d=j>0?(p/j*100).toFixed(2):"0.00",g={};h.forEach(t=>{g[t.camp]||(g[t.camp]={appearances:0,wins:0,winRate:"0.00"}),g[t.camp].appearances++,t.won&&g[t.camp].wins++}),Object.keys(g).forEach(t=>{const r=g[t];r.winRate=r.appearances>0?(r.wins/r.appearances*100).toFixed(2):"0.00"});const i={};return h.forEach(t=>{i[t.mapName]||(i[t.mapName]={appearances:0,wins:0,winRate:"0.00"}),i[t.mapName].appearances++,t.won&&i[t.mapName].wins++}),Object.keys(i).forEach(t=>{const r=i[t];r.winRate=r.appearances>0?(r.wins/r.appearances*100).toFixed(2):"0.00"}),{playerName:x,totalGames:j,totalWins:p,winRate:d,games:h,campStats:g,mapStats:i}}function ge(m){const f={};let h=0,x=0;return Object.entries(m).forEach(([j,p])=>{j==="Village"||j==="ChÃ¢teau"?f[j]={...p}:(h+=p.appearances,x+=p.wins)}),h>=10&&(f.Autres={appearances:h,wins:x,winRate:h>0?(x/h*100).toFixed(2):"0.00"}),f}function H(m){const{data:f,isLoading:h,error:x}=ie(j=>m?he(m,j):null);return{data:f,isLoading:h,error:x}}function fe({achievements:m,title:f,emptyMessage:h,achievementType:x="all"}){const{navigateToTab:j,updateNavigationState:p,clearNavigation:d}=V(),{settings:g,updateSettings:i}=B(),{joueursData:t}=O(),r=_(t),n=(s,N)=>{if(N.stopPropagation(),!s.redirectTo)return;d();const R=g.highlightedPlayer;if(i(x==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:R,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:R,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),s.category==="comparison"&&s.redirectTo.subTab==="comparison"){const a=g.highlightedPlayer||"",l=c(s.description,a);l&&p({playerComparisonState:{selectedPlayer1:a,selectedPlayer2:l,showDetailedStats:!0}})}if(s.category==="comparison"&&s.redirectTo.subTab==="pairing"){const a=s.description.toLowerCase().includes("loup");p({selectedPairingTab:a?"wolves":"lovers"})}if(s.category==="kills"&&s.redirectTo.subTab==="deathStats"){const a=s.description.match(/(Villageois|Loups|Autres)/i);a&&p({deathStatsSelectedCamp:a[1]});let l=10;const u=s.description.match(/min\.\s*(\d+)/);u&&(l=parseInt(u[1],10));let v="totalKills";const b=s.redirectTo.chartSection;b&&(b==="killers-total"?v="totalKills":b==="killers-average"?v="averageKills":b==="deaths-total"?v="totalDeaths":b==="survivors-average"&&(v="survivalRate")),p({deathStatisticsState:{selectedCamp:a?.[1]||"Tous les camps",minGamesForAverage:l,focusChart:v}})}if(s.category==="map"&&s.redirectTo.subTab==="playersGeneral"){const a=s.redirectTo.mapFilter||"all";let l=10;const u=s.description.match(/min\.\s*(\d+)/);u&&(l=parseInt(u[1])),i(x==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:a,playerFilter:{mode:"none",players:[]},highlightedPlayer:R,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:a,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:a,playerFilter:{mode:"none",players:[]},highlightedPlayer:R,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:a,playerFilter:{mode:"none",players:[]}}}),p({playersGeneralState:{minGamesForWinRate:l,winRateOrder:"best",focusChart:"winRate"}}),j("players","playersGeneral");return}if(s.category==="history"&&s.redirectTo.subTab==="history"&&p({selectedPlayerName:g.highlightedPlayer||"",groupingMethod:"session"}),s.category==="series"&&s.redirectTo.subTab==="series"){let a="wins";const l=s.title.toLowerCase(),u=s.description.toLowerCase();l.includes("dÃ©faite")||u.includes("dÃ©faite")?a="losses":l.includes("loup")||u.includes("loup")?a="loup":l.includes("villageois")||u.includes("villageois")?a="villageois":(l.includes("victoire")||u.includes("victoire"))&&(a="wins"),p({selectedSeriesType:a})}if(s.category==="general"&&s.redirectTo.subTab==="playersGeneral"){let a=10;const l=s.description.match(/min\.\s*(\d+)/);l&&(a=parseInt(l[1],10));let u="winRate",v="best";const b=s.title.toLowerCase(),P=s.description.toLowerCase();b.includes("participation")||P.includes("participation")?u="participation":(b.includes("taux de victoire")||P.includes("taux de victoire"))&&(u="winRate",(b.includes("moins bon")||b.includes("mauvais")||P.includes("moins bon")||P.includes("mauvais"))&&(v="worst")),p({playersGeneralState:{minGamesForWinRate:a,winRateOrder:v,focusChart:u}})}if(s.category==="performance"&&s.redirectTo.subTab==="campPerformance"){const a=s.redirectTo.chartSection;let l="Villageois",u=1;a&&(a==="camp-loup"?l="Loup":a==="camp-villageois"?l="Villageois":a==="camp-idiot"?l="Idiot du Village":a==="camp-amoureux"?l="Amoureux":(a==="solo-roles"||a==="hall-of-fame")&&(l="Villageois"));const v=s.description.match(/min\.\s*(\d+)/);v&&(u=parseInt(v[1],10)),a==="solo-roles"?l="RÃ´les spÃ©ciaux":a==="hall-of-fame"&&(l="Tous les camps"),p({campPerformanceState:{selectedCampPerformanceCamp:l,selectedCampPerformanceMinGames:u}})}if(s.category==="voting"&&s.redirectTo.subTab==="votingStats"){const a=s.title.toLowerCase();let l="overview",u="behavior";a.includes("agressivitÃ©")?(l="overview",u="behavior"):a.includes("taux de vote")?(l="behavior",u="voteRate"):a.includes("prÃ©cision")&&(l="overview",u="accuracy"),p({votingStatsState:{selectedCategory:l,selectedView:u}})}j(s.redirectTo.tab,s.redirectTo.subTab)},c=(s,N)=>{const R=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const a of R){const l=s.match(a);if(l&&l[1]){const u=l[1].trim();if(u!==N)return u}}return null},o=s=>{if(!s.redirectTo)return"Aucune navigation disponible";switch(s.category){case"general":if(s.redirectTo.subTab==="playersGeneral"){const a=s.description.match(/min\.\s*(\d+)/),l=a?parseInt(a[1],10):10,u=s.title.toLowerCase(),v=x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return u.includes("taux de victoire")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${l} parties)${v}`:u.includes("participation")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les participations${v}`:`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${v}`}break;case"map":if(s.redirectTo.subTab==="playersGeneral"){const a=s.redirectTo.mapFilter,l=a==="village"?"Village":a==="chateau"?"ChÃ¢teau":"map",u=x==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${l}${u}`}break;case"history":if(s.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(s.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${c(s.description,g.highlightedPlayer||"")||"ce joueur"}`;if(s.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(s.redirectTo.subTab==="deathStats"){const a=s.description.match(/(Villageois|Loups|Autres)/i),l=s.description.match(/min\.\s*(\d+)/),u=l?parseInt(l[1],10):10,v=a?.[1]||"Tous les camps",b=s.redirectTo.chartSection;let P="kills et morts";return b==="killers-total"?P="total des kills":b==="killers-average"?P=`moyenne des kills (min. ${u} parties)`:b==="deaths-total"?P="total des morts":b==="survivors-average"&&(P=`taux de survie (min. ${u} parties)`),`Cliquez pour voir les statistiques de ${P} ${v!=="Tous les camps"?`en ${v}`:""}`}break;case"series":if(s.redirectTo.subTab==="series"){const a=s.title.toLowerCase(),l=s.description.toLowerCase();return a.includes("dÃ©faite")||l.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":a.includes("loup")||l.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":a.includes("villageois")||l.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":a.includes("victoire")||l.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(s.redirectTo.subTab==="campPerformance"){const a=s.redirectTo.chartSection,l=x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return a==="camp-loup"?`Cliquez pour voir les performances camp Loup${l}`:a==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${l}`:a==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${l}`:a==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${l}`:a==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${l}`:a==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${l}`:`Cliquez pour voir les performances par camp${l}`}break;case"voting":if(s.redirectTo.subTab==="votingStats"){const a=s.description.match(/min\.\s*(\d+)/),l=a?parseInt(a[1],10):25,u=x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",v=s.title.toLowerCase();return v.includes("agressivitÃ©")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${l} meetings)${u}`:v.includes("taux de vote")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${l} meetings)${u}`:v.includes("prÃ©cision")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${u}`:`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${u}`}break}return`Cliquez pour voir ${s.redirectTo.subTab}`+(x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},y=s=>r[s]||ne(s),C=s=>{const N=[/avec ([^:]+?):/,/contre ([^:]+?):/];let R=s;return N.forEach(a=>{const l=s.match(a);if(l&&l[1]){const u=l[1].trim(),b=`<span class="player-name-highlight" style="color: ${y(u)};">${u}</span>`;R=R.replace(u,b)}}),R};if(m.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:f}),e.jsx("p",{children:h||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const w=s=>s===1?"ðŸ¥‡":s===2?"ðŸ¥ˆ":s===3?"ðŸ¥‰":"",T=s=>s===1?"rank-1":s===2?"rank-2":s===3?"rank-3":s&&s<=10?"rank-top-10":"",$=m.filter(s=>s.category!=="comparison"&&(s.type==="good"||s.type==="neutral")).sort((s,N)=>(s.rank??999)-(N.rank??999)),D=m.filter(s=>s.category!=="comparison"&&s.type==="bad").sort((s,N)=>(s.rank??999)-(N.rank??999)),S=m.filter(s=>s.category==="comparison"),F=$.filter(s=>s.rank&&s.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:f}),F>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:$.filter(s=>s.rank&&s.rank<=3).map((s,N)=>e.jsxs("div",{className:`top3-card ${T(s.rank)} animate-slide-in`,style:{animationDelay:`${N*.15}s`},onClick:R=>n(s,R),title:o(s),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:w(s.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:s.title}),e.jsx("p",{className:"top3-achievement-description",children:s.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},s.id))})]}),$.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:$.filter(s=>!s.rank||s.rank>3).map((s,N)=>e.jsxs("div",{className:`achievement-card good ${T(s.rank)}`,onClick:R=>n(s,R),title:o(s),style:{animationDelay:`${N*.05}s`},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:s.title}),e.jsxs("span",{className:"achievement-rank",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:s.description})]},s.id))})]}),D.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:D.map(s=>e.jsxs("div",{className:`achievement-card bad rank-${s.rank}`,onClick:N=>n(s,N),title:o(s),children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:s.title}),e.jsxs("span",{className:"achievement-rank",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:s.description})]},s.id))})]}),S.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:S.map(s=>e.jsxs("div",{className:"achievement-card comparison",onClick:N=>n(s,N),title:o(s),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:s.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:C(s.description)}})]},s.id))})]})]})}function xe({selectedPlayerName:m,groupingMethod:f}){const{navigateToGameDetails:h}=V(),{data:x,isLoading:j,error:p}=H(m),d=k.useMemo(()=>{switch(f){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[f]),g=k.useMemo(()=>{if(!x?.games)return new Map;const n=new Map;return x.games.forEach(c=>{if(!n.has(c.date)){const o=c.date.split("/");o.length===3?n.set(c.date,new Date(parseInt(o[2]),parseInt(o[1])-1,parseInt(o[0])).getTime()):n.set(c.date,new Date(c.date).getTime())}}),n},[x?.games]),i=k.useMemo(()=>{if(!x?.games)return[];const n={};return x.games.forEach(c=>{let o;const y=c.date.split("/");if(f==="month")if(y.length===3)o=`${y[1].padStart(2,"0")}/${y[2]}`;else{const C=new Date(c.date);o=`${String(C.getMonth()+1).padStart(2,"0")}/${C.getFullYear()}`}else if(f==="quarter")if(y.length===3){const C=parseInt(y[1],10);o=`T${Math.floor((C-1)/3)+1}/${y[2]}`}else{const C=new Date(c.date);o=`T${Math.floor(C.getMonth()/3)+1}/${C.getFullYear()}`}else f==="year"?y.length===3?o=`${y[2]}`:o=`${new Date(c.date).getFullYear()}`:o=c.date;n[o]||(n[o]={games:[],wins:0,total:0}),n[o].games.push(c),n[o].total++,c.won&&n[o].wins++}),Object.entries(n).map(([c,o])=>({period:c,totalGames:o.total,victories:o.wins,defeats:o.total-o.wins,winRate:o.total>0?(o.wins/o.total*100).toFixed(1):"0.0",winRateNum:o.total>0?o.wins/o.total*100:0})).sort((c,o)=>{if(f==="month"){const[y,C]=c.period.split("/"),[w,T]=o.period.split("/"),$=new Date(parseInt(C),parseInt(y)-1,1),D=new Date(parseInt(T),parseInt(w)-1,1);return $.getTime()-D.getTime()}else if(f==="quarter"){const[y,C]=c.period.split("/"),[w,T]=o.period.split("/"),$=parseInt(y.replace(/\D/g,""),10)||1,D=parseInt(w.replace(/\D/g,""),10)||1,S=new Date(parseInt(C,10),($-1)*3,1),F=new Date(parseInt(T,10),(D-1)*3,1);return S.getTime()-F.getTime()}else if(f==="year"){const y=parseInt(c.period,10),C=parseInt(o.period,10);return y-C}else{const y=g.get(c.period)||0,C=g.get(o.period)||0;return y-C}})},[x,f,g]),r=(n=>n<=15?{fontSize:12,angle:-45,height:80,interval:0}:n<=30?{fontSize:12,angle:-45,height:85,interval:1}:n<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(n/12)})(i.length);return j?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):p?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",p]}):x?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",d]}),e.jsx(M,{title:`Ã‰volution des Performances ${d}`,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(ce,{data:i,margin:{top:20,right:30,left:20,bottom:20},onClick:n=>{if(n&&n.activeLabel){const c=i.find(o=>o.period===n.activeLabel);c&&h({selectedPlayer:m,selectedDate:c.period,fromComponent:`Ã‰volution des Performances ${d}`})}},style:{cursor:"pointer"},children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"period",angle:r.angle,textAnchor:"end",height:r.height,interval:r.interval,fontSize:r.fontSize}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:n,payload:c})=>{if(n&&c&&c.length>0){const o=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:o.period})}),e.jsxs("div",{children:["Parties: ",o.totalGames]}),e.jsxs("div",{children:["Victoires: ",o.victories]}),e.jsxs("div",{children:["Taux: ",o.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(de,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",d]}),e.jsx(M,{title:`RÃ©partition Victoires/DÃ©faites ${d}`,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:i,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"period",angle:r.angle,textAnchor:"end",height:r.height,interval:r.interval,fontSize:r.fontSize}),e.jsx(E,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:n,payload:c})=>{if(n&&c&&c.length>0){const o=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:o.period})}),e.jsxs("div",{children:["Total: ",o.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",o.victories]}),e.jsxs("div",{children:["DÃ©faites: ",o.defeats]}),e.jsxs("div",{children:["Taux: ",o.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(W,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:i.map((n,c)=>e.jsx(A,{fill:"var(--accent-tertiary)",onClick:()=>{h({selectedPlayer:m,selectedDate:n.period,fromComponent:`Historique Joueur - Victoires ${d}`})},style:{cursor:"pointer"}},`cell-victories-${c}`))}),e.jsx(W,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:i.map((n,c)=>e.jsx(A,{fill:"var(--chart-color-4)",onClick:()=>{h({selectedPlayer:m,selectedDate:n.period,fromComponent:`Historique Joueur - DÃ©faites ${d}`})},style:{cursor:"pointer"}},`cell-defeats-${c}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ve({selectedPlayerName:m}){const{navigateToGameDetails:f}=V(),{data:h,isLoading:x,error:j}=H(m),p=oe(),d=k.useMemo(()=>h?.campStats?Object.entries(h.campStats).map(([i,t])=>({name:i,value:t.appearances,winRate:t.winRate,winRateDisplay:Math.max(parseFloat(t.winRate),1),wins:t.wins,percentage:(t.appearances/h.totalGames*100).toFixed(1)})):[],[h]),g=k.useMemo(()=>{if(!d.length)return[];const i=5;let t=0;const r=[],n=[];if(d.forEach(c=>{parseFloat(c.percentage)<i?(t+=Number(c.value),r.push(c)):n.push(c)}),t>0){const c=d.reduce((o,y)=>o+Number(y.value),0);n.push({name:"Autres",value:t,winRate:"0.0",winRateDisplay:1,wins:r.reduce((o,y)=>o+y.wins,0),percentage:(t/c*100).toFixed(1),_details:r})}return n},[d]);return x?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):j?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",j]}):h?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(ue,{children:[e.jsx(me,{data:g,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:i=>{const t=i.percent!==void 0?i.percent:0;return i.name==="Autres"?`Autres : ${i.value} (${(t*100).toFixed(1)}%)`:`${i.name}: ${i.value} (${(t*100).toFixed(1)}%)`},children:g.map((i,t)=>e.jsx(A,{fill:i.name==="Autres"?X:p[i.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{if(i.name==="Autres"){const r=i._details?.map(n=>n.name)||[];f({selectedPlayer:m,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:r},fromComponent:"Distribution par Camps"})}else i.name==="TraÃ®tre"||i.name==="Louveteau"?f({selectedPlayer:m,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):i.name==="Loup"?f({selectedPlayer:m,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):f({selectedPlayer:m,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${t}`))}),e.jsx(G,{content:({active:i,payload:t})=>{if(i&&t&&t.length>0){const r=t[0].payload;if(r.name==="Autres"&&r._details){const n=[...r._details].sort((c,o)=>o.value-c.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{children:n.map((c,o)=>e.jsxs("div",{children:[c.name,": ",c.value," parties (",c.percentage,"%)"]},o))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[r.name," (",r.percentage,"%)"]})}),e.jsxs("div",{children:["Apparitions: ",r.value]}),e.jsxs("div",{children:["Victoires: ",r.wins," (",r.winRate,"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(M,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:d,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:i,payload:t})=>{if(i&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.value]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(W,{dataKey:"winRateDisplay",children:d.map((i,t)=>e.jsx(A,{fill:parseFloat(i.winRate)===0?`${p[i.name]||`var(--chart-color-${t%6+1})`}50`:p[i.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{i.name==="TraÃ®tre"||i.name==="Louveteau"?f({selectedPlayer:m,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):i.name==="Loup"?f({selectedPlayer:m,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):f({selectedPlayer:m,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${t}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function je({selectedPlayerName:m}){const{navigateToGameDetails:f}=V(),{data:h,isLoading:x,error:j}=H(m),p=k.useMemo(()=>{if(!h?.mapStats)return[];const d=ge(h.mapStats);return Object.entries(d).map(([g,i])=>({name:g,value:i.appearances,winRate:i.winRate,winRateDisplay:Math.max(parseFloat(i.winRate),.1),wins:i.wins,percentage:(i.appearances/h.totalGames*100).toFixed(1)}))},[h]);return x?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):j?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",j]}):h?p.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Carte"}),e.jsx(M,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:p,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(J,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(p.length>0){const d=p.reduce((t,r)=>t+r.value,0),g=p.reduce((t,r)=>t+r.wins,0),i=d>0?g/d*100:0;if(i!==50)return e.jsx(J,{y:i,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${i.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(G,{content:({active:d,payload:g})=>{if(d&&g&&g.length>0){const i=g[0].payload,t=[];return p.forEach(r=>{if(r.name!==i.name&&r.value>=5){const n=parseFloat(i.winRate)-parseFloat(r.winRate);Math.abs(n)>=2&&t.push({map:r.name,diff:n,better:n>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Parties: ",i.value]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",i.winRate,"%"]})}),t.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),t.map((r,n)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:r.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[r.better?"â†—":"â†˜"," ",Math.abs(r.diff).toFixed(1),"% vs ",r.map]},n))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(W,{dataKey:"winRateDisplay",label:d=>{const{x:g,y:i,width:t,payload:r}=d;if(g===void 0||i===void 0||t===void 0||!r)return null;const n=r.winRate||"0";return e.jsxs("text",{x:g+t/2,y:i-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[n,"%"]})},onClick:d=>{d&&d.name&&f({selectedPlayer:m,selectedMapName:d.name,fromComponent:"Performance par Carte"})},children:p.map((d,g)=>{let i;d.name==="Village"?i="var(--accent-secondary)":d.name==="ChÃ¢teau"?i="var(--accent-tertiary)":d.name==="Autres"?i=X:i=`var(--chart-color-${g%6+1})`;const t=Math.max(...p.map(n=>parseFloat(n.winRate))),r=parseFloat(d.winRate)===t&&t>0;return e.jsx(A,{fill:parseFloat(d.winRate)===0?`${i}30`:i,stroke:"transparent",strokeWidth:r?3:1,style:{cursor:"pointer"}},`cell-map-${g}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ye({selectedPlayerName:m}){const{gameData:f}=se(),{joueursData:h}=O(),x=_(h),j=k.useMemo(()=>{if(!f||!m)return{playersKilled:[],killedBy:[]};const p={},d={};f.forEach(t=>{const r=t.PlayerStats.find(n=>n.Username.toLowerCase()===m.toLowerCase());r&&(t.PlayerStats.forEach(n=>{n.KillerName?.toLowerCase()===m.toLowerCase()&&(p[n.Username]=(p[n.Username]||0)+1)}),r.KillerName&&(d[r.KillerName]=(d[r.KillerName]||0)+1))});const g=Object.entries(p).map(([t,r])=>({player:t,kills:r})).sort((t,r)=>r.kills-t.kills).slice(0,10),i=Object.entries(d).map(([t,r])=>({player:t,kills:r})).sort((t,r)=>r.kills-t.kills).slice(0,10);return{playersKilled:g,killedBy:i}},[f,m]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[j.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Joueurs les plus souvent tuÃ©s"}),e.jsx(M,{title:"Joueurs les plus souvent tuÃ©s",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:j.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:p,payload:d})=>{if(p&&d&&d.length>0){const g=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:g.player})}),e.jsxs("div",{children:["TuÃ© ",g.kills," fois par ",m]})]})}return null}}),e.jsx(W,{dataKey:"kills",children:j.playersKilled.map((p,d)=>e.jsx(A,{fill:x[p.player]||"var(--chart-color-3)"},`cell-killed-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[m," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),j.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Le plus souvent tuÃ© par"}),e.jsx(M,{title:"Le plus souvent tuÃ© par",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:j.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:p,payload:d})=>{if(p&&d&&d.length>0){const g=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:g.player})}),e.jsxs("div",{children:["A tuÃ© ",m," ",g.kills," fois"]})]})}return null}}),e.jsx(W,{dataKey:"kills",children:j.killedBy.map((p,d)=>e.jsx(A,{fill:x[p.player]||"var(--chart-color-4)"},`cell-killer-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[m," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]})]})}function Ae(){const{settings:m,updateSettings:f}=B(),{navigateToGameDetails:h}=V(),{data:x,isLoading:j,error:p}=ae(),{joueursData:d,isLoading:g}=O(),{data:i,isLoading:t,error:r}=pe(m.highlightedPlayer),n=_(d),[c,o]=k.useState(""),[y,C]=k.useState("all"),[w,T]=k.useState("achievements"),[$,D]=k.useState("session"),{data:S}=H(m.highlightedPlayer||""),F=k.useMemo(()=>{if(!x||!x.GameStats)return[];const a=new Map;return x.GameStats.forEach(l=>{const u=new Date(l.StartDate);l.PlayerStats.forEach(v=>{const b=Y(v),Q=d?.Players?.find(Z=>Z.ID===b)?.Joueur||U(v);a.has(b)||a.set(b,{games:0,wins:0,firstDate:u,lastDate:u,displayName:Q});const L=a.get(b);L.games++,v.Victorious&&L.wins++,u<L.firstDate&&(L.firstDate=u),u>L.lastDate&&(L.lastDate=u)})}),Array.from(a.entries()).map(([l,u])=>{let v=d?.Players?.find(b=>b.ID===l);return v||(v=d?.Players?.find(b=>b.Joueur===u.displayName)),{name:u.displayName,totalGames:u.games,totalWins:u.wins,winRate:u.games>0?u.wins/u.games*100:0,firstGameDate:u.firstDate.toLocaleDateString("fr-FR"),lastGameDate:u.lastDate.toLocaleDateString("fr-FR"),isHighlighted:u.displayName===m.highlightedPlayer,image:v?.Image||null,twitch:v?.Twitch||null,youtube:v?.Youtube||null}})},[x,m.highlightedPlayer,d]),s=k.useMemo(()=>{if(!c.trim())return F;const a=c.toLowerCase();return F.filter(l=>l.name.toLowerCase().includes(a))},[F,c]),N=k.useMemo(()=>[...s].sort((a,l)=>l.totalGames-a.totalGames),[s]),R=a=>{f({highlightedPlayer:a}),o("")};return j||g?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):p?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",p]})]}):!x||F.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!m.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:c,onChange:a=>o(a.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[s.length," joueur",s.length!==1?"s":"",c&&` (filtrÃ©${s.length!==1?"s":""} de ${F.length})`]})]})]}),e.jsx("div",{className:"player-display",children:c?s.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{className:"clear-search-btn",onClick:()=>o(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:N.map(a=>e.jsxs("button",{className:`suggestion-btn ${a.isHighlighted?"highlighted":""}`,onClick:()=>R(a.name),children:[a.image?e.jsx("img",{src:a.image,alt:a.name,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":n[a.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[a.name,a.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[a.totalGames," parties â€¢ ",a.winRate.toFixed(1),"% victoires"]})]})]},a.name))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',c,'"']}),e.jsx("button",{className:"clear-search-btn",onClick:()=>o(""),children:"Effacer la recherche"})]}):m.highlightedPlayer?(()=>{const a=F.find(l=>l.name===m.highlightedPlayer);return a?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:a.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[a.image?e.jsx("img",{src:a.image,alt:a.name,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":n[a.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[a.totalGames," parties â€¢ ",a.totalWins," victoires â€¢ ",a.winRate.toFixed(1),"% taux de victoire"]}),(a.twitch||a.youtube)&&e.jsxs("div",{className:"social-links",children:[a.twitch&&e.jsx("a",{href:a.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),a.youtube&&e.jsx("a",{href:a.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{className:`lycans-categorie-btn ${w==="achievements"?"active":""}`,onClick:()=>T("achievements"),children:"Classement"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="evolution"?"active":""}`,onClick:()=>T("evolution"),children:"Ã‰volution"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="camps"?"active":""}`,onClick:()=>T("camps"),children:"Camps"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="maps"?"active":""}`,onClick:()=>T("maps"),children:"Maps"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="kills"?"active":""}`,onClick:()=>T("kills"),children:"Kills"})]}),w==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[t?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):r?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",r]})}):i?e.jsx(fe,{achievements:y==="all"?i.allGamesAchievements:i.moddedOnlyAchievements,title:y==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:y}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[e.jsx("button",{className:`filter-btn ${y==="all"?"active":""}`,onClick:l=>{l.stopPropagation(),C("all")},children:"Toutes les parties"}),e.jsx("button",{className:`filter-btn ${y==="modded"?"active":""}`,onClick:l=>{l.stopPropagation(),C("modded")},children:"Parties moddÃ©es"})]})]}),w==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[S&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{h({selectedPlayer:a.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${a.name}`,children:S.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{h({selectedPlayer:a.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${a.name}`,children:S.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",children:[S.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:$,onChange:l=>D(l.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]})}),e.jsx(xe,{selectedPlayerName:a.name,groupingMethod:$})]}),w==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ve,{selectedPlayerName:a.name})}),w==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(je,{selectedPlayerName:a.name})}),w==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ye,{selectedPlayerName:a.name})}),e.jsx("button",{className:"highlight-btn active",onClick:l=>{l.stopPropagation(),f({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[a.firstGameDate," - ",a.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',m.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{className:"clear-selection-btn",onClick:()=>f({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:N.map(a=>e.jsxs("div",{className:`character-card ${a.isHighlighted?"highlighted":""}`,onClick:()=>R(a.name),title:`${a.name} - ${a.totalGames} parties, ${a.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:a.image?e.jsx("img",{src:a.image,alt:a.name,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":n[a.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:a.name}),(a.twitch||a.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[a.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),a.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},a.name))})})})]})}export{Ae as PlayerSelectionPage};
