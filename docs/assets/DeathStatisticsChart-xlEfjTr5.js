import{g as de,e as he,u as te,a as ae,r as I,j as e,h as pe}from"./index-DSZwgql0.js";import{g as ne,u as xe,a as ve,b as fe,c as je}from"./useDeathStatisticsFromRaw-C9jDFb_a.js";import{u as ge}from"./baseStatsHook-Zsorn5fH.js";import{g as ee,a as ie,D as G}from"./datasyncExport-BirWLS1z.js";import{M as me,C as ue,u as re,m as le,b as ye,a as Pe}from"./api-DK9E-0gJ.js";import{D as W,g as oe}from"./deathTypes-gHH1w6_X.js";import{F as q,C as w,X as $,Y as U,a as X}from"./FullscreenChart-qUnwQzKG.js";import{u as se}from"./useJoueursData-DMV-RVyB.js";import{R as O,T as _}from"./CategoricalChart-Dtj3AAdK.js";import{B as J,a as Y}from"./BarChart-mTrRFngN.js";function ce(r){if(!r||r.trim()==="")return null;const s=r.trim().slice(1),m=parseInt(s,10);return isNaN(m)||m<1?null:m}function Se(r,h){if(r.length===0)return null;const s={},m={};r.forEach(p=>{let n=1;if(p.EndTiming){const u=ce(p.EndTiming);u&&(n=u)}p.PlayerStats.forEach(u=>{if(h&&h!=="Tous les camps"&&ee(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==h)return;const d=u.Username;s[d]||(s[d]={playerName:d,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const K=s[d];K.totalGames++;let N=null;u.DeathTiming&&(N=ce(u.DeathTiming));for(let f=1;f<=n;f++)K.gamesPlayedByDay[f]||(K.gamesPlayedByDay[f]=0,K.survivalsByDay[f]=0),m[f]||(m[f]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),K.gamesPlayedByDay[f]++,m[f].playersOnDay++,(!N||N>f)&&(K.survivalsByDay[f]++,m[f].survivorsOnDay++)});for(let u=1;u<=n;u++)m[u]||(m[u]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),m[u].gamesReachingDay++}),Object.values(s).forEach(p=>{Object.keys(p.gamesPlayedByDay).forEach(n=>{const u=parseInt(n),d=p.gamesPlayedByDay[u],K=p.survivalsByDay[u];d>0?p.survivalRatesByDay[u]=K/d*100:p.survivalRatesByDay[u]=0})});const o=Object.values(s).filter(p=>p.totalGames>0).sort((p,n)=>n.totalGames-p.totalGames),A=Object.entries(m).map(([p,n])=>({dayNumber:parseInt(p),totalGamesReachingDay:n.gamesReachingDay,totalPlayersOnDay:n.playersOnDay,averageSurvivalRate:n.playersOnDay>0?n.survivorsOnDay/n.playersOnDay*100:0})).sort((p,n)=>p.dayNumber-n.dayNumber);return{totalGames:r.length,totalPlayersAnalyzed:o.length,playerSurvivalStats:o,dayStats:A}}function be(r,h,s=me.MEDIUM){return r.playerSurvivalStats.filter(m=>m.totalGames>=s&&(m.gamesPlayedByDay[h]||0)>0).map(m=>({playerName:m.playerName,survivalRate:m.survivalRatesByDay[h]||0,gamesPlayed:m.totalGames,timesReachedDay:m.gamesPlayedByDay[h]||0,timesSurvivedDay:m.survivalsByDay[h]||0})).sort((m,o)=>o.survivalRate-m.survivalRate).slice(0,ue.TOP_15)}function De(r,h,s=me.MEDIUM){return r.playerSurvivalStats.filter(m=>m.totalGames>=s&&(m.gamesPlayedByDay[h]||0)>0).map(m=>({playerName:m.playerName,survivalRate:m.survivalRatesByDay[h]||0,gamesPlayed:m.totalGames,timesReachedDay:m.gamesPlayedByDay[h]||0,timesSurvivedDay:m.survivalsByDay[h]||0})).sort((m,o)=>m.survivalRate-o.survivalRate).slice(0,ue.TOP_15)}function Te(r){return ge(h=>Se(h,r))}function Ae(r,h){if(h==="Tous les camps"){const s=r.filter(m=>m!==W.BULLET_HUMAN&&m!==W.BULLET_WOLF);return(r.includes(W.BULLET_HUMAN)||r.includes(W.BULLET_WOLF))&&!s.includes(W.BULLET)&&s.push(W.BULLET),s}return r}function Q(r,h){if(h==="Tous les camps"){const s=r.killsByDeathType[W.BULLET_HUMAN]||0,m=r.killsByDeathType[W.BULLET_WOLF]||0,o=r.killsByDeathType[W.BULLET]||0,A={...r.killsByDeathType};return A[W.BULLET]=s+m+o,delete A[W.BULLET_HUMAN],delete A[W.BULLET_WOLF],{...r,killsByDeathType:A}}return r}function Ne(r,h="Tous les camps",s="Tous les camps"){const m=new Map;return r.forEach(o=>{o.PlayerStats.forEach(A=>{const p=de(A),n=he(A),u=ie(A.MainRoleInitial,A.MainRoleChanges||[]),d=ee(u,{regroupVillagers:!0,regroupWolfSubRoles:!0},A.Power);if(h!=="Tous les camps"&&d!==h)return;let K=0;if(o.PlayerStats.forEach(N=>{if(N.KillerName===A.Username&&N.DeathTiming){const f=ie(N.MainRoleInitial,N.MainRoleChanges||[]),M=ee(f,{regroupVillagers:!0,regroupWolfSubRoles:!0},N.Power);s==="Tous les camps"?K++:s==="Roles solo"?M!=="Villageois"&&M!=="Loups"&&K++:M===s&&K++}}),K>0){const N=m.get(p);N?K>N.maxKills?(N.maxKills=K,N.timesAchieved=1,N.gameIds=[o.DisplayedId]):K===N.maxKills&&(N.timesAchieved++,N.gameIds.includes(o.DisplayedId)||N.gameIds.push(o.DisplayedId)):m.set(p,{playerName:n,maxKills:K,timesAchieved:1,gameIds:[o.DisplayedId]})}})}),Array.from(m.values()).sort((o,A)=>A.maxKills!==o.maxKills?A.maxKills-o.maxKills:A.timesAchieved-o.timesAchieved)}function Be(r,h="Tous les camps",s="Tous les camps"){const m=new Map;return r.forEach(o=>{const A=new Map;o.PlayerStats.forEach(p=>{if(p.KillerName&&p.DeathTiming&&p.DeathTiming.match(/^[A-Z]\d+$/)){const n=p.KillerName,u=p.DeathTiming,d=o.PlayerStats.find(v=>v.Username===n);if(!d)return;const K=ie(d.MainRoleInitial,d.MainRoleChanges||[]),N=ee(K,{regroupVillagers:!0,regroupWolfSubRoles:!0},d.Power);if(h!=="Tous les camps"&&N!==h)return;const f=ie(p.MainRoleInitial,p.MainRoleChanges||[]),M=ee(f,{regroupVillagers:!0,regroupWolfSubRoles:!0},p.Power);let E=!1;if(s==="Tous les camps"?E=!0:s==="Roles solo"?E=M!=="Villageois"&&M!=="Loups":E=M===s,!E)return;A.has(n)||A.set(n,new Map);const b=A.get(n);b.set(u,(b.get(u)||0)+1)}}),A.forEach((p,n)=>{const u=Math.max(...Array.from(p.values())),d=o.PlayerStats.find(M=>M.Username===n);if(!d)return;const K=de(d),N=he(d),f=m.get(K);f?u>f.maxKills?(f.maxKills=u,f.timesAchieved=1,f.gameIds=[o.DisplayedId]):u===f.maxKills&&(f.timesAchieved++,f.gameIds.includes(o.DisplayedId)||f.gameIds.push(o.DisplayedId)):m.set(K,{playerName:N,maxKills:u,timesAchieved:1,gameIds:[o.DisplayedId]})})}),Array.from(m.values()).sort((o,A)=>A.maxKills!==o.maxKills?A.maxKills-o.maxKills:A.timesAchieved-o.timesAchieved)}function ke(r,h="Tous les camps",s="Tous les camps"){return r.length===0?null:{maxKillsPerGame:Ne(r,h,s),maxKillsPerPhase:Be(r,h,s)}}function Ke(r="Tous les camps",h="Tous les camps"){return ge(s=>ke(s,r,h))}function Me({deathStats:r,selectedCamp:h,victimCampFilter:s,minGamesForAverage:m,onMinGamesChange:o,availableDeathTypes:A,deathTypeColors:p,totalEligibleForAverage:n}){const{navigateToGameDetails:u}=te(),{settings:d}=ae(),{joueursData:K}=se(),N=re(K),{data:f}=Ke(h,s),M=I.useMemo(()=>Ae(A,s),[A,s]),E=I.useMemo(()=>{const t={...p};if(s==="Tous les camps"&&!t[W.BULLET]){const i=p[W.BULLET_HUMAN]||p[W.BULLET_WOLF];i&&(t[W.BULLET]=i)}return t},[p,s]),b=t=>{let i="Top Tueurs";return h!=="Tous les camps"&&(i+=` en ${h}`),s!=="Tous les camps"&&(s==="Roles solo"?i+=" (victimes: Roles solo)":i+=` (victimes: ${s})`),t==="total"?i+=" (Total)":i+=" (Moyenne par Partie)",i},v=t=>{let i=t==="game"?"Record de Kills en une Partie":"Record de Kills en une Phase";return h!=="Tous les camps"&&(i+=` (${h})`),s!=="Tous les camps"&&(s==="Roles solo"?i+=h!=="Tous les camps"?" - victimes: Roles solo":" (victimes: Roles solo)":i+=h!=="Tous les camps"?` - victimes: ${s}`:` (victimes: ${s})`),i},{totalKillsData:R,averageKillsData:g,highlightedPlayerAddedToTotal:y,highlightedPlayerAddedToAverage:B}=I.useMemo(()=>{if(!r)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const t=r.killerStats.sort((L,S)=>S.kills-L.kills).slice(0,15),i=d.highlightedPlayer&&t.some(L=>L.killerName===d.highlightedPlayer),a=t.map(L=>{const S=Q(L,s),H={name:S.killerName,value:S.kills,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!1};return M.forEach(C=>{H[C]=S.killsByDeathType[C]||0}),H});let x=!1;if(d.highlightedPlayer&&!i){const L=r.killerStats.find(S=>S.killerName===d.highlightedPlayer);if(L){const S=Q(L,s),H={name:S.killerName,value:S.kills,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!0};M.forEach(C=>{H[C]=S.killsByDeathType[C]||0}),a.push(H),x=!0}}const z=r.killerStats.filter(L=>L.gamesPlayed>=m).sort((L,S)=>S.averageKillsPerGame-L.averageKillsPerGame).slice(0,15),V=d.highlightedPlayer&&z.some(L=>L.killerName===d.highlightedPlayer),T=z.map(L=>{const S=Q(L,s),H={name:S.killerName,value:S.averageKillsPerGame,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!1};return M.forEach(C=>{const Z=S.killsByDeathType[C]||0;H[C]=S.gamesPlayed>0?Z/S.gamesPlayed:0}),H});let F=!1;if(d.highlightedPlayer&&!V){const L=r.killerStats.find(S=>S.killerName===d.highlightedPlayer);if(L){const S=Q(L,s),H={name:S.killerName,value:S.averageKillsPerGame,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!0};M.forEach(C=>{const Z=S.killsByDeathType[C]||0;H[C]=S.gamesPlayed>0?Z/S.gamesPlayed:0}),T.push(H),F=!0}}return{totalKillsData:a,averageKillsData:T,highlightedPlayerAddedToTotal:x,highlightedPlayerAddedToAverage:F}},[r,d.highlightedPlayer,m,M,s]),j=({active:t,payload:i,label:a})=>{if(t&&i&&i.length){const x=i[0].payload,c=x.isHighlightedAddition,z=d.highlightedPlayer===x.name,V=M.reduce((T,F)=>T+(x[F]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:z?"var(--accent-primary)":"var(--text-primary)"},children:[a,c&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",V]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",x.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),M.map(T=>({deathType:T,count:x[T]||0})).filter(T=>T.count>0).sort((T,F)=>F.count-T.count).map(({deathType:T,count:F})=>e.jsxs("p",{style:{color:E[T],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ne(T),":"]})," ",F]},T))]}),c&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),z&&!c&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},l=({active:t,payload:i,label:a})=>{if(t&&i&&i.length){const x=i[0].payload,c=x.isHighlightedAddition,z=d.highlightedPlayer===x.name,V=x.gamesPlayed>=m,T=r?.killerStats.find(H=>H.killerName===x.name),F=T?Q(T,s):null,L=M.reduce((H,C)=>H+(x[C]||0),0),S=F?F.kills:Math.round(L*x.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:z?"var(--accent-primary)":"var(--text-primary)"},children:[a,c&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",L.toFixed(2)," (",S," kills /",x.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",x.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),M.map(H=>({deathType:H,avgCount:x[H]||0,totalKillsForDeathType:F?F.killsByDeathType[H]||0:Math.round((x[H]||0)*x.gamesPlayed)})).filter(H=>H.avgCount>0).sort((H,C)=>C.avgCount-H.avgCount).map(({deathType:H,avgCount:C,totalKillsForDeathType:Z})=>e.jsxs("p",{style:{color:E[H],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ne(H),":"]})," ",C.toFixed(2)," (",Z," kills /",x.gamesPlayed," games)"]},H))]}),c&&!V&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",m," parties)"]}),c&&V&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),z&&!c&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},P=I.useMemo(()=>{if(!f)return[];const t=f.maxKillsPerGame.slice(0,15),i=d.highlightedPlayer&&t.some(a=>a.playerName===d.highlightedPlayer);if(d.highlightedPlayer&&!i){const a=f.maxKillsPerGame.find(x=>x.playerName===d.highlightedPlayer);a&&t.push({...a})}return t.map((a,x)=>({name:a.playerName,value:a.maxKills,timesAchieved:a.timesAchieved,gameIds:a.gameIds,isHighlightedAddition:x>=15}))},[f,d.highlightedPlayer]),k=I.useMemo(()=>{if(!f)return[];const t=f.maxKillsPerPhase.slice(0,15),i=d.highlightedPlayer&&t.some(a=>a.playerName===d.highlightedPlayer);if(d.highlightedPlayer&&!i){const a=f.maxKillsPerPhase.find(x=>x.playerName===d.highlightedPlayer);a&&t.push({...a})}return t.map((a,x)=>({name:a.playerName,value:a.maxKills,timesAchieved:a.timesAchieved,gameIds:a.gameIds,isHighlightedAddition:x>=15}))},[f,d.highlightedPlayer]),D=({active:t,payload:i,label:a,chartType:x})=>{if(t&&i&&i.length){const c=i[0].payload,z=d.highlightedPlayer===c.name,V=c.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:z?"var(--accent-primary)":"var(--text-primary)"},children:[a,V&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsxs("strong",{children:[x==="game"?"Max kills en une partie":"Max kills en une phase",":"]})," ",c.value]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Nombre de fois:"})," ",c.timesAchieved]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"4px 0",fontSize:"0.8rem"},children:[c.gameIds.length," partie",c.gameIds.length>1?"s":""," concernÃ©e",c.gameIds.length>1?"s":""]}),V&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),z&&!V&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:b("total")}),y&&d.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',d.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:b("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:d.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:d.highlightedPlayer===a.value?14:12,fontWeight:d.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx(U,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(j,{})}),M.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"kills",fill:E[t],onClick:i=>{const a={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(a.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(a)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:b("average")}),B&&d.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',d.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:m,onChange:t=>o(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:le.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(q,{title:b("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:g,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:d.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:d.highlightedPlayer===a.value?14:12,fontWeight:d.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx(U,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(l,{})}),M.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"averageKills",fill:E[t],onClick:i=>{const a={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(a.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(a)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,g.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",n," ayant au moins ",m," partie",m>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:v("game")}),P.some(t=>t.isHighlightedAddition)&&d.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',d.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:v("game"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:P,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:d.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:d.highlightedPlayer===a.value?14:12,fontWeight:d.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx(U,{label:{value:"Nombre max de kills en une partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(D,{...t,chartType:"game"})}),e.jsx(Y,{dataKey:"value",children:P.map((t,i)=>{const a=d.highlightedPlayer===t.name,x=t.isHighlightedAddition;return e.jsx(X,{fill:N[t.name]||(a?"var(--accent-primary)":x?"var(--accent-secondary)":"var(--chart-primary)"),stroke:a?"var(--accent-primary)":"none",strokeWidth:a?3:0,strokeDasharray:x?"5,5":"none",opacity:x?.8:1,onClick:()=>{if(t?.gameIds&&t.gameIds.length>0){const c={fromComponent:"Statistiques de Mort - Max Kills par Partie"};t.gameIds.length===1?c.selectedGame=t.gameIds[0]:c.selectedGameIds=t.gameIds,h!=="Tous les camps"&&(c.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(c)}},style:{cursor:"pointer"}},`cell-${i}`)})})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:h!=="Tous les camps"||s!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule partie (avec filtres appliquÃ©s)":"Nombre maximum de kills rÃ©alisÃ©s en une seule partie"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:v("phase")}),k.some(t=>t.isHighlightedAddition)&&d.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',d.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:v("phase"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:k,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:d.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:d.highlightedPlayer===a.value?14:12,fontWeight:d.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx(U,{label:{value:"Nombre max de kills en une phase",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(D,{...t,chartType:"phase"})}),e.jsx(Y,{dataKey:"value",children:k.map((t,i)=>{const a=d.highlightedPlayer===t.name,x=t.isHighlightedAddition;return e.jsx(X,{fill:N[t.name]||(a?"var(--accent-primary)":x?"var(--accent-secondary)":"var(--chart-secondary)"),stroke:a?"var(--accent-primary)":"none",strokeWidth:a?3:0,strokeDasharray:x?"5,5":"none",opacity:x?.8:1,onClick:()=>{if(t?.gameIds&&t.gameIds.length>0){const c={fromComponent:"Statistiques de Mort - Max Kills par Phase"};t.gameIds.length===1?c.selectedGame=t.gameIds[0]:c.selectedGameIds=t.gameIds,h!=="Tous les camps"&&(c.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(c)}},style:{cursor:"pointer"}},`cell-${i}`)})})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:h!=="Tous les camps"||s!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule phase avec filtres appliquÃ©s":"Nombre maximum de kills rÃ©alisÃ©s en une seule phase"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",textAlign:"center",marginTop:"0.25rem",fontStyle:"italic"},children:"Une phase est une sÃ©quence de jeu : Jour (J1), Nuit (N1), Meeting (M1), etc."})]})]})}function Re({deathStats:r,selectedCamp:h,minGamesForAverage:s,onMinGamesChange:m,availableDeathTypes:o,deathTypeColors:A}){const{navigateToGameDetails:p}=te(),{settings:n}=ae(),{joueursData:u}=se(),d=re(u),[K,N]=I.useState(null),{totalDeathsData:f,survivalRateData:M,highlightedPlayerAddedToDeaths:E,highlightedPlayerAddedToSurvival:b}=I.useMemo(()=>{if(!r)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const g=r.playerDeathStats.sort((i,a)=>a.totalDeaths-i.totalDeaths).slice(0,15),y=n.highlightedPlayer&&g.some(i=>i.playerName===n.highlightedPlayer),B=g.map(i=>{const a=i.gamesPlayed,x=a>0?(a-i.totalDeaths)/a*100:0,c={name:i.playerName,value:i.totalDeaths,totalDeaths:i.totalDeaths,gamesPlayed:a,deathRate:i.deathRate,survivalRate:x,isHighlightedAddition:!1};return o.forEach(z=>{c[z]=i.deathsByType[z]||0}),c});let j=!1;if(n.highlightedPlayer&&!y){const i=r.playerDeathStats.find(a=>a.playerName===n.highlightedPlayer);if(i){const a=i.gamesPlayed,x=a>0?(a-i.totalDeaths)/a*100:0,c={name:i.playerName,value:i.totalDeaths,totalDeaths:i.totalDeaths,gamesPlayed:a,deathRate:i.deathRate,survivalRate:x,isHighlightedAddition:!0};o.forEach(z=>{c[z]=i.deathsByType[z]||0}),B.push(c),j=!0}}const P=r.playerDeathStats.filter(i=>i.gamesPlayed>=s).map(i=>({...i,survivalRate:i.gamesPlayed>0?(i.gamesPlayed-i.totalDeaths)/i.gamesPlayed*100:0})).sort((i,a)=>a.survivalRate-i.survivalRate).slice(0,15),k=n.highlightedPlayer&&P.some(i=>i.playerName===n.highlightedPlayer),D=P.map(i=>{const a={name:i.playerName,value:i.survivalRate,totalDeaths:i.totalDeaths,gamesPlayed:i.gamesPlayed,deathRate:i.deathRate,survivalRate:i.survivalRate,isHighlightedAddition:!1};return o.forEach(x=>{a[x]=i.deathsByType[x]||0}),a});let t=!1;if(n.highlightedPlayer&&!k){const i=r.playerDeathStats.find(a=>a.playerName===n.highlightedPlayer);if(i){const a=i.gamesPlayed>0?(i.gamesPlayed-i.totalDeaths)/i.gamesPlayed*100:0,x={name:i.playerName,value:a,totalDeaths:i.totalDeaths,gamesPlayed:i.gamesPlayed,deathRate:i.deathRate,survivalRate:a,isHighlightedAddition:!0};o.forEach(c=>{x[c]=i.deathsByType[c]||0}),D.push(x),t=!0}}return{totalDeathsData:B,survivalRateData:D,highlightedPlayerAddedToDeaths:j,highlightedPlayerAddedToSurvival:t}},[r,n.highlightedPlayer,s,o]),v=({active:g,payload:y,label:B})=>{if(g&&y&&y.length){const j=y[0].payload,l=j.isHighlightedAddition,P=n.highlightedPlayer===j.name,k=o.reduce((D,t)=>D+(j[t]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:P?"var(--accent-primary)":"var(--text-primary)"},children:[B,l&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",k]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",j.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",j.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),o.map(D=>{const t=j[D]||0;return t===0?null:e.jsxs("p",{style:{color:A[D],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[oe(D),":"]})," ",t]},D)})]}),l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),P&&!l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},R=({active:g,payload:y,label:B})=>{if(g&&y&&y.length){const j=y[0].payload,l=j.isHighlightedAddition,P=n.highlightedPlayer===j.name,k=j.gamesPlayed>=s;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:P?"var(--accent-primary)":"var(--text-primary)"},children:[B,l&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",j.survivalRate.toFixed(1),"% (",j.gamesPlayed-j.totalDeaths," survies / ",j.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",j.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",j.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),o.map(D=>{const t=j[D]||0;return t===0?null:e.jsxs("p",{style:{color:A[D],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[oe(D),":"]})," ",t]},D)})]}),l&&!k&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",s," parties)"]}),l&&k&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),P&&!l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:h==="Tous les camps"?"Morts (Total)":`Morts en ${h} (Total)`}),E&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:h==="Tous les camps"?"Morts (Total)":`Morts en ${h} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:g,y,payload:B})=>e.jsx("text",{x:g,y,dy:10,fill:n.highlightedPlayer===B.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===B.value?14:12,fontWeight:n.highlightedPlayer===B.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${g} ${y})`,children:B.value})}),e.jsx(U,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(v,{})}),o.map(g=>e.jsx(Y,{dataKey:g,name:g,stackId:"deaths",fill:A[g],onClick:y=>{const B={selectedPlayer:y?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(B.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),p(B)}},g))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(g=>!g.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",h==="Tous les camps"?"(Total)":` en ${h}`]}),b&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:s,onChange:g=>m(Number(g.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:le.map(g=>e.jsx("option",{value:g,children:g},g))})]}),e.jsx(q,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:M,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:g,y,payload:B})=>e.jsx("text",{x:g,y,dy:10,fill:n.highlightedPlayer===B.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===B.value?14:12,fontWeight:n.highlightedPlayer===B.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${g} ${y})`,children:B.value})}),e.jsx(U,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(R,{})}),e.jsx(Y,{dataKey:"value",onClick:g=>{const y={selectedPlayer:g?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(y.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),p(y)},onMouseEnter:g=>N(g?.name||null),onMouseLeave:()=>N(null),style:{cursor:"pointer"},children:M.map((g,y)=>{const B=n.highlightedPlayer===g.name,j=g.isHighlightedAddition;return e.jsx(X,{fill:d[g.name]||"var(--chart-primary)",stroke:B?"var(--accent-primary)":K===g.name?"var(--text-primary)":"none",strokeWidth:B?3:K===g.name?2:0,strokeDasharray:j?"5,5":"none",opacity:j?.8:1},`cell-${y}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,M.filter(g=>!g.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",s," partie",s>1?"s":"",")"]})]})]})}function He({hunterStats:r,isLoading:h,error:s}){const{navigateToGameDetails:m}=te(),{settings:o}=ae(),A=ye(),{joueursData:p}=se(),n=re(p),[u,d]=I.useState(null);if(h)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(s)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",s]});if(!r||r.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:K,highlightedPlayerAddedToBest:N,finalBadHuntersData:f,highlightedPlayerAddedToBad:M}=(()=>{const R=r.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).sort((t,i)=>i.averageNonVillageoisKillsPerGame-t.averageNonVillageoisKillsPerGame).slice(0,15),g=o.highlightedPlayer&&R.some(t=>t.hunterName===o.highlightedPlayer);let y=[...R],B=!1;if(o.highlightedPlayer&&!g){const t=r.hunterStats.find(i=>i.hunterName===o.highlightedPlayer);t&&(y.push({...t,isHighlightedAddition:!0}),B=!0)}const j=r.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).map(t=>({name:t.hunterName,averageVillageoisKills:Number((t.villageoisKills/t.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:t.villageoisKills,totalNonVillageoisKills:t.nonVillageoisKills,totalKills:t.totalKills,gamesPlayed:t.gamesPlayedAsHunter,victimsByCamp:t.victimsByCamp,goodVictimsByCamp:t.goodVictimsByCamp,badVictimsByCamp:t.badVictimsByCamp,hunterName:t.hunterName})),l=j.sort((t,i)=>i.averageVillageoisKills-t.averageVillageoisKills).slice(0,15),P=o.highlightedPlayer&&l.some(t=>t.hunterName===o.highlightedPlayer);let k=[...l],D=!1;if(o.highlightedPlayer&&!P){const t=j.find(i=>i.hunterName===o.highlightedPlayer);t&&(k.push({...t,isHighlightedAddition:!0}),D=!0)}return{finalBestHuntersData:y,highlightedPlayerAddedToBest:B,finalBadHuntersData:k,highlightedPlayerAddedToBad:D}})(),E=({active:v,payload:R,label:g})=>{if(v&&R&&R.length){const y=R[0].payload,B=y.isHighlightedAddition,j=o.highlightedPlayer===y.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:j?"var(--accent-primary)":"var(--text-primary)"},children:[g,B&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",y.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",y.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",y.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",y.totalKills]}),y.goodVictimsByCamp&&Object.keys(y.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(y.goodVictimsByCamp).map(([l,P])=>e.jsxs("p",{style:{color:A[l]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[l,":"]})," ",P]},l))]}),B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),j&&!B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},b=({active:v,payload:R,label:g})=>{if(v&&R&&R.length){const y=R[0].payload,B=y.isHighlightedAddition,j=o.highlightedPlayer===y.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:j?"var(--accent-primary)":"var(--text-primary)"},children:[g,B&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",y.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",y.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",y.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",y.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",y.totalKills]}),y.badVictimsByCamp&&Object.keys(y.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(y.badVictimsByCamp).map(([l,P])=>e.jsxs("p",{style:{color:A[l]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[l,":"]})," ",P]},l))]}),B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),j&&!B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),N&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:K,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:v,y:R,payload:g})=>e.jsx("text",{x:v,y:R,dy:10,fill:o.highlightedPlayer===g.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===g.value?14:12,fontWeight:o.highlightedPlayer===g.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${v} ${R})`,children:g.value})}),e.jsx(U,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(E,{})}),e.jsx(Y,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:v=>{v?.hunterName&&m({selectedPlayer:v.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:v=>d(v?.hunterName||null),onMouseLeave:()=>d(null),style:{cursor:"pointer"},children:K.map((v,R)=>{const g=o.highlightedPlayer===v.hunterName,y=v.isHighlightedAddition;return e.jsx(X,{fill:n[v.hunterName]||A.Chasseur||"#8884d8",stroke:g?"var(--accent-primary)":u===v.hunterName?"var(--text-primary)":"none",strokeWidth:g?3:u===v.hunterName?2:0,strokeDasharray:y?"5,5":"none",opacity:y?.8:1},`cell-${R}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,K.filter(v=>!v.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),M&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:v,y:R,payload:g})=>e.jsx("text",{x:v,y:R,dy:10,fill:o.highlightedPlayer===g.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===g.value?14:12,fontWeight:o.highlightedPlayer===g.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${v} ${R})`,children:g.value})}),e.jsx(U,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(b,{})}),e.jsx(Y,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:v=>{v?.hunterName&&m({selectedPlayer:v.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:v=>d(v?.hunterName||null),onMouseLeave:()=>d(null),style:{cursor:"pointer"},children:f.map((v,R)=>{const g=o.highlightedPlayer===v.hunterName,y=v.isHighlightedAddition;return e.jsx(X,{fill:n[v.hunterName]||A.Chasseur||"#8884d8",stroke:g?"var(--accent-primary)":u===v.hunterName?"var(--text-primary)":"none",strokeWidth:g?3:u===v.hunterName?2:0,strokeDasharray:y?"5,5":"none",opacity:y?.8:1},`cell-${R}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(v=>!v.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function ze({survivalStats:r,selectedCamp:h,minGamesForAverage:s,onMinGamesChange:m,isLoading:o,error:A}){const{navigateToGameDetails:p}=te(),{settings:n}=ae(),{joueursData:u}=se(),d=re(u),[K,N]=I.useState(Pe.DEFAULT_SELECTED_DAY),[f,M]=I.useState(null),E=I.useMemo(()=>r?r.dayStats.filter(P=>P.totalGamesReachingDay>0).map(P=>P.dayNumber).sort((P,k)=>P-k):[],[r]),b=I.useMemo(()=>E.includes(K)?K:E.length>0?E[0]:1,[K,E]),{highestSurvivalData:v,highlightedPlayerAddedToHighest:R}=I.useMemo(()=>{if(!r)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const l=be(r,b,s),P=n.highlightedPlayer&&l.some(t=>t.playerName===n.highlightedPlayer),k=l.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let D=!1;if(n.highlightedPlayer&&!P){const t=r.playerSurvivalStats.find(i=>i.playerName===n.highlightedPlayer);if(t&&t.totalGames>=s&&(t.gamesPlayedByDay[b]||0)>0){const i=t.survivalRatesByDay[b]||0;k.push({name:n.highlightedPlayer,value:i,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[b]||0,timesSurvivedDay:t.survivalsByDay[b]||0,isHighlightedAddition:!0}),D=!0}}return{highestSurvivalData:k,highlightedPlayerAddedToHighest:D}},[r,b,s,n.highlightedPlayer]),{lowestSurvivalData:g,highlightedPlayerAddedToLowest:y}=I.useMemo(()=>{if(!r)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const l=De(r,b,s),P=n.highlightedPlayer&&l.some(t=>t.playerName===n.highlightedPlayer),k=l.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let D=!1;if(n.highlightedPlayer&&!P){const t=r.playerSurvivalStats.find(i=>i.playerName===n.highlightedPlayer);if(t&&t.totalGames>=s&&(t.gamesPlayedByDay[b]||0)>0){const i=t.survivalRatesByDay[b]||0;k.push({name:n.highlightedPlayer,value:i,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[b]||0,timesSurvivedDay:t.survivalsByDay[b]||0,isHighlightedAddition:!0}),D=!0}}return{lowestSurvivalData:k,highlightedPlayerAddedToLowest:D}},[r,b,s,n.highlightedPlayer]),B=l=>{p({selectedPlayer:l,fromComponent:"Statistiques de Survie"})},j=({active:l,payload:P,label:k})=>{if(l&&P&&P.length>0){const D=P[0].payload,t=D.isHighlightedAddition,i=n.highlightedPlayer===D.name,a=D.gamesPlayed>=s,x=D.timesReachedDay-D.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:k})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",b,": ",D.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",b,": ",D.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",b,": ",D.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",b,": ",x]}),e.jsxs("div",{children:["Total de parties: ",D.gamesPlayed]}),t&&!a&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",s," parties au total)"]}),t&&a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),i&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return o?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):A?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",A]}):r?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",b," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",R||y?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:b,onChange:l=>N(parseInt(l.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:E.map(l=>e.jsx("option",{value:l,children:l},l))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:s,onChange:l=>m(parseInt(l.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:le.map(l=>e.jsx("option",{value:l,children:l},l))})]})]})}),b&&r.dayStats.find(l=>l.dayNumber===b)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:b===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${b}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:r.dayStats.find(l=>l.dayNumber===b)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",b]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(r.dayStats.find(l=>l.dayNumber===b)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",s," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:r.playerSurvivalStats.filter(l=>l.totalGames>=s&&(l.gamesPlayedByDay[b]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",b]}),R&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${b}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:v,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:l,y:P,payload:k})=>e.jsx("text",{x:l,y:P,dy:16,textAnchor:"end",transform:`rotate(-45, ${l}, ${P})`,fill:n.highlightedPlayer===k.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===k.value?14:12,fontWeight:n.highlightedPlayer===k.value?"bold":"normal",children:k.value})}),e.jsx(U,{tickFormatter:l=>`${l.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(j,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:v.map((l,P)=>{const k=n.highlightedPlayer===l.name,D=f===l.name,t=l.isHighlightedAddition;return e.jsx(X,{fill:d[l.name]||"var(--chart-primary)",stroke:k?"var(--accent-primary)":D?"var(--text-primary)":"none",strokeWidth:k?3:D?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>B(l.name),onMouseEnter:()=>M(l.name),onMouseLeave:()=>M(null),style:{cursor:"pointer"}},`cell-highest-${P}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",b]}),y&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(q,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${b}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:g,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:l,y:P,payload:k})=>e.jsx("text",{x:l,y:P,dy:16,textAnchor:"end",transform:`rotate(-45, ${l}, ${P})`,fill:n.highlightedPlayer===k.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===k.value?14:12,fontWeight:n.highlightedPlayer===k.value?"bold":"normal",children:k.value})}),e.jsx(U,{tickFormatter:l=>`${l.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(j,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:g.map((l,P)=>{const k=n.highlightedPlayer===l.name,D=f===l.name,t=l.isHighlightedAddition;return e.jsx(X,{fill:d[l.name]||"var(--chart-color-4)",stroke:k?"var(--accent-primary)":D?"var(--text-primary)":"none",strokeWidth:k?3:D?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>B(l.name),onMouseEnter:()=>M(l.name),onMouseLeave:()=>M(null),style:{cursor:"pointer"}},`cell-lowest-${P}`)})})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function $e(){const{navigationState:r,updateNavigationState:h}=te(),[s,m]=I.useState(r.deathStatisticsState?.selectedCamp||r.deathStatsSelectedCamp||"Tous les camps"),[o,A]=I.useState(r.deathStatisticsState?.victimCampFilter||"Tous les camps"),[p,n]=I.useState(r.deathStatisticsState?.minGamesForAverage||25),[u,d]=I.useState(()=>{const c=r.deathStatisticsState?.selectedView;return c&&c!=="location"?c:"killers"}),{data:K}=xe(),{data:N,isLoading:f,error:M}=ve(s,o),{data:E,isLoading:b,error:v}=fe(),{data:R,isLoading:g,error:y}=Te(s),{data:B}=pe(),j=ye();I.useEffect(()=>{(!r.deathStatisticsState||r.deathStatisticsState.selectedCamp!==s||r.deathStatisticsState.victimCampFilter!==o||r.deathStatisticsState.minGamesForAverage!==p||r.deathStatisticsState.selectedView!==u)&&h({deathStatisticsState:{selectedCamp:s,victimCampFilter:o,minGamesForAverage:p,selectedView:u,focusChart:r.deathStatisticsState?.focusChart}})},[s,o,p,u,r.deathStatisticsState,h]);const l=I.useMemo(()=>B?je(B):[],[B]),P=I.useMemo(()=>{const c={};l.forEach(T=>{T===G.BY_WOLF?c[T]=j.Loup:T===G.VOTED?c[T]="var(--chart-color-1)":T===G.BULLET||T===G.BULLET_HUMAN||T===G.BULLET_WOLF?c[T]=j.Chasseur:T===G.BY_ZOMBIE?c[T]=j.Vaudou:T===G.ASSASSIN?c[T]=j.Alchimiste:T===G.AVENGER?c[T]="var(--chart-color-2)":T===G.LOVER_DEATH?c[T]=j.Amoureux:T===G.BY_BEAST?c[T]="var(--chart-color-3)":T===G.SHERIF_SUCCESS?c[T]="var(--chart-color-4)":T===G.SMUGGLER_HUNT_KILL&&(c[T]=j.Contrebandier)});const z=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let V=0;return l.forEach(T=>{c[T]||(c[T]=z[V%z.length],V++)}),c},[l,j]),k=c=>{m(c),h({deathStatsSelectedCamp:c,deathStatisticsState:{selectedCamp:c,victimCampFilter:o,minGamesForAverage:p,selectedView:u,focusChart:r.deathStatisticsState?.focusChart}})},D=c=>{A(c),h({deathStatisticsState:{selectedCamp:s,victimCampFilter:c,minGamesForAverage:p,selectedView:u,focusChart:r.deathStatisticsState?.focusChart}})},t=c=>{n(c),h({deathStatisticsState:{selectedCamp:s,victimCampFilter:o,minGamesForAverage:c,selectedView:u,focusChart:r.deathStatisticsState?.focusChart}})},i=c=>{d(c),h({deathStatisticsState:{selectedCamp:s,victimCampFilter:o,minGamesForAverage:p,selectedView:c,focusChart:r.deathStatisticsState?.focusChart}})},{gamesWithKillers:a,totalEligibleForAverage:x}=I.useMemo(()=>{if(!N)return{gamesWithKillers:0,totalEligibleForAverage:0};const c=N.killerStats.filter(z=>z.gamesPlayed>=p);return{gamesWithKillers:N.totalGames,totalEligibleForAverage:c.length}},[N,p]);return f?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):M?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",M]}):N?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="killers"?"active":""}`,onClick:()=>i("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="deaths"?"active":""}`,onClick:()=>i("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="survival"?"active":""}`,onClick:()=>i("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="hunter"?"active":""}`,onClick:()=>i("hunter"),children:"Chasseur"})]}),(u==="killers"||u==="deaths"||u==="survival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:s,onChange:c=>k(c.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),K?.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),u==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:o,onChange:c=>D(c.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(u==="killers"||u==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:N.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:N.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:a})]})]}),u==="killers"&&e.jsx(Me,{deathStats:N,selectedCamp:s,victimCampFilter:o,minGamesForAverage:p,onMinGamesChange:t,availableDeathTypes:l,deathTypeColors:P,totalEligibleForAverage:x}),u==="deaths"&&e.jsx(Re,{deathStats:N,selectedCamp:s,minGamesForAverage:p,onMinGamesChange:t,availableDeathTypes:l,deathTypeColors:P}),u==="hunter"&&e.jsx(He,{hunterStats:E,isLoading:b,error:v}),u==="survival"&&e.jsx(ze,{survivalStats:R,selectedCamp:s,minGamesForAverage:p,onMinGamesChange:t,isLoading:g,error:y}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"DonnÃ©es en cours de rÃ©cupÃ©ration (donnÃ©es partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{$e as DeathStatisticsChart};
