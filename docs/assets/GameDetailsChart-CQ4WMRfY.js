import{h as Y,r as F,j as a,u as ee,a as ae}from"./index-D8cVcsMD.js";import{g as C,a as x,e as se}from"./datasyncExport-DePHmlp0.js";import{g as W,a as te}from"./gameUtils-D1jwZHMq.js";import{a as O,c as ne,b as B}from"./api-DCm3oGtw.js";function re(e,t){if(!e)return null;try{const n=new URL(e);let i="",s=0;if(n.hostname==="youtu.be"){i=n.pathname.slice(1);const c=n.searchParams.get("t");c&&(s=parseInt(c,10)||0)}else if(n.hostname==="www.youtube.com"||n.hostname==="youtube.com"){i=n.searchParams.get("v")||"";const c=n.searchParams.get("t");c&&(s=parseInt(c,10)||0)}if(!i)return null;const r=`https://www.youtube.com/embed/${i}?start=${s}`;if(t)try{const c=new URL(t);let o=0;if(c.hostname==="youtu.be"){const d=c.searchParams.get("t");d&&(o=parseInt(d,10)||0)}else if(c.hostname==="www.youtube.com"||c.hostname==="youtube.com"){const d=c.searchParams.get("t");d&&(o=parseInt(d,10)||0)}if(o>s)return`${r}&end=${o}`}catch(c){console.warn("Failed to parse end URL:",t,c)}return r}catch(n){return console.warn("Failed to create YouTube embed URL:",e,n),null}}function le(e,t){if(!e||!t)return null;try{const n=new Date(e),i=new Date(t);if(isNaN(n.getTime())||isNaN(i.getTime()))return console.warn("Invalid date format:",e,t),null;const s=i.getTime()-n.getTime();return s>0?Math.round(s/1e3):null}catch(n){return console.warn("Failed to calculate game duration:",e,t,n),null}}function ie(e,t,n=!1,i=!1){const s=Y(e).toLowerCase(),r=t.PlayerStats.find(o=>Y(o.Username).toLowerCase()===s);return r?C(x(r.MainRoleInitial,r.MainRoleChanges||[]),{regroupLovers:!0,regroupVillagers:!i,regroupWolfSubRoles:!n}):"Villageois"}function oe(e,t,n){const i=e.toLowerCase(),s=n.PlayerStats.find(c=>c.Username.toLowerCase()===i);return s?C(x(s.MainRoleInitial,s.MainRoleChanges||[]))===t:!1}function _(e,t,n){const i=e.filter(s=>s.PlayerStats.some(r=>r.Username.toLowerCase()===t.toLowerCase()));return!n||n==="all-assignments"?i:n==="wins-only"?i.filter(s=>s.PlayerStats.some(r=>r.Username.toLowerCase()===t.toLowerCase()&&r.Victorious)):i}function ce(e,t){return e.filter(n=>n.DisplayedId===t)}function ue(e,t){return e.filter(n=>t.includes(n.DisplayedId))}function de(e,t){return e.filter(n=>{const s=new Date(n.StartDate).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"});if(t.includes("/")&&t.split("/").length===2){const[r,c]=t.split("/"),o=s.split("/");if(o.length===3){const[,d,m]=o;return d===r&&m===c}}else return s===t;return!1})}function me(e,t){return e.filter(n=>n.LegacyData?.VictoryType===t)}function he(e,t){return e.filter(n=>t==="Village"||t==="Château"?n.MapName===t:t==="Autres"?n.MapName!=="Village"&&n.MapName!=="Château":n.MapName===t)}function pe(e,t){return e.filter(n=>{const i=n.HarvestGoal,s=n.HarvestDone;if(i==null||s===null||s===void 0||i===0)return!1;const r=s/i*100;switch(t){case"0-25%":return r>=0&&r<=25;case"26-50%":return r>25&&r<=50;case"51-75%":return r>50&&r<=75;case"76-99%":return r>75&&r<=99;case"100%":return r>=100;default:return!0}})}function ye(e,t){return e.filter(n=>{if(!n.EndTiming)return!1;const i=n.EndTiming.match(/(?:Nuit|Jour)\s+(\d+)/);return i?parseInt(i[1],10)===t:!1})}function fe(e,t,n){const{selectedCamp:i,campFilterMode:s,_smallCamps:r,excludeWolfSubRoles:c}=t;return e.filter(o=>{if(n){if(i==="Autres"&&r)return r.some(u=>oe(n,u,o))?s==="wins-only"?o.PlayerStats.find(j=>j.Username.toLowerCase()===n.toLowerCase())?.Victorious===!0:!0:!1;const d=ie(n,o,c);let m=!1;return i==="Loup"&&c?m=d==="Loup"&&!o.PlayerStats.some(h=>h.Username.toLowerCase()===n.toLowerCase()&&(x(h.MainRoleInitial,h.MainRoleChanges||[])==="Traître"||x(h.MainRoleInitial,h.MainRoleChanges||[])==="Louveteau")):m=d===i,m?s==="wins-only"?o.PlayerStats.find(u=>u.Username.toLowerCase()===n.toLowerCase())?.Victorious===!0:!0:!1}else if(s==="wins-only"){const d=W(o);return i==="Autres"&&r?r.includes(d):d===i}else return i==="Autres"&&r?r.some(d=>o.PlayerStats.some(m=>C(x(m.MainRoleInitial,m.MainRoleChanges||[]))===d)):o.PlayerStats.some(d=>C(x(d.MainRoleInitial,d.MainRoleChanges||[]))===i)})}function ge(e,t,n){const{selectedPlayers:i,playersFilterMode:s,winnerPlayer:r}=t;return e.filter(c=>{const o=c.PlayerStats.flatMap(h=>[h.Username.toLowerCase(),(h.ID??h.Username).toLowerCase()]);if(!i.every(h=>o.includes(h.toLowerCase())))return!1;const m=i.map(h=>{const u=h.toLowerCase(),j=c.PlayerStats.find(v=>{const p=(v.ID??v.Username).toLowerCase();return v.Username.toLowerCase()===u||p===u}),R=x(j?.MainRoleInitial||"",j?.MainRoleChanges||[]);return C(R,{regroupWolfSubRoles:n?.excludeWolfSubRoles||!1})});switch(s){case"all-common-games":if(r){const p=r.toLowerCase();return c.PlayerStats.find(P=>{const G=(P.ID??P.Username).toLowerCase();return P.Username.toLowerCase()===p||G===p})?.Victorious===!0}return!0;case"opposing-camps":if(!([...new Set(m)].length>1))return!1;if(r){const p=i.findIndex(b=>b.toLowerCase()===r.toLowerCase());if(p!==-1){const b=m[p],P=W(c);return b==="Agent"&&P==="Agent"?c.PlayerStats.find(I=>I.Username.toLowerCase()===r.toLowerCase())?.Victorious===!0:b===P}}return!0;case"same-camp":if(!([...new Set(m)].length===1))return!1;const v=m[0];if(n&&n.selectedCamp){const p=n.selectedCamp;if(v!==p)return!1}if(r){const p=W(c);return v==="Agent"&&p==="Agent"?i.every(b=>c.PlayerStats.find(G=>G.Username.toLowerCase()===b.toLowerCase())?.Victorious===!0):v===p}return!0;default:return!0}})}function Ce(e,t){const{selectedPlayerPair:n,selectedPairRole:i}=t;return n.length!==2?e:e.filter(s=>{const r=s.PlayerStats.flatMap(o=>[o.Username.toLowerCase(),(o.ID??o.Username).toLowerCase()]);if(!n.every(o=>r.includes(o.toLowerCase())))return!1;switch(i){case"wolves":return n.every(o=>{const d=o.toLowerCase(),m=s.PlayerStats.find(h=>{const u=(h.ID??h.Username).toLowerCase();return h.Username.toLowerCase()===d||u===d});return C(x(m?.MainRoleInitial||"",m?.MainRoleChanges||[]))==="Loup"});case"lovers":return n.every(o=>{const d=o.toLowerCase(),m=s.PlayerStats.find(h=>{const u=(h.ID??h.Username).toLowerCase();return h.Username.toLowerCase()===d||u===d});return C(x(m?.MainRoleInitial||"",m?.MainRoleChanges||[]))==="Amoureux"});default:return!0}})}function xe(e,t,n){const i=t&&(t.selectedPlayer||t.selectedGame||t.selectedVictoryType||t.selectedDate||t.selectedHarvestRange||t.selectedGameDuration||t.selectedGameIds&&t.selectedGameIds.length>0||t.selectedMapName||t.campFilter||t.playerPairFilter||t.multiPlayerFilter);if(!i&&n)return _(e,n,"all-assignments");if(!i)return e;let s=[...e];return t.selectedPlayer&&(s=_(s,t.selectedPlayer,t.selectedPlayerWinMode)),t.selectedGame&&(s=ce(s,t.selectedGame)),t.selectedGameIds&&(s=ue(s,t.selectedGameIds)),t.campFilter&&(s=fe(s,t.campFilter,t.selectedPlayer)),t.selectedDate&&(s=de(s,t.selectedDate)),t.selectedHarvestRange&&(s=pe(s,t.selectedHarvestRange)),t.selectedVictoryType&&(s=me(s,t.selectedVictoryType)),t.selectedGameDuration&&(s=ye(s,t.selectedGameDuration)),t.selectedMapName&&(s=he(s,t.selectedMapName)),t.multiPlayerFilter&&(s=ge(s,t.multiPlayerFilter,t.campFilter)),t.playerPairFilter&&(s=Ce(s,t.playerPairFilter)),s}function je(e,t,n){return e.length===0?null:xe(e,t,n).map(s=>{const r=s.PlayerStats.length,c=s.PlayerStats.filter(y=>C(x(y.MainRoleInitial,y.MainRoleChanges||[]))==="Loup"),o=s.PlayerStats.filter(y=>C(x(y.MainRoleInitial,y.MainRoleChanges||[]))==="Traître"),d=s.PlayerStats.filter(y=>C(x(y.MainRoleInitial,y.MainRoleChanges||[]))==="Louveteau"),m=s.PlayerStats.filter(y=>C(x(y.MainRoleInitial,y.MainRoleChanges||[]))==="Amoureux"),h=s.PlayerStats.filter(y=>y.Victorious),u=c.length+o.length+d.length,j=W(s),R=["Loup","Villageois","Amoureux"],v=s.PlayerStats.filter(y=>!R.includes(C(x(y.MainRoleInitial,y.MainRoleChanges||[])))),p=v.length>0?v.map(y=>C(x(y.MainRoleInitial,y.MainRoleChanges||[]))).join(", "):null,P=new Date(s.StartDate).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"});let G=0;if(s.EndTiming){const y=s.EndTiming.match(/[UNJMC](\d+)/);y&&(G=parseInt(y[1],10))}let I=null;return s.HarvestGoal&&s.HarvestGoal>0&&(I=s.HarvestDone/s.HarvestGoal),{gameId:s.DisplayedId,date:P,isModded:s.Modded||!1,playerCount:r,wolfCount:u,hasTraitor:o.length>0,hasWolfCub:d.length>0,hasLovers:m.length>0,soloRoles:p,winningCamp:j,dayCount:G,winners:h.map(y=>y.Username).join(", "),harvest:s.HarvestDone,totalHarvest:s.HarvestGoal,harvestPercentage:I,playersList:s.PlayerStats.map(y=>y.Username).join(", "),versions:s.Version||null,map:s.MapName,victoryType:s.LegacyData?.VictoryType||null,youtubeEmbedUrl:re(s.LegacyData?.VODLink||null,s.LegacyData?.VODLinkEnd||null),gameDuration:le(s.StartDate,s.EndDate),playerData:s.PlayerStats}})}function ve(e,t){const{data:n,isLoading:i,error:s}=se(r=>je(r,e,t));return{data:n||[],isLoading:i,error:s}}const Ne=({playerData:e})=>{const t=O(),n=ne(),i=e.reduce((r,c)=>{const o=C(x(c.MainRoleInitial,c.MainRoleChanges||[]));return r[o]||(r[o]=[]),r[o].push(c),r},{}),s=Object.entries(i).sort(([r,c],[o,d])=>{const m=B.includes(r),h=B.includes(o);return m&&!h?-1:!m&&h?1:d.length-c.length});return a.jsxs("div",{className:"lycans-game-detail-section full-width",children:[a.jsx("h4",{children:"Composition des Camps"}),a.jsx("div",{className:"camps-grid",children:s.map(([r,c])=>{const o=c,d=t[r]||"#666",h=o.filter(u=>u.Victorious).length>0;return a.jsxs("div",{className:`camp-group ${h?"winning-camp":""}`,style:{borderColor:d,backgroundColor:`${d}15`,boxShadow:h?`0 0 10px ${d}40`:"none"},children:[a.jsx("div",{className:"camp-header",style:{backgroundColor:`${d}25`},children:a.jsxs("h5",{style:{color:d},children:[r," (",o.length,")",h&&a.jsx("span",{className:"victory-crown",children:"👑"})]})}),a.jsx("div",{className:"camp-players",children:o.sort((u,j)=>u.Username.localeCompare(j.Username)).map(u=>{let j=d;return u.Color&&n[u.Color]&&(j=n[u.Color]),a.jsxs("div",{className:`player-badge ${u.Victorious?"winner":""} ${u.DeathTiming?"dead":"alive"}`,style:{borderColor:j},title:`${u.Username} - ${C(u.MainRoleInitial)!==C(x(u.MainRoleInitial,u.MainRoleChanges||[]))?`${C(u.MainRoleInitial)} puis ${C(x(u.MainRoleInitial,u.MainRoleChanges||[]))}`:C(u.MainRoleInitial)}${u.DeathTiming?` (Mort ${te(u.DeathTiming)})`:""}`,children:[a.jsx("span",{className:"player-name",children:u.Username}),u.DeathTiming&&a.jsx("span",{className:"death-indicator",children:"💀"}),u.Victorious&&a.jsx("span",{className:"victory-indicator",children:"⭐"})]},u.Username)})})]},r)})})]})};function we(e){if(e===null||e<=0)return"N/A";const t=Math.floor(e/60),n=e%60;return t===0?`${n}s`:n===0?`${t}m`:`${t}m ${n}s`}function Pe({game:e}){const[t,n]=F.useState(!1),i=O();return a.jsx("div",{className:"lycans-game-detail-view",children:a.jsxs("div",{className:"lycans-game-detail-grid",children:[a.jsxs("div",{className:"lycans-game-detail-section",children:[a.jsx("h4",{children:"Informations Générales"}),a.jsxs("div",{className:"lycans-game-detail-stats",children:[a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Nombre de joueurs:"}),a.jsx("span",{className:"value",children:e.playerCount})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Nombre de loups:"}),a.jsx("span",{className:"value",children:e.wolfCount})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Traître:"}),a.jsx("span",{className:"value",children:e.hasTraitor?"Oui":"Non"})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Louveteau:"}),a.jsx("span",{className:"value",children:e.hasWolfCub?"Oui":"Non"})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Amoureux:"}),a.jsx("span",{className:"value",children:e.hasLovers?"Oui":"Non"})]}),e.soloRoles&&a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Rôles solo:"}),a.jsx("span",{className:"value",children:e.soloRoles})]})]})]}),a.jsxs("div",{className:"lycans-game-detail-section",children:[a.jsx("h4",{children:"Informations Supplémentaires"}),a.jsxs("div",{className:"lycans-game-detail-stats",children:[e.victoryType!==null&&a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Type de victoire:"}),a.jsx("span",{className:"value",children:e.victoryType})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Jours de jeu:"}),a.jsx("span",{className:"value",children:e.dayCount})]}),e.gameDuration!==null&&a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Durée de la partie:"}),a.jsx("span",{className:"value",children:we(e.gameDuration)})]}),e.versions&&a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Version:"}),a.jsxs("span",{className:"value",children:[e.versions,e.isModded?" (moddée)":""]})]}),e.map&&a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Map:"}),a.jsx("span",{className:"value",children:e.map})]})]})]}),e.harvest!==null&&a.jsxs("div",{className:"lycans-game-detail-section",children:[a.jsx("h4",{children:"Récolte"}),a.jsxs("div",{className:"lycans-game-detail-stats",children:[a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Récolte:"}),a.jsx("span",{className:"value",children:e.harvest})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Total possible:"}),a.jsx("span",{className:"value",children:e.totalHarvest})]}),a.jsxs("div",{className:"lycans-stat-item",children:[a.jsx("span",{className:"label",children:"Pourcentage:"}),a.jsx("span",{className:"value",children:typeof e.harvestPercentage=="number"?(e.harvestPercentage*100).toFixed(1)+"%":"N/A"})]})]})]}),a.jsx(Ne,{playerData:e.playerData}),a.jsxs("div",{className:"lycans-game-detail-section full-width",children:[a.jsx("h4",{children:"Rôles des Joueurs"}),a.jsx("div",{className:"lycans-player-roles-grid",children:e.playerData.sort((s,r)=>{const c=C(x(s.MainRoleInitial,s.MainRoleChanges||[])),o=C(x(r.MainRoleInitial,r.MainRoleChanges||[])),d=B.indexOf(c),m=B.indexOf(o);return d!==-1&&m!==-1?d-m:d!==-1?-1:m!==-1?1:c!==o?c.localeCompare(o):s.Username.localeCompare(r.Username)}).map(s=>{const r=C(s.MainRoleInitial),c=s.MainRoleInitial,o=C(x(s.MainRoleInitial,s.MainRoleChanges||[])),d=x(s.MainRoleInitial,s.MainRoleChanges||[]),m=s.Power,h=s.SecondaryRole;let u=r;c&&c!==r&&(u+=` - ${c}`),m&&m.trim()&&(u+=` - ${m}`),h&&h.trim()&&(u+=` + ${h}`),d&&d!==c&&(u+=` (devient ${d})`);let j=i[x(s.MainRoleInitial,s.MainRoleChanges||[])]||"#666";j==="#666"&&(j=i[o]||"#666");const R=i[o]||"#666",v=s.DeathTiming,p=s.Victorious;return a.jsxs("div",{className:`lycans-player-role-item ${p?"victorious":""}`,style:{borderColor:R},children:[a.jsxs("div",{className:"lycans-player-name",style:{color:j,textAlign:"left"},children:[s.Username,v&&a.jsx("span",{className:"death-skull",children:"💀"})]}),a.jsx("div",{className:"lycans-player-camp",style:{textAlign:"left"},children:u})]},s.Username)})})]}),e.youtubeEmbedUrl&&a.jsx("div",{className:"lycans-game-detail-section full-width",children:a.jsx("button",{onClick:()=>n(!t),className:"lycans-video-toggle-btn",children:t?"📹 Masquer la vidéo":"🎥 Voir la vidéo"})}),e.youtubeEmbedUrl&&t&&a.jsxs("div",{className:"lycans-game-detail-section full-width",children:[a.jsx("h4",{children:"Vidéo de la Partie"}),a.jsx("div",{className:"lycans-youtube-container",children:a.jsx("iframe",{src:e.youtubeEmbedUrl,title:`Partie Lycans #${e.gameId}`,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"lycans-youtube-iframe"})})]})]})})}function De(){const{navigationFilters:e,navigateBack:t}=ee(),{settings:n}=ae(),i=!!(e.selectedPlayer||e.selectedGame||e.selectedVictoryType||e.selectedDate||e.selectedHarvestRange||e.selectedGameDuration||e.selectedGameIds&&e.selectedGameIds.length>0||e.selectedMapName||e.campFilter||e.playerPairFilter||e.multiPlayerFilter),s=i?null:n.highlightedPlayer,{data:r,isLoading:c,error:o}=ve(e,s),d=O(),[m,h]=F.useState("date"),[u,j]=F.useState("desc"),[R,v]=F.useState(null),[p,b]=F.useState(1),[P,G]=F.useState(25),I=F.useRef(!1),L=e.selectedPlayer?[e.selectedPlayer]:e.playerPairFilter?.selectedPlayerPair?e.playerPairFilter.selectedPlayerPair:e.multiPlayerFilter?.selectedPlayers?e.multiPlayerFilter.selectedPlayers:n.highlightedPlayer?[n.highlightedPlayer]:[],k=L.length>0,K=()=>L.length===0?"Vainqueur":L.length===1?L[0]+" (victoire)":L.length===2?L.join(" & ")+" (victoires)":`${L.slice(0,2).join(" & ")} (+${L.length-2}) (victoires)`,E=l=>{if(!k)return"";if(!i&&s)return(l.winners?l.winners.split(",").map(q=>q.trim()):[]).filter(q=>L.some(Z=>Z.toLowerCase()===q.toLowerCase())).length>0?"✅":"❌";const g=l.playersList?l.playersList.split(",").map(w=>w.trim()):[];return L.filter(w=>g.some(S=>S.toLowerCase()===w.toLowerCase())).length===0?"Pas dans la partie":(l.winners?l.winners.split(",").map(w=>w.trim()):[]).filter(w=>L.some(S=>S.toLowerCase()===w.toLowerCase())).length>0?"✅":"❌"},$=F.useMemo(()=>r?[...r].sort((l,g)=>{let f,N;switch(m){case"date":f=new Date(l.date.split("/").reverse().join("-")).getTime(),N=new Date(g.date.split("/").reverse().join("-")).getTime();break;case"gameId":f=parseInt(l.gameId,10),N=parseInt(g.gameId,10);break;case"playerCount":f=l.playerCount,N=g.playerCount;break;case"gameDuration":f=l.gameDuration||0,N=g.gameDuration||0;break;case"winningCamp":f=l.winningCamp,N=g.winningCamp;break;case"winner":f=E(l),N=E(g);break;default:return 0}let M;if(u==="asc"?M=f>N?1:f<N?-1:0:M=f<N?1:f>N?-1:0,M===0){const w=parseInt(l.gameId,10),S=parseInt(g.gameId,10);return u==="asc"?w-S:S-w}return M}):[],[r,m,u]),D=Math.ceil($.length/P),A=(p-1)*P,H=A+P,Q=$.slice(A,H);F.useEffect(()=>{if(I.current){I.current=!1;return}b(1),v(null)},[r]),F.useEffect(()=>{b(1),v(null)},[m,u]);const T=l=>{I.current=!0,b(l),v(null)},X=l=>{I.current=!0,G(l),b(1),v(null)},J=l=>{I.current=!0,v(R===l?null:l)},V=l=>{m===l?j(u==="asc"?"desc":"asc"):(h(l),j("desc"))},U=l=>m!==l?"↕️":u==="asc"?"↗️":"↘️",z=()=>{const l=[];if(e.selectedPlayer&&e.campFilter){const g=e.selectedPlayerWinMode==="wins-only"?" (victoires uniquement)":"";let f=e.campFilter.selectedCamp;e.campFilter.selectedCamp==="Loup"&&e.campFilter.excludeWolfSubRoles?f="Loups sans Traître/Louveteau":e.campFilter.selectedCamp==="Villageois"&&e.campFilter.excludeVillagers&&(f="Villageois sans Chasseur/Alchimiste"),l.push(`${e.selectedPlayer} jouant ${f}${g}`)}else{if(e.selectedPlayer){const g=e.selectedPlayerWinMode==="wins-only"?" (victoires uniquement)":e.selectedPlayerWinMode==="all-assignments"?" (toutes parties)":"";l.push(`Joueur: ${e.selectedPlayer}${g}`)}if(e.campFilter){const{campFilterMode:g}=e.campFilter;let f=e.campFilter.selectedCamp;e.campFilter.selectedCamp==="Loup"&&e.campFilter.excludeWolfSubRoles?f="Loups sans Traître/Louveteau":e.campFilter.selectedCamp==="Villageois"&&e.campFilter.excludeVillagers&&(f="Villageois sans Chasseur/Alchimiste");const N=`Camp: ${f}`,M=g==="wins-only"?" (victoires uniquement)":g==="all-assignments"?" (toutes assignations)":"";l.push(N+M)}}if(e.selectedMapName){const g=e.selectedMapName==="Autres"?"autres cartes":e.selectedMapName;l.push(`Carte: ${g}`)}if(e.playerPairFilter){const{selectedPlayerPair:g,selectedPairRole:f}=e.playerPairFilter,N=g.join(" & "),M=f==="wolves"?"loups":"amoureux";l.push(`Paire ${M}: ${N}`)}if(e.multiPlayerFilter){const{selectedPlayers:g,playersFilterMode:f,winnerPlayer:N}=e.multiPlayerFilter,M=g.join(" & ");let w="";f==="all-common-games"?w="toutes les parties communes":f==="opposing-camps"?w="affrontements uniquement":f==="same-camp"&&(w="parties en équipe (même camp)");const S=N?` (victoires de ${N})`:"";l.push(`${M} (${w}${S})`)}return e.selectedVictoryType&&l.push(`Victoire: ${e.selectedVictoryType}`),e.selectedHarvestRange&&l.push(`Récolte: ${e.selectedHarvestRange}`),e.selectedGameDuration&&l.push(`Durée: ${e.selectedGameDuration} jour${e.selectedGameDuration>1?"s":""}`),e.selectedGame&&l.push(`Partie ${e.selectedGame}`),e.selectedDate&&(e.selectedDate.includes("/")&&e.selectedDate.split("/").length===2?l.push(`Mois: ${e.selectedDate}`):l.push(`Date: ${e.selectedDate}`)),e.selectedGameIds&&e.selectedGameIds.length>0&&l.push(`${e.selectedGameIds.length} parties sélectionnée${e.selectedGameIds.length>1?"s":""}`),l};return c?a.jsx("div",{className:"statistiques-chargement",children:"Chargement des détails des parties..."}):o?a.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",o]}):!r||r.length===0?a.jsxs("div",{className:"lycans-empty-section",children:[a.jsx("h2",{children:"Aucune partie trouvée"}),a.jsx("p",{children:"Aucune partie ne correspond aux critères sélectionnés."}),e.fromComponent&&a.jsxs("button",{onClick:t,className:"lycans-submenu-btn",style:{marginTop:"1rem"},children:["← Retour à ",e.fromComponent]})]}):a.jsxs("div",{className:"lycans-game-details",children:[a.jsxs("div",{className:"lycans-game-details-header",children:[a.jsxs("div",{className:"lycans-game-details-navigation",children:[e.fromComponent&&a.jsxs("button",{onClick:t,className:"lycans-submenu-btn",style:{marginRight:"1rem"},children:["← Retour à ",e.fromComponent]}),a.jsxs("h2",{children:["Détails des Parties (",r.length," partie",r.length>1?"s":"",")"]})]}),z().length>0&&a.jsxs("div",{className:"lycans-active-filters",children:[a.jsx("strong",{children:"Filtres actifs:"})," ",z().join(", ")]})]}),D>1&&a.jsxs("div",{className:"lycans-pagination-container",children:[a.jsxs("div",{className:"lycans-pagination-info",children:["Affichage de ",A+1," à ",Math.min(H,$.length)," sur ",$.length," parties"]}),a.jsxs("div",{className:"lycans-pagination-controls",children:[a.jsxs("select",{value:P,onChange:l=>X(Number(l.target.value)),className:"lycans-pagination-select",children:[a.jsx("option",{value:10,children:"10 par page"}),a.jsx("option",{value:25,children:"25 par page"}),a.jsx("option",{value:50,children:"50 par page"}),a.jsx("option",{value:100,children:"100 par page"})]}),a.jsxs("div",{className:"lycans-pagination-buttons",children:[a.jsx("button",{onClick:()=>T(1),disabled:p===1,className:"lycans-pagination-btn",children:"««"}),a.jsx("button",{onClick:()=>T(p-1),disabled:p===1,className:"lycans-pagination-btn",children:"‹"}),a.jsxs("span",{className:"lycans-pagination-current",children:["Page ",p," sur ",D]}),a.jsx("button",{onClick:()=>T(p+1),disabled:p===D,className:"lycans-pagination-btn",children:"›"}),a.jsx("button",{onClick:()=>T(D),disabled:p===D,className:"lycans-pagination-btn",children:"»»"})]})]})]}),a.jsx("div",{className:"lycans-games-table-container",children:a.jsxs("table",{className:"lycans-games-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>V("gameId"),className:"sortable",children:["Partie ",U("gameId")]}),a.jsxs("th",{onClick:()=>V("date"),className:"sortable",children:["Date ",U("date")]}),a.jsxs("th",{onClick:()=>V("playerCount"),className:"sortable",children:["Joueurs ",U("playerCount")]}),a.jsxs("th",{onClick:()=>V("gameDuration"),className:"sortable",children:["Durée ",U("gameDuration")]}),a.jsxs("th",{onClick:()=>V("winningCamp"),className:"sortable",children:["Camp Vainqueur ",U("winningCamp")]}),k&&a.jsxs("th",{onClick:()=>V("winner"),className:"sortable",children:[K()," ",U("winner")]}),a.jsx("th",{children:"Détails"})]})}),a.jsx("tbody",{children:Q.map(l=>a.jsxs(a.Fragment,{children:[a.jsxs("tr",{className:`${R===l.gameId?"selected":""} clickable-row`,onClick:()=>J(l.gameId),style:{cursor:"pointer"},children:[a.jsxs("td",{children:["#",l.gameId]}),a.jsx("td",{children:l.date}),a.jsx("td",{children:l.playerCount}),a.jsx("td",{children:be(l.gameDuration)}),a.jsx("td",{style:{color:d[l.winningCamp]||"#fff"},children:l.winningCamp}),k&&a.jsx("td",{style:{textAlign:"left",fontSize:"1.2rem",verticalAlign:"middle"},children:E(l)}),a.jsx("td",{children:a.jsx("button",{onClick:g=>{g.stopPropagation(),J(l.gameId)},className:"lycans-details-btn",children:R===l.gameId?"Masquer":"Voir"})})]},l.gameId),R===l.gameId&&a.jsx("tr",{className:"game-details-row",children:a.jsx("td",{colSpan:k?8:7,children:a.jsx(Pe,{game:l})})},`${l.gameId}-details`)]}))})]})}),D>1&&a.jsxs("div",{className:"lycans-pagination-container",children:[a.jsxs("div",{className:"lycans-pagination-info",children:["Affichage de ",A+1," à ",Math.min(H,$.length)," sur ",$.length," parties"]}),a.jsx("div",{className:"lycans-pagination-controls",children:a.jsxs("div",{className:"lycans-pagination-buttons",children:[a.jsx("button",{onClick:()=>T(1),disabled:p===1,className:"lycans-pagination-btn",children:"««"}),a.jsx("button",{onClick:()=>T(p-1),disabled:p===1,className:"lycans-pagination-btn",children:"‹"}),a.jsxs("span",{className:"lycans-pagination-current",children:["Page ",p," sur ",D]}),a.jsx("button",{onClick:()=>T(p+1),disabled:p===D,className:"lycans-pagination-btn",children:"›"}),a.jsx("button",{onClick:()=>T(D),disabled:p===D,className:"lycans-pagination-btn",children:"»»"})]})})]})]})}function be(e){if(e===null||e<=0)return"N/A";const t=Math.floor(e/60),n=e%60;return t===0?`${n}s`:n===0?`${t}m`:`${t}m ${n}s`}export{De as GameDetailsChart};
