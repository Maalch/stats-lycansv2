import{a as J,r as k,g as Y,f as le,u as O,j as e,c as oe,l as ce}from"./index-DsKVzdDr.js";import{u as U}from"./useJoueursData-v2UN-bXE.js";import{u as ae}from"./baseStatsHook-BUEDjTnL.js";import{g as de}from"./gameUtils-CCGRmivF.js";import{g as se,a as te,c as ue}from"./datasyncExport-D6_8Fmuy.js";import{u as Q,g as me,a as Z,l as re}from"./api-UdYmKHEN.js";import{d as pe}from"./durationFormatters-Br-IfF5C.js";import{F as z,C as G,X as L,Y as E,B,a as V,b as K}from"./FullscreenChart-2NGr9g12.js";import{R as W,T as q}from"./CategoricalChart-DBaj8-0p.js";import{L as he,a as ge}from"./LineChart-CKXSROM9.js";import{P as fe,a as xe}from"./PieChart-ol--S3RM.js";import{u as ve}from"./useDeathStatisticsFromRaw-Bbl9f9Qz.js";import{R as ee}from"./ReferenceLine-4J9wkJ2_.js";import{g as ye}from"./deathTypes-CGUOTngO.js";import"./ActivePoints-CXHO9nmU.js";import"./PolarChart-B3u8wHbv.js";function je(u){const{settings:j}=J(),{joueursData:C}=U(),[f,v]=k.useState(null),[x,R]=k.useState(!1),[h,c]=k.useState(null);k.useEffect(()=>{let n=!0;return(async()=>{try{R(!0),c(null);const r=j.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",s=await fetch(r);if(!s.ok)throw new Error(`Failed to load achievements: ${s.status} ${s.statusText}`);const i=await s.json();n&&v(i)}catch(r){n&&c(r instanceof Error?r.message:"Failed to load achievements")}finally{n&&R(!1)}})(),()=>{n=!1}},[j.dataSource]);const d=(()=>{if(!u||!f)return null;const t=C?.Players?.find(r=>r.Joueur===u)?.SteamID;return t?f.achievements[t]||null:(console.warn(`âš ï¸ No Steam ID found for player: ${u}`),null)})();return k.useEffect(()=>{if(u&&f&&C){const t=C.Players?.find(s=>s.Joueur===u)?.SteamID;if(!t){console.log(`âŒ No Steam ID found for player: ${u}`);return}const r=f.achievements[t];r?console.log(`ðŸ† Achievements for ${u} [ID: ${t}] (${j.dataSource}):`,{allGames:r.allGamesAchievements.length,moddedOnly:r.moddedOnlyAchievements.length,categories:[...new Set([...r.allGamesAchievements.map(s=>s.category),...r.moddedOnlyAchievements.map(s=>s.category)])]}):console.log(`âŒ No achievements found for ${u} [ID: ${t}] in ${j.dataSource} data source`)}},[u,f,C,j.dataSource]),{data:d,isLoading:x,error:h,metadata:{generatedAt:f?.generatedAt||null,totalPlayers:f?.totalPlayers||0,totalGames:f?.totalGames||0,totalModdedGames:f?.totalModdedGames||0}}}function Ce(u,j,C){if(!u||u.trim()===""||j.length===0)return null;const f=[];let v=u;j.forEach(t=>{const r=t.PlayerStats.find(s=>Y(s)===u||s.Username.toLowerCase()===u.toLowerCase());if(r){v=r.Username;const s=se(te(r.MainRoleInitial,r.MainRoleChanges||[]));if(C&&C!=="Tous les camps"&&s!==C)return;const i=de(t),m=r.Victorious,l=le(new Date(t.StartDate)),y=ue(t.StartDate,t.EndDate)||0;f.push({gameId:t.Id,date:l,camp:s,won:m,winnerCamp:i,playersInGame:t.PlayerStats.length,mapName:t.MapName,duration:y})}}),f.sort((t,r)=>{const s=i=>{const m=i.split("/");return m.length===3?new Date(parseInt(m[2]),parseInt(m[1])-1,parseInt(m[0])):new Date(i)};return s(r.date).getTime()-s(t.date).getTime()});const x=f.length,R=f.filter(t=>t.won).length,h=x>0?(R/x*100).toFixed(2):"0.00",c={};f.forEach(t=>{c[t.camp]||(c[t.camp]={appearances:0,wins:0,winRate:"0.00"}),c[t.camp].appearances++,t.won&&c[t.camp].wins++}),Object.keys(c).forEach(t=>{const r=c[t];r.winRate=r.appearances>0?(r.wins/r.appearances*100).toFixed(2):"0.00"});const d={};f.forEach(t=>{d[t.mapName]||(d[t.mapName]={appearances:0,wins:0,winRate:"0.00"}),d[t.mapName].appearances++,t.won&&d[t.mapName].wins++}),Object.keys(d).forEach(t=>{const r=d[t];r.winRate=r.appearances>0?(r.wins/r.appearances*100).toFixed(2):"0.00"});const n=f.reduce((t,r)=>t+r.duration,0);return{playerName:v,totalGames:x,totalWins:R,winRate:h,totalPlayTime:n,games:f,campStats:c,mapStats:d}}function be(u){const j={};let C=0,f=0;return Object.entries(u).forEach(([v,x])=>{v==="Village"||v==="ChÃ¢teau"?j[v]={...x}:(C+=x.appearances,f+=x.wins)}),C>=10&&(j.Autres={appearances:C,wins:f,winRate:C>0?(f/C*100).toFixed(2):"0.00"}),j}function X(u,j){const{data:C,isLoading:f,error:v}=ae(x=>u?Ce(u,x,j):null);return{data:C,isLoading:f,error:v}}function we({achievements:u,title:j,emptyMessage:C,achievementType:f="all"}){const{navigateToTab:v,updateNavigationState:x,clearNavigation:R}=O(),{settings:h,updateSettings:c}=J(),{joueursData:d}=U(),n=Q(d),t=(a,F)=>{if(F.stopPropagation(),!a.redirectTo)return;R();const P=h.highlightedPlayer;if(c(f==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),a.category==="comparison"&&a.redirectTo.subTab==="comparison"){const p=h.highlightedPlayer||"",g=r(a.description,p);g&&x({playerComparisonState:{selectedPlayer1:p,selectedPlayer2:g,showDetailedStats:!0}})}if(a.category==="comparison"&&a.redirectTo.subTab==="pairing"){const p=a.description.toLowerCase().includes("loup");x({selectedPairingTab:p?"wolves":"lovers"})}if(a.category==="kills"&&a.redirectTo.subTab==="deathStats"){const p=a.description.match(/(Villageois|Loups|Autres)/i);p&&x({deathStatsSelectedCamp:p[1]});let g=10;const b=a.description.match(/min\.\s*(\d+)/);b&&(g=parseInt(b[1],10));let N="totalKills",S="killers";const o=a.redirectTo.chartSection;o&&(o==="killers-total"?(N="totalKills",S="killers"):o==="killers-average"?(N="averageKills",S="killers"):o==="deaths-total"?(N="totalDeaths",S="deaths"):o==="survivors-average"?(N="survivalRate",S="deaths"):(o==="hunters-good"||o==="hunters-bad")&&(S="hunter",N="averageKills")),x({deathStatisticsState:{selectedCamp:p?.[1]||"Tous les camps",minGamesForAverage:g,selectedView:S,focusChart:N}})}if(a.category==="map"&&a.redirectTo.subTab==="playersGeneral"){const p=a.redirectTo.mapFilter||"all";let g=10;const b=a.description.match(/min\.\s*(\d+)/);b&&(g=parseInt(b[1])),c(f==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:p,playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:p,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:p,playerFilter:{mode:"none",players:[]},highlightedPlayer:P,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:p,playerFilter:{mode:"none",players:[]}}}),x({playersGeneralState:{minGamesForWinRate:g,winRateOrder:"best",focusChart:"winRate"}}),v("players","playersGeneral");return}if(a.category==="history"&&a.redirectTo.subTab==="history"&&x({selectedPlayerName:h.highlightedPlayer||"",groupingMethod:"session"}),a.category==="series"&&a.redirectTo.subTab==="series"){let p="wins";const g=a.title.toLowerCase(),b=a.description.toLowerCase();g.includes("dÃ©faite")||b.includes("dÃ©faite")?p="losses":g.includes("loup")||b.includes("loup")?p="loup":g.includes("villageois")||b.includes("villageois")?p="villageois":(g.includes("victoire")||b.includes("victoire"))&&(p="wins"),x({selectedSeriesType:p})}if(a.category==="general"&&a.redirectTo.subTab==="playersGeneral"){let p=10;const g=a.description.match(/min\.\s*(\d+)/);g&&(p=parseInt(g[1],10));let b="winRate",N="best";const S=a.title.toLowerCase(),o=a.description.toLowerCase();S.includes("participation")||o.includes("participation")?b="participation":(S.includes("taux de victoire")||o.includes("taux de victoire"))&&(b="winRate",(S.includes("moins bon")||S.includes("mauvais")||o.includes("moins bon")||o.includes("mauvais"))&&(N="worst")),x({playersGeneralState:{minGamesForWinRate:p,winRateOrder:N,focusChart:b}})}if(a.category==="performance"&&a.redirectTo.subTab==="campPerformance"){const p=a.redirectTo.chartSection;let g="Villageois",b=1;p&&(p==="camp-loup"?g="Loup":p==="camp-villageois"?g="Villageois":p==="camp-idiot"?g="Idiot du Village":p==="camp-amoureux"?g="Amoureux":(p==="solo-roles"||p==="hall-of-fame")&&(g="Villageois"));const N=a.description.match(/min\.\s*(\d+)/);N&&(b=parseInt(N[1],10)),p==="solo-roles"?g="RÃ´les spÃ©ciaux":p==="hall-of-fame"&&(g="Tous les camps"),x({campPerformanceState:{selectedCampPerformanceCamp:g,selectedCampPerformanceMinGames:b}})}if(a.category==="voting"&&a.redirectTo.subTab==="votingStats"){const p=a.title.toLowerCase();let g="overview",b="behavior";p.includes("agressivitÃ©")?(g="overview",b="behavior"):p.includes("taux de vote")?(g="behavior",b="voteRate"):p.includes("prÃ©cision")&&(g="overview",b="accuracy"),x({votingStatsState:{selectedCategory:g,selectedView:b}})}v(a.redirectTo.tab,a.redirectTo.subTab)},r=(a,F)=>{const P=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const p of P){const g=a.match(p);if(g&&g[1]){const b=g[1].trim();if(b!==F)return b}}return null},s=a=>{if(!a.redirectTo)return"Aucune navigation disponible";switch(a.category){case"general":if(a.redirectTo.subTab==="playersGeneral"){const p=a.description.match(/min\.\s*(\d+)/),g=p?parseInt(p[1],10):10,b=a.title.toLowerCase(),N=f==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return b.includes("taux de victoire")?`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${g} parties)${N}`:b.includes("participation")?`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir les participations${N}`:`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${N}`}break;case"map":if(a.redirectTo.subTab==="playersGeneral"){const p=a.redirectTo.mapFilter,g=p==="village"?"Village":p==="chateau"?"ChÃ¢teau":"map",b=f==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${g}${b}`}break;case"history":if(a.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(a.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${r(a.description,h.highlightedPlayer||"")||"ce joueur"}`;if(a.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(a.redirectTo.subTab==="deathStats"){const p=a.description.match(/(Villageois|Loups|Autres)/i),g=a.description.match(/min\.\s*(\d+)/),b=g?parseInt(g[1],10):10,N=p?.[1]||"Tous les camps",S=a.redirectTo.chartSection;let o="kills et morts";return S==="killers-total"?o="total des kills":S==="killers-average"?o=`moyenne des kills (min. ${b} parties)`:S==="deaths-total"?o="total des morts":S==="survivors-average"&&(o=`taux de survie (min. ${b} parties)`),`Cliquez pour voir les statistiques de ${o} ${N!=="Tous les camps"?`en ${N}`:""}`}break;case"series":if(a.redirectTo.subTab==="series"){const p=a.title.toLowerCase(),g=a.description.toLowerCase();return p.includes("dÃ©faite")||g.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":p.includes("loup")||g.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":p.includes("villageois")||g.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":p.includes("victoire")||g.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(a.redirectTo.subTab==="campPerformance"){const p=a.redirectTo.chartSection,g=f==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return p==="camp-loup"?`Cliquez pour voir les performances camp Loup${g}`:p==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${g}`:p==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${g}`:p==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${g}`:p==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${g}`:p==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${g}`:`Cliquez pour voir les performances par camp${g}`}break;case"voting":if(a.redirectTo.subTab==="votingStats"){const p=a.description.match(/min\.\s*(\d+)/),g=p?parseInt(p[1],10):25,b=f==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",N=a.title.toLowerCase();return N.includes("agressivitÃ©")?`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${g} meetings)${b}`:N.includes("taux de vote")?`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${g} meetings)${b}`:N.includes("prÃ©cision")?`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${b}`:`Classement: ${a.rank}${a.totalRanked?`/${a.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${b}`}break}return`Cliquez pour voir ${a.redirectTo.subTab}`+(f==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},i=a=>n[a]||me(a),m=a=>{const F=[/avec ([^:]+?):/,/contre ([^:]+?):/];let P=a;return F.forEach(p=>{const g=a.match(p);if(g&&g[1]){const b=g[1].trim(),S=`<span class="player-name-highlight" style="color: ${i(b)};">${b}</span>`;P=P.replace(b,S)}}),P};if(u.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:j}),e.jsx("p",{children:C||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const l=a=>a===1?"ðŸ¥‡":a===2?"ðŸ¥ˆ":a===3?"ðŸ¥‰":"",y=a=>a===1?"rank-1":a===2?"rank-2":a===3?"rank-3":a&&a<=10?"rank-top-10":"",w=u.filter(a=>a.category!=="comparison"&&(a.type==="good"||a.type==="neutral")).sort((a,F)=>(a.rank??999)-(F.rank??999)),D=u.filter(a=>a.category!=="comparison"&&a.type==="bad").sort((a,F)=>(a.rank??999)-(F.rank??999)),$=u.filter(a=>a.category==="comparison"),_=w.filter(a=>a.rank&&a.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:j}),_>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:w.filter(a=>a.rank&&a.rank<=3).map((a,F)=>e.jsxs("div",{className:`top3-card ${y(a.rank)} animate-slide-in`,style:{animationDelay:`${F*.15}s`},onClick:P=>t(a,P),title:s(a),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:l(a.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",a.rank,a.totalRanked?`/${a.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:a.title}),e.jsx("p",{className:"top3-achievement-description",children:a.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},a.id))})]}),w.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:w.filter(a=>!a.rank||a.rank>3).map((a,F)=>e.jsxs("div",{className:`achievement-card good ${y(a.rank)}`,onClick:P=>t(a,P),title:s(a),style:{animationDelay:`${F*.05}s`},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:a.title}),e.jsxs("span",{className:"achievement-rank",children:["#",a.rank,a.totalRanked?`/${a.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:a.description})]},a.id))})]}),D.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:D.map(a=>e.jsxs("div",{className:`achievement-card bad rank-${a.rank}`,onClick:F=>t(a,F),title:s(a),children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:a.title}),e.jsxs("span",{className:"achievement-rank",children:["#",a.rank,a.totalRanked?`/${a.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:a.description})]},a.id))})]}),$.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:$.map(a=>e.jsxs("div",{className:"achievement-card comparison",onClick:F=>t(a,F),title:s(a),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:a.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:m(a.description)}})]},a.id))})]})]})}function Re({selectedPlayerName:u,groupingMethod:j,campFilter:C="all"}){const{navigateToGameDetails:f}=O(),{data:v,isLoading:x,error:R}=X(u),h=k.useMemo(()=>{switch(j){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[j]),c=k.useMemo(()=>{if(!v?.games)return new Map;const r=new Map;return v.games.forEach(s=>{if(!r.has(s.date)){const i=s.date.split("/");i.length===3?r.set(s.date,new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])).getTime()):r.set(s.date,new Date(s.date).getTime())}}),r},[v?.games]),d=k.useMemo(()=>{if(!v?.games)return[];const r={};return v.games.forEach(s=>{if(C!=="all"){if(C==="solo"){if(s.camp==="Villageois"||s.camp==="Loup")return}else if(s.camp!==C)return}let i;const m=s.date.split("/");if(j==="month")if(m.length===3)i=`${m[1].padStart(2,"0")}/${m[2]}`;else{const l=new Date(s.date);i=`${String(l.getMonth()+1).padStart(2,"0")}/${l.getFullYear()}`}else if(j==="quarter")if(m.length===3){const l=parseInt(m[1],10);i=`T${Math.floor((l-1)/3)+1}/${m[2]}`}else{const l=new Date(s.date);i=`T${Math.floor(l.getMonth()/3)+1}/${l.getFullYear()}`}else j==="year"?m.length===3?i=`${m[2]}`:i=`${new Date(s.date).getFullYear()}`:i=s.date;r[i]||(r[i]={games:[],wins:0,total:0}),r[i].games.push(s),r[i].total++,s.won&&r[i].wins++}),Object.entries(r).map(([s,i])=>({period:s,totalGames:i.total,victories:i.wins,defeats:i.total-i.wins,winRate:i.total>0?(i.wins/i.total*100).toFixed(1):"0.0",winRateNum:i.total>0?i.wins/i.total*100:0})).sort((s,i)=>{if(j==="month"){const[m,l]=s.period.split("/"),[y,w]=i.period.split("/"),D=new Date(parseInt(l),parseInt(m)-1,1),$=new Date(parseInt(w),parseInt(y)-1,1);return D.getTime()-$.getTime()}else if(j==="quarter"){const[m,l]=s.period.split("/"),[y,w]=i.period.split("/"),D=parseInt(m.replace(/\D/g,""),10)||1,$=parseInt(y.replace(/\D/g,""),10)||1,_=new Date(parseInt(l,10),(D-1)*3,1),a=new Date(parseInt(w,10),($-1)*3,1);return _.getTime()-a.getTime()}else if(j==="year"){const m=parseInt(s.period,10),l=parseInt(i.period,10);return m-l}else{const m=c.get(s.period)||0,l=c.get(i.period)||0;return m-l}})},[v,j,c,C]),t=(r=>r<=15?{fontSize:12,angle:-45,height:80,interval:0}:r<=30?{fontSize:12,angle:-45,height:85,interval:1}:r<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(r/12)})(d.length);return x?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):R?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",R]}):v?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",h]}),e.jsx(z,{title:`Ã‰volution des Performances ${h}`,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(he,{data:d,margin:{top:20,right:30,left:20,bottom:20},onClick:r=>{if(r&&r.activeLabel){const s=d.find(i=>i.period===r.activeLabel);s&&f({selectedPlayer:u,selectedDate:s.period,fromComponent:`Ã‰volution des Performances ${h}`})}},style:{cursor:"pointer"},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"period",angle:t.angle,textAnchor:"end",height:t.height,interval:t.interval,fontSize:t.fontSize}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(q,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Parties: ",i.totalGames]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(ge,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",h]}),e.jsx(z,{title:`RÃ©partition Victoires/DÃ©faites ${h}`,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:d,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"period",angle:t.angle,textAnchor:"end",height:t.height,interval:t.interval,fontSize:t.fontSize}),e.jsx(E,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(q,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Total: ",i.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["DÃ©faites: ",i.defeats]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(V,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:d.map((r,s)=>e.jsx(K,{fill:"var(--accent-tertiary)",onClick:()=>{f({selectedPlayer:u,selectedDate:r.period,fromComponent:`Historique Joueur - Victoires ${h}`})},style:{cursor:"pointer"}},`cell-victories-${s}`))}),e.jsx(V,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:d.map((r,s)=>e.jsx(K,{fill:"var(--chart-color-4)",onClick:()=>{f({selectedPlayer:u,selectedDate:r.period,fromComponent:`Historique Joueur - DÃ©faites ${h}`})},style:{cursor:"pointer"}},`cell-defeats-${s}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Ne({selectedPlayerName:u}){const{navigateToGameDetails:j}=O(),{data:C,isLoading:f,error:v}=X(u),x=Z(),R=k.useMemo(()=>C?.campStats?Object.entries(C.campStats).map(([c,d])=>({name:c,value:d.appearances,winRate:d.winRate,winRateDisplay:Math.max(parseFloat(d.winRate),1),wins:d.wins,percentage:(d.appearances/C.totalGames*100).toFixed(1)})):[],[C]),h=k.useMemo(()=>{if(!R.length)return[];const c=5;let d=0;const n=[],t=[];if(R.forEach(r=>{parseFloat(r.percentage)<c?(d+=Number(r.value),n.push(r)):t.push(r)}),d>0){const r=R.reduce((s,i)=>s+Number(i.value),0);t.push({name:"Autres",value:d,winRate:"0.0",winRateDisplay:1,wins:n.reduce((s,i)=>s+i.wins,0),percentage:(d/r*100).toFixed(1),_details:n})}return t},[R]);return f?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):v?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",v]}):C?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(fe,{children:[e.jsx(xe,{data:h,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:c=>{const d=c.percent!==void 0?c.percent:0;return c.name==="Autres"?`Autres : ${c.value} (${(d*100).toFixed(1)}%)`:`${c.name}: ${c.value} (${(d*100).toFixed(1)}%)`},children:h.map((c,d)=>e.jsx(K,{fill:c.name==="Autres"?re:x[c.name]||`var(--chart-color-${d%6+1})`,onClick:()=>{if(c.name==="Autres"){const n=c._details?.map(t=>t.name)||[];j({selectedPlayer:u,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:n},fromComponent:"Distribution par Camps"})}else c.name==="TraÃ®tre"||c.name==="Louveteau"?j({selectedPlayer:u,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):c.name==="Loup"?j({selectedPlayer:u,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):j({selectedPlayer:u,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${d}`))}),e.jsx(q,{content:({active:c,payload:d})=>{if(c&&d&&d.length>0){const n=d[0].payload;if(n.name==="Autres"&&n._details){const t=[...n._details].sort((r,s)=>s.value-r.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",n.value," parties (",n.percentage,"%)"]})}),e.jsx("div",{children:t.map((r,s)=>e.jsxs("div",{children:[r.name,": ",r.value," parties (",r.percentage,"%)"]},s))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[n.name," - ",n.value," parties (",n.percentage,"%)"]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(z,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:R,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(q,{content:({active:c,payload:d})=>{if(c&&d&&d.length>0){const n=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.name})}),e.jsxs("div",{children:["Victoires: ",n.wins," / ",n.value]}),e.jsxs("div",{children:["Taux: ",n.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(V,{dataKey:"winRateDisplay",children:R.map((c,d)=>e.jsx(K,{fill:parseFloat(c.winRate)===0?`${x[c.name]||`var(--chart-color-${d%6+1})`}50`:x[c.name]||`var(--chart-color-${d%6+1})`,onClick:()=>{c.name==="TraÃ®tre"||c.name==="Louveteau"?j({selectedPlayer:u,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):c.name==="Loup"?j({selectedPlayer:u,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):j({selectedPlayer:u,campFilter:{selectedCamp:c.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${d}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ke({selectedPlayerName:u}){const{navigateToGameDetails:j,navigationState:C,updateNavigationState:f}=O(),[v,x]=k.useState(C.playerHistoryMapState?.selectedCamp||"Tous les camps"),{data:R}=ve(),{data:h,isLoading:c,error:d}=X(u,v);k.useEffect(()=>{(!C.playerHistoryMapState||C.playerHistoryMapState.selectedCamp!==v)&&f({playerHistoryMapState:{selectedCamp:v}})},[v,C.playerHistoryMapState,f]);const n=r=>{x(r),f({playerHistoryMapState:{selectedCamp:r}})},t=k.useMemo(()=>{if(!h?.mapStats)return[];const r=be(h.mapStats);return Object.entries(r).map(([s,i])=>({name:s,value:i.appearances,winRate:i.winRate,winRateDisplay:Math.max(parseFloat(i.winRate),.1),wins:i.wins,percentage:(i.appearances/h.totalGames*100).toFixed(1)}))},[h]);return c?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):d?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",d]}):h?t.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Performance par Carte",v!=="Tous les camps"?` (${v})`:""]}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select-map",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select-map",value:v,onChange:r=>n(r.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),R?.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsx(z,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:t,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(ee,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(t.length>0){const r=t.reduce((m,l)=>m+l.value,0),s=t.reduce((m,l)=>m+l.wins,0),i=r>0?s/r*100:0;if(i!==50)return e.jsx(ee,{y:i,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${i.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(q,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload,m=[];return t.forEach(l=>{if(l.name!==i.name&&l.value>=5){const y=parseFloat(i.winRate)-parseFloat(l.winRate);Math.abs(y)>=2&&m.push({map:l.name,diff:y,better:y>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Parties: ",i.value]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",i.winRate,"%"]})}),m.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),m.map((l,y)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:l.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[l.better?"â†—":"â†˜"," ",Math.abs(l.diff).toFixed(1),"% vs ",l.map]},y))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(V,{dataKey:"winRateDisplay",label:r=>{const{x:s,y:i,width:m,payload:l}=r;if(s===void 0||i===void 0||m===void 0||!l)return null;const y=l.winRate||"0";return e.jsxs("text",{x:s+m/2,y:i-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[y,"%"]})},onClick:r=>{if(r&&r.name){const s={selectedPlayer:u,selectedMapName:r.name,fromComponent:"Performance par Carte"};v!=="Tous les camps"&&(s.campFilter={selectedCamp:v,campFilterMode:"all-assignments"}),j(s)}},children:t.map((r,s)=>{let i;r.name==="Village"?i="var(--accent-secondary)":r.name==="ChÃ¢teau"?i="var(--accent-tertiary)":r.name==="Autres"?i=re:i=`var(--chart-color-${s%6+1})`;const m=Math.max(...t.map(y=>parseFloat(y.winRate))),l=parseFloat(r.winRate)===m&&m>0;return e.jsx(K,{fill:parseFloat(r.winRate)===0?`${i}30`:i,stroke:"transparent",strokeWidth:l?3:1,style:{cursor:"pointer"}},`cell-map-${s}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Se({selectedPlayerName:u}){const{gameData:j}=oe(),{joueursData:C}=U(),f=Q(C),v=Z(),x=k.useMemo(()=>{if(!j||!u)return{playersKilled:[],killedBy:[],deathTypes:[],availableDeathTypes:[]};const h={},c={},d={},n=new Set;j.forEach(m=>{const l=m.PlayerStats.find(y=>y.Username.toLowerCase()===u.toLowerCase());if(l&&(m.PlayerStats.forEach(y=>{y.KillerName?.toLowerCase()===u.toLowerCase()&&(h[y.Username]=(h[y.Username]||0)+1)}),l.KillerName&&(c[l.KillerName]=(c[l.KillerName]||0)+1),l.DeathType)){const y=l.DeathType,w=ye(y);d[w]||(d[w]={count:0,byDeathType:{}}),d[w].count+=1,d[w].byDeathType[y]=(d[w].byDeathType[y]||0)+1,n.add(y)}});const t=Object.entries(h).map(([m,l])=>({player:m,kills:l})).sort((m,l)=>l.kills-m.kills).slice(0,10),r=Object.entries(c).map(([m,l])=>({player:m,kills:l})).sort((m,l)=>l.kills-m.kills).slice(0,10),s=Object.entries(d).map(([m,l])=>{const y={deathType:m,count:l.count};return y[m]=l.count,y}).sort((m,l)=>l.count-m.count).slice(0,10),i=Object.keys(d);return{playersKilled:t,killedBy:r,deathTypes:s,availableDeathTypes:i}},[j,u]),R=k.useMemo(()=>{const h={};x.availableDeathTypes.forEach(n=>{n==="TuÃ© par Loup"?h[n]=v.Loup:n==="Mort aux votes"?h[n]="var(--chart-color-1)":n.includes("Chasseur")?h[n]=v.Chasseur:n==="TuÃ© par Zombie"?h[n]=v.Vaudou:n==="TuÃ© par potion assassin"?h[n]=v.Alchimiste:n==="TuÃ© par Vengeur"?h[n]="var(--chart-color-2)":n==="Amoureux mort"?h[n]=v.Amoureux:n==="TuÃ© par La BÃªte"?h[n]="var(--chart-color-3)":n==="TuÃ© par ShÃ©rif"&&(h[n]="var(--chart-color-4)")});const c=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let d=0;return x.availableDeathTypes.forEach(n=>{h[n]||(h[n]=c[d%c.length],d++)}),h},[x.availableDeathTypes,v]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[x.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Victimes"}),e.jsx(z,{title:"Les Victimes",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:x.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(q,{content:({active:h,payload:c})=>{if(h&&c&&c.length>0){const d=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:d.player})}),e.jsxs("div",{children:["TuÃ© ",d.kills," fois par ",u]})]})}return null}}),e.jsx(V,{dataKey:"kills",children:x.playersKilled.map((h,c)=>e.jsx(K,{fill:f[h.player]||"var(--chart-color-3)"},`cell-killed-${c}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[u," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),x.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Tueurs"}),e.jsx(z,{title:"Les Tueurs",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:x.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(q,{content:({active:h,payload:c})=>{if(h&&c&&c.length>0){const d=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:d.player})}),e.jsxs("div",{children:["A tuÃ© ",u," ",d.kills," fois"]})]})}return null}}),e.jsx(V,{dataKey:"kills",children:x.killedBy.map((h,c)=>e.jsx(K,{fill:f[h.player]||"var(--chart-color-4)"},`cell-killer-${c}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[u," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]}),x.deathTypes.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Mort les Plus FrÃ©quents"}),e.jsx(z,{title:"Types de Mort les Plus FrÃ©quents",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:x.deathTypes,margin:{top:20,right:30,left:20,bottom:90},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"deathType",angle:-45,textAnchor:"end",height:120,interval:0,fontSize:12}),e.jsx(E,{label:{value:"Nombre de morts",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(q,{content:({active:h,payload:c})=>{if(h&&c&&c.length>0){const d=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:d.deathType})}),e.jsxs("div",{children:[u," est mort ",d.count," fois ainsi"]})]})}return null}}),x.availableDeathTypes.map(h=>e.jsx(V,{dataKey:h,name:h,stackId:"deaths",fill:R[h]||"var(--chart-color-5)"},h))]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de mort"}),e.jsxs("p",{children:["Aucune information de mort disponible pour ",u,"."]})]})]})}function Pe(u,j){if(!u||u.trim()===""||j.length===0)return null;const C=new Map,f=new Map,v=new Map;j.forEach(d=>{if(!d.Modded||!d.LegacyData||d.LegacyData.deathInformationFilled!==!0)return;const n=d.PlayerStats.find(t=>Y(t)===u||t.Username.toLowerCase()===u.toLowerCase());if(n){if(n.MainRoleInitial==="Inconnu")return;const t=n.Victorious,s=te(n.MainRoleInitial,n.MainRoleChanges||[])!==n.MainRoleInitial,i=se(n.MainRoleInitial),m=i==="Loup"||i==="TraÃ®tre"||i==="Louveteau";if(i==="Villageois"&&(n.MainRoleInitial==="Chasseur"||n.MainRoleInitial==="Alchimiste")){const l=C.get(n.MainRoleInitial)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};C.set(n.MainRoleInitial,{appearances:l.appearances+1,wins:l.wins+(t?1:0),winsWithoutRoleChange:l.winsWithoutRoleChange+(!s&&t?1:0),gamesWithoutRoleChange:l.gamesWithoutRoleChange+(s?0:1)})}else if(n.Power&&n.Power.trim()!==""){if(i==="Villageois"){const l=C.get(n.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};C.set(n.Power,{appearances:l.appearances+1,wins:l.wins+(t?1:0),winsWithoutRoleChange:l.winsWithoutRoleChange+(!s&&t?1:0),gamesWithoutRoleChange:l.gamesWithoutRoleChange+(s?0:1)})}else if(m){const l=f.get(n.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},y=l.roleBreakdown;y.set(n.MainRoleInitial,(y.get(n.MainRoleInitial)||0)+1),f.set(n.Power,{appearances:l.appearances+1,wins:l.wins+(t?1:0),winsWithoutRoleChange:l.winsWithoutRoleChange+(!s&&t?1:0),gamesWithoutRoleChange:l.gamesWithoutRoleChange+(s?0:1),roleBreakdown:y})}}else if(i==="Villageois"||m)if(i==="Villageois"){const l=C.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};C.set("Aucun pouvoir",{appearances:l.appearances+1,wins:l.wins+(t?1:0),winsWithoutRoleChange:l.winsWithoutRoleChange+(!s&&t?1:0),gamesWithoutRoleChange:l.gamesWithoutRoleChange+(s?0:1)})}else{const l=f.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},y=l.roleBreakdown;y.set(n.MainRoleInitial,(y.get(n.MainRoleInitial)||0)+1),f.set("Aucun pouvoir",{appearances:l.appearances+1,wins:l.wins+(t?1:0),winsWithoutRoleChange:l.winsWithoutRoleChange+(!s&&t?1:0),gamesWithoutRoleChange:l.gamesWithoutRoleChange+(s?0:1),roleBreakdown:y})}if(n.SecondaryRole&&n.SecondaryRole.trim()!==""){if(n.SecondaryRole==="Inconnu")return;const l=v.get(n.SecondaryRole)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};v.set(n.SecondaryRole,{appearances:l.appearances+1,wins:l.wins+(t?1:0),winsWithoutRoleChange:l.winsWithoutRoleChange+(!s&&t?1:0),gamesWithoutRoleChange:l.gamesWithoutRoleChange+(s?0:1)})}}});const x=new Map;j.forEach(d=>{if(!d.LegacyData||d.LegacyData.deathInformationFilled!==!0)return;const n=d.PlayerStats.find(t=>Y(t)===u||t.Username.toLowerCase()===u.toLowerCase());if(n&&(n.MainRoleInitial==="Chasseur"||n.MainRoleInitial==="Alchimiste")){const t=n.MainRoleInitial;x.set(t,(x.get(t)||0)+1)}});const R=d=>Array.from(d.entries()).map(([n,t])=>({name:n,appearances:t.appearances,wins:t.wins,winsWithoutRoleChange:t.winsWithoutRoleChange,gamesWithoutRoleChange:t.gamesWithoutRoleChange,winRate:t.gamesWithoutRoleChange>0?(t.winsWithoutRoleChange/t.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Villageois",...x.has(n)&&{totalGamesAllModes:x.get(n)}})).sort((n,t)=>t.appearances-n.appearances),h=d=>Array.from(d.entries()).map(([n,t])=>({name:n,appearances:t.appearances,wins:t.wins,winsWithoutRoleChange:t.winsWithoutRoleChange,gamesWithoutRoleChange:t.gamesWithoutRoleChange,winRate:t.gamesWithoutRoleChange>0?(t.winsWithoutRoleChange/t.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Loup",roleBreakdown:Array.from(t.roleBreakdown.entries()).map(([r,s])=>({role:r,count:s})).sort((r,s)=>s.count-r.count)})).sort((n,t)=>t.appearances-n.appearances),c=d=>Array.from(d.entries()).map(([n,t])=>({name:n,appearances:t.appearances,wins:t.wins,winsWithoutRoleChange:t.winsWithoutRoleChange,gamesWithoutRoleChange:t.gamesWithoutRoleChange,winRate:t.gamesWithoutRoleChange>0?(t.winsWithoutRoleChange/t.gamesWithoutRoleChange*100).toFixed(1):"0.0"})).sort((n,t)=>t.appearances-n.appearances);return{villageoisPowers:R(C),loupPowers:h(f),secondaryRoles:c(v)}}function Te({selectedPlayerName:u}){const{navigateToGameDetails:j}=O(),{settings:C}=J(),f=Z(),{data:v,isLoading:x,error:R}=ae(s=>Pe(u,s)),h=k.useMemo(()=>{if(!v)return{villageoisPowers:[],loupPowers:[],secondaryRoles:[]};const s=1,i=1,m=15;return{villageoisPowers:v.villageoisPowers.filter(l=>l.appearances>=s).slice(0,m),loupPowers:v.loupPowers.filter(l=>l.appearances>=s).slice(0,m),secondaryRoles:v.secondaryRoles.filter(l=>l.appearances>=i).slice(0,m)}},[v]);if(x)return e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique des rÃ´les..."});if(R)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",R]});if(!v)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de rÃ´le disponible"});const c=h.villageoisPowers.length>0,d=h.loupPowers.length>0,n=h.secondaryRoles.length>0;if(!c&&!d&&!n)return e.jsx("div",{className:"donnees-manquantes",children:"Aucun pouvoir ou rÃ´le secondaire trouvÃ©"});const t=({active:s,payload:i})=>{if(s&&i&&i.length>0){const m=i[0].payload,l=m.gamesWithoutRoleChange<m.appearances;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:m.name})}),e.jsxs("div",{children:["Apparitions: ",m.appearances]}),l&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"0.25rem"},children:["dont ",m.appearances-m.gamesWithoutRoleChange," avec changement de rÃ´le"]}),m.totalGamesAllModes&&m.totalGamesAllModes!==m.appearances&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic"},children:["(Total avec parties non moddÃ©es: ",m.totalGamesAllModes,")"]}),m.roleBreakdown&&m.roleBreakdown.length>0&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:[e.jsx("div",{style:{fontStyle:"italic"},children:"RÃ©partition par rÃ´le:"}),m.roleBreakdown.map((y,w)=>e.jsxs("div",{style:{marginLeft:"0.5rem"},children:["â€¢ ",y.role,": ",y.count]},w))]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},r=(s,i,m,l,y)=>e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:i}),e.jsx(z,{title:i,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(B,{data:s,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(L,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:12,tick:({x:w,y:D,payload:$})=>e.jsx("text",{x:w,y:D,textAnchor:"end",transform:`rotate(-45, ${w}, ${D})`,fill:C.highlightedPlayer===u?"var(--text-primary)":"var(--text-secondary)",fontSize:12,children:$.value})}),e.jsx(E,{label:{value:"Nombre d'apparitions",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(q,{content:e.jsx(t,{})}),e.jsx(V,{dataKey:"appearances",children:s.map((w,D)=>e.jsx(K,{fill:y?y(w.name,D):m,onClick:()=>l(w.name),style:{cursor:"pointer"}},`cell-${D}`))})]})})})})]});return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[c&&r(h.villageoisPowers,"Camp Villageois","var(--chart-color-1)",s=>{j({selectedPlayer:u,campFilter:{selectedCamp:"Villageois",campFilterMode:"all-assignments"},fromComponent:`Historique des RÃ´les - Pouvoir: ${s}`})},s=>s==="Chasseur"&&f.Chasseur?f.Chasseur:s==="Alchimiste"&&f.Alchimiste?f.Alchimiste:"var(--chart-color-1)"),d&&r(h.loupPowers,"Camp Loups","var(--chart-color-2)",s=>{j({selectedPlayer:u,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments"},fromComponent:`Historique des RÃ´les - Pouvoir: ${s}`})},()=>f.Loup||"var(--chart-color-2)"),n&&r(h.secondaryRoles,"RÃ´les Secondaires","var(--chart-color-3)",s=>{j({selectedPlayer:u,fromComponent:`Historique des RÃ´les - RÃ´le Secondaire: ${s}`})})]})}function _e(){const{settings:u,updateSettings:j}=J(),{navigateToGameDetails:C,navigationState:f,updateNavigationState:v}=O(),{data:x,isLoading:R,error:h}=ce(),{joueursData:c,isLoading:d}=U(),{data:n,isLoading:t,error:r}=je(u.highlightedPlayer),s=Q(c),[i,m]=k.useState(""),[l,y]=k.useState(()=>u.useIndependentFilters&&u.independentFilters?.gameTypeEnabled?u.independentFilters.gameFilter==="modded"?"modded":"all":u.gameFilter==="modded"?"modded":"all"),[w,D]=k.useState(f.selectedPlayerSelectionView||"achievements"),[$,_]=k.useState("session"),[a,F]=k.useState("all");k.useEffect(()=>{if(u.useIndependentFilters&&u.independentFilters?.gameTypeEnabled){const o=u.independentFilters.gameFilter==="modded"?"modded":"all";y(o)}else if(!u.useIndependentFilters){const o=u.gameFilter==="modded"?"modded":"all";y(o)}},[u.gameFilter,u.useIndependentFilters,u.independentFilters?.gameTypeEnabled,u.independentFilters?.gameFilter]),k.useEffect(()=>{f.selectedPlayerSelectionView&&D(f.selectedPlayerSelectionView)},[f.selectedPlayerSelectionView]);const{data:P}=X(u.highlightedPlayer||""),p=k.useMemo(()=>{if(!x||!x.GameStats)return[];const o=new Map;return x.GameStats.forEach(T=>{const A=new Date(T.StartDate);T.PlayerStats.forEach(M=>{const I=Y(M),ie=c?.Players?.find(ne=>ne.SteamID===I)?.Joueur||M.Username;o.has(I)||o.set(I,{games:0,wins:0,firstDate:A,lastDate:A,displayName:ie});const H=o.get(I);H.games++,M.Victorious&&H.wins++,A<H.firstDate&&(H.firstDate=A),A>H.lastDate&&(H.lastDate=A)})}),Array.from(o.entries()).map(([T,A])=>{let M=c?.Players?.find(I=>I.SteamID===T);return M||(M=c?.Players?.find(I=>I.Joueur===A.displayName)),{id:T,name:A.displayName,totalGames:A.games,totalWins:A.wins,winRate:A.games>0?A.wins/A.games*100:0,firstGameDate:A.firstDate.toLocaleDateString("fr-FR"),lastGameDate:A.lastDate.toLocaleDateString("fr-FR"),isHighlighted:A.displayName===u.highlightedPlayer,image:M?.Image||null,twitch:M?.Twitch||null,youtube:M?.Youtube||null}})},[x,u.highlightedPlayer,c]),g=k.useMemo(()=>{if(!i.trim())return p;const o=i.toLowerCase();return p.filter(T=>T.name.toLowerCase().includes(o))},[p,i]),b=k.useMemo(()=>[...g].sort((o,T)=>T.totalGames-o.totalGames),[g]),N=o=>{j({highlightedPlayer:o}),m("")},S=o=>{D(o),v({selectedPlayerSelectionView:o})};return R||d?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):h?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",h]})]}):!x||p.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!u.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:i,onChange:o=>m(o.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[g.length," joueur",g.length!==1?"s":"",i&&` (filtrÃ©${g.length!==1?"s":""} de ${p.length})`]})]})]}),e.jsx("div",{className:"player-display",children:i?g.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{className:"clear-search-btn",onClick:()=>m(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:b.map(o=>e.jsxs("button",{className:`suggestion-btn ${o.isHighlighted?"highlighted":""}`,onClick:()=>N(o.name),children:[o.image?e.jsx("img",{src:o.image,alt:o.name,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":s[o.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[o.name,o.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[o.totalGames," parties â€¢ ",o.winRate.toFixed(1),"% victoires"]})]})]},o.id))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',i,'"']}),e.jsx("button",{className:"clear-search-btn",onClick:()=>m(""),children:"Effacer la recherche"})]}):u.highlightedPlayer?(()=>{const o=p.find(T=>T.name===u.highlightedPlayer);return o?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:o.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[o.image?e.jsx("img",{src:o.image,alt:o.name,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":s[o.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[o.totalGames," parties â€¢ ",o.totalWins," victoires â€¢ ",o.winRate.toFixed(1),"% taux de victoire"]}),(o.twitch||o.youtube)&&e.jsxs("div",{className:"social-links",children:[o.twitch&&e.jsx("a",{href:o.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),o.youtube&&e.jsx("a",{href:o.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{className:`lycans-categorie-btn ${w==="achievements"?"active":""}`,onClick:()=>S("achievements"),children:"Classement"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="evolution"?"active":""}`,onClick:()=>S("evolution"),children:"Ã‰volution"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="camps"?"active":""}`,onClick:()=>S("camps"),children:"Camps"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="roles"?"active":""}`,onClick:()=>S("roles"),children:"RÃ´les"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="maps"?"active":""}`,onClick:()=>S("maps"),children:"Maps"}),e.jsx("button",{className:`lycans-categorie-btn ${w==="kills"?"active":""}`,onClick:()=>S("kills"),children:"Kills"})]}),w==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[t?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):r?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",r]})}):n?e.jsx(we,{achievements:l==="all"?n.allGamesAchievements:n.moddedOnlyAchievements,title:l==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:l}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[e.jsx("button",{className:`filter-btn ${l==="all"?"active":""}`,onClick:T=>{T.stopPropagation(),y("all")},children:"Toutes les parties"}),e.jsx("button",{className:`filter-btn ${l==="modded"?"active":""}`,onClick:T=>{T.stopPropagation(),y("modded")},children:"Parties moddÃ©es"})]})]}),w==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[P&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{C({selectedPlayer:o.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${o.name}`,style:{fontSize:"1.3rem"},children:P.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Temps de jeu cumulÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:pe(P.totalPlayTime)}),e.jsx("p",{children:"temps total de jeu"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{C({selectedPlayer:o.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${o.name}`,style:{fontSize:"1.3rem"},children:P.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:[P.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:$,onChange:T=>_(T.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-filter-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsxs("select",{id:"camp-filter-select",value:a,onChange:T=>F(T.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"all",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loups"}),e.jsx("option",{value:"solo",children:"RÃ´les solo"})]})]})]}),e.jsx(Re,{selectedPlayerName:o.name,groupingMethod:$,campFilter:a})]}),w==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ne,{selectedPlayerName:o.name})}),w==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ke,{selectedPlayerName:o.name})}),w==="roles"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Te,{selectedPlayerName:o.name})}),w==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Se,{selectedPlayerName:o.name})}),e.jsx("button",{className:"highlight-btn active",onClick:T=>{T.stopPropagation(),j({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[o.firstGameDate," - ",o.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',u.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{className:"clear-selection-btn",onClick:()=>j({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:b.map(o=>e.jsxs("div",{className:`character-card ${o.isHighlighted?"highlighted":""}`,onClick:()=>N(o.name),title:`${o.name} - ${o.totalGames} parties, ${o.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:o.image?e.jsx("img",{src:o.image,alt:o.name,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":s[o.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:o.name}),(o.twitch||o.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[o.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),o.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},o.id))})})})]})}export{_e as PlayerSelectionPage};
