import{r as E,a as V,j as e}from"./index-i2D8CKXz.js";import{a as z,u as O}from"./baseStatsHook-Yue8JXBk.js";import{g as K}from"./gameUtils-rkfcKAVy.js";import{a as Y,c as U}from"./datasyncExport-BirWLS1z.js";import{b as X,l as H,g as B}from"./api-CGjKkj89.js";import{a as Q,F as b,C,X as W,Y as D}from"./FullscreenChart-DkD7fDqR.js";import{a as Z,b as q,f as $}from"./durationFormatters-C9UyWcKX.js";import{aa as _,R as N,T,ab as ee,a as w}from"./CategoricalChart-lJQ-xVrZ.js";import{B as R,a as M}from"./BarChart-u1lo5U5Z.js";import{L as te,a as k}from"./LineChart-B3vHKje5.js";import{P as ae,a as re}from"./PieChart-DZrAE2uw.js";import{L as ie}from"./Legend-CD3-5LZy.js";import"./ActivePoints-5COj_4NI.js";import"./PolarChart-D11YOEvL.js";var ne=["axis"],se=E.forwardRef((a,r)=>E.createElement(Q,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ne,tooltipPayloadSearcher:_,categoricalChartProps:a,ref:r}));function A(a){const r=Math.floor(a/3600),s=Math.floor(a%3600/60),i=a%60;return r>0?`${r}h${s.toString().padStart(2,"0")}m${i.toString().padStart(2,"0")}s`:s>0?`${s}m${i.toString().padStart(2,"0")}s`:`${i}s`}function oe(a,r=10){const s=Math.round(a/60);return Math.round(s/r)*r}function le(){return{averageDuration:"0s",maxDuration:0,minDuration:1/0,maxDurationGameId:null,minDurationGameId:null,durationDistribution:{},durationsByWinnerCamp:{},durationsByPlayerCount:{},durationsByWolfRatio:{},totalGameTime:"0s",totalPlayerTime:"0s"}}function ce(a,r,s){a>s.maxDuration&&(s.maxDuration=a,s.maxDurationGameId=r),a<s.minDuration&&(s.minDuration=a,s.minDurationGameId=r)}function ue(a,r){const s=oe(a,2);r[s]||(r[s]=0),r[s]++}function de(a,r,s){a&&a.trim()!==""&&(s[a]||(s[a]={totalDuration:0,count:0,average:"0s"}),s[a].totalDuration+=r,s[a].count++)}function me(a,r,s){if(a&&!isNaN(a)&&a>0){const i=a.toString();s[i]||(s[i]={totalDuration:0,count:0,average:"0s"}),s[i].totalDuration+=r,s[i].count++}}function he(a,r,s,i){if(a&&r&&!isNaN(a)&&!isNaN(r)&&a>0){const l=a-r;if(l>0){const m=Math.round(r/l*100),h=(Math.round(m/1)*1).toString();i[h]||(i[h]={totalDuration:0,count:0,average:"0s"}),i[h].totalDuration+=s,i[h].count++}}}function pe(a,r,s){const i=a.PlayerStats.length,l=a.PlayerStats.filter(h=>Y(h.MainRoleInitial,h.MainRoleChanges||[])==="Loup").length;let m=K(a);const u=U(a.StartDate,a.EndDate);u&&!isNaN(u)&&u>0&&(s.gamesWithDuration++,s.totalDuration+=u,s.totalPlayerTime+=u*i,ce(u,a.DisplayedId,r),ue(u,r.durationDistribution),de(m,u,r.durationsByWinnerCamp),me(i,u,r.durationsByPlayerCount),he(i,l,u,r.durationsByWolfRatio))}function ye(a,r){if(r.gamesWithDuration>0){const s=r.totalDuration/r.gamesWithDuration;a.averageDuration=A(Math.round(s)),a.totalGameTime=A(Math.round(r.totalDuration)),a.totalPlayerTime=A(Math.round(r.totalPlayerTime)),Object.keys(a.durationsByWinnerCamp).forEach(i=>{const l=a.durationsByWinnerCamp[i];if(l.count>0){const m=l.totalDuration/l.count;l.average=A(Math.round(m))}}),Object.keys(a.durationsByPlayerCount).forEach(i=>{const l=a.durationsByPlayerCount[i];if(l.count>0){const m=l.totalDuration/l.count;l.average=A(Math.round(m))}}),Object.keys(a.durationsByWolfRatio).forEach(i=>{const l=a.durationsByWolfRatio[i];if(l.count>0){const m=l.totalDuration/l.count;l.average=A(Math.round(m))}})}}function ge(a){const r=Object.keys(a).map(s=>({duration:parseInt(s),count:a[parseInt(s)]}));return r.sort((s,i)=>s.duration-i.duration),r}function xe(a){if(a.length===0)return null;const r=le(),s={totalDuration:0,gamesWithDuration:0,totalPlayerTime:0};a.forEach(l=>{pe(l,r,s)}),ye(r,s);const i=ge(r.durationDistribution);return{averageDuration:r.averageDuration,maxDuration:r.maxDuration,minDuration:r.minDuration===1/0?0:r.minDuration,maxDurationGameId:r.maxDurationGameId,minDurationGameId:r.minDurationGameId,durationDistribution:i,durationsByWinnerCamp:r.durationsByWinnerCamp,durationsByPlayerCount:r.durationsByPlayerCount,durationsByWolfRatio:r.durationsByWolfRatio,totalGameTime:r.totalGameTime,totalPlayerTime:r.totalPlayerTime}}function fe(){const{data:a,isLoading:r,error:s}=z(xe);return{durationAnalysis:a,fetchingData:r,apiError:s}}function L(a){if(!a||a.trim()==="")return null;const r=a.trim(),s=r.charAt(0).toUpperCase(),i=r.slice(1),l=parseInt(i,10);return!["J","N","M"].includes(s)||isNaN(l)||l<1?null:{phase:s,dayNumber:l,originalTiming:r,phaseLabel:{J:"Jour",N:"Nuit",M:"Meeting"}[s]}}function J(a){const r={J:0,N:.33,M:.67};return a.dayNumber+r[a.phase]}function je(a){if(!a||a.length===0)return{totalGames:0,gamesWithEndTiming:0,averageGameLength:0,endTimingDistribution:[],phaseDistribution:[],dayDistribution:[],longestGame:null,shortestGame:null};const r=a.length;let s=0,i=0,l=null,m=null;const u={},h={},j={};a.forEach(d=>{const c=L(d.EndTiming);if(c){s++,i+=c.dayNumber;const x=J(c);(!l||x>J(L(l.endTiming)))&&(l={gameId:d.DisplayedId,endTiming:c.originalTiming,dayNumber:c.dayNumber}),(!m||x<J(L(m.endTiming)))&&(m={gameId:d.DisplayedId,endTiming:c.originalTiming,dayNumber:c.dayNumber});const I=c.originalTiming;u[I]=(u[I]||0)+1;const t=c.phaseLabel;h[t]||(h[t]={count:0,totalDays:0}),h[t].count++,h[t].totalDays+=c.dayNumber;const n=c.dayNumber;j[n]||(j[n]={count:0,phases:{}}),j[n].count++,j[n].phases[t]=(j[n].phases[t]||0)+1}});const v=s>0?i/s:0,G=Object.entries(u).map(([d,c])=>{const x=L(d);return{timing:d,phase:x?.phaseLabel||"Unknown",dayNumber:x?.dayNumber||0,count:c,percentage:c/s*100}}).sort((d,c)=>{if(d.dayNumber!==c.dayNumber)return d.dayNumber-c.dayNumber;const x={Jour:0,Nuit:1,Meeting:2};return(x[d.phase]||3)-(x[c.phase]||3)}),F=Object.entries(h).map(([d,c])=>({phase:d,count:c.count,percentage:c.count/s*100,averageDay:c.count>0?c.totalDays/c.count:0})).sort((d,c)=>c.count-d.count),P=Object.entries(j).map(([d,c])=>({dayNumber:parseInt(d,10),count:c.count,percentage:c.count/s*100,phases:c.phases})).sort((d,c)=>d.dayNumber-c.dayNumber);return{totalGames:r,gamesWithEndTiming:s,averageGameLength:v,endTimingDistribution:G,phaseDistribution:F,dayDistribution:P,longestGame:l,shortestGame:m}}function ve(){const{data:a,isLoading:r,error:s}=O(i=>je(i));return{gameTimeAnalysis:a,fetchingData:r,apiError:s}}function be(a){if(!a||a.length===0)return null;const r=new Map;return a.forEach(i=>{if(!i.EndTiming)return;const l=i.EndTiming.match(/^[JNM](\d+)$/);if(!l)return;const m=parseInt(l[1],10);if(isNaN(m))return;r.has(m)||r.set(m,{villageoisWins:0,loupsWins:0,soloWins:0,totalGames:0});const u=r.get(m);u.totalGames++;const h=K(i);h==="Villageois"?u.villageoisWins++:h==="Loup"?u.loupsWins++:u.soloWins++}),Array.from(r.entries()).map(([i,l])=>({day:i,villageoisWins:l.villageoisWins,loupsWins:l.loupsWins,soloWins:l.soloWins,totalGames:l.totalGames,villageoisWinRate:l.villageoisWins/l.totalGames*100,loupsWinRate:l.loupsWins/l.totalGames*100,soloWinRate:l.soloWins/l.totalGames*100})).filter(i=>i.totalGames>=5).sort((i,l)=>i.day-l.day)}function De(){const{data:a,isLoading:r,error:s}=z(be);return{data:a,isLoading:r,error:s}}function Je(){const{durationAnalysis:a,fetchingData:r,apiError:s}=fe(),{gameTimeAnalysis:i,fetchingData:l,apiError:m}=ve(),{data:u,isLoading:h,error:j}=De(),{navigateToGameDetails:v}=V(),[G,F]=E.useState("real"),P=X(),d=t=>{if(!t)return t;const n=t.match(/^([JNM])(\d+)$/);if(!n)return t;const[,o,p]=n;return`${{J:"Jour",N:"Nuit",M:"Meeting"}[o]||o} ${p}`};if(r||l||h)return e.jsx("div",{className:"statistiques-attente",children:"Analyse des dur√©es en cours..."});if(s||m||j)return e.jsxs("div",{className:"statistiques-echec",children:["Probl√®me rencontr√©: ",s||m||j]});if(!a||!i)return e.jsx("div",{className:"statistiques-indisponibles",children:"Donn√©es d'analyse non disponibles"});const c=t=>{const n=t.match(/(\d+)h/),o=t.match(/(\d+)m/),p=t.match(/(\d+)s/),y=n?parseInt(n[1]):0,g=o?parseInt(o[1]):0,f=p?parseInt(p[1]):0;return y*60+g+f/60},x=a?Object.entries(a.durationsByWolfRatio).map(([t,n])=>({ratio:parseFloat(t),moyenne:c(n.average),parties:n.count,dureeFormatee:n.average})).sort((t,n)=>t.ratio-n.ratio):[],I=a?Object.entries(a.durationsByWinnerCamp).map(([t,n])=>({camp:t,moyenne:c(n.average),parties:n.count,dureeFormatee:n.average})).sort((t,n)=>n.moyenne-t.moyenne):[];return e.jsxs("div",{className:"lycans-duree-analyse",children:[e.jsx("h2",{children:"Analyse des Dur√©es"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${G==="real"?"active":""}`,onClick:()=>F("real"),children:"Dur√©e en jeu"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${G==="gametime"?"active":""}`,onClick:()=>F("gametime"),children:"Temps de jeu"})]}),G==="real"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Dur√©e Moyenne"}),e.jsx("p",{className:"lycans-valeur-principale",children:Z(a.averageDuration)||"N/A"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Temps de jeu cumul√©s des parties"}),e.jsx("p",{className:"lycans-valeur-principale",children:q(a.totalGameTime)||"N/A"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Temps de jeu cumul√©s par les joueurs"}),e.jsx("p",{className:"lycans-valeur-principale",children:q(a.totalPlayerTime)||"N/A"})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{a.minDurationGameId&&v({selectedGame:a.minDurationGameId,fromComponent:"Analyse des Dur√©es"})},style:{cursor:a.minDurationGameId?"pointer":"default",opacity:a.minDurationGameId?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{a.minDurationGameId&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{a.minDurationGameId&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:a.minDurationGameId?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus courte"}),e.jsx("p",{className:"lycans-valeur-principale",children:$(a.minDuration)}),a.minDurationGameId&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",a.minDurationGameId]})]}),e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{a.maxDurationGameId&&v({selectedGame:a.maxDurationGameId,fromComponent:"Analyse des Dur√©ee"})},style:{cursor:a.maxDurationGameId?"pointer":"default",opacity:a.maxDurationGameId?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{a.maxDurationGameId&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{a.maxDurationGameId&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:a.maxDurationGameId?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus longue"}),e.jsx("p",{className:"lycans-valeur-principale",children:$(a.maxDuration)}),a.maxDurationGameId&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",a.maxDurationGameId]})]})]}),e.jsxs("div",{className:"lycans-graphiques-section",children:[e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution des Dur√©es"}),e.jsx(b,{title:"Distribution des Dur√©es",children:e.jsx("div",{style:{height:300},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(R,{data:a?.durationDistribution||[],margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"duration",label:{value:"Dur√©e (minutes)",position:"insideBottom",offset:-5},tickFormatter:t=>`${t}min`}),e.jsx(D,{label:{value:"Nombre de Parties",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["~",o.duration," minutes"]})}),e.jsxs("div",{children:[o.count," parties"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Dur√©es regroup√©es par intervalles de 2 minutes"})]})}return null}}),e.jsx(M,{dataKey:"count",name:"Nombre de Parties",fill:"var(--chart-color-2)"})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Dur√©e Moyenne par Ratio Loups/Villageois"}),e.jsx(b,{title:"Dur√©e Moyenne par Ratio Loups/Villageois",children:e.jsx("div",{style:{height:300},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(te,{data:x,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"ratio",type:"number",domain:["auto","auto"],allowDecimals:!1,tickFormatter:t=>`${t}%`,label:{value:"Ratio Loups/Joueurs (%)",position:"insideBottom",offset:-5}}),e.jsx(D,{label:{value:"Dur√©e Moyenne (minutes)",angle:270,position:"left",style:{textAnchor:"middle"}},tickFormatter:t=>`${Math.round(t)}min`}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Pourcentage de loups : ",o.ratio,"%"]})}),e.jsxs("div",{children:["Dur√©e moyenne : ",o.dureeFormatee]}),e.jsxs("div",{children:["Nombre de parties : ",o.parties]})]})}return null}}),e.jsx(k,{type:"monotone",dataKey:"moyenne",name:"Dur√©e Moyenne",stroke:"var(--chart-color-5)",strokeWidth:2,activeDot:{r:8}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Dur√©e Moyenne par Camp Victorieux"}),e.jsx(b,{title:"Dur√©e Moyenne par Camp Victorieux",children:e.jsx("div",{style:{height:300},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(R,{data:I,margin:{top:20,right:30,left:20,bottom:40},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:n,payload:o})=>e.jsx("text",{x:t,y:n,dy:16,textAnchor:"end",fill:"var(--text-secondary)",fontSize:13,transform:`rotate(-45 ${t} ${n})`,children:o.value})}),e.jsx(D,{label:{value:"Dur√©e Moyenne (minutes)",angle:270,position:"left",style:{textAnchor:"middle"}},tickFormatter:t=>`${Math.round(t)}min`}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:o.camp})}),e.jsxs("div",{children:["Dur√©e moyenne : ",o.dureeFormatee]}),e.jsxs("div",{children:["Nombre de parties : ",o.parties]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(M,{dataKey:"moyenne",name:"moyenne",isAnimationActive:!1,style:{cursor:"pointer"},shape:t=>{const{x:n,y:o,width:p,height:y,payload:g}=t,f=g,S=P[f.camp]||H;return e.jsx(w,{x:n,y:o,width:p,height:y,fill:S,onClick:()=>{v({campFilter:{selectedCamp:f.camp,campFilterMode:"wins-only"},fromComponent:"Dur√©e Moyenne par Camp Victorieux"})},style:{cursor:"pointer"}})},children:e.jsx(ee,{dataKey:"moyenne",position:"top",formatter:t=>{const n=typeof t=="number"?t:Number(t);return isNaN(n)?"":`${Math.round(n)}min`},fill:"var(--text-primary)",fontSize:12})})]})})})})]})]})]}),G==="gametime"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lycans-section-description",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Analyse du temps de jeu :"})," Ces graphiques montrent √† quels moments les parties se terminent en fonction du cycle jour/nuit/meeting.",e.jsx("br",{}),'Le chiffre indique le num√©ro du jour (Jour 3 = Phase "Jour" de la 3√®me journ√©e, Nuit 2 = Phase "Nuit" de la 2√®me journ√©e, Meeting 4 = 4√®me meeting).',e.jsx("br",{}),"Bas√© sur ",i.gamesWithEndTiming," parties avec donn√©es de timing sur ",i.totalGames," parties totales."]})}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Longueur Moyenne"}),e.jsxs("p",{className:"lycans-valeur-principale",children:[i.averageGameLength.toFixed(1)," jours"]})]}),e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{i.shortestGame&&v({selectedGame:i.shortestGame.gameId,fromComponent:"Analyse des Temps de Jeu"})},style:{cursor:i.shortestGame?"pointer":"default",opacity:i.shortestGame?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{i.shortestGame&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{i.shortestGame&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:i.shortestGame?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus courte"}),e.jsx("p",{className:"lycans-valeur-principale",children:i.shortestGame?d(i.shortestGame.endTiming):"N/A"}),i.shortestGame&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",i.shortestGame.gameId]})]}),e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{i.longestGame&&v({selectedGame:i.longestGame.gameId,fromComponent:"Analyse des Temps de Jeu"})},style:{cursor:i.longestGame?"pointer":"default",opacity:i.longestGame?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{i.longestGame&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{i.longestGame&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:i.longestGame?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus longue"}),e.jsx("p",{className:"lycans-valeur-principale",children:i.longestGame?d(i.longestGame.endTiming):"N/A"}),i.longestGame&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",i.longestGame.gameId]})]})]}),e.jsxs("div",{className:"lycans-graphiques-section",children:[e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution par Phase de Fin"}),e.jsx(b,{title:"Distribution par Phase de Fin",children:e.jsx("div",{style:{height:300},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(ae,{children:[e.jsx(re,{data:i.phaseDistribution.map(t=>({...t,fill:t.phase==="Jour"?"#FFD700":t.phase==="Nuit"?"#4169E1":t.phase==="Meeting"?"#FF6347":B(t.phase)})),cx:"50%",cy:"50%",labelLine:!1,label:t=>`${t.phase} (${t.percentage.toFixed(1)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"count"}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:o.phase})}),e.jsxs("div",{children:[o.count," parties (",o.percentage.toFixed(1),"%)"]}),e.jsxs("div",{children:["Jour moyen: ",o.averageDay.toFixed(1)]})]})}return null}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution par Nombre de Jours"}),e.jsx(b,{title:"Distribution par Nombre de Jours",children:e.jsx("div",{style:{height:300},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(R,{data:i.dayDistribution,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"dayNumber",label:{value:"Nombre de Jours",position:"insideBottom",offset:-5}}),e.jsx(D,{label:{value:"Nombre de Parties",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload,p=Object.entries(o.phases).map(([y,g])=>`${y}: ${g}`).join(", ");return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Jour ",o.dayNumber]})}),e.jsxs("div",{children:[o.count," parties (",o.percentage.toFixed(1),"%)"]}),e.jsxs("div",{children:["D√©tail: ",p]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(M,{dataKey:"count",name:"Nombre de Parties",fill:"var(--chart-color-3)",onClick:t=>{v({fromComponent:`Analyse des Temps de Jeu - Jour ${t.dayNumber}`})},style:{cursor:"pointer"}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"D√©tail par Timing de Fin"}),e.jsx(b,{title:"D√©tail par Timing de Fin",children:e.jsx("div",{style:{height:400},children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(R,{data:i.endTimingDistribution,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"timing",angle:-45,textAnchor:"end",height:80,interval:0,label:{value:"Timing de Fin",position:"insideBottom",offset:-40},tick:({x:t,y:n,payload:o})=>e.jsx("text",{x:t,y:n,dy:16,textAnchor:"end",fill:"var(--text-secondary)",fontSize:13,transform:`rotate(-45 ${t} ${n})`,children:d(o.value)})}),e.jsx(D,{label:{value:"Nombre de Parties",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:d(o.timing)})}),e.jsxs("div",{children:["Phase: ",o.phase]}),e.jsxs("div",{children:["Jour: ",o.dayNumber]}),e.jsxs("div",{children:[o.count," parties (",o.percentage.toFixed(1),"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(M,{dataKey:"count",name:"Nombre de Parties",style:{cursor:"pointer"},shape:t=>{const{x:n,y:o,width:p,height:y,payload:g}=t,f=g,S=f.phase==="Jour"?"#FFD700":f.phase==="Nuit"?"#4169E1":f.phase==="Meeting"?"#FF6347":B(f.timing);return e.jsx(w,{x:n,y:o,width:p,height:y,fill:S,onClick:()=>{v({fromComponent:`Analyse des Temps de Jeu - Timing ${d(f.timing)}`})},style:{cursor:"pointer"}})}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Taux de Victoire par Jour de Jeu"}),e.jsx(b,{title:"Taux de Victoire par Jour de Jeu",children:e.jsx("div",{style:{height:450},children:u&&u.length>0?e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(se,{data:u,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"day",label:{value:"Jour de fin de partie",position:"insideBottom",offset:-10},tickFormatter:t=>`Jour ${t}`}),e.jsx(D,{yAxisId:"left",label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(D,{yAxisId:"right",orientation:"right",label:{value:"Nombre de parties",angle:90,position:"right",style:{textAnchor:"middle"}},domain:[0,"auto"]}),e.jsx(T,{content:({active:t,payload:n})=>{if(t&&n&&n.length>0){const o=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Jour ",o.day]}),e.jsxs("div",{style:{fontSize:"0.9rem"},children:[e.jsxs("div",{style:{color:"#4CAF50",marginBottom:4},children:["üü¢ Villageois: ",o.villageoisWinRate.toFixed(1),"% (",o.villageoisWins,"/",o.totalGames,")"]}),e.jsxs("div",{style:{color:"#f44336",marginBottom:4},children:["üî¥ Loups: ",o.loupsWinRate.toFixed(1),"% (",o.loupsWins,"/",o.totalGames,")"]}),e.jsxs("div",{style:{color:"#FF9800"},children:["üü† Solo: ",o.soloWinRate.toFixed(1),"% (",o.soloWins,"/",o.totalGames,")"]})]}),e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid var(--border-color)",fontSize:"0.85rem",color:"var(--text-secondary)"},children:["Total: ",o.totalGames," parties"]})]})}return null}}),e.jsx(ie,{wrapperStyle:{paddingTop:"20px"},formatter:t=>t==="villageoisWinRate"?"Villageois":t==="loupsWinRate"?"Loups":t==="soloWinRate"?"Solo":t==="totalGames"?"Nombre de parties":t}),e.jsx(M,{yAxisId:"right",dataKey:"totalGames",name:"totalGames",fill:"rgba(128, 128, 128, 0.2)",radius:[4,4,0,0]}),e.jsx(k,{yAxisId:"left",type:"monotone",dataKey:"villageoisWinRate",name:"villageoisWinRate",stroke:"#4CAF50",strokeWidth:3,activeDot:{r:8},dot:t=>{const{cx:n,cy:o,payload:p}=t,y=3+p.totalGames/Math.max(...u.map(g=>g.totalGames))*5;return e.jsx("circle",{cx:n,cy:o,r:y,fill:"#4CAF50",stroke:"#4CAF50",strokeWidth:2})}}),e.jsx(k,{yAxisId:"left",type:"monotone",dataKey:"loupsWinRate",name:"loupsWinRate",stroke:"#f44336",strokeWidth:3,activeDot:{r:8},dot:t=>{const{cx:n,cy:o,payload:p}=t,y=3+p.totalGames/Math.max(...u.map(g=>g.totalGames))*5;return e.jsx("circle",{cx:n,cy:o,r:y,fill:"#f44336",stroke:"#f44336",strokeWidth:2})}}),e.jsx(k,{yAxisId:"left",type:"monotone",dataKey:"soloWinRate",name:"soloWinRate",stroke:"#FF9800",strokeWidth:3,activeDot:{r:8},dot:t=>{const{cx:n,cy:o,payload:p}=t,y=3+p.totalGames/Math.max(...u.map(g=>g.totalGames))*5;return e.jsx("circle",{cx:n,cy:o,r:y,fill:"#FF9800",stroke:"#FF9800",strokeWidth:2})}})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-secondary)"},children:"Aucune donn√©e disponible (minimum 5 parties par jour requis)"})})}),e.jsx("div",{style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--text-secondary)",padding:"0 1rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Analyse des victoires selon la dur√©e :"})," Ce graphique montre le taux de victoire de chaque camp en fonction du jour o√π la partie s'est termin√©e. Les phases Jour, Nuit et Meeting de chaque journ√©e sont regroup√©es ensemble.",e.jsx("br",{}),'La taille des points refl√®te le nombre de parties termin√©es ce "jour"-l√†. Les barres grises en arri√®re-plan indiquent le volume de parties.',e.jsx("br",{}),"Seuls les jours avec au moins 5 parties sont affich√©s pour garantir la fiabilit√© statistique."]})})]})]})]})]})}export{Je as GameDurationInsights};
