import{g as O,b as z,u as T,a as k,r as D,j as s}from"./index-TKEKv-o7.js";import{b as M,a as R,u as J}from"./datasyncExport-T8WED8O2.js";import{u as $}from"./useJoueursData-BRta7aeo.js";import{u as q}from"./api-pZdyOU17.js";import{F as H,B,C as K,X as U,Y as X,a as Y,b as _}from"./FullscreenChart-D5ZT1a6p.js";import{R as Q,T as Z}from"./CategoricalChart-BNqQottb.js";function ee(e){const c=new Map;return e.forEach(g=>{g.PlayerStats.forEach(t=>{const u=O(t),h=z(t);c.set(u,h)})}),c}function se(e){const c={};return e.forEach((g,t)=>{c[t]={currentVillageoisSeries:0,currentLoupsSeries:0,currentNoWolfSeries:0,longestVillageoisSeries:null,longestLoupsSeries:null,longestNoWolfSeries:null,currentWinSeries:0,longestWinSeries:null,currentWinCamps:[],currentLossSeries:0,longestLossSeries:null,currentLossCamps:[],currentNoWolfCamps:[],lastCamp:null,lastWon:!1,villageoisSeriesStart:null,loupsSeriesStart:null,noWolfSeriesStart:null,winSeriesStart:null,lossSeriesStart:null,currentVillageoisGameIds:[],currentLoupsGameIds:[],currentNoWolfGameIds:[],currentWinGameIds:[],currentLossGameIds:[]}}),c}function ie(e,c,g,t,u){if(g==="Villageois"||g==="Loup"?(g==="Villageois"&&(e.lastCamp==="Villageois"?(e.currentVillageoisSeries++,e.currentVillageoisGameIds.push(t)):(e.currentVillageoisSeries=1,e.villageoisSeriesStart={game:t,date:u},e.currentVillageoisGameIds=[t]),(!e.longestVillageoisSeries||e.currentVillageoisSeries>=e.longestVillageoisSeries.seriesLength)&&(e.longestVillageoisSeries={player:c,camp:"Villageois",seriesLength:e.currentVillageoisSeries,startGame:e.villageoisSeriesStart?.game||t,endGame:t,startDate:e.villageoisSeriesStart?.date||u,endDate:u,isOngoing:!1,gameIds:[...e.currentVillageoisGameIds]}),e.currentLoupsSeries=0,e.loupsSeriesStart=null,e.currentLoupsGameIds=[]),g==="Loup"&&(e.lastCamp==="Loup"?(e.currentLoupsSeries++,e.currentLoupsGameIds.push(t)):(e.currentLoupsSeries=1,e.loupsSeriesStart={game:t,date:u},e.currentLoupsGameIds=[t]),(!e.longestLoupsSeries||e.currentLoupsSeries>=e.longestLoupsSeries.seriesLength)&&(e.longestLoupsSeries={player:c,camp:"Loups",seriesLength:e.currentLoupsSeries,startGame:e.loupsSeriesStart?.game||t,endGame:t,startDate:e.loupsSeriesStart?.date||u,endDate:u,isOngoing:!1,gameIds:[...e.currentLoupsGameIds]}),e.currentVillageoisSeries=0,e.villageoisSeriesStart=null,e.currentVillageoisGameIds=[],e.currentNoWolfSeries=0,e.noWolfSeriesStart=null,e.currentNoWolfGameIds=[],e.currentNoWolfCamps=[]),e.lastCamp=g):(e.currentVillageoisSeries=0,e.currentLoupsSeries=0,e.villageoisSeriesStart=null,e.loupsSeriesStart=null,e.currentVillageoisGameIds=[],e.currentLoupsGameIds=[],e.lastCamp="Autres"),g!=="Loup"){e.currentNoWolfSeries>0?(e.currentNoWolfSeries++,e.currentNoWolfGameIds.push(t),e.currentNoWolfCamps.push(g)):(e.currentNoWolfSeries=1,e.noWolfSeriesStart={game:t,date:u},e.currentNoWolfGameIds=[t],e.currentNoWolfCamps=[g]);const h={};e.currentNoWolfCamps.forEach(l=>{h[l]=(h[l]||0)+1}),(!e.longestNoWolfSeries||e.currentNoWolfSeries>=e.longestNoWolfSeries.seriesLength)&&(e.longestNoWolfSeries={player:c,camp:"Sans Loups",seriesLength:e.currentNoWolfSeries,startGame:e.noWolfSeriesStart?.game||t,endGame:t,startDate:e.noWolfSeriesStart?.date||u,endDate:u,campCounts:h,isOngoing:!1,gameIds:[...e.currentNoWolfGameIds]})}}function re(e,c,g,t,u,h){if(g){if(e.lastWon?(e.currentWinSeries++,e.currentWinCamps.push(t),e.currentWinGameIds.push(u)):(e.currentWinSeries=1,e.currentWinCamps=[t],e.winSeriesStart={game:u,date:h},e.currentWinGameIds=[u]),!e.longestWinSeries||e.currentWinSeries>=e.longestWinSeries.seriesLength){const l={};e.currentWinCamps.forEach(n=>{l[n]=(l[n]||0)+1}),e.longestWinSeries={player:c,seriesLength:e.currentWinSeries,startGame:e.winSeriesStart?.game||u,endGame:u,startDate:e.winSeriesStart?.date||h,endDate:h,campCounts:l,isOngoing:!1,gameIds:[...e.currentWinGameIds]}}e.lastWon=!0}else e.currentWinSeries=0,e.currentWinCamps=[],e.winSeriesStart=null,e.currentWinGameIds=[],e.lastWon=!1}function ne(e,c,g,t,u,h){if(g)e.currentLossSeries=0,e.currentLossCamps=[],e.lossSeriesStart=null,e.currentLossGameIds=[];else if(e.currentLossSeries>0?(e.currentLossSeries++,e.currentLossCamps.push(t),e.currentLossGameIds.push(u)):(e.currentLossSeries=1,e.currentLossCamps=[t],e.lossSeriesStart={game:u,date:h},e.currentLossGameIds=[u]),!e.longestLossSeries||e.currentLossSeries>=e.longestLossSeries.seriesLength){const l={};e.currentLossCamps.forEach(n=>{l[n]=(l[n]||0)+1}),e.longestLossSeries={player:c,seriesLength:e.currentLossSeries,startGame:e.lossSeriesStart?.game||u,endGame:u,startDate:e.lossSeriesStart?.date||h,endDate:h,campCounts:l,isOngoing:!1,gameIds:[...e.currentLossGameIds]}}}function oe(e){const c=[],g=[],t=[],u=[],h=[];return Object.values(e).forEach(l=>{l.longestVillageoisSeries&&c.push(l.longestVillageoisSeries),l.longestLoupsSeries&&g.push(l.longestLoupsSeries),l.longestNoWolfSeries&&t.push(l.longestNoWolfSeries),l.longestWinSeries&&u.push(l.longestWinSeries),l.longestLossSeries&&h.push(l.longestLossSeries)}),c.sort((l,n)=>n.seriesLength-l.seriesLength),g.sort((l,n)=>n.seriesLength-l.seriesLength),t.sort((l,n)=>n.seriesLength-l.seriesLength),u.sort((l,n)=>n.seriesLength-l.seriesLength),h.sort((l,n)=>n.seriesLength-l.seriesLength),{allVillageoisSeries:c,allLoupsSeries:g,allNoWolfSeries:t,allWinSeries:u,allLossSeries:h}}function le(e,c){const g=[],t=[],u=[],h=[],l=[];Object.values(e).forEach(d=>{g.push(d.longestVillageoisSeries?.seriesLength||0),t.push(d.longestLoupsSeries?.seriesLength||0),u.push(d.longestNoWolfSeries?.seriesLength||0),h.push(d.longestWinSeries?.seriesLength||0),l.push(d.longestLossSeries?.seriesLength||0)});const n=c>0?g.reduce((d,S)=>d+S,0)/c:0,I=c>0?t.reduce((d,S)=>d+S,0)/c:0,f=c>0?u.reduce((d,S)=>d+S,0)/c:0,W=c>0?h.reduce((d,S)=>d+S,0)/c:0,C=c>0?l.reduce((d,S)=>d+S,0)/c:0,j=g.filter(d=>d>=5).length,N=t.filter(d=>d>=3).length,b=u.filter(d=>d>=5).length,G=h.filter(d=>d>=5).length,L=l.filter(d=>d>=5).length;return{averageVillageoisSeries:Math.round(n*10)/10,averageLoupsSeries:Math.round(I*10)/10,averageNoWolfSeries:Math.round(f*10)/10,averageWinSeries:Math.round(W*10)/10,averageLossSeries:Math.round(C*10)/10,eliteVillageoisCount:j,eliteLoupsCount:N,eliteNoWolfCount:b,eliteWinCount:G,eliteLossCount:L}}function te(e){if(e.length===0)return null;const c=[...e].sort((r,i)=>parseInt(r.DisplayedId)-parseInt(i.DisplayedId)),g=ee(c),t=se(g);c.forEach(r=>{const i=r.DisplayedId,o=new Date(r.StartDate).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"});r.PlayerStats.forEach(a=>{const m=O(a),p=z(a);g.set(m,p);const y=t[m];if(!y)return;const F=M(R(a.MainRoleInitial,a.MainRoleChanges||[])),E=a.Victorious;ie(y,p,F,i,o),re(y,p,E,F,i,o),ne(y,p,E,F,i,o)})});const{allVillageoisSeries:u,allLoupsSeries:h,allNoWolfSeries:l,allWinSeries:n,allLossSeries:I}=oe(t);Object.values(t).forEach(r=>{r.longestVillageoisSeries&&r.currentVillageoisSeries===r.longestVillageoisSeries.seriesLength&&r.currentVillageoisSeries>0&&(r.longestVillageoisSeries.isOngoing=!0),r.longestLoupsSeries&&r.currentLoupsSeries===r.longestLoupsSeries.seriesLength&&r.currentLoupsSeries>0&&(r.longestLoupsSeries.isOngoing=!0),r.longestNoWolfSeries&&r.currentNoWolfSeries===r.longestNoWolfSeries.seriesLength&&r.currentNoWolfSeries>0&&(r.longestNoWolfSeries.isOngoing=!0),r.longestWinSeries&&r.currentWinSeries===r.longestWinSeries.seriesLength&&r.currentWinSeries>0&&(r.longestWinSeries.isOngoing=!0),r.longestLossSeries&&r.currentLossSeries===r.longestLossSeries.seriesLength&&r.currentLossSeries>0&&(r.longestLossSeries.isOngoing=!0)});const f=le(t,g.size);let W=0,C=0,j=0,N=0,b=0,G=0,L=0,d=0,S=0,A=0;const v=[],x=[],V=[],w=[],P=[];return Object.entries(t).forEach(([r,i])=>{const o=i.longestVillageoisSeries?.player||i.longestLoupsSeries?.player||i.longestNoWolfSeries?.player||i.longestWinSeries?.player||i.longestLossSeries?.player||r;if(i.currentVillageoisSeries>0&&(W++,v.push({player:o,camp:"Villageois",seriesLength:i.currentVillageoisSeries,startGame:i.villageoisSeriesStart?.game||"",endGame:i.currentVillageoisGameIds[i.currentVillageoisGameIds.length-1]||"",startDate:i.villageoisSeriesStart?.date||"",endDate:c[c.length-1]?.EndDate||"",isOngoing:!0,gameIds:[...i.currentVillageoisGameIds]})),i.currentLoupsSeries>0&&(C++,x.push({player:o,camp:"Loups",seriesLength:i.currentLoupsSeries,startGame:i.loupsSeriesStart?.game||"",endGame:i.currentLoupsGameIds[i.currentLoupsGameIds.length-1]||"",startDate:i.loupsSeriesStart?.date||"",endDate:c[c.length-1]?.EndDate||"",isOngoing:!0,gameIds:[...i.currentLoupsGameIds]})),i.currentNoWolfSeries>0){j++;const a={};i.currentNoWolfCamps.forEach(m=>{a[m]=(a[m]||0)+1}),V.push({player:o,camp:"Sans Loups",seriesLength:i.currentNoWolfSeries,startGame:i.noWolfSeriesStart?.game||"",endGame:i.currentNoWolfGameIds[i.currentNoWolfGameIds.length-1]||"",startDate:i.noWolfSeriesStart?.date||"",endDate:c[c.length-1]?.EndDate||"",campCounts:a,isOngoing:!0,gameIds:[...i.currentNoWolfGameIds]})}if(i.currentWinSeries>0){N++;const a={};i.currentWinCamps.forEach(m=>{a[m]=(a[m]||0)+1}),w.push({player:o,seriesLength:i.currentWinSeries,startGame:i.winSeriesStart?.game||"",endGame:i.currentWinGameIds[i.currentWinGameIds.length-1]||"",startDate:i.winSeriesStart?.date||"",endDate:c[c.length-1]?.EndDate||"",campCounts:a,isOngoing:!0,gameIds:[...i.currentWinGameIds]})}if(i.currentLossSeries>0){b++;const a={};i.currentLossCamps.forEach(m=>{a[m]=(a[m]||0)+1}),P.push({player:o,seriesLength:i.currentLossSeries,startGame:i.lossSeriesStart?.game||"",endGame:i.currentLossGameIds[i.currentLossGameIds.length-1]||"",startDate:i.lossSeriesStart?.date||"",endDate:c[c.length-1]?.EndDate||"",campCounts:a,isOngoing:!0,gameIds:[...i.currentLossGameIds]})}i.longestVillageoisSeries?.isOngoing&&G++,i.longestLoupsSeries?.isOngoing&&L++,i.longestNoWolfSeries?.isOngoing&&d++,i.longestWinSeries?.isOngoing&&S++,i.longestLossSeries?.isOngoing&&A++}),v.sort((r,i)=>i.seriesLength-r.seriesLength),x.sort((r,i)=>i.seriesLength-r.seriesLength),V.sort((r,i)=>i.seriesLength-r.seriesLength),w.sort((r,i)=>i.seriesLength-r.seriesLength),P.sort((r,i)=>i.seriesLength-r.seriesLength),{allVillageoisSeries:u,allLoupsSeries:h,allNoWolfSeries:l,allWinSeries:n,allLossSeries:I,currentVillageoisSeries:v,currentLoupsSeries:x,currentNoWolfSeries:V,currentWinSeries:w,currentLossSeries:P,totalGamesAnalyzed:c.length,totalPlayersCount:g.size,activeVillageoisCount:W,activeLoupsCount:C,activeNoWolfCount:j,activeWinCount:N,activeLossCount:b,ongoingVillageoisCount:G,ongoingLoupsCount:L,ongoingNoWolfCount:d,ongoingWinCount:S,ongoingLossCount:A,...f}}function ce(){const{data:e,isLoading:c,error:g}=J(t=>te(t));return{data:e,isLoading:c,error:g}}function fe(){const{data:e,isLoading:c,error:g}=ce(),{navigateToGameDetails:t,navigationState:u,updateNavigationState:h}=T(),{settings:l}=k(),[n,I]=D.useState(u.selectedSeriesType||"villageois"),[f,W]=D.useState(u.seriesViewMode||"best"),[C,j]=D.useState(null),N=D.useRef(null),{joueursData:b}=$(),G=q(b),L=r=>{I(r),h({selectedSeriesType:r})},d=r=>{W(r),h({seriesViewMode:r})},{currentData:S,highlightedPlayerAdded:A,fullDataset:v}=D.useMemo(()=>{if(!e)return{currentData:[],highlightedPlayerAdded:!1,fullDataset:[]};let r=[];if(f==="ongoing")switch(n){case"villageois":r=e.currentVillageoisSeries;break;case"loup":r=e.currentLoupsSeries;break;case"nowolf":r=e.currentNoWolfSeries;break;case"wins":r=e.currentWinSeries;break;case"losses":r=e.currentLossSeries;break;default:r=[]}else switch(n){case"villageois":r=e.allVillageoisSeries;break;case"loup":r=e.allLoupsSeries;break;case"nowolf":r=e.allNoWolfSeries;break;case"wins":r=e.allWinSeries;break;case"losses":r=e.allLossSeries;break;default:r=[]}const i=r.slice(0,20),o=l.highlightedPlayer&&i.some(p=>p.player===l.highlightedPlayer);let a=[...i],m=!1;if(l.highlightedPlayer&&!o){const p=r.find(y=>y.player===l.highlightedPlayer);p&&(a.push({...p,isHighlightedAddition:!0}),m=!0)}return{currentData:a,highlightedPlayerAdded:m,fullDataset:r}},[e,n,f,l.highlightedPlayer]);if(c)return s.jsx("div",{className:"donnees-attente",children:"Récupération des séries de joueurs..."});if(g)return s.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",g]});if(!e)return s.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de série disponible"});const x=r=>Object.entries(r).map(([i,o])=>`${i} (${o})`).join(", "),V=()=>{switch(n){case"villageois":return f==="ongoing"?"Séries Villageois En Cours":"Plus Longues Séries Villageois Consécutives";case"loup":return f==="ongoing"?"Séries Loups En Cours":"Plus Longues Séries Loups Consécutives";case"nowolf":return f==="ongoing"?"Séries Sans Rôle Loup En Cours":"Plus Longues Séries Sans Rôle Loup";case"wins":return f==="ongoing"?"Séries de Victoires En Cours":"Plus Longues Séries de Victoires";case"losses":return f==="ongoing"?"Séries de Défaites En Cours":"Plus Longues Séries de Défaites";default:return""}},w=({active:r,payload:i})=>{if(!r||!i||i.length===0)return null;const o=i[0].payload,a=o.isHighlightedAddition,m=l.highlightedPlayer===o.player,p=f==="best"&&o.isOngoing;return n==="wins"?s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:o.player}),p&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"🔥"})]}),s.jsxs("div",{children:["Série de victoires : ",o.seriesLength," parties ",p?"(En cours)":""]}),s.jsxs("div",{children:["Du ",o.startGame," au ",o.endGame]}),s.jsxs("div",{children:["Du ",o.startDate," au ",o.endDate]}),s.jsxs("div",{children:["Camps joués : ",x(o.campCounts)]}),a&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"🎯 Joueur mis en évidence (hors top 20)"}),m&&!a&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"🎯 Joueur mis en évidence"}),p&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"🔥 Série en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]}):n==="losses"?s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:o.player}),p&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"🔥"})]}),s.jsxs("div",{children:["Série de défaites : ",o.seriesLength," parties ",p?"(En cours)":""]}),s.jsxs("div",{children:["Du ",o.startGame," au ",o.endGame]}),s.jsxs("div",{children:["Du ",o.startDate," au ",o.endDate]}),s.jsxs("div",{children:["Camps joués : ",x(o.campCounts)]}),a&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"🎯 Joueur mis en évidence (hors top 20)"}),m&&!a&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"🎯 Joueur mis en évidence"}),p&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"🔥 Série en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]}):s.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:o.player}),p&&s.jsx("span",{style:{marginLeft:"8px",fontSize:"1.2em"},children:"🔥"})]}),s.jsxs("div",{children:["Série ",o.camp," : ",o.seriesLength," parties consécutives ",p?"(En cours)":""]}),s.jsxs("div",{children:["Du ",o.startGame," au ",o.endGame]}),s.jsxs("div",{children:["Du ",o.startDate," au ",o.endDate]}),o.campCounts&&s.jsxs("div",{children:["Camps joués : ",x(o.campCounts)]}),a&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"🎯 Joueur mis en évidence (hors top 20)"}),m&&!a&&s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontStyle:"italic",textAlign:"center"},children:"🎯 Joueur mis en évidence"}),p&&s.jsx("div",{style:{fontSize:"0.8rem",color:"#FF8C00",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"🔥 Série en cours - Aucun jeu depuis !"}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})},P=r=>{if(n==="wins")t({selectedPlayer:r.player,selectedGameIds:r.gameIds,fromComponent:"Séries de Victoires"});else if(n==="losses")t({selectedPlayer:r.player,selectedGameIds:r.gameIds,fromComponent:"Séries de Défaites"});else if(n==="nowolf")t({selectedPlayer:r.player,selectedGameIds:r.gameIds,fromComponent:"Séries Sans Loups"});else{const i=n==="villageois"?"Villageois":"Loup";t({selectedPlayer:r.player,selectedGameIds:r.gameIds,campFilter:{selectedCamp:i,campFilterMode:"all-assignments"},fromComponent:`Séries ${i}`})}};return s.jsxs("div",{className:"lycans-players-series",children:[s.jsx("h2",{children:"Séries des Joueurs"}),s.jsx("div",{className:"lycans-section-description",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Mode Meilleurs Records :"})," Affiche les meilleures séries de tous les temps pour chaque joueur.",s.jsx("br",{}),s.jsx("strong",{children:"Mode Séries En Cours :"})," Affiche uniquement les séries actuellement actives (tous les joueurs ayant une série en cours, pas seulement leur record personnel).",s.jsx("br",{}),s.jsx("br",{}),n==="villageois"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Séries Villageois :"})," Parties consécutives dans le camp Villageois. Jouer dans n'importe quel autre camp brise la série."]}),n==="loup"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Séries Loups :"})," Parties consécutives dans le camp Loups. Jouer dans n'importe quel autre camp brise la série."]}),n==="nowolf"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Séries sans Loups :"})," Parties consécutives où le joueur n'a PAS joué de rôle Loup. Jouer un rôle Loup brise la série."]}),n==="wins"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Séries de victoires :"})," Victoires consécutives dans n'importe quel camp. Une défaite brise la série."]}),n==="losses"&&s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Séries de défaites :"})," Défaites consécutives dans n'importe quel camp. Une victoire brise la série."]}),s.jsx("br",{}),s.jsx("strong",{children:"🔥 Séries en cours :"})," ",f==="ongoing"?"Toutes les séries affichées sont actuellement actives":"Les séries avec l'effet de flamme sont encore actives"]})}),s.jsxs("div",{className:"lycans-categories-selection",style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[s.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[s.jsx("button",{className:`lycans-categorie-btn ${n==="villageois"?"active":""}`,onClick:()=>L("villageois"),children:"Séries Villageois"}),s.jsx("button",{className:`lycans-categorie-btn ${n==="loup"?"active":""}`,onClick:()=>L("loup"),children:"Séries Loups"}),s.jsx("button",{className:`lycans-categorie-btn ${n==="nowolf"?"active":""}`,onClick:()=>L("nowolf"),children:"Séries Sans Loups"}),s.jsx("button",{className:`lycans-categorie-btn ${n==="wins"?"active":""}`,onClick:()=>L("wins"),children:"Séries de Victoires"}),s.jsx("button",{className:`lycans-categorie-btn ${n==="losses"?"active":""}`,onClick:()=>L("losses"),children:"Séries de Défaites"})]}),s.jsx("button",{className:"lycans-categorie-btn",onClick:()=>d(f==="best"?"ongoing":"best"),style:{marginLeft:"auto",backgroundColor:f==="ongoing"?"#FF8C00":"var(--accent-primary)",color:"white",fontWeight:"bold"},children:f==="best"?"🔥 Focus Séries En Cours":"📊 Voir les Records"})]}),s.jsxs("div",{className:"lycans-graphique-section",children:[s.jsxs("div",{children:[s.jsx("h3",{children:V()}),A&&l.highlightedPlayer&&s.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',l.highlightedPlayer,'" affiché en plus du top 20']})]}),s.jsx(H,{title:V(),children:s.jsx("div",{ref:N,style:{height:500},children:s.jsx(Q,{width:"100%",height:"100%",children:s.jsxs(B,{data:S,margin:{top:20,right:30,left:20,bottom:10},children:[s.jsx(K,{strokeDasharray:"3 3"}),s.jsx(U,{dataKey:"player",angle:-45,textAnchor:"end",height:120,interval:0,tick:({x:r,y:i,payload:o})=>s.jsx("text",{x:r,y:i,dy:16,textAnchor:"end",fill:l.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:l.highlightedPlayer===o.value?14:13,fontWeight:l.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${r} ${i})`,children:o.value})}),s.jsx(X,{label:{value:n==="wins"?"Victoires consécutives":n==="losses"?"Défaites consécutives":n==="nowolf"?"Parties sans Loups consécutives":"Parties consécutives",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),s.jsx(Z,{content:w}),s.jsx(Y,{dataKey:"seriesLength",name:n==="wins"?"Victoires consécutives":n==="losses"?"Défaites consécutives":"Parties consécutives",fill:n==="villageois"?"#82ca9d":n==="loup"?"#FF8042":n==="nowolf"?"#FFA500":n==="wins"?"#8884d8":"#dc3545",children:S.map((r,i)=>{const o=l.highlightedPlayer===r.player,a=C===r.player,m=r.isHighlightedAddition,p=G[r.player]||(n==="villageois"?"#82ca9d":n==="loup"?"#FF8042":n==="nowolf"?"#FFA500":n==="wins"?"#8884d8":"#dc3545");return s.jsx(_,{fill:p,stroke:o?"var(--accent-primary)":a?"var(--text-primary)":"none",strokeWidth:o?3:a?2:0,strokeDasharray:m?"5,5":"none",opacity:m?.8:1,onClick:()=>P(r),onMouseEnter:()=>j(r.player),onMouseLeave:()=>j(null),style:{cursor:"pointer"},className:f==="best"&&r.isOngoing?"lycans-ongoing-series":""},`cell-${n}-${i}`)})})]})})})}),S.length>0&&(()=>{const r=S[0].seriesLength,i=S.filter(a=>a.seriesLength===r),o=i.some(a=>a.isOngoing);return s.jsxs("div",{className:"lycans-stats-grid",style:{marginTop:"0rem",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))"},children:[s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:f==="ongoing"?"🔥 Plus Longue Série Active":"🏆 Record Absolu"}),s.jsxs("div",{className:"lycans-stat-value",children:[r,f==="ongoing"&&s.jsx("span",{style:{fontSize:"0.6em",marginLeft:"5px"},children:"🔥"}),f==="best"&&o&&s.jsx("span",{style:{fontSize:"0.6em",marginLeft:"5px"},children:"🔥"})]}),i.length===1?s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["par ",s.jsx("strong",{children:i[0].player}),f==="best"&&i[0].isOngoing&&s.jsx("span",{style:{color:"#FF8C00",fontWeight:"bold"},children:" (En cours)"})]}),i[0].campCounts?s.jsxs("p",{className:"lycans-h2h-description",children:["Camps joués : ",x(i[0].campCounts)]}):s.jsxs("p",{className:"lycans-h2h-description",children:["Camp : ",i[0].camp]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["par ",s.jsxs("strong",{children:[i.length," joueurs"]}),f==="best"&&o&&s.jsxs("span",{style:{color:"#FF8C00",fontWeight:"bold"},children:[" (dont série",i.filter(a=>a.isOngoing).length>1?"s":""," en cours)"]})]}),s.jsx("p",{className:"lycans-h2h-description",style:{fontSize:"0.9rem",lineHeight:"1.4"},children:i.map((a,m)=>s.jsxs("span",{children:[s.jsx("strong",{children:a.player}),f==="best"&&a.isOngoing&&s.jsx("span",{style:{fontSize:"0.9em"},children:"🔥"}),m<i.length-1&&", "]},a.player))})]})]}),f==="best"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"📊 Meilleure série moyenne (tous les joueurs)"}),s.jsx("div",{className:"lycans-stat-value",children:n==="villageois"?e.averageVillageoisSeries:n==="loup"?e.averageLoupsSeries:n==="nowolf"?e.averageNoWolfSeries:n==="wins"?e.averageWinSeries:e.averageLossSeries}),s.jsx("p",{children:"parties en moyenne"}),s.jsxs("p",{className:"lycans-h2h-description",children:["Basé sur ",e.totalPlayersCount," joueurs"]})]}),s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"🔥 Séries En Cours"}),s.jsx("div",{className:"lycans-stat-value",children:n==="villageois"?e.activeVillageoisCount:n==="loup"?e.activeLoupsCount:n==="nowolf"?e.activeNoWolfCount:n==="wins"?e.activeWinCount:e.activeLossCount}),s.jsx("p",{children:"séries encore actives"}),s.jsx("p",{className:"lycans-h2h-description",children:(n==="villageois"?e.activeVillageoisCount:n==="loup"?e.activeLoupsCount:n==="nowolf"?e.activeNoWolfCount:n==="wins"?e.activeWinCount:e.activeLossCount)>0?"Joueurs actuellement dans une série de ce type":"Aucune série active de ce type"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"📊 Série active moyenne"}),s.jsx("div",{className:"lycans-stat-value",children:v.length>0?(v.reduce((a,m)=>a+m.seriesLength,0)/v.length).toFixed(1):"0"}),s.jsx("p",{children:"parties en moyenne"}),s.jsxs("p",{className:"lycans-h2h-description",children:["Basé sur ",v.length," joueur",v.length>1?"s":""," en série active"]})]}),s.jsxs("div",{className:"lycans-stat-card",children:[s.jsx("h3",{children:"👥 Joueurs Actifs"}),s.jsx("div",{className:"lycans-stat-value",children:v.length}),s.jsxs("p",{children:["joueur",v.length>1?"s":""," en série active"]}),s.jsx("p",{className:"lycans-h2h-description",children:v.length>0?`Sur ${e.totalPlayersCount} joueurs au total`:"Aucun joueur en série active"})]})]})]})})(),S.length===0&&s.jsxs("div",{className:"lycans-empty-section",children:[s.jsx("h3",{children:"Aucune série trouvée"}),s.jsx("p",{children:"Aucune série n'a été trouvée pour ce type avec les filtres actuels."})]})]})]})}export{fe as PlayerSeriesChart};
