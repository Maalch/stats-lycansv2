import{a as O,r as f,j as e}from"./index-DEBEVqWU.js";import{F as T,C as w,X as B,Y as H}from"./FullscreenChart-CfHeIRjY.js";import{u as V,a as q}from"./useRawBRData-DRqiQKMO.js";import{u as _}from"./useJoueursData-DdsiCQ1M.js";import{M as K,u as $,c as X,g as Y}from"./api-DgMAvMYB.js";import{R as z,T as D,a as F}from"./CategoricalChart-rAR1f6Ll.js";import{B as N,a as k}from"./BarChart-CwCHSbAs.js";const J=X.BR_STANDARD;function ae(){const{data:v,isLoading:C,error:j}=V(),{data:P,isLoading:E,error:b}=q(),{settings:a}=O(),{joueursData:M}=_(),[R,u]=f.useState(null),[m,I]=f.useState(K.LOW),G=$(M),S=r=>G[r]||Y(r),y=f.useMemo(()=>{if(!v||!P)return null;const r=v.reduce((t,o)=>{const x=o.Participants;return t[x]||(t[x]={name:x,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),t[x].participations++,t[x].totalScore+=o.Score,o.Gagnant&&t[x].wins++,t},{});Object.values(r).forEach(t=>{t.averageScore=t.totalScore/t.participations,t.winRate=t.wins/t.participations*100});const s=Object.values(r).sort((t,o)=>o.participations-t.participations),i=Object.values(r).sort((t,o)=>o.wins-t.wins),l=i.slice(0,15),c=a.highlightedPlayer&&l.some(t=>t.name===a.highlightedPlayer);let g=!1,n=[...l];if(a.highlightedPlayer&&!c){const t=i.find(o=>o.name===a.highlightedPlayer);t&&(n.push({...t,isHighlightedAddition:!0}),g=!0)}const d=Object.values(r).filter(t=>t.participations>=m),h=d.sort((t,o)=>o.winRate-t.winRate).slice(0,15),L=a.highlightedPlayer&&h.some(t=>t.name===a.highlightedPlayer);let A=!1,W=[...h];if(a.highlightedPlayer&&!L){const t=s.find(o=>o.name===a.highlightedPlayer);t&&(W.push({...t,isHighlightedAddition:!0}),A=!0)}return{topPlayersByWins:n,highlightedPlayerInWins:g,topPlayersByWinRate:W,highlightedPlayerInWinRate:A,totalEligiblePlayers:d.length}},[v,P,a.highlightedPlayer,m]);return C||E?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):j||b?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",j||b]}):y?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Taux de Victoire - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Victoires"}),y.highlightedPlayerInWins&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary-text)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(T,{title:"Victoires - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(z,{width:"100%",height:400,children:e.jsxs(N,{data:y.topPlayersByWins,children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:r,y:s,payload:i})=>e.jsx("text",{x:r,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:a.highlightedPlayer===i.value?14:12,fontWeight:a.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${r} ${s})`,children:i.value})}),e.jsx(H,{}),e.jsx(D,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload,l=i.isHighlightedAddition,c=a.highlightedPlayer===i.name;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,c&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:i.wins})]}),e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:i.participations})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]})]}),l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(k,{dataKey:"wins",name:"Victoires",fill:"var(--chart-color-2)",shape:r=>{const{x:s,y:i,width:l,height:c,payload:g}=r,n=g,d=a.highlightedPlayer===n.name,p=R===n.name,h=n.isHighlightedAddition;return e.jsx(F,{x:s,y:i,width:l,height:c,fill:d?"var(--accent-primary)":h?"var(--accent-secondary)":S(n.name),stroke:d?"var(--accent-primary)":p?"var(--text-primary)":"none",strokeWidth:d?3:p?2:0,strokeDasharray:h?"5,5":"none",opacity:h?.8:1,onMouseEnter:()=>u(n.name),onMouseLeave:()=>u(null),style:{cursor:"pointer"}})}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Taux de Victoire"}),y.highlightedPlayerInWinRate&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary-text)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-br-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-br-select",value:m,onChange:r=>I(Number(r.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:J.map(r=>e.jsx("option",{value:r,children:r},r))})]})]}),e.jsx(T,{title:"Taux de Victoire - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(z,{width:"100%",height:400,children:e.jsxs(N,{data:y.topPlayersByWinRate,children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:r,y:s,payload:i})=>e.jsx("text",{x:r,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:a.highlightedPlayer===i.value?14:12,fontWeight:a.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${r} ${s})`,children:i.value})}),e.jsx(H,{}),e.jsx(D,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload,l=i.isHighlightedAddition,c=a.highlightedPlayer===i.name,g=i.participations>=m;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,c&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:i.wins})," / ",i.participations]})]}),l&&!g&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",m," partie",m>1?"s":"",")"]}),l&&g&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(k,{dataKey:"winRate",name:"Taux de victoire (%)",shape:r=>{const{x:s,y:i,width:l,height:c,payload:g}=r,n=g,d=a.highlightedPlayer===n.name,p=R===n.name,h=n.isHighlightedAddition;return e.jsx(F,{x:s,y:i,width:l,height:c,fill:d?"var(--accent-primary)":h?"var(--accent-secondary)":S(n.name),stroke:d?"var(--accent-primary)":p?"var(--text-primary)":"none",strokeWidth:d?3:p?2:0,strokeDasharray:h?"5,5":"none",opacity:h?.8:1,onMouseEnter:()=>u(n.name),onMouseLeave:()=>u(null),style:{cursor:"pointer"}})}})]})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",y.topPlayersByWinRate.length," des joueurs (sur ",y.totalEligiblePlayers," ayant au moins ",m," partie",m>1?"s":"",")"]})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{ae as BRWinRateChart};
