import{g as ne,e as oe,u as Q,a as ee,r as L,j as e,h as me}from"./index-CYMfGvXf.js";import{g as re,u as ue,a as ye,b as ve,c as pe}from"./useDeathStatisticsFromRaw-DkdhjQhI.js";import{u as de}from"./baseStatsHook-B2Pt1DYZ.js";import{g as xe,D as V}from"./datasyncExport-CjB7UYqV.js";import{M as ce,C as he,u as te,m as ae,b as ge,a as fe}from"./api-Bi-DxJak.js";import{D as F,g as se}from"./deathTypes-gHH1w6_X.js";import{F as G,C as q,X as $,Y as w,a as Y}from"./FullscreenChart-BOwoAEcH.js";import{u as ie}from"./useJoueursData-hTX7qFXz.js";import{R as U,T as O}from"./CategoricalChart-BYuqHaki.js";import{B as _,a as J}from"./BarChart-C4fuAJ8O.js";function le(s){if(!s||s.trim()==="")return null;const l=s.trim().slice(1),o=parseInt(l,10);return isNaN(o)||o<1?null:o}function je(s,u){if(s.length===0)return null;const l={},o={};s.forEach(v=>{let r=1;if(v.EndTiming){const p=le(v.EndTiming);p&&(r=p)}v.PlayerStats.forEach(p=>{if(u&&u!=="Tous les camps"&&xe(p.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==u)return;const h=p.Username;l[h]||(l[h]={playerName:h,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const B=l[h];B.totalGames++;let R=null;p.DeathTiming&&(R=le(p.DeathTiming));for(let N=1;N<=r;N++)B.gamesPlayedByDay[N]||(B.gamesPlayedByDay[N]=0,B.survivalsByDay[N]=0),o[N]||(o[N]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),B.gamesPlayedByDay[N]++,o[N].playersOnDay++,(!R||R>N)&&(B.survivalsByDay[N]++,o[N].survivorsOnDay++)});for(let p=1;p<=r;p++)o[p]||(o[p]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),o[p].gamesReachingDay++}),Object.values(l).forEach(v=>{Object.keys(v.gamesPlayedByDay).forEach(r=>{const p=parseInt(r),h=v.gamesPlayedByDay[p],B=v.survivalsByDay[p];h>0?v.survivalRatesByDay[p]=B/h*100:v.survivalRatesByDay[p]=0})});const c=Object.values(l).filter(v=>v.totalGames>0).sort((v,r)=>r.totalGames-v.totalGames),k=Object.entries(o).map(([v,r])=>({dayNumber:parseInt(v),totalGamesReachingDay:r.gamesReachingDay,totalPlayersOnDay:r.playersOnDay,averageSurvivalRate:r.playersOnDay>0?r.survivorsOnDay/r.playersOnDay*100:0})).sort((v,r)=>v.dayNumber-r.dayNumber);return{totalGames:s.length,totalPlayersAnalyzed:c.length,playerSurvivalStats:c,dayStats:k}}function Se(s,u,l=ce.MEDIUM){return s.playerSurvivalStats.filter(o=>o.totalGames>=l&&(o.gamesPlayedByDay[u]||0)>0).map(o=>({playerName:o.playerName,survivalRate:o.survivalRatesByDay[u]||0,gamesPlayed:o.totalGames,timesReachedDay:o.gamesPlayedByDay[u]||0,timesSurvivedDay:o.survivalsByDay[u]||0})).sort((o,c)=>c.survivalRate-o.survivalRate).slice(0,he.TOP_15)}function Pe(s,u,l=ce.MEDIUM){return s.playerSurvivalStats.filter(o=>o.totalGames>=l&&(o.gamesPlayedByDay[u]||0)>0).map(o=>({playerName:o.playerName,survivalRate:o.survivalRatesByDay[u]||0,gamesPlayed:o.totalGames,timesReachedDay:o.gamesPlayedByDay[u]||0,timesSurvivedDay:o.survivalsByDay[u]||0})).sort((o,c)=>o.survivalRate-c.survivalRate).slice(0,he.TOP_15)}function De(s){return de(u=>je(u,s))}function be(s,u){if(u==="Tous les camps"){const l=s.filter(o=>o!==F.BULLET_HUMAN&&o!==F.BULLET_WOLF);return(s.includes(F.BULLET_HUMAN)||s.includes(F.BULLET_WOLF))&&!l.includes(F.BULLET)&&l.push(F.BULLET),l}return s}function Z(s,u){if(u==="Tous les camps"){const l=s.killsByDeathType[F.BULLET_HUMAN]||0,o=s.killsByDeathType[F.BULLET_WOLF]||0,c=s.killsByDeathType[F.BULLET]||0,k={...s.killsByDeathType};return k[F.BULLET]=l+o+c,delete k[F.BULLET_HUMAN],delete k[F.BULLET_WOLF],{...s,killsByDeathType:k}}return s}function Ae(s){const u=new Map;return s.forEach(l=>{l.PlayerStats.forEach(o=>{const c=ne(o),k=oe(o);let v=0;if(l.PlayerStats.forEach(r=>{r.KillerName===o.Username&&r.DeathTiming&&v++}),v>0){const r=u.get(c);r?v>r.maxKills?(r.maxKills=v,r.timesAchieved=1,r.gameIds=[l.DisplayedId]):v===r.maxKills&&(r.timesAchieved++,r.gameIds.includes(l.DisplayedId)||r.gameIds.push(l.DisplayedId)):u.set(c,{playerName:k,maxKills:v,timesAchieved:1,gameIds:[l.DisplayedId]})}})}),Array.from(u.values()).sort((l,o)=>o.maxKills!==l.maxKills?o.maxKills-l.maxKills:o.timesAchieved-l.timesAchieved)}function Te(s){const u=new Map;return s.forEach(l=>{const o=new Map;l.PlayerStats.forEach(c=>{if(c.KillerName&&c.DeathTiming&&c.DeathTiming.match(/^N\d+$/)){const k=c.KillerName,v=c.DeathTiming;o.has(k)||o.set(k,new Map);const r=o.get(k);r.set(v,(r.get(v)||0)+1)}}),o.forEach((c,k)=>{const v=Math.max(...Array.from(c.values())),r=l.PlayerStats.find(R=>R.Username===k);if(!r)return;const p=ne(r),h=oe(r),B=u.get(p);B?v>B.maxKills?(B.maxKills=v,B.timesAchieved=1,B.gameIds=[l.DisplayedId]):v===B.maxKills&&(B.timesAchieved++,B.gameIds.includes(l.DisplayedId)||B.gameIds.push(l.DisplayedId)):u.set(p,{playerName:h,maxKills:v,timesAchieved:1,gameIds:[l.DisplayedId]})})}),Array.from(u.values()).sort((l,o)=>o.maxKills!==l.maxKills?o.maxKills-l.maxKills:o.timesAchieved-l.timesAchieved)}function Ne(s){return s.length===0?null:{maxKillsPerGame:Ae(s),maxKillsPerNight:Te(s)}}function Be(){return de(s=>Ne(s))}function ke({deathStats:s,selectedCamp:u,victimCampFilter:l,minGamesForAverage:o,onMinGamesChange:c,availableDeathTypes:k,deathTypeColors:v,totalEligibleForAverage:r}){const{navigateToGameDetails:p}=Q(),{settings:h}=ee(),{joueursData:B}=ie(),R=te(B),{data:N}=Be(),H=L.useMemo(()=>be(k,l),[k,l]),W=L.useMemo(()=>{const a={...v};if(l==="Tous les camps"&&!a[F.BULLET]){const i=v[F.BULLET_HUMAN]||v[F.BULLET_WOLF];i&&(a[F.BULLET]=i)}return a},[v,l]),D=a=>{let i="Top Tueurs";return u!=="Tous les camps"&&(i+=` en ${u}`),l!=="Tous les camps"&&(l==="Roles solo"?i+=" (victimes: Roles solo)":i+=` (victimes: ${l})`),a==="total"?i+=" (Total)":i+=" (Moyenne par Partie)",i},{totalKillsData:x,averageKillsData:K,highlightedPlayerAddedToTotal:g,highlightedPlayerAddedToAverage:y}=L.useMemo(()=>{if(!s)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const a=s.killerStats.sort((z,S)=>S.kills-z.kills).slice(0,15),i=h.highlightedPlayer&&a.some(z=>z.killerName===h.highlightedPlayer),t=a.map(z=>{const S=Z(z,l),M={name:S.killerName,value:S.kills,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!1};return H.forEach(I=>{M[I]=S.killsByDeathType[I]||0}),M});let d=!1;if(h.highlightedPlayer&&!i){const z=s.killerStats.find(S=>S.killerName===h.highlightedPlayer);if(z){const S=Z(z,l),M={name:S.killerName,value:S.kills,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!0};H.forEach(I=>{M[I]=S.killsByDeathType[I]||0}),t.push(M),d=!0}}const m=s.killerStats.filter(z=>z.gamesPlayed>=o).sort((z,S)=>S.averageKillsPerGame-z.averageKillsPerGame).slice(0,15),C=h.highlightedPlayer&&m.some(z=>z.killerName===h.highlightedPlayer),E=m.map(z=>{const S=Z(z,l),M={name:S.killerName,value:S.averageKillsPerGame,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!1};return H.forEach(I=>{const X=S.killsByDeathType[I]||0;M[I]=S.gamesPlayed>0?X/S.gamesPlayed:0}),M});let T=!1;if(h.highlightedPlayer&&!C){const z=s.killerStats.find(S=>S.killerName===h.highlightedPlayer);if(z){const S=Z(z,l),M={name:S.killerName,value:S.averageKillsPerGame,victims:S.victims.length,percentage:S.percentage,gamesPlayed:S.gamesPlayed,averageKillsPerGame:S.averageKillsPerGame,isHighlightedAddition:!0};H.forEach(I=>{const X=S.killsByDeathType[I]||0;M[I]=S.gamesPlayed>0?X/S.gamesPlayed:0}),E.push(M),T=!0}}return{totalKillsData:t,averageKillsData:E,highlightedPlayerAddedToTotal:d,highlightedPlayerAddedToAverage:T}},[s,h.highlightedPlayer,o,H,l]),P=({active:a,payload:i,label:t})=>{if(a&&i&&i.length){const d=i[0].payload,b=d.isHighlightedAddition,m=h.highlightedPlayer===d.name,C=H.reduce((E,T)=>E+(d[T]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:m?"var(--accent-primary)":"var(--text-primary)"},children:[t,b&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",C]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",d.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),H.map(E=>({deathType:E,count:d[E]||0})).filter(E=>E.count>0).sort((E,T)=>T.count-E.count).map(({deathType:E,count:T})=>e.jsxs("p",{style:{color:W[E],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[re(E),":"]})," ",T]},E))]}),b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),m&&!b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},f=({active:a,payload:i,label:t})=>{if(a&&i&&i.length){const d=i[0].payload,b=d.isHighlightedAddition,m=h.highlightedPlayer===d.name,C=d.gamesPlayed>=o,E=s?.killerStats.find(M=>M.killerName===d.name),T=E?Z(E,l):null,z=H.reduce((M,I)=>M+(d[I]||0),0),S=T?T.kills:Math.round(z*d.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:m?"var(--accent-primary)":"var(--text-primary)"},children:[t,b&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",z.toFixed(2)," (",S," kills /",d.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",d.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),H.map(M=>({deathType:M,avgCount:d[M]||0,totalKillsForDeathType:T?T.killsByDeathType[M]||0:Math.round((d[M]||0)*d.gamesPlayed)})).filter(M=>M.avgCount>0).sort((M,I)=>I.avgCount-M.avgCount).map(({deathType:M,avgCount:I,totalKillsForDeathType:X})=>e.jsxs("p",{style:{color:W[M],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[re(M),":"]})," ",I.toFixed(2)," (",X," kills /",d.gamesPlayed," games)"]},M))]}),b&&!C&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",o," parties)"]}),b&&C&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),m&&!b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},n=L.useMemo(()=>{if(!N)return[];const a=N.maxKillsPerGame.slice(0,15),i=h.highlightedPlayer&&a.some(t=>t.playerName===h.highlightedPlayer);if(h.highlightedPlayer&&!i){const t=N.maxKillsPerGame.find(d=>d.playerName===h.highlightedPlayer);t&&a.push({...t})}return a.map((t,d)=>({name:t.playerName,value:t.maxKills,timesAchieved:t.timesAchieved,gameIds:t.gameIds,isHighlightedAddition:d>=15}))},[N,h.highlightedPlayer]),j=L.useMemo(()=>{if(!N)return[];const a=N.maxKillsPerNight.slice(0,15),i=h.highlightedPlayer&&a.some(t=>t.playerName===h.highlightedPlayer);if(h.highlightedPlayer&&!i){const t=N.maxKillsPerNight.find(d=>d.playerName===h.highlightedPlayer);t&&a.push({...t})}return a.map((t,d)=>({name:t.playerName,value:t.maxKills,timesAchieved:t.timesAchieved,gameIds:t.gameIds,isHighlightedAddition:d>=15}))},[N,h.highlightedPlayer]),A=({active:a,payload:i,label:t,chartType:d})=>{if(a&&i&&i.length){const b=i[0].payload,m=h.highlightedPlayer===b.name,C=b.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:m?"var(--accent-primary)":"var(--text-primary)"},children:[t,C&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsxs("strong",{children:[d==="game"?"Max kills en une partie":"Max kills en une nuit",":"]})," ",b.value]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Nombre de fois:"})," ",b.timesAchieved]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"4px 0",fontSize:"0.8rem"},children:[b.gameIds.length," partie",b.gameIds.length>1?"s":""," concernÃ©e",b.gameIds.length>1?"s":""]}),C&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),m&&!C&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:D("total")}),g&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:D("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:x,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:i,payload:t})=>e.jsx("text",{x:a,y:i,dy:10,fill:h.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===t.value?14:12,fontWeight:h.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${i})`,children:t.value})}),e.jsx(w,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(P,{})}),H.map(a=>e.jsx(J,{dataKey:a,name:a,stackId:"kills",fill:W[a],onClick:i=>{const t={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};u!=="Tous les camps"&&(t.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),p(t)}},a))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,x.filter(a=>!a.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:D("average")}),y&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:o,onChange:a=>c(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ae.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx(G,{title:D("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:K,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:i,payload:t})=>e.jsx("text",{x:a,y:i,dy:10,fill:h.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===t.value?14:12,fontWeight:h.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${i})`,children:t.value})}),e.jsx(w,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(f,{})}),H.map(a=>e.jsx(J,{dataKey:a,name:a,stackId:"averageKills",fill:W[a],onClick:i=>{const t={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};u!=="Tous les camps"&&(t.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),p(t)}},a))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,K.filter(a=>!a.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",r," ayant au moins ",o," partie",o>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Record de Kills en une Partie"}),n.some(a=>a.isHighlightedAddition)&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Record de Kills en une Partie",children:e.jsx("div",{style:{height:440},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:n,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:i,payload:t})=>e.jsx("text",{x:a,y:i,dy:10,fill:h.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===t.value?14:12,fontWeight:h.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${i})`,children:t.value})}),e.jsx(w,{label:{value:"Nombre max de kills en une partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:a=>e.jsx(A,{...a,chartType:"game"})}),e.jsx(J,{dataKey:"value",children:n.map((a,i)=>{const t=h.highlightedPlayer===a.name,d=a.isHighlightedAddition;return e.jsx(Y,{fill:R[a.name]||(t?"var(--accent-primary)":d?"var(--accent-secondary)":"var(--chart-primary)"),stroke:t?"var(--accent-primary)":"none",strokeWidth:t?3:0,strokeDasharray:d?"5,5":"none",opacity:d?.8:1,onClick:()=>{if(a?.gameIds&&a.gameIds.length>0){const b={fromComponent:"Statistiques de Mort - Max Kills par Partie"};a.gameIds.length===1?b.selectedGame=a.gameIds[0]:b.selectedGameIds=a.gameIds,u!=="Tous les camps"&&(b.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),p(b)}},style:{cursor:"pointer"}},`cell-${i}`)})})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:"Nombre maximum de kills rÃ©alisÃ©s en une seule partie"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Record de Kills en une Nuit"}),j.some(a=>a.isHighlightedAddition)&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Record de Kills en une Nuit",children:e.jsx("div",{style:{height:440},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:j,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:i,payload:t})=>e.jsx("text",{x:a,y:i,dy:10,fill:h.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===t.value?14:12,fontWeight:h.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${i})`,children:t.value})}),e.jsx(w,{label:{value:"Nombre max de kills en une nuit",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:a=>e.jsx(A,{...a,chartType:"night"})}),e.jsx(J,{dataKey:"value",children:j.map((a,i)=>{const t=h.highlightedPlayer===a.name,d=a.isHighlightedAddition;return e.jsx(Y,{fill:R[a.name]||(t?"var(--accent-primary)":d?"var(--accent-secondary)":"var(--chart-secondary)"),stroke:t?"var(--accent-primary)":"none",strokeWidth:t?3:0,strokeDasharray:d?"5,5":"none",opacity:d?.8:1,onClick:()=>{if(a?.gameIds&&a.gameIds.length>0){const b={fromComponent:"Statistiques de Mort - Max Kills par Nuit"};a.gameIds.length===1?b.selectedGame=a.gameIds[0]:b.selectedGameIds=a.gameIds,u!=="Tous les camps"&&(b.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),p(b)}},style:{cursor:"pointer"}},`cell-${i}`)})})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:"Nombre maximum de kills rÃ©alisÃ©s en une seule nuit (timing NX)"})]})]})}function Ke({deathStats:s,selectedCamp:u,minGamesForAverage:l,onMinGamesChange:o,availableDeathTypes:c,deathTypeColors:k}){const{navigateToGameDetails:v}=Q(),{settings:r}=ee(),{joueursData:p}=ie(),h=te(p),[B,R]=L.useState(null),{totalDeathsData:N,survivalRateData:H,highlightedPlayerAddedToDeaths:W,highlightedPlayerAddedToSurvival:D}=L.useMemo(()=>{if(!s)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const g=s.playerDeathStats.sort((t,d)=>d.totalDeaths-t.totalDeaths).slice(0,15),y=r.highlightedPlayer&&g.some(t=>t.playerName===r.highlightedPlayer),P=g.map(t=>{const d=t.gamesPlayed,b=d>0?(d-t.totalDeaths)/d*100:0,m={name:t.playerName,value:t.totalDeaths,totalDeaths:t.totalDeaths,gamesPlayed:d,deathRate:t.deathRate,survivalRate:b,isHighlightedAddition:!1};return c.forEach(C=>{m[C]=t.deathsByType[C]||0}),m});let f=!1;if(r.highlightedPlayer&&!y){const t=s.playerDeathStats.find(d=>d.playerName===r.highlightedPlayer);if(t){const d=t.gamesPlayed,b=d>0?(d-t.totalDeaths)/d*100:0,m={name:t.playerName,value:t.totalDeaths,totalDeaths:t.totalDeaths,gamesPlayed:d,deathRate:t.deathRate,survivalRate:b,isHighlightedAddition:!0};c.forEach(C=>{m[C]=t.deathsByType[C]||0}),P.push(m),f=!0}}const j=s.playerDeathStats.filter(t=>t.gamesPlayed>=l).map(t=>({...t,survivalRate:t.gamesPlayed>0?(t.gamesPlayed-t.totalDeaths)/t.gamesPlayed*100:0})).sort((t,d)=>d.survivalRate-t.survivalRate).slice(0,15),A=r.highlightedPlayer&&j.some(t=>t.playerName===r.highlightedPlayer),a=j.map(t=>{const d={name:t.playerName,value:t.survivalRate,totalDeaths:t.totalDeaths,gamesPlayed:t.gamesPlayed,deathRate:t.deathRate,survivalRate:t.survivalRate,isHighlightedAddition:!1};return c.forEach(b=>{d[b]=t.deathsByType[b]||0}),d});let i=!1;if(r.highlightedPlayer&&!A){const t=s.playerDeathStats.find(d=>d.playerName===r.highlightedPlayer);if(t){const d=t.gamesPlayed>0?(t.gamesPlayed-t.totalDeaths)/t.gamesPlayed*100:0,b={name:t.playerName,value:d,totalDeaths:t.totalDeaths,gamesPlayed:t.gamesPlayed,deathRate:t.deathRate,survivalRate:d,isHighlightedAddition:!0};c.forEach(m=>{b[m]=t.deathsByType[m]||0}),a.push(b),i=!0}}return{totalDeathsData:P,survivalRateData:a,highlightedPlayerAddedToDeaths:f,highlightedPlayerAddedToSurvival:i}},[s,r.highlightedPlayer,l,c]),x=({active:g,payload:y,label:P})=>{if(g&&y&&y.length){const f=y[0].payload,n=f.isHighlightedAddition,j=r.highlightedPlayer===f.name,A=c.reduce((a,i)=>a+(f[i]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:j?"var(--accent-primary)":"var(--text-primary)"},children:[P,n&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",A]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",f.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",f.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),c.map(a=>{const i=f[a]||0;return i===0?null:e.jsxs("p",{style:{color:k[a],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[se(a),":"]})," ",i]},a)})]}),n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),j&&!n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},K=({active:g,payload:y,label:P})=>{if(g&&y&&y.length){const f=y[0].payload,n=f.isHighlightedAddition,j=r.highlightedPlayer===f.name,A=f.gamesPlayed>=l;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:j?"var(--accent-primary)":"var(--text-primary)"},children:[P,n&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",f.survivalRate.toFixed(1),"% (",f.gamesPlayed-f.totalDeaths," survies / ",f.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",f.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",f.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),c.map(a=>{const i=f[a]||0;return i===0?null:e.jsxs("p",{style:{color:k[a],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[se(a),":"]})," ",i]},a)})]}),n&&!A&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties)"]}),n&&A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),j&&!n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:u==="Tous les camps"?"Morts (Total)":`Morts en ${u} (Total)`}),W&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:u==="Tous les camps"?"Morts (Total)":`Morts en ${u} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:N,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:g,y,payload:P})=>e.jsx("text",{x:g,y,dy:10,fill:r.highlightedPlayer===P.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===P.value?14:12,fontWeight:r.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${g} ${y})`,children:P.value})}),e.jsx(w,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(x,{})}),c.map(g=>e.jsx(J,{dataKey:g,name:g,stackId:"deaths",fill:k[g],onClick:y=>{const P={selectedPlayer:y?.name,fromComponent:"Statistiques de Mort"};u!=="Tous les camps"&&(P.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),v(P)}},g))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,N.filter(g=>!g.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",u==="Tous les camps"?"(Total)":` en ${u}`]}),D&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:l,onChange:g=>o(Number(g.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ae.map(g=>e.jsx("option",{value:g,children:g},g))})]}),e.jsx(G,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:H,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:g,y,payload:P})=>e.jsx("text",{x:g,y,dy:10,fill:r.highlightedPlayer===P.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===P.value?14:12,fontWeight:r.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${g} ${y})`,children:P.value})}),e.jsx(w,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(K,{})}),e.jsx(J,{dataKey:"value",onClick:g=>{const y={selectedPlayer:g?.name,fromComponent:"Statistiques de Mort"};u!=="Tous les camps"&&(y.campFilter={selectedCamp:u,campFilterMode:"all-assignments"}),v(y)},onMouseEnter:g=>R(g?.name||null),onMouseLeave:()=>R(null),style:{cursor:"pointer"},children:H.map((g,y)=>{const P=r.highlightedPlayer===g.name,f=g.isHighlightedAddition;return e.jsx(Y,{fill:h[g.name]||"var(--chart-primary)",stroke:P?"var(--accent-primary)":B===g.name?"var(--text-primary)":"none",strokeWidth:P?3:B===g.name?2:0,strokeDasharray:f?"5,5":"none",opacity:f?.8:1},`cell-${y}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,H.filter(g=>!g.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",l," partie",l>1?"s":"",")"]})]})]})}function Me({hunterStats:s,isLoading:u,error:l}){const{navigateToGameDetails:o}=Q(),{settings:c}=ee(),k=ge(),{joueursData:v}=ie(),r=te(v),[p,h]=L.useState(null);if(u)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(l)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",l]});if(!s||s.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:B,highlightedPlayerAddedToBest:R,finalBadHuntersData:N,highlightedPlayerAddedToBad:H}=(()=>{const K=s.hunterStats.filter(i=>i.gamesPlayedAsHunter>=5).sort((i,t)=>t.averageNonVillageoisKillsPerGame-i.averageNonVillageoisKillsPerGame).slice(0,15),g=c.highlightedPlayer&&K.some(i=>i.hunterName===c.highlightedPlayer);let y=[...K],P=!1;if(c.highlightedPlayer&&!g){const i=s.hunterStats.find(t=>t.hunterName===c.highlightedPlayer);i&&(y.push({...i,isHighlightedAddition:!0}),P=!0)}const f=s.hunterStats.filter(i=>i.gamesPlayedAsHunter>=5).map(i=>({name:i.hunterName,averageVillageoisKills:Number((i.villageoisKills/i.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:i.villageoisKills,totalNonVillageoisKills:i.nonVillageoisKills,totalKills:i.totalKills,gamesPlayed:i.gamesPlayedAsHunter,victimsByCamp:i.victimsByCamp,goodVictimsByCamp:i.goodVictimsByCamp,badVictimsByCamp:i.badVictimsByCamp,hunterName:i.hunterName})),n=f.sort((i,t)=>t.averageVillageoisKills-i.averageVillageoisKills).slice(0,15),j=c.highlightedPlayer&&n.some(i=>i.hunterName===c.highlightedPlayer);let A=[...n],a=!1;if(c.highlightedPlayer&&!j){const i=f.find(t=>t.hunterName===c.highlightedPlayer);i&&(A.push({...i,isHighlightedAddition:!0}),a=!0)}return{finalBestHuntersData:y,highlightedPlayerAddedToBest:P,finalBadHuntersData:A,highlightedPlayerAddedToBad:a}})(),W=({active:x,payload:K,label:g})=>{if(x&&K&&K.length){const y=K[0].payload,P=y.isHighlightedAddition,f=c.highlightedPlayer===y.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:f?"var(--accent-primary)":"var(--text-primary)"},children:[g,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",y.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",y.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",y.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",y.totalKills]}),y.goodVictimsByCamp&&Object.keys(y.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(y.goodVictimsByCamp).map(([n,j])=>e.jsxs("p",{style:{color:k[n]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[n,":"]})," ",j]},n))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),f&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},D=({active:x,payload:K,label:g})=>{if(x&&K&&K.length){const y=K[0].payload,P=y.isHighlightedAddition,f=c.highlightedPlayer===y.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:f?"var(--accent-primary)":"var(--text-primary)"},children:[g,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",y.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",y.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",y.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",y.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",y.totalKills]}),y.badVictimsByCamp&&Object.keys(y.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(y.badVictimsByCamp).map(([n,j])=>e.jsxs("p",{style:{color:k[n]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[n,":"]})," ",j]},n))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),f&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),R&&c.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',c.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:B,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x,y:K,payload:g})=>e.jsx("text",{x,y:K,dy:10,fill:c.highlightedPlayer===g.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:c.highlightedPlayer===g.value?14:12,fontWeight:c.highlightedPlayer===g.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${x} ${K})`,children:g.value})}),e.jsx(w,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(W,{})}),e.jsx(J,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:x=>{x?.hunterName&&o({selectedPlayer:x.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:x=>h(x?.hunterName||null),onMouseLeave:()=>h(null),style:{cursor:"pointer"},children:B.map((x,K)=>{const g=c.highlightedPlayer===x.hunterName,y=x.isHighlightedAddition;return e.jsx(Y,{fill:r[x.hunterName]||k.Chasseur||"#8884d8",stroke:g?"var(--accent-primary)":p===x.hunterName?"var(--text-primary)":"none",strokeWidth:g?3:p===x.hunterName?2:0,strokeDasharray:y?"5,5":"none",opacity:y?.8:1},`cell-${K}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,B.filter(x=>!x.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),H&&c.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',c.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:N,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x,y:K,payload:g})=>e.jsx("text",{x,y:K,dy:10,fill:c.highlightedPlayer===g.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:c.highlightedPlayer===g.value?14:12,fontWeight:c.highlightedPlayer===g.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${x} ${K})`,children:g.value})}),e.jsx(w,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(D,{})}),e.jsx(J,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:x=>{x?.hunterName&&o({selectedPlayer:x.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:x=>h(x?.hunterName||null),onMouseLeave:()=>h(null),style:{cursor:"pointer"},children:N.map((x,K)=>{const g=c.highlightedPlayer===x.hunterName,y=x.isHighlightedAddition;return e.jsx(Y,{fill:r[x.hunterName]||k.Chasseur||"#8884d8",stroke:g?"var(--accent-primary)":p===x.hunterName?"var(--text-primary)":"none",strokeWidth:g?3:p===x.hunterName?2:0,strokeDasharray:y?"5,5":"none",opacity:y?.8:1},`cell-${K}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,N.filter(x=>!x.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function He({survivalStats:s,selectedCamp:u,minGamesForAverage:l,onMinGamesChange:o,isLoading:c,error:k}){const{navigateToGameDetails:v}=Q(),{settings:r}=ee(),{joueursData:p}=ie(),h=te(p),[B,R]=L.useState(fe.DEFAULT_SELECTED_DAY),[N,H]=L.useState(null),W=L.useMemo(()=>s?s.dayStats.filter(j=>j.totalGamesReachingDay>0).map(j=>j.dayNumber).sort((j,A)=>j-A):[],[s]),D=L.useMemo(()=>W.includes(B)?B:W.length>0?W[0]:1,[B,W]),{highestSurvivalData:x,highlightedPlayerAddedToHighest:K}=L.useMemo(()=>{if(!s)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const n=Se(s,D,l),j=r.highlightedPlayer&&n.some(i=>i.playerName===r.highlightedPlayer),A=n.map(i=>({name:i.playerName,value:i.survivalRate,gamesPlayed:i.gamesPlayed,timesReachedDay:i.timesReachedDay,timesSurvivedDay:i.timesSurvivedDay,isHighlightedAddition:!1}));let a=!1;if(r.highlightedPlayer&&!j){const i=s.playerSurvivalStats.find(t=>t.playerName===r.highlightedPlayer);if(i&&i.totalGames>=l&&(i.gamesPlayedByDay[D]||0)>0){const t=i.survivalRatesByDay[D]||0;A.push({name:r.highlightedPlayer,value:t,gamesPlayed:i.totalGames,timesReachedDay:i.gamesPlayedByDay[D]||0,timesSurvivedDay:i.survivalsByDay[D]||0,isHighlightedAddition:!0}),a=!0}}return{highestSurvivalData:A,highlightedPlayerAddedToHighest:a}},[s,D,l,r.highlightedPlayer]),{lowestSurvivalData:g,highlightedPlayerAddedToLowest:y}=L.useMemo(()=>{if(!s)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const n=Pe(s,D,l),j=r.highlightedPlayer&&n.some(i=>i.playerName===r.highlightedPlayer),A=n.map(i=>({name:i.playerName,value:i.survivalRate,gamesPlayed:i.gamesPlayed,timesReachedDay:i.timesReachedDay,timesSurvivedDay:i.timesSurvivedDay,isHighlightedAddition:!1}));let a=!1;if(r.highlightedPlayer&&!j){const i=s.playerSurvivalStats.find(t=>t.playerName===r.highlightedPlayer);if(i&&i.totalGames>=l&&(i.gamesPlayedByDay[D]||0)>0){const t=i.survivalRatesByDay[D]||0;A.push({name:r.highlightedPlayer,value:t,gamesPlayed:i.totalGames,timesReachedDay:i.gamesPlayedByDay[D]||0,timesSurvivedDay:i.survivalsByDay[D]||0,isHighlightedAddition:!0}),a=!0}}return{lowestSurvivalData:A,highlightedPlayerAddedToLowest:a}},[s,D,l,r.highlightedPlayer]),P=n=>{v({selectedPlayer:n,fromComponent:"Statistiques de Survie"})},f=({active:n,payload:j,label:A})=>{if(n&&j&&j.length>0){const a=j[0].payload,i=a.isHighlightedAddition,t=r.highlightedPlayer===a.name,d=a.gamesPlayed>=l,b=a.timesReachedDay-a.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:A})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",D,": ",a.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",D,": ",a.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",D,": ",a.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",D,": ",b]}),e.jsxs("div",{children:["Total de parties: ",a.gamesPlayed]}),i&&!d&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties au total)"]}),i&&d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),t&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return c?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):s?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",D," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",K||y?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:D,onChange:n=>R(parseInt(n.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:W.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:l,onChange:n=>o(parseInt(n.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:ae.map(n=>e.jsx("option",{value:n,children:n},n))})]})]})}),D&&s.dayStats.find(n=>n.dayNumber===D)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:D===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${D}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:s.dayStats.find(n=>n.dayNumber===D)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",D]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(s.dayStats.find(n=>n.dayNumber===D)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",l," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:s.playerSurvivalStats.filter(n=>n.totalGames>=l&&(n.gamesPlayedByDay[D]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",D]}),K&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${D}`,children:e.jsx("div",{style:{height:400},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:x,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:n,y:j,payload:A})=>e.jsx("text",{x:n,y:j,dy:16,textAnchor:"end",transform:`rotate(-45, ${n}, ${j})`,fill:r.highlightedPlayer===A.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===A.value?14:12,fontWeight:r.highlightedPlayer===A.value?"bold":"normal",children:A.value})}),e.jsx(w,{tickFormatter:n=>`${n.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(f,{})}),e.jsx(J,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:x.map((n,j)=>{const A=r.highlightedPlayer===n.name,a=N===n.name,i=n.isHighlightedAddition;return e.jsx(Y,{fill:h[n.name]||"var(--chart-primary)",stroke:A?"var(--accent-primary)":a?"var(--text-primary)":"none",strokeWidth:A?3:a?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1,onClick:()=>P(n.name),onMouseEnter:()=>H(n.name),onMouseLeave:()=>H(null),style:{cursor:"pointer"}},`cell-highest-${j}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",D]}),y&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${D}`,children:e.jsx("div",{style:{height:400},children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(_,{data:g,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx($,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:n,y:j,payload:A})=>e.jsx("text",{x:n,y:j,dy:16,textAnchor:"end",transform:`rotate(-45, ${n}, ${j})`,fill:r.highlightedPlayer===A.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===A.value?14:12,fontWeight:r.highlightedPlayer===A.value?"bold":"normal",children:A.value})}),e.jsx(w,{tickFormatter:n=>`${n.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(f,{})}),e.jsx(J,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:g.map((n,j)=>{const A=r.highlightedPlayer===n.name,a=N===n.name,i=n.isHighlightedAddition;return e.jsx(Y,{fill:h[n.name]||"var(--chart-color-4)",stroke:A?"var(--accent-primary)":a?"var(--text-primary)":"none",strokeWidth:A?3:a?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1,onClick:()=>P(n.name),onMouseEnter:()=>H(n.name),onMouseLeave:()=>H(null),style:{cursor:"pointer"}},`cell-lowest-${j}`)})})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function qe(){const{navigationState:s,updateNavigationState:u}=Q(),[l,o]=L.useState(s.deathStatisticsState?.selectedCamp||s.deathStatsSelectedCamp||"Tous les camps"),[c,k]=L.useState(s.deathStatisticsState?.victimCampFilter||"Tous les camps"),[v,r]=L.useState(s.deathStatisticsState?.minGamesForAverage||25),[p,h]=L.useState(()=>{const m=s.deathStatisticsState?.selectedView;return m&&m!=="location"?m:"killers"}),{data:B}=ue(),{data:R,isLoading:N,error:H}=ye(l,c),{data:W,isLoading:D,error:x}=ve(),{data:K,isLoading:g,error:y}=De(l),{data:P}=me(),f=ge();L.useEffect(()=>{(!s.deathStatisticsState||s.deathStatisticsState.selectedCamp!==l||s.deathStatisticsState.victimCampFilter!==c||s.deathStatisticsState.minGamesForAverage!==v||s.deathStatisticsState.selectedView!==p)&&u({deathStatisticsState:{selectedCamp:l,victimCampFilter:c,minGamesForAverage:v,selectedView:p,focusChart:s.deathStatisticsState?.focusChart}})},[l,c,v,p,s.deathStatisticsState,u]);const n=L.useMemo(()=>P?pe(P):[],[P]),j=L.useMemo(()=>{const m={};n.forEach(T=>{T===V.BY_WOLF?m[T]=f.Loup:T===V.VOTED?m[T]="var(--chart-color-1)":T===V.BULLET||T===V.BULLET_HUMAN||T===V.BULLET_WOLF?m[T]=f.Chasseur:T===V.BY_ZOMBIE?m[T]=f.Vaudou:T===V.ASSASSIN?m[T]=f.Alchimiste:T===V.AVENGER?m[T]="var(--chart-color-2)":T===V.LOVER_DEATH?m[T]=f.Amoureux:T===V.BY_BEAST?m[T]="var(--chart-color-3)":T===V.SHERIF_SUCCESS?m[T]="var(--chart-color-4)":T===V.SMUGGLER_HUNT_KILL&&(m[T]=f.Contrebandier)});const C=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let E=0;return n.forEach(T=>{m[T]||(m[T]=C[E%C.length],E++)}),m},[n,f]),A=m=>{o(m),u({deathStatsSelectedCamp:m,deathStatisticsState:{selectedCamp:m,victimCampFilter:c,minGamesForAverage:v,selectedView:p,focusChart:s.deathStatisticsState?.focusChart}})},a=m=>{k(m),u({deathStatisticsState:{selectedCamp:l,victimCampFilter:m,minGamesForAverage:v,selectedView:p,focusChart:s.deathStatisticsState?.focusChart}})},i=m=>{r(m),u({deathStatisticsState:{selectedCamp:l,victimCampFilter:c,minGamesForAverage:m,selectedView:p,focusChart:s.deathStatisticsState?.focusChart}})},t=m=>{h(m),u({deathStatisticsState:{selectedCamp:l,victimCampFilter:c,minGamesForAverage:v,selectedView:m,focusChart:s.deathStatisticsState?.focusChart}})},{gamesWithKillers:d,totalEligibleForAverage:b}=L.useMemo(()=>{if(!R)return{gamesWithKillers:0,totalEligibleForAverage:0};const m=R.killerStats.filter(C=>C.gamesPlayed>=v);return{gamesWithKillers:R.totalGames,totalEligibleForAverage:m.length}},[R,v]);return N?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):H?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",H]}):R?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="killers"?"active":""}`,onClick:()=>t("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="deaths"?"active":""}`,onClick:()=>t("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="survival"?"active":""}`,onClick:()=>t("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="hunter"?"active":""}`,onClick:()=>t("hunter"),children:"Chasseur"})]}),(p==="killers"||p==="deaths"||p==="survival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:l,onChange:m=>A(m.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),B?.map(m=>e.jsx("option",{value:m,children:m},m))]})]}),p==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:c,onChange:m=>a(m.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(p==="killers"||p==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:R.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:R.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:d})]})]}),p==="killers"&&e.jsx(ke,{deathStats:R,selectedCamp:l,victimCampFilter:c,minGamesForAverage:v,onMinGamesChange:i,availableDeathTypes:n,deathTypeColors:j,totalEligibleForAverage:b}),p==="deaths"&&e.jsx(Ke,{deathStats:R,selectedCamp:l,minGamesForAverage:v,onMinGamesChange:i,availableDeathTypes:n,deathTypeColors:j}),p==="hunter"&&e.jsx(Me,{hunterStats:W,isLoading:D,error:x}),p==="survival"&&e.jsx(He,{survivalStats:K,selectedCamp:l,minGamesForAverage:v,onMinGamesChange:i,isLoading:g,error:y}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"DonnÃ©es en cours de rÃ©cupÃ©ration (donnÃ©es partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{qe as DeathStatisticsChart};
