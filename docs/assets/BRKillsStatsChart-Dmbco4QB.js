import{a as F,r as b,j as e}from"./index-Cin4BaLL.js";import{F as P,B as H,C as N,X as z,Y as k,a as M,b as A}from"./FullscreenChart-BVTrhgUa.js";import{u as q}from"./useRawBRData-O80QFR6m.js";import{u as E}from"./useJoueursData-Dl8pSJpK.js";import{u as $,g as I}from"./api-C0W34Rzp.js";import{R as w,T as R}from"./CategoricalChart-Dhaxec9B.js";import{P as O,a as L}from"./PieChart-Dxbndjd8.js";import"./PolarChart-Cr9qm8aT.js";function V(){const{data:g,isLoading:B,error:j}=q(),{settings:n}=F(),{joueursData:D}=E(),[C,f]=b.useState(null),T=$(D),S=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],K=a=>T[a]||I(a),h=b.useMemo(()=>{if(!g)return null;const a=g.length,i=g.reduce((r,s)=>{const o=s.Participants;return r[o]||(r[o]={name:o,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),r[o].participations++,r[o].totalScore+=s.Score,s.Gagnant&&r[o].wins++,r},{});Object.values(i).forEach(r=>{r.averageScore=r.totalScore/r.participations,r.winRate=r.wins/r.participations*100});const l=Object.values(i).filter(r=>r.participations>=3).sort((r,s)=>s.averageScore-r.averageScore).slice(0,15),d=Object.values(i).sort((r,s)=>s.participations-r.participations),y=n.highlightedPlayer&&l.some(r=>r.name===n.highlightedPlayer);let p=!1,x=[...l];if(n.highlightedPlayer&&!y){const r=d.find(s=>s.name===n.highlightedPlayer);r&&(x.push({...r,isHighlightedAddition:!0}),p=!0)}const u=g.reduce((r,s)=>{const o=s.Score,m=o===0?"0":o===1?"1":o===2?"2":o===3?"3":o===4?"4":o<=6?"5-6":"7+";return r[m]||(r[m]={count:0,wins:0}),r[m].count++,s.Gagnant&&r[m].wins++,r},{}),v=Object.entries(u).map(([r,s])=>({range:r,count:s.count,wins:s.wins,percentage:(s.count/a*100).toFixed(1),winRate:s.count>0?(s.wins/s.count*100).toFixed(1):"0.0"}));return{topPlayersByAverageScore:x,scoreData:v,highlightedPlayerInAverageScore:p}},[g,n.highlightedPlayer]);return B?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):j?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",j]}):h?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Statistiques Kills - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Kill Moyen par Partie (min. 3 parties)"}),h.highlightedPlayerInAverageScore&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",n.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(P,{title:"Kill Moyen par Partie - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(w,{width:"100%",height:400,children:e.jsxs(H,{data:h.topPlayersByAverageScore,children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:a,y:i,payload:t})=>e.jsx("text",{x:a,y:i,dy:16,textAnchor:"end",fill:n.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===t.value?14:12,fontWeight:n.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${a} ${i})`,children:t.value})}),e.jsx(k,{}),e.jsx(R,{content:({active:a,payload:i})=>{if(a&&i&&i.length>0){const t=i[0].payload,c=t.isHighlightedAddition,l=n.highlightedPlayer===t.name,d=t.participations>=3;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,l&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Kill total: ",e.jsx("strong",{children:t.totalScore})]}),e.jsxs("div",{children:["Kill moyen: ",e.jsx("strong",{children:t.averageScore.toFixed(2)})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate.toFixed(1),"%"]})]})]}),c&&!d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (< 3 parties)"}),c&&d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(M,{dataKey:"averageScore",name:"Kill moyen par partie",children:h.topPlayersByAverageScore.map((a,i)=>{const t=n.highlightedPlayer===a.name,c=C===a.name,l=a.isHighlightedAddition;return e.jsx(A,{fill:t?"var(--accent-primary)":l?"var(--accent-secondary)":K(a.name),stroke:t?"var(--accent-primary)":c?"var(--text-primary)":"none",strokeWidth:t?3:c?2:0,strokeDasharray:l?"5,5":"none",opacity:l?.8:1,onMouseEnter:()=>f(a.name),onMouseLeave:()=>f(null),style:{cursor:"pointer"}},`cell-${i}`)})})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills"}),e.jsx(P,{title:"Distribution des Kills",className:"lycans-chart-wrapper",children:e.jsx(w,{width:"100%",height:400,children:e.jsxs(O,{children:[e.jsx(L,{data:h.scoreData,cx:"50%",cy:"50%",labelLine:!1,label:a=>{const{cx:i,cy:t,midAngle:c,outerRadius:l,range:d,percentage:y,fill:p}=a,x=Math.PI/180,u=l+30,v=i+u*Math.cos(-c*x),r=t+u*Math.sin(-c*x),s=d==="7+"?-12:0;return e.jsx("text",{x:v,y:r+s,fill:p,textAnchor:v>i?"start":"end",dominantBaseline:"central",children:`${d}: ${y}%`})},outerRadius:140,fill:"#8884d8",dataKey:"count",children:h.scoreData.map((a,i)=>e.jsx(A,{fill:S[i%S.length]},`cell-${i}`))}),e.jsx(R,{content:({active:a,payload:i})=>{if(a&&i&&i.length>0){const t=i[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.range," ",t.range==="1"?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Nombre de parties: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate,"%"]})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"4px"},children:["(",t.wins," victoire",t.wins!==1?"s":"",")"]})]})]})}return null}})]})})})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{V as BRKillsStatsChart};
