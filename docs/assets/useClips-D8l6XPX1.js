import{r as d,j as n,e as f}from"./index-1qrZIWO-.js";function x(s){if(!s)return null;try{const e=new URL(s);let l=null;if(e.hostname==="clips.twitch.tv")l=e.pathname.split("/")[1];else if(e.hostname.includes("twitch.tv")){const a=e.pathname.split("/"),r=a.indexOf("clip");r!==-1&&a[r+1]&&(l=a[r+1])}if(l)return`https://clips.twitch.tv/embed?clip=${l}&parent=${window.location.hostname}`}catch(e){console.warn("Failed to parse Twitch clip URL:",s,e)}return null}function o(s){return s.NewName?s.NewName:s.ClipName?s.ClipName:`Clip ${s.ClipId}`}function y(s){return s?s.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}function g(s){return s?s.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}function j(s){const e=[s.POVPlayer],l=y(s.OthersPlayers);return[...e,...l]}function v(s,e){const l=e.toLowerCase();return s.filter(a=>j(a).map(c=>c.toLowerCase()).includes(l))}function C(s,e){return s.filter(l=>Array.isArray(l.Tags)&&l.Tags.includes(e))}function P(s){const e=new Set;return s.forEach(l=>{Array.isArray(l.Tags)&&l.Tags.forEach(a=>e.add(a))}),Array.from(e).sort()}function A(s,e){const l=g(s.RelatedClips);return e.filter(a=>l.includes(a.ClipId))}function b(s,e){return s.NextClip&&e.find(l=>l.ClipId===s.NextClip)||null}function T({clip:s,onClose:e,onNextClip:l,onRelatedClip:a,relatedClips:r=[],nextClip:c=null}){d.useEffect(()=>{const i=t=>{t.key==="Escape"&&e()};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[e]);const p=x(s.ClipUrl),u=o(s),h=y(s.OthersPlayers),m=Array.isArray(s.Tags)&&s.Tags.some(i=>i.toLowerCase().includes("warning sonore"));return n.jsx("div",{className:"lycans-clip-viewer-overlay",onClick:e,children:n.jsxs("div",{className:"lycans-clip-viewer-container",onClick:i=>i.stopPropagation(),children:[n.jsxs("div",{className:"lycans-clip-viewer-header",children:[n.jsxs("div",{className:"lycans-clip-viewer-title",children:[n.jsx("h2",{children:u}),Array.isArray(s.Tags)&&s.Tags.length>0&&n.jsx("div",{className:"lycans-clip-tags",children:s.Tags.map((i,t)=>n.jsx("span",{className:"lycans-clip-tag",children:i},t))})]}),n.jsx("button",{className:"lycans-clip-viewer-close",onClick:e,children:"âœ•"})]}),m&&n.jsxs("div",{className:"lycans-clip-warning-banner",children:[n.jsx("span",{className:"lycans-clip-warning-icon",children:"âš ï¸ ðŸ”Š"}),n.jsx("span",{className:"lycans-clip-warning-text",children:"Attention : Ce clip contient un son fort"})]}),n.jsxs("div",{className:"lycans-clip-viewer-content",children:[n.jsx("div",{className:"lycans-clip-player",children:p?n.jsx("iframe",{src:p,frameBorder:"0",allowFullScreen:!0,scrolling:"no",title:u}):n.jsxs("div",{className:"lycans-clip-no-video",children:[n.jsx("p",{children:"VidÃ©o non disponible"}),s.ClipUrl&&n.jsx("a",{href:s.ClipUrl,target:"_blank",rel:"noopener noreferrer",children:"Voir sur Twitch"})]})}),n.jsxs("div",{className:"lycans-clip-metadata",children:[n.jsxs("div",{className:"lycans-clip-info-section",children:[n.jsx("h3",{children:"Joueurs"}),n.jsxs("div",{className:"lycans-clip-players",children:[n.jsxs("div",{className:"lycans-clip-pov-player",children:[n.jsx("span",{className:"lycans-clip-pov-badge",children:"POV"}),n.jsx("span",{className:"lycans-clip-player-name",children:s.POVPlayer})]}),h.length>0&&n.jsx("div",{className:"lycans-clip-other-players",children:h.map((i,t)=>n.jsx("span",{className:"lycans-clip-player-name",children:i},t))})]})]}),s.AdditionalInfo&&n.jsxs("div",{className:"lycans-clip-info-section",children:[n.jsx("h3",{children:"Description"}),n.jsx("p",{className:"lycans-clip-description",children:s.AdditionalInfo})]}),(c||r.length>0)&&n.jsxs("div",{className:"lycans-clip-info-section",children:[n.jsx("h3",{children:"Clips liÃ©s"}),n.jsxs("div",{className:"lycans-clip-navigation",children:[c&&l&&n.jsxs("button",{className:"lycans-clip-nav-btn lycans-clip-next-btn",onClick:l,children:["â–¶ Suivant: ",o(c)]}),r.length>0&&a&&n.jsxs("div",{className:"lycans-clip-related-clips",children:[n.jsx("p",{className:"lycans-clip-related-label",children:"Autres POV:"}),r.map(i=>n.jsxs("button",{className:"lycans-clip-nav-btn lycans-clip-related-btn",onClick:()=>a(i.ClipId),children:[o(i)," (",i.POVPlayer,")"]},i.ClipId))]})]})]})]})]})]})})}function N(){const{data:s,isLoading:e,error:l}=f();return{clips:d.useMemo(()=>{if(!s)return[];const r=[];return s.forEach(c=>{c.Clips&&Array.isArray(c.Clips)&&r.push(...c.Clips)}),r},[s]),isLoading:e,error:l}}function E(s){const{clips:e,isLoading:l,error:a}=N();return{clips:d.useMemo(()=>s?v(e,s):[],[e,s]),isLoading:l,error:a}}export{T as C,A as a,E as b,P as c,j as d,C as e,b as f,o as g,v as h,N as u};
