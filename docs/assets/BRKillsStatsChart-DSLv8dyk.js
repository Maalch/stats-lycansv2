import{a as F,r as j,j as e}from"./index-w5s5ED4v.js";import{F as f,B as H,C as N,X as q,Y as z,a as k,b as S}from"./FullscreenChart-CXHmE3KY.js";import{u as E}from"./useRawBRData-C07OVZtC.js";import{u as M}from"./useJoueursData-Bn8-bfpn.js";import{u as $,g as L}from"./api-Bijp4vbc.js";import{R as P,T as b}from"./CategoricalChart-BusM2Wy1.js";import{P as O,a as I}from"./PieChart-NiJYNPY3.js";import"./PolarChart-Ck_ZSPJz.js";function V(){const{data:h,isLoading:A,error:m}=E(),{settings:n}=F(),{joueursData:R}=M(),[B,v]=j.useState(null),C=$(R),u=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],D=t=>C[t]||L(t),c=j.useMemo(()=>{if(!h)return null;const t=h.length,a=h.reduce((r,s)=>{const o=s.Participants;return r[o]||(r[o]={name:o,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),r[o].participations++,r[o].totalScore+=s.Score,s.Gagnant&&r[o].wins++,r},{});Object.values(a).forEach(r=>{r.averageScore=r.totalScore/r.participations,r.winRate=r.wins/r.participations*100});const l=Object.values(a).filter(r=>r.participations>=3).sort((r,s)=>s.averageScore-r.averageScore).slice(0,15),g=Object.values(a).sort((r,s)=>s.participations-r.participations),w=n.highlightedPlayer&&l.some(r=>r.name===n.highlightedPlayer);let x=!1,y=[...l];if(n.highlightedPlayer&&!w){const r=g.find(s=>s.name===n.highlightedPlayer);r&&(y.push({...r,isHighlightedAddition:!0}),x=!0)}const K=h.reduce((r,s)=>{const o=s.Score,p=o===0?"0":o===1?"1":o===2?"2":o===3?"3":o===4?"4":o<=6?"5-6":"7+";return r[p]||(r[p]=0),r[p]++,r},{}),T=Object.entries(K).map(([r,s])=>({range:r,count:s,percentage:(s/t*100).toFixed(1)}));return{topPlayersByAverageScore:y,scoreData:T,highlightedPlayerInAverageScore:x}},[h,n.highlightedPlayer]);return A?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):m?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",m]}):c?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Statistiques Kills - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Kill Moyen par Partie (min. 3 parties)"}),c.highlightedPlayerInAverageScore&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",n.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(f,{title:"Kill Moyen par Partie - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(P,{width:"100%",height:400,children:e.jsxs(H,{data:c.topPlayersByAverageScore,children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:16,textAnchor:"end",fill:n.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===i.value?14:12,fontWeight:n.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx(z,{}),e.jsx(b,{content:({active:t,payload:a})=>{if(t&&a&&a.length>0){const i=a[0].payload,d=i.isHighlightedAddition,l=n.highlightedPlayer===i.name,g=i.participations>=3;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,l&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:i.participations})]}),e.jsxs("div",{children:["Kill total: ",e.jsx("strong",{children:i.totalScore})]}),e.jsxs("div",{children:["Kill moyen: ",e.jsx("strong",{children:i.averageScore.toFixed(2)})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]})]}),d&&!g&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (< 3 parties)"}),d&&g&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(k,{dataKey:"averageScore",name:"Kill moyen par partie",children:c.topPlayersByAverageScore.map((t,a)=>{const i=n.highlightedPlayer===t.name,d=B===t.name,l=t.isHighlightedAddition;return e.jsx(S,{fill:i?"var(--accent-primary)":l?"var(--accent-secondary)":D(t.name),stroke:i?"var(--accent-primary)":d?"var(--text-primary)":"none",strokeWidth:i?3:d?2:0,strokeDasharray:l?"5,5":"none",opacity:l?.8:1,onMouseEnter:()=>v(t.name),onMouseLeave:()=>v(null),style:{cursor:"pointer"}},`cell-${a}`)})})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills"}),e.jsx(f,{title:"Distribution des Kills",className:"lycans-chart-wrapper",children:e.jsx(P,{width:"100%",height:400,children:e.jsxs(O,{children:[e.jsx(I,{data:c.scoreData,cx:"50%",cy:"50%",labelLine:!1,label:({range:t,percentage:a})=>`${t}: ${a}%`,outerRadius:140,fill:"#8884d8",dataKey:"count",children:c.scoreData.map((t,a)=>e.jsx(S,{fill:u[a%u.length]},`cell-${a}`))}),e.jsx(b,{formatter:t=>[t,"Participations"]})]})})})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{V as BRKillsStatsChart};
