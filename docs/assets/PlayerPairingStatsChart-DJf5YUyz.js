import{r as z,j as e}from"./index-DfpoRKFe.js";import{u as E,a as V}from"./useRawGameData-BNuRrhYV.js";import{F as L,R as k,B as I,C as T,X as q,Y as F,T as D,o as G,p as W,q as O}from"./FullscreenChart-JLwVKNUJ.js";function X(){const{data:o,isLoading:B,error:A}=E(),{data:j,isLoading:R,error:v}=V();return{data:z.useMemo(()=>{if(!o||o.length===0||!j||j.length===0)return null;const g=i=>i?i.split(",").map(a=>a.trim()).filter(Boolean):[],C={};o.forEach(i=>{const a=i.Game?.toString(),h=i["Camp victorieux"];a&&h&&(C[a]=h.toString())});const u={},t={};let N=0,y=0;j.forEach(i=>{const a=i.Game?.toString();if(!a)return;const h=i.Loups,S=i.Amoureux,w=C[a];if(h){const l=g(h.toString());if(l.length>=2){N++;for(let c=0;c<l.length;c++)for(let x=c+1;x<l.length;x++){const P=l[c],m=l[x],s=[P,m].sort().join(" & ");u[s]||(u[s]={appearances:0,wins:0,winRate:0,players:[P,m]}),u[s].appearances++,w==="Loups"&&u[s].wins++}}}if(S){const l=g(S.toString());if(l.length>=2){y++;for(let c=0;c<l.length;c+=2)if(c+1<l.length){const x=l[c],P=l[c+1],m=[x,P].sort().join(" & ");t[m]||(t[m]={appearances:0,wins:0,winRate:0,players:[x,P]}),t[m].appearances++,w==="Amoureux"&&t[m].wins++}}}});const f=Object.keys(u).map(i=>{const a=u[i],h=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:i,appearances:a.appearances,wins:a.wins,winRate:h,players:a.players}}),b=Object.keys(t).map(i=>{const a=t[i],h=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:i,appearances:a.appearances,wins:a.wins,winRate:h,players:a.players}});return f.sort((i,a)=>a.appearances-i.appearances),b.sort((i,a)=>a.appearances-i.appearances),{wolfPairs:{totalGames:N,pairs:f},loverPairs:{totalGames:y,pairs:b}}},[o,j]),isLoading:B||R,error:A||v}}function Z(){const{data:o,isLoading:B,error:A}=X();console.log("DEBUG playerPairingStats:",o);const[j,R]=z.useState("wolves"),[v,$]=z.useState(2),[g,C]=z.useState(1),u=[1,2,3,4,5];if(B)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(A)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",A]});if(!o)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const t=s=>O[s]||"#8884d8",N=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,y=s=>s.map(r=>{const[n,p]=r.players,d=t(n),K=t(p),M=N(r.pair);return e.jsxs("linearGradient",{id:M,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:d}),e.jsx("stop",{offset:"50%",stopColor:d}),e.jsx("stop",{offset:"50%",stopColor:K}),e.jsx("stop",{offset:"100%",stopColor:K})]},M)}),f=o.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:N(s.pair)})),b=o.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:N(s.pair)})),i=f.filter(s=>s.appearances>=v).length,a=b.filter(s=>s.appearances>=g).length,h=f.filter(s=>s.appearances>=2),S=b.filter(s=>s.appearances>=2),w=[...f].sort((s,r)=>r.appearances-s.appearances).slice(0,10),l=[...f].filter(s=>s.appearances>=v).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),c=[...b].sort((s,r)=>r.appearances-s.appearances).slice(0,10),x=[...b].filter(s=>s.appearances>=g).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),P=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:h.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),e.jsx(L,{title:"Paires de Loups les Plus Fréquentes",children:w.length>0?e.jsx("div",{style:{height:350},children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(I,{data:w,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:y(w)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx(D,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const n=r[0].payload,[p,d]=n.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Apparitions: ",n.appearances]}),e.jsxs("div",{children:["Victoires: ",n.wins]}),e.jsxs("div",{children:["Taux de victoire: ",n.winRate,"%"]})]})}return null}}),e.jsx(G,{dataKey:"appearances",name:"Apparitions",children:w.map((s,r)=>e.jsx(W,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-wolf-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-wolf-appearances-select",value:v,onChange:s=>$(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:u.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(L,{title:"Paires de Loups les Plus Performantes",children:[l.length>0?e.jsx("div",{style:{height:320},children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(I,{data:l,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:y(l)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(D,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const n=r[0].payload,[p,d]=n.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Taux de victoire: ",n.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",n.wins," / ",n.appearances]})]})}return null}}),e.jsx(G,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:l.map((s,r)=>e.jsx(W,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",l.length," des paires (sur ",i,") avec au moins ",v," apparition",v>1?"s":""]})]})]})]})]}),m=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:o.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:S.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),e.jsx(L,{title:"Paires d'Amoureux les Plus Fréquentes",children:c.length>0?e.jsx("div",{style:{height:350},children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(I,{data:c,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:y(c)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx(D,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const n=r[0].payload,[p,d]=n.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Apparitions: ",n.appearances]}),e.jsxs("div",{children:["Victoires: ",n.wins]}),e.jsxs("div",{children:["Taux de victoire: ",n.winRate,"%"]})]})}return null}}),e.jsx(G,{dataKey:"appearances",name:"Apparitions",children:c.map((s,r)=>e.jsx(W,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-lover-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-lover-appearances-select",value:g,onChange:s=>C(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:u.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(L,{title:"Paires d'Amoureux les Plus Performantes",children:[x.length>0?e.jsx("div",{style:{height:320},children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(I,{data:x,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:y(x)}),e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(D,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const n=r[0].payload,[p,d]=n.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:t(d),borderRadius:"2px"}}),e.jsx("span",{children:d})]}),e.jsxs("div",{children:["Taux de victoire: ",n.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",n.wins," / ",n.appearances]})]})}return null}}),e.jsx(G,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:x.map((s,r)=>e.jsx(W,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",x.length," des paires (sur ",a,") avec au moins ",g," apparition",g>1?"s":""]})]})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${j==="wolves"?" active":""}`,onClick:()=>R("wolves"),type:"button",children:["Paires de Loups (",o.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${j==="lovers"?" active":""}`,onClick:()=>R("lovers"),type:"button",children:["Paires d'Amoureux (",o.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:j==="wolves"?P():m()})]})}export{Z as PlayerPairingStatsChart};
