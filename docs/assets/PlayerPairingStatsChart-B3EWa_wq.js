import{r as $,u as X,j as e}from"./index-Dt0EPfhr.js";import{u as Y,a as J}from"./useRawGameData-Gi1Rccqn.js";import{p as Z}from"./api-beq3FXpM.js";import{F as k,B as T,C as q,X as z,Y as F,a as I,b as D}from"./FullscreenChart-DJNhalAm.js";import{R as G,T as W}from"./CategoricalChart-D18qLnbt.js";function H(){const{data:g,isLoading:B,error:N}=Y(),{data:t,isLoading:K,error:R}=J();return{data:$.useMemo(()=>{if(!g||g.length===0||!t||t.length===0)return null;const b=n=>n?n.split(",").map(a=>a.trim()).filter(Boolean):[],y={};g.forEach(n=>{const a=n.Game?.toString(),l=n["Camp victorieux"];a&&l&&(y[a]=l.toString())});const f={},x={};let C=0,w=0;t.forEach(n=>{const a=n.Game?.toString();if(!a)return;const l=n.Loups,S=n.Amoureux,L=y[a];if(l){const d=b(l.toString());if(d.length>=2){C++;for(let h=0;h<d.length;h++)for(let m=h+1;m<d.length;m++){const j=d[h],u=d[m],v=[j,u].sort().join(" & ");f[v]||(f[v]={appearances:0,wins:0,winRate:0,players:[j,u]}),f[v].appearances++,L==="Loups"&&f[v].wins++}}}if(S){const d=b(S.toString());if(d.length>=2){w++;for(let h=0;h<d.length;h+=2)if(h+1<d.length){const m=d[h],j=d[h+1],u=[m,j].sort().join(" & ");x[u]||(x[u]={appearances:0,wins:0,winRate:0,players:[m,j]}),x[u].appearances++,L==="Amoureux"&&x[u].wins++}}}});const c=Object.keys(f).map(n=>{const a=f[n],l=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:n,appearances:a.appearances,wins:a.wins,winRate:l,players:a.players}}),P=Object.keys(x).map(n=>{const a=x[n],l=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:n,appearances:a.appearances,wins:a.wins,winRate:l,players:a.players}});return c.sort((n,a)=>a.appearances-n.appearances),P.sort((n,a)=>a.appearances-n.appearances),{wolfPairs:{totalGames:C,pairs:c},loverPairs:{totalGames:w,pairs:P}}},[g,t]),isLoading:B||K,error:N||R}}function re(){const{navigateToGameDetails:g,navigationState:B,updateNavigationState:N}=X(),{data:t,isLoading:K,error:R}=H(),[A,b]=$.useState(B.selectedPairingTab||"wolves"),[y,f]=$.useState(2),[x,C]=$.useState(1),w=[1,2,3,4,5];if(K)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(R)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",R]});if(!t)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const c=s=>Z[s]||"#8884d8",P=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,n=s=>s.map(r=>{const[i,p]=r.players,o=c(i),M=c(p),E=P(r.pair);return e.jsxs("linearGradient",{id:E,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:o}),e.jsx("stop",{offset:"50%",stopColor:o}),e.jsx("stop",{offset:"50%",stopColor:M}),e.jsx("stop",{offset:"100%",stopColor:M})]},E)}),a=t.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:P(s.pair)})),l=t.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:P(s.pair)})),S=a.filter(s=>s.appearances>=y).length,L=l.filter(s=>s.appearances>=x).length,d=a.filter(s=>s.appearances>=2),h=l.filter(s=>s.appearances>=2),m=[...a].sort((s,r)=>r.appearances-s.appearances).slice(0,10),j=[...a].filter(s=>s.appearances>=y).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),u=[...l].sort((s,r)=>r.appearances-s.appearances).slice(0,10),v=[...l].filter(s=>s.appearances>=x).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),V=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:d.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),e.jsx(k,{title:"Paires de Loups les Plus Fréquentes",children:m.length>0?e.jsx("div",{style:{height:350},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:m,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:n(m)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,o]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(o),borderRadius:"2px"}}),e.jsx("span",{children:o})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir les parties"})]})}return null}}),e.jsx(I,{dataKey:"appearances",name:"Apparitions",children:m.map((s,r)=>e.jsx(D,{fill:`url(#${s.gradientId})`,onClick:()=>{g({selectedPlayerPair:s.players,selectedPairRole:"wolves",fromComponent:"Paires de Loups les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-wolf-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-wolf-appearances-select",value:y,onChange:s=>f(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:w.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(k,{title:"Paires de Loups les Plus Performantes",children:[j.length>0?e.jsx("div",{style:{height:320},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:j,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:n(j)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,o]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(o),borderRadius:"2px"}}),e.jsx("span",{children:o})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]})]})}return null}}),e.jsx(I,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:j.map((s,r)=>e.jsx(D,{fill:`url(#${s.gradientId})`,onClick:()=>{g({selectedPlayerPair:s.players,selectedPairRole:"wolves",fromComponent:"Paires de Loups les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",j.length," des paires (sur ",S,") avec au moins ",y," apparition",y>1?"s":""]})]})]})]})]}),O=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:t.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:h.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),e.jsx(k,{title:"Paires d'Amoureux les Plus Fréquentes",children:u.length>0?e.jsx("div",{style:{height:350},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:u,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:n(u)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,o]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(o),borderRadius:"2px"}}),e.jsx("span",{children:o})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir les parties"})]})}return null}}),e.jsx(I,{dataKey:"appearances",name:"Apparitions",children:u.map((s,r)=>e.jsx(D,{fill:`url(#${s.gradientId})`,onClick:()=>{g({selectedPlayerPair:s.players,selectedPairRole:"lovers",fromComponent:"Paires d'Amoureux les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-lover-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-lover-appearances-select",value:x,onChange:s=>C(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:w.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(k,{title:"Paires d'Amoureux les Plus Performantes",children:[v.length>0?e.jsx("div",{style:{height:320},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:v,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:n(v)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(W,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,o]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:c(o),borderRadius:"2px"}}),e.jsx("span",{children:o})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir les parties"})]})}return null}}),e.jsx(I,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:v.map((s,r)=>e.jsx(D,{fill:`url(#${s.gradientId})`,onClick:()=>{g({selectedPlayerPair:s.players,selectedPairRole:"lovers",fromComponent:"Paires d'Amoureux les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",v.length," des paires (sur ",L,") avec au moins ",x," apparition",x>1?"s":""]})]})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${A==="wolves"?" active":""}`,onClick:()=>{b("wolves"),N({selectedPairingTab:"wolves"})},type:"button",children:["Paires de Loups (",t.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${A==="lovers"?" active":""}`,onClick:()=>{b("lovers"),N({selectedPairingTab:"lovers"})},type:"button",children:["Paires d'Amoureux (",t.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:A==="wolves"?V():O()})]})}export{re as PlayerPairingStatsChart};
