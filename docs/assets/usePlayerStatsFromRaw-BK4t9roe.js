import{r as C}from"./index-DWfrD1eM.js";import{q as A,t as x}from"./useRawGameData-BVqoB0l1.js";function G(){const{data:l,isLoading:y,error:S}=A(),{data:u,isLoading:P,error:L}=x();return{data:C.useMemo(()=>{if(!l||l.length===0||!u||u.length===0)return null;const o=t=>t?t.split(",").map(e=>e.trim()).filter(Boolean):[],E=(t,e)=>e&&e.trim()!==""?o(e).some(c=>c.toLowerCase()===t.toLowerCase()):!1,h=(t,e,a)=>t[e]&&t[e][a]||"Villageois",n={};u.forEach(t=>{const e=t.Game?.toString();if(!e)return;n[e]||(n[e]={});const a=(r,p)=>{r&&r.toString().trim()&&(n[e][r.toString().trim()]=p)},c=t.Loups;c&&o(c.toString()).forEach(r=>{n[e][r]="Loups"}),a(t.Traître,"Traître"),a(t["Idiot du village"],"Idiot du Village"),a(t.Cannibale,"Cannibale"),a(t.Espion,"Espion"),a(t["La Bête"],"La Bête"),a(t["Chasseur de primes"],"Chasseur de primes"),a(t.Vaudou,"Vaudou");const g=t.Agent;g&&o(g.toString()).forEach(r=>{n[e][r]="Agent"});const d=t.Scientifique;d&&o(d.toString()).forEach(r=>{n[e][r]="Scientifique"});const s=t.Amoureux;s&&o(s.toString()).forEach(r=>{n[e][r]="Amoureux"})});const i={};let m=0;l.forEach(t=>{const e=t.Game?.toString(),a=t["Liste des joueurs"],c=t["Liste des gagnants"];e&&a&&(m++,o(a.toString()).forEach(d=>{const s=d.trim();if(s){i[s]||(i[s]={gamesPlayed:0,gamesPlayedPercent:"0",wins:0,winPercent:"0",camps:{Villageois:0,Loups:0,Traître:0,"Idiot du Village":0,Cannibale:0,Agent:0,Espion:0,Scientifique:0,Amoureux:0,"La Bête":0,"Chasseur de primes":0,Vaudou:0}}),i[s].gamesPlayed++;const r=h(n,e,s);i[s].camps[r]++,E(s,c?.toString())&&i[s].wins++}}))}),Object.keys(i).forEach(t=>{const e=i[t];e.gamesPlayedPercent=(e.gamesPlayed/m*100).toFixed(2),e.winPercent=(e.wins/e.gamesPlayed*100).toFixed(2)});const f=Object.keys(i).map(t=>({player:t,...i[t]}));return f.sort((t,e)=>e.gamesPlayed-t.gamesPlayed),{totalGames:m,playerStats:f}},[l,u]),isLoading:y||P,error:S||L}}export{G as u};
