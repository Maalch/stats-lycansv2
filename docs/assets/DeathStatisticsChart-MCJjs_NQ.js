import{u as J,a as _,r as M,j as e,d as ie}from"./index-BsyVkShX.js";import{g as Q,a as ae,u as re,b as se,c as le,d as ne}from"./useDeathStatisticsFromRaw-CzWrVQX_.js";import{u as oe}from"./baseStatsHook-vHhlrzUC.js";import{g as ce,D as E}from"./datasyncExport-D6_8Fmuy.js";import{m as Y,u as X,a as te}from"./api-DV1ujGJ3.js";import{D as L}from"./deathTypes-CGUOTngO.js";import{F as W,B as F,C as V,X as q,Y as $,a as G,b as U}from"./FullscreenChart-DxhJgsw4.js";import{R as O,T as w}from"./CategoricalChart-DS1rzY5F.js";import{u as Z}from"./useJoueursData-BLynDft9.js";function ee(n){if(!n||n.trim()==="")return null;const u=n.trim().slice(1),x=parseInt(u,10);return isNaN(x)||x<1?null:x}function de(n,S){if(n.length===0)return null;const u=n.filter(s=>!s.LegacyData||s.LegacyData.deathInformationFilled===!0);if(u.length===0)return null;const x={},g={};u.forEach(s=>{let p=1;if(s.EndTiming){const y=ee(s.EndTiming);y&&(p=y)}s.PlayerStats.forEach(y=>{if(S&&S!=="Tous les camps"&&ce(y.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==S)return;const H=y.Username;x[H]||(x[H]={playerName:H,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const b=x[H];b.totalGames++;let z=null;y.DeathTiming&&(z=ee(y.DeathTiming));for(let A=1;A<=p;A++)b.gamesPlayedByDay[A]||(b.gamesPlayedByDay[A]=0,b.survivalsByDay[A]=0),g[A]||(g[A]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),b.gamesPlayedByDay[A]++,g[A].playersOnDay++,(!z||z>A)&&(b.survivalsByDay[A]++,g[A].survivorsOnDay++)});for(let y=1;y<=p;y++)g[y]||(g[y]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),g[y].gamesReachingDay++}),Object.values(x).forEach(s=>{Object.keys(s.gamesPlayedByDay).forEach(p=>{const y=parseInt(p),H=s.gamesPlayedByDay[y],b=s.survivalsByDay[y];H>0?s.survivalRatesByDay[y]=b/H*100:s.survivalRatesByDay[y]=0})});const K=Object.values(x).filter(s=>s.totalGames>0).sort((s,p)=>p.totalGames-s.totalGames),k=Object.entries(g).map(([s,p])=>({dayNumber:parseInt(s),totalGamesReachingDay:p.gamesReachingDay,totalPlayersOnDay:p.playersOnDay,averageSurvivalRate:p.playersOnDay>0?p.survivorsOnDay/p.playersOnDay*100:0})).sort((s,p)=>s.dayNumber-p.dayNumber);return{totalGames:u.length,totalPlayersAnalyzed:K.length,playerSurvivalStats:K,dayStats:k}}function he(n,S,u=10){return n.playerSurvivalStats.filter(x=>(x.gamesPlayedByDay[S]||0)>=u).map(x=>({playerName:x.playerName,survivalRate:x.survivalRatesByDay[S]||0,gamesPlayed:x.totalGames,timesReachedDay:x.gamesPlayedByDay[S]||0,timesSurvivedDay:x.survivalsByDay[S]||0})).sort((x,g)=>g.survivalRate-x.survivalRate).slice(0,15)}function ge(n,S,u=10){return n.playerSurvivalStats.filter(x=>(x.gamesPlayedByDay[S]||0)>=u).map(x=>({playerName:x.playerName,survivalRate:x.survivalRatesByDay[S]||0,gamesPlayed:x.totalGames,timesReachedDay:x.gamesPlayedByDay[S]||0,timesSurvivedDay:x.survivalsByDay[S]||0})).sort((x,g)=>x.survivalRate-g.survivalRate).slice(0,15)}function me(n){return oe(S=>de(S,n))}function ue({deathStats:n,selectedCamp:S,victimCampFilter:u,minGamesForAverage:x,onMinGamesChange:g,availableDeathTypes:K,deathTypeColors:k,totalEligibleForAverage:s}){const{navigateToGameDetails:p}=J(),{settings:y}=_(),H=i=>{if(u==="Tous les camps"){const t=i.filter(l=>l!==L.BULLET_HUMAN&&l!==L.BULLET_WOLF);return(i.includes(L.BULLET_HUMAN)||i.includes(L.BULLET_WOLF))&&!t.includes(L.BULLET)&&t.push(L.BULLET),t}return i},b=M.useMemo(()=>H(K),[K,u]),z=M.useMemo(()=>{const i={...k};if(u==="Tous les camps"&&!i[L.BULLET]){const t=k[L.BULLET_HUMAN]||k[L.BULLET_WOLF];t&&(i[L.BULLET]=t)}return i},[k,u]),A=i=>{if(u==="Tous les camps"){const t=i.killsByDeathType[L.BULLET_HUMAN]||0,l=i.killsByDeathType[L.BULLET_WOLF]||0,d=i.killsByDeathType[L.BULLET]||0,v={...i.killsByDeathType};return v[L.BULLET]=t+l+d,delete v[L.BULLET_HUMAN],delete v[L.BULLET_WOLF],{...i,killsByDeathType:v}}return i},C=i=>{let t="Top Tueurs";return S!=="Tous les camps"&&(t+=` en ${S}`),u!=="Tous les camps"&&(u==="Roles solo"?t+=" (victimes: Roles solo)":t+=` (victimes: ${u})`),i==="total"?t+=" (Total)":t+=" (Moyenne par Partie)",t},{totalKillsData:T,averageKillsData:f,highlightedPlayerAddedToTotal:N,highlightedPlayerAddedToAverage:o}=M.useMemo(()=>{if(!n)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const i=n.killerStats.sort((c,m)=>m.kills-c.kills).slice(0,15),t=y.highlightedPlayer&&i.some(c=>c.killerName===y.highlightedPlayer),l=i.map(c=>{const m=A(c),B={name:m.killerName,value:m.kills,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!1};return b.forEach(D=>{B[D]=m.killsByDeathType[D]||0}),B});let d=!1;if(y.highlightedPlayer&&!t){const c=n.killerStats.find(m=>m.killerName===y.highlightedPlayer);if(c){const m=A(c),B={name:m.killerName,value:m.kills,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!0};b.forEach(D=>{B[D]=m.killsByDeathType[D]||0}),l.push(B),d=!0}}const a=n.killerStats.filter(c=>c.gamesPlayed>=x).sort((c,m)=>m.averageKillsPerGame-c.averageKillsPerGame).slice(0,15),r=y.highlightedPlayer&&a.some(c=>c.killerName===y.highlightedPlayer),j=a.map(c=>{const m=A(c),B={name:m.killerName,value:m.averageKillsPerGame,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!1};return b.forEach(D=>{const I=m.killsByDeathType[D]||0;B[D]=m.gamesPlayed>0?I/m.gamesPlayed:0}),B});let R=!1;if(y.highlightedPlayer&&!r){const c=n.killerStats.find(m=>m.killerName===y.highlightedPlayer);if(c){const m=A(c),B={name:m.killerName,value:m.averageKillsPerGame,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!0};b.forEach(D=>{const I=m.killsByDeathType[D]||0;B[D]=m.gamesPlayed>0?I/m.gamesPlayed:0}),j.push(B),R=!0}}return{totalKillsData:l,averageKillsData:j,highlightedPlayerAddedToTotal:d,highlightedPlayerAddedToAverage:R}},[n,y.highlightedPlayer,x,b,u]),h=({active:i,payload:t,label:l})=>{if(i&&t&&t.length){const d=t[0].payload,v=d.isHighlightedAddition,a=y.highlightedPlayer===d.name,r=b.reduce((j,R)=>j+(d[R]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:a?"var(--accent-primary)":"var(--text-primary)"},children:[l,v&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",r]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",d.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),b.map(j=>({deathType:j,count:d[j]||0})).filter(j=>j.count>0).sort((j,R)=>R.count-j.count).map(({deathType:j,count:R})=>e.jsxs("p",{style:{color:z[j],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[Q(j),":"]})," ",R]},j))]}),v&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),a&&!v&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},P=({active:i,payload:t,label:l})=>{if(i&&t&&t.length){const d=t[0].payload,v=d.isHighlightedAddition,a=y.highlightedPlayer===d.name,r=d.gamesPlayed>=x,j=n?.killerStats.find(B=>B.killerName===d.name),R=j?A(j):null,c=b.reduce((B,D)=>B+(d[D]||0),0),m=R?R.kills:Math.round(c*d.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:a?"var(--accent-primary)":"var(--text-primary)"},children:[l,v&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",c.toFixed(2)," (",m," kills /",d.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",d.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),b.map(B=>({deathType:B,avgCount:d[B]||0,totalKillsForDeathType:R?R.killsByDeathType[B]||0:Math.round((d[B]||0)*d.gamesPlayed)})).filter(B=>B.avgCount>0).sort((B,D)=>D.avgCount-B.avgCount).map(({deathType:B,avgCount:D,totalKillsForDeathType:I})=>e.jsxs("p",{style:{color:z[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[Q(B),":"]})," ",D.toFixed(2)," (",I," kills /",d.gamesPlayed," games)"]},B))]}),v&&!r&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",x," parties)"]}),v&&r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),a&&!v&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:C("total")}),N&&y.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',y.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:C("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:T,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:i,y:t,payload:l})=>e.jsx("text",{x:i,y:t,dy:10,fill:y.highlightedPlayer===l.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:y.highlightedPlayer===l.value?14:12,fontWeight:y.highlightedPlayer===l.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${i} ${t})`,children:l.value})}),e.jsx($,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(h,{})}),b.map(i=>e.jsx(G,{dataKey:i,name:i,stackId:"kills",fill:z[i],onClick:t=>{const l={selectedPlayer:t?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(l.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),p(l)}},i))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(i=>!i.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:C("average")}),o&&y.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',y.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:x,onChange:i=>g(Number(i.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsx(W,{title:C("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:f,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:i,y:t,payload:l})=>e.jsx("text",{x:i,y:t,dy:10,fill:y.highlightedPlayer===l.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:y.highlightedPlayer===l.value?14:12,fontWeight:y.highlightedPlayer===l.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${i} ${t})`,children:l.value})}),e.jsx($,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(P,{})}),b.map(i=>e.jsx(G,{dataKey:i,name:i,stackId:"averageKills",fill:z[i],onClick:t=>{const l={selectedPlayer:t?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(l.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),p(l)}},i))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(i=>!i.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",s," ayant au moins ",x," partie",x>1?"s":"",")"]})]})]})}function ye({deathStats:n,selectedCamp:S,minGamesForAverage:u,onMinGamesChange:x,availableDeathTypes:g,deathTypeColors:K}){const{navigateToGameDetails:k}=J(),{settings:s}=_(),{joueursData:p}=Z(),y=X(p),[H,b]=M.useState(null),{totalDeathsData:z,survivalRateData:A,highlightedPlayerAddedToDeaths:C,highlightedPlayerAddedToSurvival:T}=M.useMemo(()=>{if(!n)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const o=n.playerDeathStats.sort((r,j)=>j.totalDeaths-r.totalDeaths).slice(0,15),h=s.highlightedPlayer&&o.some(r=>r.playerName===s.highlightedPlayer),P=o.map(r=>{const j=r.gamesPlayed,R=j>0?(j-r.totalDeaths)/j*100:0,c={name:r.playerName,value:r.totalDeaths,totalDeaths:r.totalDeaths,gamesPlayed:j,deathRate:r.deathRate,survivalRate:R,isHighlightedAddition:!1};return g.forEach(m=>{c[m]=r.deathsByType[m]||0}),c});let i=!1;if(s.highlightedPlayer&&!h){const r=n.playerDeathStats.find(j=>j.playerName===s.highlightedPlayer);if(r){const j=r.gamesPlayed,R=j>0?(j-r.totalDeaths)/j*100:0,c={name:r.playerName,value:r.totalDeaths,totalDeaths:r.totalDeaths,gamesPlayed:j,deathRate:r.deathRate,survivalRate:R,isHighlightedAddition:!0};g.forEach(m=>{c[m]=r.deathsByType[m]||0}),P.push(c),i=!0}}const l=n.playerDeathStats.filter(r=>r.gamesPlayed>=u).map(r=>({...r,survivalRate:r.gamesPlayed>0?(r.gamesPlayed-r.totalDeaths)/r.gamesPlayed*100:0})).sort((r,j)=>j.survivalRate-r.survivalRate).slice(0,15),d=s.highlightedPlayer&&l.some(r=>r.playerName===s.highlightedPlayer),v=l.map(r=>({name:r.playerName,value:r.survivalRate,totalDeaths:r.totalDeaths,gamesPlayed:r.gamesPlayed,deathRate:r.deathRate,survivalRate:r.survivalRate,isHighlightedAddition:!1}));let a=!1;if(s.highlightedPlayer&&!d){const r=n.playerDeathStats.find(j=>j.playerName===s.highlightedPlayer);if(r){const j=r.gamesPlayed>0?(r.gamesPlayed-r.totalDeaths)/r.gamesPlayed*100:0,R={name:r.playerName,value:j,totalDeaths:r.totalDeaths,gamesPlayed:r.gamesPlayed,deathRate:r.deathRate,survivalRate:j,isHighlightedAddition:!0};v.push(R),a=!0}}return{totalDeathsData:P,survivalRateData:v,highlightedPlayerAddedToDeaths:i,highlightedPlayerAddedToSurvival:a}},[n,s.highlightedPlayer,u,g]),f=({active:o,payload:h,label:P})=>{if(o&&h&&h.length){const i=h[0].payload,t=i.isHighlightedAddition,l=s.highlightedPlayer===i.name,d=g.reduce((v,a)=>v+(i[a]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:l?"var(--accent-primary)":"var(--text-primary)"},children:[P,t&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",d]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",i.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",i.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),g.map(v=>{const a=i[v]||0;return a===0?null:e.jsxs("p",{style:{color:K[v],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ae(v),":"]})," ",a]},v)})]}),t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),l&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},N=({active:o,payload:h,label:P})=>{if(o&&h&&h.length){const i=h[0].payload,t=i.isHighlightedAddition,l=s.highlightedPlayer===i.name,d=i.gamesPlayed>=u;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:l?"var(--accent-primary)":"var(--text-primary)"},children:[P,t&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",i.survivalRate.toFixed(1),"% (",i.gamesPlayed-i.totalDeaths," survies / ",i.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",i.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",i.gamesPlayed]}),t&&!d&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",u," parties)"]}),t&&d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),l&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:S==="Tous les camps"?"Morts (Total)":`Morts en ${S} (Total)`}),C&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:S==="Tous les camps"?"Morts (Total)":`Morts en ${S} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:z,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:o,y:h,payload:P})=>e.jsx("text",{x:o,y:h,dy:10,fill:s.highlightedPlayer===P.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===P.value?14:12,fontWeight:s.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${o} ${h})`,children:P.value})}),e.jsx($,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(f,{})}),g.map(o=>e.jsx(G,{dataKey:o,name:o,stackId:"deaths",fill:K[o],onClick:h=>{const P={selectedPlayer:h?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(P.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),k(P)}},o))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,z.filter(o=>!o.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",S==="Tous les camps"?"(Total)":` en ${S}`]}),T&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:u,onChange:o=>x(Number(o.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsx(W,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:A,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:o,y:h,payload:P})=>e.jsx("text",{x:o,y:h,dy:10,fill:s.highlightedPlayer===P.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===P.value?14:12,fontWeight:s.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${o} ${h})`,children:P.value})}),e.jsx($,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(N,{})}),e.jsx(G,{dataKey:"value",onClick:o=>{const h={selectedPlayer:o?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(h.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),k(h)},onMouseEnter:o=>b(o?.name||null),onMouseLeave:()=>b(null),style:{cursor:"pointer"},children:A.map((o,h)=>{const P=s.highlightedPlayer===o.name,i=o.isHighlightedAddition;return e.jsx(U,{fill:y[o.name]||"var(--chart-primary)",stroke:P?"var(--accent-primary)":H===o.name?"var(--text-primary)":"none",strokeWidth:P?3:H===o.name?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1},`cell-${h}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,A.filter(o=>!o.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",u," partie",u>1?"s":"",")"]})]})]})}function ve({hunterStats:n,isLoading:S,error:u}){const{navigateToGameDetails:x}=J(),{settings:g}=_(),K=te(),{joueursData:k}=Z(),s=X(k),[p,y]=M.useState(null);if(S)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(u)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]});if(!n||n.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:H,highlightedPlayerAddedToBest:b,finalBadHuntersData:z,highlightedPlayerAddedToBad:A}=(()=>{const N=n.hunterStats.filter(a=>a.gamesPlayedAsHunter>=5).sort((a,r)=>r.averageNonVillageoisKillsPerGame-a.averageNonVillageoisKillsPerGame).slice(0,15),o=g.highlightedPlayer&&N.some(a=>a.hunterName===g.highlightedPlayer);let h=[...N],P=!1;if(g.highlightedPlayer&&!o){const a=n.hunterStats.find(r=>r.hunterName===g.highlightedPlayer);a&&(h.push({...a,isHighlightedAddition:!0}),P=!0)}const i=n.hunterStats.filter(a=>a.gamesPlayedAsHunter>=5).map(a=>({name:a.hunterName,averageVillageoisKills:Number((a.villageoisKills/a.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:a.villageoisKills,totalNonVillageoisKills:a.nonVillageoisKills,totalKills:a.totalKills,gamesPlayed:a.gamesPlayedAsHunter,victimsByCamp:a.victimsByCamp,goodVictimsByCamp:a.goodVictimsByCamp,badVictimsByCamp:a.badVictimsByCamp,hunterName:a.hunterName})),t=i.sort((a,r)=>r.averageVillageoisKills-a.averageVillageoisKills).slice(0,15),l=g.highlightedPlayer&&t.some(a=>a.hunterName===g.highlightedPlayer);let d=[...t],v=!1;if(g.highlightedPlayer&&!l){const a=i.find(r=>r.hunterName===g.highlightedPlayer);a&&(d.push({...a,isHighlightedAddition:!0}),v=!0)}return{finalBestHuntersData:h,highlightedPlayerAddedToBest:P,finalBadHuntersData:d,highlightedPlayerAddedToBad:v}})(),C=({active:f,payload:N,label:o})=>{if(f&&N&&N.length){const h=N[0].payload,P=h.isHighlightedAddition,i=g.highlightedPlayer===h.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:i?"var(--accent-primary)":"var(--text-primary)"},children:[o,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",h.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",h.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",h.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",h.totalKills]}),h.goodVictimsByCamp&&Object.keys(h.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(h.goodVictimsByCamp).map(([t,l])=>e.jsxs("p",{style:{color:K[t]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[t,":"]})," ",l]},t))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),i&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},T=({active:f,payload:N,label:o})=>{if(f&&N&&N.length){const h=N[0].payload,P=h.isHighlightedAddition,i=g.highlightedPlayer===h.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:i?"var(--accent-primary)":"var(--text-primary)"},children:[o,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",h.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",h.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",h.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",h.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",h.totalKills]}),h.badVictimsByCamp&&Object.keys(h.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(h.badVictimsByCamp).map(([t,l])=>e.jsxs("p",{style:{color:K[t]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[t,":"]})," ",l]},t))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),i&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),b&&g.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',g.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:H,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:f,y:N,payload:o})=>e.jsx("text",{x:f,y:N,dy:10,fill:g.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:g.highlightedPlayer===o.value?14:12,fontWeight:g.highlightedPlayer===o.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${f} ${N})`,children:o.value})}),e.jsx($,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(C,{})}),e.jsx(G,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:f=>{f?.hunterName&&x({selectedPlayer:f.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:f=>y(f?.hunterName||null),onMouseLeave:()=>y(null),style:{cursor:"pointer"},children:H.map((f,N)=>{const o=g.highlightedPlayer===f.hunterName,h=f.isHighlightedAddition;return e.jsx(U,{fill:s[f.hunterName]||K.Chasseur||"#8884d8",stroke:o?"var(--accent-primary)":p===f.hunterName?"var(--text-primary)":"none",strokeWidth:o?3:p===f.hunterName?2:0,strokeDasharray:h?"5,5":"none",opacity:h?.8:1},`cell-${N}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,H.filter(f=>!f.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),A&&g.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',g.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:z,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:f,y:N,payload:o})=>e.jsx("text",{x:f,y:N,dy:10,fill:g.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:g.highlightedPlayer===o.value?14:12,fontWeight:g.highlightedPlayer===o.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${f} ${N})`,children:o.value})}),e.jsx($,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(T,{})}),e.jsx(G,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:f=>{f?.hunterName&&x({selectedPlayer:f.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:f=>y(f?.hunterName||null),onMouseLeave:()=>y(null),style:{cursor:"pointer"},children:z.map((f,N)=>{const o=g.highlightedPlayer===f.hunterName,h=f.isHighlightedAddition;return e.jsx(U,{fill:s[f.hunterName]||K.Chasseur||"#8884d8",stroke:o?"var(--accent-primary)":p===f.hunterName?"var(--text-primary)":"none",strokeWidth:o?3:p===f.hunterName?2:0,strokeDasharray:h?"5,5":"none",opacity:h?.8:1},`cell-${N}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,z.filter(f=>!f.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function pe({survivalStats:n,selectedCamp:S,minGamesForAverage:u,onMinGamesChange:x,isLoading:g,error:K}){const{navigateToGameDetails:k}=J(),{settings:s}=_(),{joueursData:p}=Z(),y=X(p),[H,b]=M.useState(1),[z,A]=M.useState(null),C=M.useMemo(()=>n?n.dayStats.filter(l=>l.totalGamesReachingDay>0).map(l=>l.dayNumber).sort((l,d)=>l-d):[],[n]),T=M.useMemo(()=>C.includes(H)?H:C.length>0?C[0]:1,[H,C]),{highestSurvivalData:f,highlightedPlayerAddedToHighest:N}=M.useMemo(()=>{if(!n)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const t=he(n,T,u),l=s.highlightedPlayer&&t.some(a=>a.playerName===s.highlightedPlayer),d=t.map(a=>({name:a.playerName,value:a.survivalRate,gamesPlayed:a.gamesPlayed,timesReachedDay:a.timesReachedDay,timesSurvivedDay:a.timesSurvivedDay,isHighlightedAddition:!1}));let v=!1;if(s.highlightedPlayer&&!l){const a=n.playerSurvivalStats.find(r=>r.playerName===s.highlightedPlayer);if(a&&(a.gamesPlayedByDay[T]||0)>=1){const r=a.survivalRatesByDay[T]||0;d.push({name:s.highlightedPlayer,value:r,gamesPlayed:a.totalGames,timesReachedDay:a.gamesPlayedByDay[T]||0,timesSurvivedDay:a.survivalsByDay[T]||0,isHighlightedAddition:!0}),v=!0}}return{highestSurvivalData:d,highlightedPlayerAddedToHighest:v}},[n,T,u,s.highlightedPlayer]),{lowestSurvivalData:o,highlightedPlayerAddedToLowest:h}=M.useMemo(()=>{if(!n)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const t=ge(n,T,u),l=s.highlightedPlayer&&t.some(a=>a.playerName===s.highlightedPlayer),d=t.map(a=>({name:a.playerName,value:a.survivalRate,gamesPlayed:a.gamesPlayed,timesReachedDay:a.timesReachedDay,timesSurvivedDay:a.timesSurvivedDay,isHighlightedAddition:!1}));let v=!1;if(s.highlightedPlayer&&!l){const a=n.playerSurvivalStats.find(r=>r.playerName===s.highlightedPlayer);if(a&&(a.gamesPlayedByDay[T]||0)>=1){const r=a.survivalRatesByDay[T]||0;d.push({name:s.highlightedPlayer,value:r,gamesPlayed:a.totalGames,timesReachedDay:a.gamesPlayedByDay[T]||0,timesSurvivedDay:a.survivalsByDay[T]||0,isHighlightedAddition:!0}),v=!0}}return{lowestSurvivalData:d,highlightedPlayerAddedToLowest:v}},[n,T,u,s.highlightedPlayer]),P=t=>{k({selectedPlayer:t,fromComponent:"Statistiques de Survie"})},i=({active:t,payload:l,label:d})=>{if(t&&l&&l.length>0){const v=l[0].payload,a=v.isHighlightedAddition,r=s.highlightedPlayer===v.name,j=v.timesReachedDay>=u;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:d})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",T,": ",v.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",T,": ",v.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",T,": ",v.timesSurvivedDay]}),e.jsxs("div",{children:["Total de parties: ",v.gamesPlayed]}),a&&!j&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",u," parties ce jour)"]}),a&&j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),r&&!a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return g?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):K?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",K]}):n?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:T,onChange:t=>b(parseInt(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:C.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:u,onChange:t=>x(parseInt(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:Y.map(t=>e.jsx("option",{value:t,children:t},t))})]})]})}),T&&n.dayStats.find(t=>t.dayNumber===T)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Parties atteignant le Jour ",T]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:n.dayStats.find(t=>t.dayNumber===T)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",T]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(n.dayStats.find(t=>t.dayNumber===T)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",u," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:n.playerSurvivalStats.filter(t=>(t.gamesPlayedByDay[T]||0)>=u).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",T]}),N&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:f,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:t,y:l,payload:d})=>e.jsx("text",{x:t,y:l,dy:16,textAnchor:"end",transform:`rotate(-45, ${t}, ${l})`,fill:s.highlightedPlayer===d.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===d.value?14:12,fontWeight:s.highlightedPlayer===d.value?"bold":"normal",children:d.value})}),e.jsx($,{tickFormatter:t=>`${t.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(i,{})}),e.jsx(G,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:f.map((t,l)=>{const d=s.highlightedPlayer===t.name,v=z===t.name,a=t.isHighlightedAddition;return e.jsx(U,{fill:y[t.name]||"var(--chart-primary)",stroke:d?"var(--accent-primary)":v?"var(--text-primary)":"none",strokeWidth:d?3:v?2:0,strokeDasharray:a?"5,5":"none",opacity:a?.8:1,onClick:()=>P(t.name),onMouseEnter:()=>A(t.name),onMouseLeave:()=>A(null),style:{cursor:"pointer"}},`cell-highest-${l}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",T]}),h&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(F,{data:o,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:t,y:l,payload:d})=>e.jsx("text",{x:t,y:l,dy:16,textAnchor:"end",transform:`rotate(-45, ${t}, ${l})`,fill:s.highlightedPlayer===d.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===d.value?14:12,fontWeight:s.highlightedPlayer===d.value?"bold":"normal",children:d.value})}),e.jsx($,{tickFormatter:t=>`${t.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(i,{})}),e.jsx(G,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:o.map((t,l)=>{const d=s.highlightedPlayer===t.name,v=z===t.name,a=t.isHighlightedAddition;return e.jsx(U,{fill:y[t.name]||"var(--chart-color-4)",stroke:d?"var(--accent-primary)":v?"var(--text-primary)":"none",strokeWidth:d?3:v?2:0,strokeDasharray:a?"5,5":"none",opacity:a?.8:1,onClick:()=>P(t.name),onMouseEnter:()=>A(t.name),onMouseLeave:()=>A(null),style:{cursor:"pointer"}},`cell-lowest-${l}`)})})]})})})})]}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note :"})," Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",T," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",N||h?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function Be(){const{navigationState:n,updateNavigationState:S}=J(),[u,x]=M.useState(n.deathStatisticsState?.selectedCamp||n.deathStatsSelectedCamp||"Tous les camps"),[g,K]=M.useState(n.deathStatisticsState?.victimCampFilter||"Tous les camps"),[k,s]=M.useState(n.deathStatisticsState?.minGamesForAverage||25),[p,y]=M.useState(n.deathStatisticsState?.selectedView||"killers"),{data:H}=re(),{data:b,isLoading:z,error:A}=se(u,g),{data:C,isLoading:T,error:f}=le(),{data:N,isLoading:o,error:h}=me(u),{data:P}=ie(),i=te();M.useEffect(()=>{(!n.deathStatisticsState||n.deathStatisticsState.selectedCamp!==u||n.deathStatisticsState.victimCampFilter!==g||n.deathStatisticsState.minGamesForAverage!==k||n.deathStatisticsState.selectedView!==p)&&S({deathStatisticsState:{selectedCamp:u,victimCampFilter:g,minGamesForAverage:k,selectedView:p,focusChart:n.deathStatisticsState?.focusChart}})},[u,g,k,p,n.deathStatisticsState,S]);const t=M.useMemo(()=>P?ne(P):[],[P]),l=M.useMemo(()=>{const c={};t.forEach(D=>{D===E.BY_WOLF?c[D]=i.Loup:D===E.VOTED?c[D]="var(--chart-color-1)":D===E.BULLET||D===E.BULLET_HUMAN||D===E.BULLET_WOLF?c[D]=i.Chasseur:D===E.BY_ZOMBIE?c[D]=i.Vaudou:D===E.ASSASSIN?c[D]=i.Alchimiste:D===E.AVENGER?c[D]="var(--chart-color-2)":D===E.LOVER_DEATH?c[D]=i.Amoureux:D===E.BY_BEAST?c[D]="var(--chart-color-3)":D===E.SHERIF_SUCCESS&&(c[D]="var(--chart-color-4)")});const m=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let B=0;return t.forEach(D=>{c[D]||(c[D]=m[B%m.length],B++)}),c},[t,i]),d=c=>{x(c),S({deathStatsSelectedCamp:c,deathStatisticsState:{selectedCamp:c,victimCampFilter:g,minGamesForAverage:k,selectedView:p,focusChart:n.deathStatisticsState?.focusChart}})},v=c=>{K(c),S({deathStatisticsState:{selectedCamp:u,victimCampFilter:c,minGamesForAverage:k,selectedView:p,focusChart:n.deathStatisticsState?.focusChart}})},a=c=>{s(c),S({deathStatisticsState:{selectedCamp:u,victimCampFilter:g,minGamesForAverage:c,selectedView:p,focusChart:n.deathStatisticsState?.focusChart}})},r=c=>{y(c),S({deathStatisticsState:{selectedCamp:u,victimCampFilter:g,minGamesForAverage:k,selectedView:c,focusChart:n.deathStatisticsState?.focusChart}})},{gamesWithKillers:j,totalEligibleForAverage:R}=M.useMemo(()=>{if(!b)return{gamesWithKillers:0,totalEligibleForAverage:0};const c=b.killerStats.filter(m=>m.gamesPlayed>=k);return{gamesWithKillers:b.totalGames,totalEligibleForAverage:c.length}},[b,k]);return z?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):A?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",A]}):b?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${p==="killers"?"active":""}`,onClick:()=>r("killers"),children:"Tueurs"}),e.jsx("button",{className:`lycans-categorie-btn ${p==="deaths"?"active":""}`,onClick:()=>r("deaths"),children:"Morts"}),e.jsx("button",{className:`lycans-categorie-btn ${p==="survival"?"active":""}`,onClick:()=>r("survival"),children:"Survie"}),e.jsx("button",{className:`lycans-categorie-btn ${p==="hunter"?"active":""}`,onClick:()=>r("hunter"),children:"Chasseur"})]}),(p==="killers"||p==="deaths"||p==="survival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:u,onChange:c=>d(c.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),H?.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),p==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:g,onChange:c=>v(c.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(p==="killers"||p==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:b.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:b.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:j})]})]}),p==="killers"&&e.jsx(ue,{deathStats:b,selectedCamp:u,victimCampFilter:g,minGamesForAverage:k,onMinGamesChange:a,availableDeathTypes:t,deathTypeColors:l,totalEligibleForAverage:R}),p==="deaths"&&e.jsx(ye,{deathStats:b,selectedCamp:u,minGamesForAverage:k,onMinGamesChange:a,availableDeathTypes:t,deathTypeColors:l}),p==="hunter"&&e.jsx(ve,{hunterStats:C,isLoading:T,error:f}),p==="survival"&&e.jsx(pe,{survivalStats:N,selectedCamp:u,minGamesForAverage:k,onMinGamesChange:a,isLoading:o,error:h}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"DonnÃ©es en cours de rÃ©cupÃ©ration (donnÃ©es partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{Be as DeathStatisticsChart};
