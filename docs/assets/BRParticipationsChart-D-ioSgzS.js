import{a as L,r as P,j as t}from"./index-dro47kk1.js";import{F as f,C as b,X as S,Y as N,a as R}from"./FullscreenChart-B0XHeYa8.js";import{u as W,a as I}from"./useRawBRData-CeTJQ0UJ.js";import{u as K}from"./useJoueursData-JW4aAZgi.js";import{u as M,g as $}from"./api-CfzEUjpP.js";import{R as B,T as w}from"./CategoricalChart-LF9-L1vF.js";import{B as D,a as A}from"./BarChart-6EsdULjZ.js";function V(){const{data:h,isLoading:C,error:g}=W(),{data:p,isLoading:H,error:m}=I(),{settings:n}=L(),{joueursData:F}=K(),[k,x]=P.useState(null),z=M(F),u=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],G=i=>z[i]||$(i),l=P.useMemo(()=>{if(!h||!p)return null;const i=p.length,r=h.length,e=h.filter(a=>a.Gagnant).length,d=h.reduce((a,s)=>{const o=s.Participants;return a[o]||(a[o]={name:o,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),a[o].participations++,a[o].totalScore+=s.Score,s.Gagnant&&a[o].wins++,a},{});Object.values(d).forEach(a=>{a.averageScore=a.totalScore/a.participations,a.winRate=a.wins/a.participations*100});const c=Object.values(d).sort((a,s)=>s.participations-a.participations),y=c.slice(0,15),T=n.highlightedPlayer&&y.some(a=>a.name===n.highlightedPlayer);let v=!1,j=[...y];if(n.highlightedPlayer&&!T){const a=c.find(s=>s.name===n.highlightedPlayer);a&&(j.push({...a,isHighlightedAddition:!0}),v=!0)}const E=p.reduce((a,s)=>{const o=s["Nombre de participants"];return a[o]||(a[o]=0),a[o]++,a},{}),q=Object.entries(E).map(([a,s])=>({participants:parseInt(a),games:s,percentage:(s/i*100).toFixed(1)})).sort((a,s)=>a.participants-s.participants);return{totalGames:i,totalParticipations:r,totalWins:e,winRate:(e/r*100).toFixed(1),averageParticipantsPerGame:(r/i).toFixed(1),topPlayersByParticipations:j,participantData:q,highlightedPlayerInParticipations:v}},[h,p,n.highlightedPlayer]);return C||H?t.jsx("div",{className:"statistiques-chargement",children:"Chargement des donn√©es Battle Royale..."}):g||m?t.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",g||m]}):l?t.jsxs("div",{className:"lycans-chart-container",children:[t.jsx("div",{className:"lycans-chart-header",children:t.jsx("h2",{children:"Participations - Battle Royale"})}),t.jsxs("div",{className:"lycans-stats-grid",children:[t.jsxs("div",{className:"lycans-stat-card",children:[t.jsx("h3",{children:"Parties totales"}),t.jsx("div",{className:"lycans-stat-value",children:l.totalGames})]}),t.jsxs("div",{className:"lycans-stat-card",children:[t.jsx("h3",{children:"Participations"}),t.jsx("div",{className:"lycans-stat-value",children:l.totalParticipations})]}),t.jsxs("div",{className:"lycans-stat-card",children:[t.jsx("h3",{children:"Moy. participants/partie"}),t.jsx("div",{className:"lycans-stat-value",children:l.averageParticipantsPerGame})]})]}),t.jsxs("div",{className:"lycans-graphiques-groupe",children:[t.jsxs("div",{className:"lycans-graphique-section",children:[t.jsx("h3",{children:"Participations"}),l.highlightedPlayerInParticipations&&n.highlightedPlayer&&t.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["üéØ ",n.highlightedPlayer," affich√© en plus du top 15"]}),t.jsx(f,{title:"Participations - Battle Royale",className:"lycans-chart-wrapper",children:t.jsx(B,{width:"100%",height:400,children:t.jsxs(D,{data:l.topPlayersByParticipations,children:[t.jsx(b,{strokeDasharray:"3 3"}),t.jsx(S,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:i,y:r,payload:e})=>t.jsx("text",{x:i,y:r,dy:16,textAnchor:"end",fill:n.highlightedPlayer===e.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===e.value?14:12,fontWeight:n.highlightedPlayer===e.value?"bold":"normal",transform:`rotate(-45 ${i} ${r})`,children:e.value})}),t.jsx(N,{}),t.jsx(w,{content:({active:i,payload:r})=>{if(i&&r&&r.length>0){const e=r[0].payload,d=e.isHighlightedAddition,c=n.highlightedPlayer===e.name;return t.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[t.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[e.name,c&&" üéØ"]}),t.jsx("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:t.jsxs("div",{children:["Participations: ",t.jsx("strong",{children:e.participations})]})}),d&&t.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"üéØ Affich√© via s√©lection (hors top 15)"})]})}return null}}),t.jsx(A,{dataKey:"participations",name:"Participations",children:l.topPlayersByParticipations.map((i,r)=>{const e=n.highlightedPlayer===i.name,d=k===i.name,c=i.isHighlightedAddition;return t.jsx(R,{fill:e?"var(--accent-primary)":c?"var(--accent-secondary)":G(i.name),stroke:e?"var(--accent-primary)":d?"var(--text-primary)":"none",strokeWidth:e?3:d?2:0,strokeDasharray:c?"5,5":"none",opacity:c?.8:1,onMouseEnter:()=>x(i.name),onMouseLeave:()=>x(null),style:{cursor:"pointer"}},`cell-${r}`)})})]})})})]}),t.jsxs("div",{className:"lycans-graphique-section",children:[t.jsx("h3",{children:"R√©partition par Nombre de Participants"}),t.jsx(f,{title:"R√©partition par Nombre de Participants - Battle Royale",className:"lycans-chart-wrapper",children:t.jsx(B,{width:"100%",height:400,children:t.jsxs(D,{data:l.participantData,margin:{bottom:15},children:[t.jsx(b,{strokeDasharray:"3 3"}),t.jsx(S,{dataKey:"participants",label:{value:"Nombre de participants",position:"insideBottom",offset:-5}}),t.jsx(N,{}),t.jsx(w,{content:({active:i,payload:r})=>{if(i&&r&&r.length>0){const e=r[0].payload;return t.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[t.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[e.participants," ",e.participants===1?"participant":"participants"]}),t.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[t.jsxs("div",{children:["Nombre de parties: ",t.jsx("strong",{children:e.games})]}),t.jsxs("div",{children:["Pourcentage: ",t.jsxs("strong",{children:[e.percentage,"%"]})]})]})]})}return null}}),t.jsx(A,{dataKey:"games",name:"Nombre de parties",children:l.participantData.map((i,r)=>t.jsx(R,{fill:u[r%u.length]},`cell-${r}`))})]})})})]})]})]}):t.jsx("div",{className:"statistiques-vide",children:"Aucune donn√©e Battle Royale disponible"})}export{V as BRParticipationsChart};
