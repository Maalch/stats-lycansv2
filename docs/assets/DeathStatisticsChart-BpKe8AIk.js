import{u as F,a as _,r as R,j as e,c as $}from"./index-BxB4rgU5.js";import{u as I}from"./baseStatsHook-Cn_WCRpg.js";import{D as l,g as K}from"./datasyncExport-Drm4NSNA.js";import{c as U,m as Y,a as w,u as Z}from"./api-Bm1F_-H7.js";import{F as k,B as L,C as M,X as H,Y as V,a as z,b as W}from"./FullscreenChart-CcB5wL2i.js";import{R as C,T as O}from"./CategoricalChart-C7pUyUgU.js";function J(h){const g=new Set;h.filter(p=>!p.LegacyData||p.LegacyData.deathInformationFilled===!0).forEach(p=>{p.PlayerStats.forEach(f=>{const j=K(f.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});g.add(j)})});const u=Array.from(g);return[...U.filter(p=>u.includes(p)),...u.filter(p=>!U.includes(p)).sort()]}function G(h){switch(h){case l.SURVIVOR:return"Survivant";case l.VOTED:return"Mort aux votes";case l.BY_WOLF:return"Tué par un loup";case l.BY_WOLF_REZ:return"Tué par un loup ressuscité";case l.BY_WOLF_LOVER:return"Tué par un loup amoureux";case l.BY_ZOMBIE:return"Tué par un zombie";case l.BY_BEAST:return"Dévoré par la Bête";case l.BY_AVATAR_CHAIN:return"Mort liée à l'Avatar";case l.BULLET:return"Abattu par un chasseur";case l.BULLET_HUMAN:return"Tué par un chasseur en humain";case l.BULLET_WOLF:return"Tué par un chasseur en loup";case l.BULLET_BOUNTYHUNTER:return"Tué par un chasseur de primes";case l.SHERIF:return"Abattu par le Shérif";case l.OTHER_AGENT:return"Éliminé par l'Agent";case l.AVENGER:return"Tué par un vengeur";case l.SEER:return"Rôle deviné par un loup";case l.HANTED:return"Tué par une potion hantée";case l.ASSASSIN:return"Tué par une potion (Assassin)";case l.LOVER_DEATH:return"Mort par amoureux";case l.LOVER_DEATH_OWN:return"Tué par son amoureux";case l.BOMB:return"Mort dans une explosion";case l.CRUSHED:return"Écrasé";case l.STARVATION:return"Mort de faim";case l.STARVATION_AS_BEAST:return"Mort bestiale";case l.FALL:return"Mort de chute";case l.UNKNOWN:default:return"Mort inconnue"}}function q(h){switch(h){case l.SURVIVOR:return"Survivant";case l.VOTED:return"Mort aux votes";case l.BY_WOLF:return"Kill en Loup";case l.BY_WOLF_REZ:return"Kill en Loup ressuscité";case l.BY_WOLF_LOVER:return"Kill en Loup amoureux";case l.BY_ZOMBIE:return"Kill en Zombie";case l.BY_BEAST:return"Kill en Bête";case l.BY_AVATAR_CHAIN:return"Mort d'Avatar";case l.BULLET:return"Tir de Chasseur";case l.BULLET_HUMAN:return"Kill en Chasseur (sur humain)";case l.BULLET_WOLF:return"Kill en Chasseur (sur loup)";case l.BULLET_BOUNTYHUNTER:return"Kill en Chasseur de primes";case l.SHERIF:return"Kill en Shérif";case l.OTHER_AGENT:return"Kill en Agent";case l.AVENGER:return"Kill en Vengeur";case l.SEER:return"Kill en Devin";case l.HANTED:return"Kill avec Potion hantée";case l.ASSASSIN:return"Kill avec Potion (Assassin)";case l.LOVER_DEATH:return"Kill de son amoureux";case l.LOVER_DEATH_OWN:return"Kill de son propre amoureux";case l.BOMB:return"Explosion";case l.CRUSHED:return"Écrasement";case l.STARVATION:return"Famine";case l.STARVATION_AS_BEAST:return"Tuerie bestiale";case l.FALL:return"Chute mortelle";case l.UNKNOWN:default:return"Kill inconnu"}}function X(h){const g=new Set;h.forEach(s=>{s.PlayerStats.forEach(p=>{p.DeathType&&p.DeathType!==l.SURVIVOR&&p.DeathType!==""&&g.add(p.DeathType)})});const d=Array.from(g),u=[l.BY_WOLF,l.VOTED,l.BULLET,l.BULLET_HUMAN,l.BULLET_WOLF,l.BY_ZOMBIE,l.ASSASSIN,l.AVENGER,l.LOVER_DEATH,l.SURVIVOR];return[...u.filter(s=>d.includes(s)),...d.filter(s=>!u.includes(s)).sort()]}function Q(h,g){return h.PlayerStats.filter(d=>d.DeathType&&d.DeathType!==l.SURVIVOR&&d.DeathType!==""&&(d.DeathTiming||d.DeathType)).map(d=>{let u=null;if(d.KillerName){const s=h.PlayerStats.find(p=>p.Username===d.KillerName);s&&(u=K(s.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1}),s.MainRoleFinal&&s.MainRoleFinal!==s.MainRoleInitial&&(s.MainRoleFinal==="Loup"?u="Loup":s.MainRoleFinal==="Zombie"&&(u="Vaudou")))}return{playerName:d.Username,deathType:d.DeathType,killerName:d.KillerName,killerCamp:u}}).filter(d=>{if(!g||g==="Tous les camps")return!0;const u=h.PlayerStats.find(p=>p.Username===d.playerName);return u?K(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===g:!1})}function ee(h,g){const d=[];return h.PlayerStats.forEach(u=>{if(u.KillerName&&u.DeathType){if(u.DeathType===l.SURVIVOR||u.DeathType===l.VOTED||u.DeathType===l.STARVATION||u.DeathType===l.FALL||u.DeathType===l.BY_AVATAR_CHAIN||u.DeathType==="")return;const s=h.PlayerStats.find(f=>f.Username===u.KillerName);if(!s)return;let p=K(s.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});s.MainRoleFinal&&s.MainRoleFinal!==s.MainRoleInitial&&(s.MainRoleFinal==="Loup"?p="Loup":s.MainRoleFinal==="Zombie"&&(p="Vaudou")),d.push({killerName:u.KillerName,victimName:u.Username,deathType:u.DeathType,killerCamp:p})}}),g&&g!=="Tous les camps"?d.filter(u=>u.killerCamp===g):d}function te(h,g){if(h.length===0)return null;const d=h.filter(t=>!t.LegacyData||t.LegacyData.deathInformationFilled===!0);if(d.length===0)return null;const u=[],s={};d.forEach(t=>{Q(t,g).forEach(m=>{u.push({...m,gameId:t.Id})}),t.PlayerStats.forEach(m=>{const N=m.Username;(!g||g==="Tous les camps"||K(m.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===g)&&(s[N]=(s[N]||0)+1)})});const p=u.length,f=d.length,j=f>0?p/f:0,S={};u.forEach(t=>{S[t.deathType]=(S[t.deathType]||0)+1});const T=Object.entries(S).map(([t,i])=>({type:t,count:i||0,percentage:p>0?(i||0)/p*100:0})).sort((t,i)=>i.count-t.count),A={};d.forEach(t=>{ee(t,g).forEach(m=>{A[m.killerName]||(A[m.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),A[m.killerName].kills++,A[m.killerName].victims.add(m.victimName),A[m.killerName].killsByDeathType[m.deathType]=(A[m.killerName].killsByDeathType[m.deathType]||0)+1})});const D=Object.entries(A).map(([t,i])=>{const m=s[t]||0,N=m>0?i.kills/m:0;return{killerName:t,kills:i.kills,victims:Array.from(i.victims),percentage:p>0?i.kills/p*100:0,gamesPlayed:m,averageKillsPerGame:N,killsByDeathType:i.killsByDeathType}}).sort((t,i)=>i.kills-t.kills),b={};u.forEach(t=>{b[t.playerName]||(b[t.playerName]={totalDeaths:0,deathsByType:{},killedBy:{},deathDays:[]});const i=b[t.playerName];i.totalDeaths++,i.deathsByType[t.deathType]=(i.deathsByType[t.deathType]||0)+1,t.killerName&&(i.killedBy[t.killerName]=(i.killedBy[t.killerName]||0)+1)});const E=[];Object.entries(b).forEach(([t,i])=>{E.push({playerName:t,totalDeaths:i.totalDeaths,deathsByType:i.deathsByType,killedBy:i.killedBy,deathRate:s[t]>0?i.totalDeaths/s[t]:0,gamesPlayed:s[t]||0})}),Object.entries(s).forEach(([t,i])=>{b[t]||E.push({playerName:t,totalDeaths:0,deathsByType:{},killedBy:{},deathRate:0,gamesPlayed:i})});const y=E.sort((t,i)=>i.totalDeaths-t.totalDeaths),a=T.length>0?T[0].type:null,n=D.length>0?D[0].killerName:null;return{totalDeaths:p,totalGames:f,averageDeathsPerGame:j,deathsByType:T,killerStats:D,playerDeathStats:y,mostCommonDeathType:a,mostDeadlyKiller:n}}function re(h,g){const d=h.filter(T=>!T.LegacyData||T.LegacyData.deathInformationFilled===!0),u={},s=d.length,p=[l.BULLET,l.BULLET_HUMAN,l.BULLET_WOLF,l.BULLET_BOUNTYHUNTER];d.forEach(T=>{const A=new Set;T.PlayerStats.forEach(D=>{const b=D.MainRoleInitial,E=D.MainRoleFinal;(b==="Chasseur"||E==="Chasseur")&&(A.add(D.Username),u[D.Username]||(u[D.Username]={kills:[],gamesPlayed:0,victimsCamps:[]}),u[D.Username].gamesPlayed++)}),T.PlayerStats.forEach(D=>{const b=D.DeathType,E=D.KillerName;if(b&&p.includes(b)&&E&&A.has(E)){const y=K(D.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});u[E].kills.push(b),u[E].victimsCamps.push(y)}})});const f=Object.entries(u).map(([T,A])=>{const D=A.kills.length,b={};A.kills.forEach(i=>{b[i]=(b[i]||0)+1});const E={};A.victimsCamps.forEach(i=>{E[i]=(E[i]||0)+1});const y=A.victimsCamps.filter(i=>i!=="Villageois").length,a=A.victimsCamps.filter(i=>i==="Villageois").length,n=A.gamesPlayed>0?D/A.gamesPlayed:0,t=A.gamesPlayed>0?y/A.gamesPlayed:0;return{hunterName:T,totalKills:D,nonVillageoisKills:y,villageoisKills:a,gamesPlayedAsHunter:A.gamesPlayed,averageKillsPerGame:n,averageNonVillageoisKillsPerGame:t,killsByDeathType:b,victimsByCamp:E}}).sort((T,A)=>A.totalKills-T.totalKills),j=f.length>0?f[0].hunterName:null,S=f.length>0?f.sort((T,A)=>A.averageNonVillageoisKillsPerGame-T.averageNonVillageoisKillsPerGame)[0].hunterName:null;return{totalHunters:f.length,totalGames:s,hunterStats:f,bestHunter:j,bestAverageHunter:S}}function ie(h){return I(g=>te(g,h))}function ae(){return I(h=>J(h))}function se(h){return I(g=>re(g))}function le({deathStats:h,selectedCamp:g,minGamesForAverage:d,onMinGamesChange:u,availableDeathTypes:s,deathTypeColors:p,totalEligibleForAverage:f}){const{navigateToGameDetails:j}=F(),{settings:S}=_(),{totalKillsData:T,averageKillsData:A,highlightedPlayerAddedToTotal:D,highlightedPlayerAddedToAverage:b}=R.useMemo(()=>{if(!h)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const a=h.killerStats.sort((r,o)=>o.kills-r.kills).slice(0,15),n=S.highlightedPlayer&&a.some(r=>r.killerName===S.highlightedPlayer),t=a.map(r=>{const o={name:r.killerName,value:r.kills,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!1};return s.forEach(v=>{o[v]=r.killsByDeathType[v]||0}),o});let i=!1;if(S.highlightedPlayer&&!n){const r=h.killerStats.find(o=>o.killerName===S.highlightedPlayer);if(r){const o={name:r.killerName,value:r.kills,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!0};s.forEach(v=>{o[v]=r.killsByDeathType[v]||0}),t.push(o),i=!0}}const N=h.killerStats.filter(r=>r.gamesPlayed>=d).sort((r,o)=>o.averageKillsPerGame-r.averageKillsPerGame).slice(0,15),P=S.highlightedPlayer&&N.some(r=>r.killerName===S.highlightedPlayer),B=N.map(r=>{const o={name:r.killerName,value:r.averageKillsPerGame,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!1};return s.forEach(v=>{const x=r.killsByDeathType[v]||0;o[v]=r.gamesPlayed>0?x/r.gamesPlayed:0}),o});let c=!1;if(S.highlightedPlayer&&!P){const r=h.killerStats.find(o=>o.killerName===S.highlightedPlayer);if(r){const o={name:r.killerName,value:r.averageKillsPerGame,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!0};s.forEach(v=>{const x=r.killsByDeathType[v]||0;o[v]=r.gamesPlayed>0?x/r.gamesPlayed:0}),B.push(o),c=!0}}return{totalKillsData:t,averageKillsData:B,highlightedPlayerAddedToTotal:i,highlightedPlayerAddedToAverage:c}},[h,S.highlightedPlayer,d,s]),E=({active:a,payload:n,label:t})=>{if(a&&n&&n.length){const i=n[0].payload,m=i.isHighlightedAddition,N=S.highlightedPlayer===i.name,P=s.reduce((B,c)=>B+(i[c]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[t,m&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",P]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),s.map(B=>{const c=i[B]||0;return c===0?null:e.jsxs("p",{style:{color:p[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[q(B),":"]})," ",c]},B)})]}),m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),N&&!m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},y=({active:a,payload:n,label:t})=>{if(a&&n&&n.length){const i=n[0].payload,m=i.isHighlightedAddition,N=S.highlightedPlayer===i.name,P=i.gamesPlayed>=d,B=h?.killerStats.find(o=>o.killerName===i.name),c=s.reduce((o,v)=>o+(i[v]||0),0),r=B?B.kills:Math.round(c*i.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[t,m&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",c.toFixed(2)," (",r," kills /",i.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),s.map(o=>{const v=i[o]||0;if(v===0)return null;const x=B?B.killsByDeathType[o]||0:Math.round(v*i.gamesPlayed);return e.jsxs("p",{style:{color:p[o],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[q(o),":"]})," ",v.toFixed(2)," (",x," kills /",i.gamesPlayed," games)"]},o)})]}),m&&!P&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",d," parties)"]}),m&&P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),N&&!m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:g==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${g} (Total)`}),D&&S.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',S.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:g==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${g} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:n,payload:t})=>e.jsx("text",{x:a,y:n,dy:10,fill:S.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:S.highlightedPlayer===t.value?14:12,fontWeight:S.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${n})`,children:t.value})}),e.jsx(V,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(E,{})}),s.map(a=>e.jsx(z,{dataKey:a,name:a,stackId:"kills",fill:p[a],onClick:n=>{const t={selectedPlayer:n?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(t.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),j(t)}},a))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(a=>!a.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:g==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${g} (Moyenne par partie)`}),b&&S.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',S.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:d,onChange:a=>u(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx(k,{title:g==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${g} (Moyenne par partie)`,children:e.jsx("div",{style:{height:400},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:A,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:n,payload:t})=>e.jsx("text",{x:a,y:n,dy:10,fill:S.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:S.highlightedPlayer===t.value?14:12,fontWeight:S.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${n})`,children:t.value})}),e.jsx(V,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(y,{})}),s.map(a=>e.jsx(z,{dataKey:a,name:a,stackId:"averageKills",fill:p[a],onClick:n=>{const t={selectedPlayer:n?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(t.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),j(t)}},a))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,A.filter(a=>!a.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",f," ayant au moins ",d," partie",d>1?"s":"",")"]})]})]})}function ne({deathStats:h,selectedCamp:g,minGamesForAverage:d,onMinGamesChange:u,availableDeathTypes:s,deathTypeColors:p}){const{navigateToGameDetails:f}=F(),{settings:j}=_(),{totalDeathsData:S,survivalRateData:T,highlightedPlayerAddedToDeaths:A,highlightedPlayerAddedToSurvival:D}=R.useMemo(()=>{if(!h)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const y=h.playerDeathStats.sort((c,r)=>r.totalDeaths-c.totalDeaths).slice(0,15),a=j.highlightedPlayer&&y.some(c=>c.playerName===j.highlightedPlayer),n=y.map(c=>{const r=c.gamesPlayed,o=r>0?(r-c.totalDeaths)/r*100:0,v={name:c.playerName,value:c.totalDeaths,totalDeaths:c.totalDeaths,gamesPlayed:r,deathRate:c.deathRate,survivalRate:o,isHighlightedAddition:!1};return s.forEach(x=>{v[x]=c.deathsByType[x]||0}),v});let t=!1;if(j.highlightedPlayer&&!a){const c=h.playerDeathStats.find(r=>r.playerName===j.highlightedPlayer);if(c){const r=c.gamesPlayed,o=r>0?(r-c.totalDeaths)/r*100:0,v={name:c.playerName,value:c.totalDeaths,totalDeaths:c.totalDeaths,gamesPlayed:r,deathRate:c.deathRate,survivalRate:o,isHighlightedAddition:!0};s.forEach(x=>{v[x]=c.deathsByType[x]||0}),n.push(v),t=!0}}const m=h.playerDeathStats.filter(c=>c.gamesPlayed>=d).map(c=>({...c,survivalRate:c.gamesPlayed>0?(c.gamesPlayed-c.totalDeaths)/c.gamesPlayed*100:0})).sort((c,r)=>r.survivalRate-c.survivalRate).slice(0,15),N=j.highlightedPlayer&&m.some(c=>c.playerName===j.highlightedPlayer),P=m.map(c=>{const r={name:c.playerName,value:c.survivalRate,totalDeaths:c.totalDeaths,gamesPlayed:c.gamesPlayed,deathRate:c.deathRate,survivalRate:c.survivalRate,isHighlightedAddition:!1};return s.forEach(o=>{const v=c.deathsByType[o]||0;r[o]=c.gamesPlayed>0?v/c.gamesPlayed*100:0}),r});let B=!1;if(j.highlightedPlayer&&!N){const c=h.playerDeathStats.find(r=>r.playerName===j.highlightedPlayer);if(c){const r=c.gamesPlayed>0?(c.gamesPlayed-c.totalDeaths)/c.gamesPlayed*100:0,o={name:c.playerName,value:r,totalDeaths:c.totalDeaths,gamesPlayed:c.gamesPlayed,deathRate:c.deathRate,survivalRate:r,isHighlightedAddition:!0};s.forEach(v=>{const x=c.deathsByType[v]||0;o[v]=c.gamesPlayed>0?x/c.gamesPlayed*100:0}),P.push(o),B=!0}}return{totalDeathsData:n,survivalRateData:P,highlightedPlayerAddedToDeaths:t,highlightedPlayerAddedToSurvival:B}},[h,j.highlightedPlayer,d,s]),b=({active:y,payload:a,label:n})=>{if(y&&a&&a.length){const t=a[0].payload,i=t.isHighlightedAddition,m=j.highlightedPlayer===t.name,N=s.reduce((P,B)=>P+(t[B]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:m?"var(--accent-primary)":"var(--text-primary)"},children:[n,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",N]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",t.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",t.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),s.map(P=>{const B=t[P]||0;return B===0?null:e.jsxs("p",{style:{color:p[P],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[G(P),":"]})," ",B]},P)})]}),i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),m&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},E=({active:y,payload:a,label:n})=>{if(y&&a&&a.length){const t=a[0].payload,i=t.isHighlightedAddition,m=j.highlightedPlayer===t.name,N=t.gamesPlayed>=d;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:m?"var(--accent-primary)":"var(--text-primary)"},children:[n,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",t.survivalRate.toFixed(1),"% (",t.gamesPlayed-t.totalDeaths," survies / ",t.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",t.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",t.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),s.map(P=>{const B=t[P]||0;return B===0?null:e.jsxs("p",{style:{color:p[P],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[G(P),":"]})," ",B.toFixed(1),"%"]},P)})]}),i&&!N&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",d," parties)"]}),i&&N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),m&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:g==="Tous les camps"?"Morts (Total)":`Morts en ${g} (Total)`}),A&&j.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',j.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:g==="Tous les camps"?"Morts (Total)":`Morts en ${g} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:S,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:y,y:a,payload:n})=>e.jsx("text",{x:y,y:a,dy:10,fill:j.highlightedPlayer===n.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:j.highlightedPlayer===n.value?14:12,fontWeight:j.highlightedPlayer===n.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${y} ${a})`,children:n.value})}),e.jsx(V,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(b,{})}),s.map(y=>e.jsx(z,{dataKey:y,name:y,stackId:"deaths",fill:p[y],onClick:a=>{const n={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(n.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),f(n)}},y))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,S.filter(y=>!y.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",g==="Tous les camps"?"(Total)":` en ${g}`]}),D&&j.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',j.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:d,onChange:y=>u(Number(y.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(y=>e.jsx("option",{value:y,children:y},y))})]}),e.jsx(k,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:y,y:a,payload:n})=>e.jsx("text",{x:y,y:a,dy:10,fill:j.highlightedPlayer===n.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:j.highlightedPlayer===n.value?14:12,fontWeight:j.highlightedPlayer===n.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${y} ${a})`,children:n.value})}),e.jsx(V,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(E,{})}),s.map(y=>e.jsx(z,{dataKey:y,name:y,stackId:"survivalRate",fill:p[y],onClick:a=>{const n={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(n.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),f(n)}},y))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(y=>!y.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",d," partie",d>1?"s":"",")"]})]})]})}function oe({hunterStats:h,isLoading:g,error:d}){const{navigateToGameDetails:u}=F(),{settings:s}=_(),p=w(),f=Z(),[j,S]=R.useState(null);if(g)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(d)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",d]});if(!h||h.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnée Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:T,highlightedPlayerAddedToBest:A,finalBadHuntersData:D,highlightedPlayerAddedToBad:b}=(()=>{const n=h.hunterStats.filter(o=>o.gamesPlayedAsHunter>=5).sort((o,v)=>v.averageNonVillageoisKillsPerGame-o.averageNonVillageoisKillsPerGame).slice(0,15),t=s.highlightedPlayer&&n.some(o=>o.hunterName===s.highlightedPlayer);let i=[...n],m=!1;if(s.highlightedPlayer&&!t){const o=h.hunterStats.find(v=>v.hunterName===s.highlightedPlayer);o&&(i.push({...o,isHighlightedAddition:!0}),m=!0)}const N=h.hunterStats.filter(o=>o.gamesPlayedAsHunter>=5).map(o=>({name:o.hunterName,averageVillageoisKills:Number((o.villageoisKills/o.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:o.villageoisKills,totalNonVillageoisKills:o.nonVillageoisKills,totalKills:o.totalKills,gamesPlayed:o.gamesPlayedAsHunter,victimsByCamp:o.victimsByCamp,hunterName:o.hunterName})),P=N.sort((o,v)=>v.averageVillageoisKills-o.averageVillageoisKills).slice(0,15),B=s.highlightedPlayer&&P.some(o=>o.hunterName===s.highlightedPlayer);let c=[...P],r=!1;if(s.highlightedPlayer&&!B){const o=N.find(v=>v.hunterName===s.highlightedPlayer);o&&(c.push({...o,isHighlightedAddition:!0}),r=!0)}return{finalBestHuntersData:i,highlightedPlayerAddedToBest:m,finalBadHuntersData:c,highlightedPlayerAddedToBad:r}})(),E=({active:a,payload:n,label:t})=>{if(a&&n&&n.length){const i=n[0].payload,m=i.isHighlightedAddition,N=s.highlightedPlayer===i.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[t,m&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",i.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tués:"})," ",i.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",i.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",i.totalKills]}),i.victimsByCamp&&Object.keys(i.victimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Victimes par camp:"}),Object.entries(i.victimsByCamp).map(([P,B])=>e.jsxs("p",{style:{color:p[P]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[P,":"]})," ",B]},P))]}),m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),N&&!m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},y=({active:a,payload:n,label:t})=>{if(a&&n&&n.length){const i=n[0].payload,m=i.isHighlightedAddition,N=s.highlightedPlayer===i.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[t,m&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tués/partie:"})," ",i.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tués:"})," ",i.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tués:"})," ",i.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",i.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",i.totalKills]}),i.victimsByCamp&&Object.keys(i.victimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Victimes par camp:"}),Object.entries(i.victimsByCamp).map(([P,B])=>e.jsxs("p",{style:{color:p[P]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[P,":"]})," ",B]},P))]}),m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),N&&!m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Meilleurs Chasseurs"}),A&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',s.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:"Meilleurs Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:n,payload:t})=>e.jsx("text",{x:a,y:n,dy:10,fill:s.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===t.value?14:12,fontWeight:s.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${n})`,children:t.value})}),e.jsx(V,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(E,{})}),e.jsx(z,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:a=>{a?.hunterName&&u({selectedPlayer:a.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Meilleurs Chasseurs"})},onMouseEnter:a=>S(a?.hunterName||null),onMouseLeave:()=>S(null),style:{cursor:"pointer"},children:T.map((a,n)=>{const t=s.highlightedPlayer===a.hunterName,i=a.isHighlightedAddition;return e.jsx(W,{fill:f[a.hunterName]||p.Chasseur||"#8884d8",stroke:t?"var(--accent-primary)":j===a.hunterName?"var(--text-primary)":"none",strokeWidth:t?3:j===a.hunterName?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1},`cell-${n}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(a=>!a.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),b&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',s.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:D,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:n,payload:t})=>e.jsx("text",{x:a,y:n,dy:10,fill:s.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===t.value?14:12,fontWeight:s.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${n})`,children:t.value})}),e.jsx(V,{label:{value:"Moyenne Villageois tués/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(O,{content:e.jsx(y,{})}),e.jsx(z,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:a=>{a?.hunterName&&u({selectedPlayer:a.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:a=>S(a?.hunterName||null),onMouseLeave:()=>S(null),style:{cursor:"pointer"},children:D.map((a,n)=>{const t=s.highlightedPlayer===a.hunterName,i=a.isHighlightedAddition;return e.jsx(W,{fill:f[a.hunterName]||p.Chasseur||"#8884d8",stroke:t?"var(--accent-primary)":j===a.hunterName?"var(--text-primary)":"none",strokeWidth:t?3:j===a.hunterName?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1},`cell-${n}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,D.filter(a=>!a.isHighlightedAddition).length)," des chasseurs ayant le plus tué de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function pe(){const{navigationState:h,updateNavigationState:g}=F(),[d,u]=R.useState(h.deathStatisticsState?.selectedCamp||h.deathStatsSelectedCamp||"Tous les camps"),[s,p]=R.useState(h.deathStatisticsState?.minGamesForAverage||10),[f,j]=R.useState(h.deathStatisticsState?.selectedView||"killers"),{data:S}=ae(),{data:T,isLoading:A,error:D}=ie(d),{data:b,isLoading:E,error:y}=se(),{data:a}=$(),n=w();R.useEffect(()=>{(!h.deathStatisticsState||h.deathStatisticsState.selectedCamp!==d||h.deathStatisticsState.minGamesForAverage!==s||h.deathStatisticsState.selectedView!==f)&&g({deathStatisticsState:{selectedCamp:d,minGamesForAverage:s,selectedView:f,focusChart:h.deathStatisticsState?.focusChart}})},[d,s,f,h.deathStatisticsState,g]);const t=R.useMemo(()=>a?X(a):[],[a]),i=R.useMemo(()=>{const r={};t.forEach(x=>{x===l.BY_WOLF||x===l.BY_WOLF_REZ||x===l.BY_WOLF_LOVER?r[x]=n.Loup:x===l.VOTED?r[x]="var(--chart-color-1)":x===l.BULLET||x===l.BULLET_BOUNTYHUNTER||x===l.BULLET_HUMAN||x===l.BULLET_WOLF?r[x]=n.Chasseur:x===l.BY_ZOMBIE?r[x]=n.Vaudou:x===l.ASSASSIN?r[x]=n.Alchimiste:x===l.AVENGER?r[x]="var(--chart-color-2)":x===l.LOVER_DEATH||x===l.LOVER_DEATH_OWN?r[x]=n.Amoureux:x===l.BY_BEAST?r[x]="var(--chart-color-3)":x===l.SURVIVOR?r[x]="var(--chart-color-4)":x===l.SHERIF&&(r[x]="var(--chart-color-5)")});const o=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let v=0;return t.forEach(x=>{r[x]||(r[x]=o[v%o.length],v++)}),r},[t,n]),m=r=>{u(r),g({deathStatsSelectedCamp:r,deathStatisticsState:{selectedCamp:r,minGamesForAverage:s,selectedView:f,focusChart:h.deathStatisticsState?.focusChart}})},N=r=>{p(r),g({deathStatisticsState:{selectedCamp:d,minGamesForAverage:r,selectedView:f,focusChart:h.deathStatisticsState?.focusChart}})},P=r=>{j(r),g({deathStatisticsState:{selectedCamp:d,minGamesForAverage:s,selectedView:r,focusChart:h.deathStatisticsState?.focusChart}})},{gamesWithKillers:B,totalEligibleForAverage:c}=R.useMemo(()=>{if(!T)return{gamesWithKillers:0,totalEligibleForAverage:0};const r=T.killerStats.filter(o=>o.gamesPlayed>=s);return{gamesWithKillers:T.totalGames,totalEligibleForAverage:r.length}},[T,s]);return A?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):D?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",D]}):T?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${f==="killers"?"active":""}`,onClick:()=>P("killers"),children:"Tueurs"}),e.jsx("button",{className:`lycans-categorie-btn ${f==="deaths"?"active":""}`,onClick:()=>P("deaths"),children:"Morts"}),e.jsx("button",{className:`lycans-categorie-btn ${f==="hunter"?"active":""}`,onClick:()=>P("hunter"),children:"Chasseur"})]}),(f==="killers"||f==="deaths")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:d,onChange:r=>m(r.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),S?.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),(f==="killers"||f==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:T.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:T.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:B})]})]}),f==="killers"&&e.jsx(le,{deathStats:T,selectedCamp:d,minGamesForAverage:s,onMinGamesChange:N,availableDeathTypes:t,deathTypeColors:i,totalEligibleForAverage:c}),f==="deaths"&&e.jsx(ne,{deathStats:T,selectedCamp:d,minGamesForAverage:s,onMinGamesChange:N,availableDeathTypes:t,deathTypeColors:i}),f==="hunter"&&e.jsx(oe,{hunterStats:b,isLoading:E,error:y}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"})}export{pe as DeathStatisticsChart};
