import{u as T,r as m,j as e}from"./index-CeJOCtb3.js";import{u as G}from"./usePlayerCampPerformance-Bgf7HZw0.js";import{l as j}from"./api-BkgNdDCZ.js";import{R as v,p as g,T as f,B as D,C as S,X as E,Y as F,o as W}from"./BarChart-OQUaB-1V.js";import{P as R,a as w}from"./PieChart-D-xP_8fc.js";import{L as $}from"./Legend-CTcV6y4k.js";function L(){const{combinedData:l,isLoading:h,error:u}=T();return{campWinStats:l&&l.campWinStats?l.campWinStats:null,isLoading:h,errorInfo:u}}const _="#607D8B";function I(){const{campWinStats:l,isLoading:h,errorInfo:u}=L(),{playerCampPerformance:c,isLoading:N,error:C}=G(),o=m.useMemo(()=>c?.campAverages?c.campAverages.map(s=>({...s,winRateNum:parseFloat(s.winRate)})).sort((s,a)=>a.winRateNum-s.winRateNum):[],[c]),p=m.useMemo(()=>l?.campStats?.map(s=>({...s,winRateNum:typeof s.winRate=="string"?parseFloat(s.winRate):s.winRate}))||[],[l]),x=m.useMemo(()=>{if(!p.length)return[];const s=5;let a=0;const r=[],n=[];return p.forEach(t=>{t.winRateNum<s?(a+=t.winRateNum,r.push(t)):n.push(t)}),a>0&&n.push({camp:"Autres",wins:r.reduce((t,i)=>t+i.wins,0),winRate:a.toFixed(1),winRateNum:a,_details:r}),n},[p]),b=m.useMemo(()=>{if(!o.length)return[];const s=5,a=o.reduce((i,d)=>i+d.totalGames,0);let r=0;const n=[],t=[];if(o.forEach(i=>{const d=i.totalGames/a*100;d<s?(r+=i.totalGames,n.push({...i,winRate:d.toFixed(1)})):t.push(i)}),r>0){const i=n.length>0?(n.reduce((d,P)=>d+P.winRateNum,0)/n.length).toFixed(1):"0.0";t.push({camp:"Autres",totalGames:r,winRate:i,winRateNum:parseFloat(i),_details:n})}return t},[o]),A=h||N,y=u||C;return A?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques des camps..."}):y?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",y]}):!l&&!c?e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de camp disponible"}):e.jsxs("div",{className:"lycans-camps-container",children:[e.jsx("h2",{children:"Statistiques des Camps"}),c&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Camps Analysés"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.campAverages.length}),e.jsx("p",{children:"camps différents"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Joueurs Évalués"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.playerPerformance.length}),e.jsx("p",{children:"joueurs analysés"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale",children:l?.totalGames||0}),e.jsx("p",{children:"parties analysées"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[l&&x.length>0&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Répartition des Victoires par Camp"}),e.jsxs("p",{className:"lycans-stats-info",children:["Distribution des victoires sur ",l.totalGames," parties"]}),e.jsx("div",{style:{height:450},children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(R,{children:[e.jsx(w,{data:x,cx:"50%",cy:"50%",labelLine:!1,outerRadius:140,fill:"#8884d8",dataKey:"winRateNum",nameKey:"camp",label:({camp:s,winRate:a})=>s==="Autres"?"Autres":`${s}: ${a}%`,children:x.map((s,a)=>e.jsx(g,{fill:s.camp==="Autres"?"#cccccc":j[s.camp]||_},`cellule-camp-${a}`))}),e.jsx(f,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;if(r.camp==="Autres"&&r._details){const n=[...r._details].sort((t,i)=>i.winRateNum-t.winRateNum);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:"Autres"})}),e.jsx("div",{children:n.map((t,i)=>e.jsxs("div",{children:[t.camp,": ",t.wins," victoires (",t.winRate,"%)"]},i))}),e.jsxs("div",{style:{marginTop:4,fontWeight:"bold"},children:["Total: ",r.wins," victoires (",r.winRate,"%)"]})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:r.camp}),e.jsxs("div",{children:["Victoires: ",r.wins]}),e.jsxs("div",{children:["Taux de victoire: ",r.winRate,"%"]})]})}return null}}),e.jsx($,{})]})})})]})}),c&&o.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Taux de Victoire Moyen par Camp"}),e.jsx("div",{style:{height:400},children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(D,{data:o,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(S,{strokeDasharray:"3 3"}),e.jsx(E,{dataKey:"camp",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(F,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(f,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.camp})}),e.jsxs("div",{children:["Parties totales: ",r.totalGames]}),e.jsxs("div",{children:["Taux de victoire: ",r.winRate,"%"]})]})}return null}}),e.jsx(W,{dataKey:"winRateNum",children:o.map((s,a)=>e.jsx(g,{fill:j[s.camp]||`var(--chart-color-${a%6+1})`},`cell-${a}`))})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Parties par Camp"}),e.jsx("div",{style:{height:400},children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(R,{children:[e.jsx(w,{data:b,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"totalGames",label:({camp:s,totalGames:a,percent:r})=>s==="Autres"?"Autres":`${s}: ${a} (${((r!==void 0?r:0)*100).toFixed(1)}%)`,children:b.map((s,a)=>e.jsx(g,{fill:s.camp==="Autres"?"#cccccc":j[s.camp]||`var(--chart-color-${a%6+1})`},`cell-${a}`))}),e.jsx(f,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;if(r.camp==="Autres"&&r._details){const n=[...r._details].sort((t,i)=>i.totalGames-t.totalGames);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:"Autres"})}),e.jsx("div",{children:n.map((t,i)=>e.jsxs("div",{children:[t.camp,": ",t.totalGames," parties"]},i))}),e.jsxs("div",{style:{marginTop:4,fontWeight:"bold"},children:["Total: ",r.totalGames," parties"]})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.camp})}),e.jsxs("div",{children:["Parties: ",r.totalGames]}),e.jsxs("div",{children:["Taux victoire: ",r.winRate,"%"]})]})}return null}})]})})})]})]})]})]})}export{I as CampsChart};
