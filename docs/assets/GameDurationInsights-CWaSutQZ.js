import{r as S,u as K,j as e}from"./index-Dkohcs-_.js";import{a as $,u as V}from"./baseStatsHook-LepSzusV.js";import{g as w}from"./gameUtils-rkfcKAVy.js";import{a as O,c as Y}from"./datasyncExport-BirWLS1z.js";import{b as U,l as X,g as E}from"./api-DaXuUoL6.js";import{b as H,F as v,C as G,X as C,Y as b,a as P}from"./FullscreenChart-Ckwx9wWr.js";import{a as Q,b as B,f as q}from"./durationFormatters-C9UyWcKX.js";import{a5 as Z,R as D,T as N,a6 as _}from"./CategoricalChart-CG0hV8zE.js";import{B as I,a as M}from"./BarChart-BbN1p2sU.js";import{L as ee,a as R}from"./LineChart-B66vn4iS.js";import{P as te,a as ae}from"./PieChart-DXF3JFGn.js";import{L as re}from"./Legend-DyVLF-mm.js";import"./ActivePoints-DJQP5IRq.js";import"./PolarChart-BQwa3NYz.js";var ie=["axis"],ne=S.forwardRef((a,i)=>S.createElement(H,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ie,tooltipPayloadSearcher:Z,categoricalChartProps:a,ref:i}));function W(a){const i=Math.floor(a/3600),n=Math.floor(a%3600/60),r=a%60;return i>0?`${i}h${n.toString().padStart(2,"0")}m${r.toString().padStart(2,"0")}s`:n>0?`${n}m${r.toString().padStart(2,"0")}s`:`${r}s`}function se(a,i=10){const n=Math.round(a/60);return Math.round(n/i)*i}function oe(){return{averageDuration:"0s",maxDuration:0,minDuration:1/0,maxDurationGameId:null,minDurationGameId:null,durationDistribution:{},durationsByWinnerCamp:{},durationsByPlayerCount:{},durationsByWolfRatio:{},totalGameTime:"0s",totalPlayerTime:"0s"}}function le(a,i,n){a>n.maxDuration&&(n.maxDuration=a,n.maxDurationGameId=i),a<n.minDuration&&(n.minDuration=a,n.minDurationGameId=i)}function ce(a,i){const n=se(a,2);i[n]||(i[n]=0),i[n]++}function ue(a,i,n){a&&a.trim()!==""&&(n[a]||(n[a]={totalDuration:0,count:0,average:"0s"}),n[a].totalDuration+=i,n[a].count++)}function de(a,i,n){if(a&&!isNaN(a)&&a>0){const r=a.toString();n[r]||(n[r]={totalDuration:0,count:0,average:"0s"}),n[r].totalDuration+=i,n[r].count++}}function me(a,i,n,r){if(a&&i&&!isNaN(a)&&!isNaN(i)&&a>0){const l=a-i;if(l>0){const m=Math.round(i/l*100),h=(Math.round(m/1)*1).toString();r[h]||(r[h]={totalDuration:0,count:0,average:"0s"}),r[h].totalDuration+=n,r[h].count++}}}function he(a,i,n){const r=a.PlayerStats.length,l=a.PlayerStats.filter(h=>O(h.MainRoleInitial,h.MainRoleChanges||[])==="Loup").length;let m=w(a);const u=Y(a.StartDate,a.EndDate);u&&!isNaN(u)&&u>0&&(n.gamesWithDuration++,n.totalDuration+=u,n.totalPlayerTime+=u*r,le(u,a.DisplayedId,i),ce(u,i.durationDistribution),ue(m,u,i.durationsByWinnerCamp),de(r,u,i.durationsByPlayerCount),me(r,l,u,i.durationsByWolfRatio))}function pe(a,i){if(i.gamesWithDuration>0){const n=i.totalDuration/i.gamesWithDuration;a.averageDuration=W(Math.round(n)),a.totalGameTime=W(Math.round(i.totalDuration)),a.totalPlayerTime=W(Math.round(i.totalPlayerTime)),Object.keys(a.durationsByWinnerCamp).forEach(r=>{const l=a.durationsByWinnerCamp[r];if(l.count>0){const m=l.totalDuration/l.count;l.average=W(Math.round(m))}}),Object.keys(a.durationsByPlayerCount).forEach(r=>{const l=a.durationsByPlayerCount[r];if(l.count>0){const m=l.totalDuration/l.count;l.average=W(Math.round(m))}}),Object.keys(a.durationsByWolfRatio).forEach(r=>{const l=a.durationsByWolfRatio[r];if(l.count>0){const m=l.totalDuration/l.count;l.average=W(Math.round(m))}})}}function ge(a){const i=Object.keys(a).map(n=>({duration:parseInt(n),count:a[parseInt(n)]}));return i.sort((n,r)=>n.duration-r.duration),i}function ye(a){if(a.length===0)return null;const i=oe(),n={totalDuration:0,gamesWithDuration:0,totalPlayerTime:0};a.forEach(l=>{he(l,i,n)}),pe(i,n);const r=ge(i.durationDistribution);return{averageDuration:i.averageDuration,maxDuration:i.maxDuration,minDuration:i.minDuration===1/0?0:i.minDuration,maxDurationGameId:i.maxDurationGameId,minDurationGameId:i.minDurationGameId,durationDistribution:r,durationsByWinnerCamp:i.durationsByWinnerCamp,durationsByPlayerCount:i.durationsByPlayerCount,durationsByWolfRatio:i.durationsByWolfRatio,totalGameTime:i.totalGameTime,totalPlayerTime:i.totalPlayerTime}}function xe(){const{data:a,isLoading:i,error:n}=$(ye);return{durationAnalysis:a,fetchingData:i,apiError:n}}function k(a){if(!a||a.trim()==="")return null;const i=a.trim(),n=i.charAt(0).toUpperCase(),r=i.slice(1),l=parseInt(r,10);return!["J","N","M"].includes(n)||isNaN(l)||l<1?null:{phase:n,dayNumber:l,originalTiming:i,phaseLabel:{J:"Jour",N:"Nuit",M:"Meeting"}[n]}}function J(a){const i={J:0,N:.33,M:.67};return a.dayNumber+i[a.phase]}function fe(a){if(!a||a.length===0)return{totalGames:0,gamesWithEndTiming:0,averageGameLength:0,endTimingDistribution:[],phaseDistribution:[],dayDistribution:[],longestGame:null,shortestGame:null};const i=a.length;let n=0,r=0,l=null,m=null;const u={},h={},x={};a.forEach(d=>{const c=k(d.EndTiming);if(c){n++,r+=c.dayNumber;const g=J(c);(!l||g>J(k(l.endTiming)))&&(l={gameId:d.DisplayedId,endTiming:c.originalTiming,dayNumber:c.dayNumber}),(!m||g<J(k(m.endTiming)))&&(m={gameId:d.DisplayedId,endTiming:c.originalTiming,dayNumber:c.dayNumber});const A=c.originalTiming;u[A]=(u[A]||0)+1;const t=c.phaseLabel;h[t]||(h[t]={count:0,totalDays:0}),h[t].count++,h[t].totalDays+=c.dayNumber;const s=c.dayNumber;x[s]||(x[s]={count:0,phases:{}}),x[s].count++,x[s].phases[t]=(x[s].phases[t]||0)+1}});const f=n>0?r/n:0,T=Object.entries(u).map(([d,c])=>{const g=k(d);return{timing:d,phase:g?.phaseLabel||"Unknown",dayNumber:g?.dayNumber||0,count:c,percentage:c/n*100}}).sort((d,c)=>{if(d.dayNumber!==c.dayNumber)return d.dayNumber-c.dayNumber;const g={Jour:0,Nuit:1,Meeting:2};return(g[d.phase]||3)-(g[c.phase]||3)}),F=Object.entries(h).map(([d,c])=>({phase:d,count:c.count,percentage:c.count/n*100,averageDay:c.count>0?c.totalDays/c.count:0})).sort((d,c)=>c.count-d.count),L=Object.entries(x).map(([d,c])=>({dayNumber:parseInt(d,10),count:c.count,percentage:c.count/n*100,phases:c.phases})).sort((d,c)=>d.dayNumber-c.dayNumber);return{totalGames:i,gamesWithEndTiming:n,averageGameLength:f,endTimingDistribution:T,phaseDistribution:F,dayDistribution:L,longestGame:l,shortestGame:m}}function je(){const{data:a,isLoading:i,error:n}=V(r=>fe(r));return{gameTimeAnalysis:a,fetchingData:i,apiError:n}}function ve(a){if(!a||a.length===0)return null;const i=new Map;return a.forEach(r=>{if(!r.EndTiming)return;const l=r.EndTiming.match(/^[JNM](\d+)$/);if(!l)return;const m=parseInt(l[1],10);if(isNaN(m))return;i.has(m)||i.set(m,{villageoisWins:0,loupsWins:0,soloWins:0,totalGames:0});const u=i.get(m);u.totalGames++;const h=w(r);h==="Villageois"?u.villageoisWins++:h==="Loup"?u.loupsWins++:u.soloWins++}),Array.from(i.entries()).map(([r,l])=>({day:r,villageoisWins:l.villageoisWins,loupsWins:l.loupsWins,soloWins:l.soloWins,totalGames:l.totalGames,villageoisWinRate:l.villageoisWins/l.totalGames*100,loupsWinRate:l.loupsWins/l.totalGames*100,soloWinRate:l.soloWins/l.totalGames*100})).filter(r=>r.totalGames>=5).sort((r,l)=>r.day-l.day)}function be(){const{data:a,isLoading:i,error:n}=$(ve);return{data:a,isLoading:i,error:n}}function Je(){const{durationAnalysis:a,fetchingData:i,apiError:n}=xe(),{gameTimeAnalysis:r,fetchingData:l,apiError:m}=je(),{data:u,isLoading:h,error:x}=be(),{navigateToGameDetails:f}=K(),[T,F]=S.useState("real"),L=U(),d=t=>{if(!t)return t;const s=t.match(/^([JNM])(\d+)$/);if(!s)return t;const[,o,p]=s;return`${{J:"Jour",N:"Nuit",M:"Meeting"}[o]||o} ${p}`};if(i||l||h)return e.jsx("div",{className:"statistiques-attente",children:"Analyse des dur√©es en cours..."});if(n||m||x)return e.jsxs("div",{className:"statistiques-echec",children:["Probl√®me rencontr√©: ",n||m||x]});if(!a||!r)return e.jsx("div",{className:"statistiques-indisponibles",children:"Donn√©es d'analyse non disponibles"});const c=t=>{const s=t.match(/(\d+)h/),o=t.match(/(\d+)m/),p=t.match(/(\d+)s/),y=s?parseInt(s[1]):0,j=o?parseInt(o[1]):0,z=p?parseInt(p[1]):0;return y*60+j+z/60},g=a?Object.entries(a.durationsByWolfRatio).map(([t,s])=>({ratio:parseFloat(t),moyenne:c(s.average),parties:s.count,dureeFormatee:s.average})).sort((t,s)=>t.ratio-s.ratio):[],A=a?Object.entries(a.durationsByWinnerCamp).map(([t,s])=>({camp:t,moyenne:c(s.average),parties:s.count,dureeFormatee:s.average})).sort((t,s)=>s.moyenne-t.moyenne):[];return e.jsxs("div",{className:"lycans-duree-analyse",children:[e.jsx("h2",{children:"Analyse des Dur√©es"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${T==="real"?"active":""}`,onClick:()=>F("real"),children:"Dur√©e en jeu"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${T==="gametime"?"active":""}`,onClick:()=>F("gametime"),children:"Temps de jeu"})]}),T==="real"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Dur√©e Moyenne"}),e.jsx("p",{className:"lycans-valeur-principale",children:Q(a.averageDuration)||"N/A"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Temps de jeu cumul√©s des parties"}),e.jsx("p",{className:"lycans-valeur-principale",children:B(a.totalGameTime)||"N/A"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Temps de jeu cumul√©s par les joueurs"}),e.jsx("p",{className:"lycans-valeur-principale",children:B(a.totalPlayerTime)||"N/A"})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{a.minDurationGameId&&f({selectedGame:a.minDurationGameId,fromComponent:"Analyse des Dur√©es"})},style:{cursor:a.minDurationGameId?"pointer":"default",opacity:a.minDurationGameId?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{a.minDurationGameId&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{a.minDurationGameId&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:a.minDurationGameId?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus courte"}),e.jsx("p",{className:"lycans-valeur-principale",children:q(a.minDuration)}),a.minDurationGameId&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",a.minDurationGameId]})]}),e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{a.maxDurationGameId&&f({selectedGame:a.maxDurationGameId,fromComponent:"Analyse des Dur√©ee"})},style:{cursor:a.maxDurationGameId?"pointer":"default",opacity:a.maxDurationGameId?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{a.maxDurationGameId&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{a.maxDurationGameId&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:a.maxDurationGameId?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus longue"}),e.jsx("p",{className:"lycans-valeur-principale",children:q(a.maxDuration)}),a.maxDurationGameId&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",a.maxDurationGameId]})]})]}),e.jsxs("div",{className:"lycans-graphiques-section",children:[e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution des Dur√©es"}),e.jsx(v,{title:"Distribution des Dur√©es",children:e.jsx("div",{style:{height:300},children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(I,{data:a?.durationDistribution||[],margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(C,{dataKey:"duration",label:{value:"Dur√©e (minutes)",position:"insideBottom",offset:-5},tickFormatter:t=>`${t}min`}),e.jsx(b,{label:{value:"Nombre de Parties",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["~",o.duration," minutes"]})}),e.jsxs("div",{children:[o.count," parties"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Dur√©es regroup√©es par intervalles de 2 minutes"})]})}return null}}),e.jsx(M,{dataKey:"count",name:"Nombre de Parties",fill:"var(--chart-color-2)"})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Dur√©e Moyenne par Ratio Loups/Villageois"}),e.jsx(v,{title:"Dur√©e Moyenne par Ratio Loups/Villageois",children:e.jsx("div",{style:{height:300},children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(ee,{data:g,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(C,{dataKey:"ratio",type:"number",domain:["auto","auto"],allowDecimals:!1,tickFormatter:t=>`${t}%`,label:{value:"Ratio Loups/Joueurs (%)",position:"insideBottom",offset:-5}}),e.jsx(b,{label:{value:"Dur√©e Moyenne (minutes)",angle:270,position:"left",style:{textAnchor:"middle"}},tickFormatter:t=>`${Math.round(t)}min`}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Pourcentage de loups : ",o.ratio,"%"]})}),e.jsxs("div",{children:["Dur√©e moyenne : ",o.dureeFormatee]}),e.jsxs("div",{children:["Nombre de parties : ",o.parties]})]})}return null}}),e.jsx(R,{type:"monotone",dataKey:"moyenne",name:"Dur√©e Moyenne",stroke:"var(--chart-color-5)",strokeWidth:2,activeDot:{r:8}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Dur√©e Moyenne par Camp Victorieux"}),e.jsx(v,{title:"Dur√©e Moyenne par Camp Victorieux",children:e.jsx("div",{style:{height:300},children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(I,{data:A,margin:{top:20,right:30,left:20,bottom:40},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(C,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(b,{label:{value:"Dur√©e Moyenne (minutes)",angle:270,position:"left",style:{textAnchor:"middle"}},tickFormatter:t=>`${Math.round(t)}min`}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:o.camp})}),e.jsxs("div",{children:["Dur√©e moyenne : ",o.dureeFormatee]}),e.jsxs("div",{children:["Nombre de parties : ",o.parties]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsxs(M,{dataKey:"moyenne",name:"moyenne",isAnimationActive:!1,onClick:t=>{t&&t.camp&&f({campFilter:{selectedCamp:t.camp,campFilterMode:"wins-only"},fromComponent:"Dur√©e Moyenne par Camp Victorieux"})},style:{cursor:"pointer"},children:[A.map(t=>e.jsx(P,{fill:L[t.camp]||X},`cell-${t.camp}`)),e.jsx(_,{dataKey:"moyenne",position:"top",formatter:t=>{const s=typeof t=="number"?t:Number(t);return isNaN(s)?"":`${Math.round(s)}min`},fill:"var(--text-primary)",fontSize:12})]})]})})})})]})]})]}),T==="gametime"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lycans-section-description",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Analyse du temps de jeu :"})," Ces graphiques montrent √† quels moments les parties se terminent en fonction du cycle jour/nuit/meeting.",e.jsx("br",{}),'Le chiffre indique le num√©ro du jour (Jour 3 = Phase "Jour" de la 3√®me journ√©e, Nuit 2 = Phase "Nuit" de la 2√®me journ√©e, Meeting 4 = 4√®me meeting).',e.jsx("br",{}),"Bas√© sur ",r.gamesWithEndTiming," parties avec donn√©es de timing sur ",r.totalGames," parties totales."]})}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Longueur Moyenne"}),e.jsxs("p",{className:"lycans-valeur-principale",children:[r.averageGameLength.toFixed(1)," jours"]})]}),e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{r.shortestGame&&f({selectedGame:r.shortestGame.gameId,fromComponent:"Analyse des Temps de Jeu"})},style:{cursor:r.shortestGame?"pointer":"default",opacity:r.shortestGame?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{r.shortestGame&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{r.shortestGame&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:r.shortestGame?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus courte"}),e.jsx("p",{className:"lycans-valeur-principale",children:r.shortestGame?d(r.shortestGame.endTiming):"N/A"}),r.shortestGame&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",r.shortestGame.gameId]})]}),e.jsxs("div",{className:"lycans-stat-carte",onClick:()=>{r.longestGame&&f({selectedGame:r.longestGame.gameId,fromComponent:"Analyse des Temps de Jeu"})},style:{cursor:r.longestGame?"pointer":"default",opacity:r.longestGame?1:.7,transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:t=>{r.longestGame&&(t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)")},onMouseLeave:t=>{r.longestGame&&(t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="")},title:r.longestGame?"Cliquez pour voir cette partie":"Aucune partie trouv√©e",children:[e.jsx("h3",{children:"Partie la plus longue"}),e.jsx("p",{className:"lycans-valeur-principale",children:r.longestGame?d(r.longestGame.endTiming):"N/A"}),r.longestGame&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["üñ±Ô∏è Partie #",r.longestGame.gameId]})]})]}),e.jsxs("div",{className:"lycans-graphiques-section",children:[e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution par Phase de Fin"}),e.jsx(v,{title:"Distribution par Phase de Fin",children:e.jsx("div",{style:{height:300},children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(te,{children:[e.jsx(ae,{data:r.phaseDistribution,cx:"50%",cy:"50%",labelLine:!1,label:t=>`${t.phase} (${t.percentage.toFixed(1)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"count",children:r.phaseDistribution.map((t,s)=>e.jsx(P,{fill:t.phase==="Jour"?"#FFD700":t.phase==="Nuit"?"#4169E1":t.phase==="Meeting"?"#FF6347":E(t.phase)},`cell-${s}`))}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:o.phase})}),e.jsxs("div",{children:[o.count," parties (",o.percentage.toFixed(1),"%)"]}),e.jsxs("div",{children:["Jour moyen: ",o.averageDay.toFixed(1)]})]})}return null}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution par Nombre de Jours"}),e.jsx(v,{title:"Distribution par Nombre de Jours",children:e.jsx("div",{style:{height:300},children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(I,{data:r.dayDistribution,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(C,{dataKey:"dayNumber",label:{value:"Nombre de Jours",position:"insideBottom",offset:-5}}),e.jsx(b,{label:{value:"Nombre de Parties",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload,p=Object.entries(o.phases).map(([y,j])=>`${y}: ${j}`).join(", ");return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Jour ",o.dayNumber]})}),e.jsxs("div",{children:[o.count," parties (",o.percentage.toFixed(1),"%)"]}),e.jsxs("div",{children:["D√©tail: ",p]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(M,{dataKey:"count",name:"Nombre de Parties",fill:"var(--chart-color-3)",onClick:t=>{f({fromComponent:`Analyse des Temps de Jeu - Jour ${t.dayNumber}`})},style:{cursor:"pointer"}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"D√©tail par Timing de Fin"}),e.jsx(v,{title:"D√©tail par Timing de Fin",children:e.jsx("div",{style:{height:400},children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(I,{data:r.endTimingDistribution,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(C,{dataKey:"timing",angle:-45,textAnchor:"end",height:80,interval:0,tickFormatter:t=>d(t),label:{value:"Timing de Fin",position:"insideBottom",offset:-40}}),e.jsx(b,{label:{value:"Nombre de Parties",angle:270,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:d(o.timing)})}),e.jsxs("div",{children:["Phase: ",o.phase]}),e.jsxs("div",{children:["Jour: ",o.dayNumber]}),e.jsxs("div",{children:[o.count," parties (",o.percentage.toFixed(1),"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(M,{dataKey:"count",name:"Nombre de Parties",onClick:t=>{f({fromComponent:`Analyse des Temps de Jeu - Timing ${d(t.timing)}`})},style:{cursor:"pointer"},children:r.endTimingDistribution.map((t,s)=>e.jsx(P,{fill:t.phase==="Jour"?"#FFD700":t.phase==="Nuit"?"#4169E1":t.phase==="Meeting"?"#FF6347":E(t.timing)},`cell-${s}`))})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Taux de Victoire par Jour de Jeu"}),e.jsx(v,{title:"Taux de Victoire par Jour de Jeu",children:e.jsx("div",{style:{height:450},children:u&&u.length>0?e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(ne,{data:u,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(C,{dataKey:"day",label:{value:"Jour de fin de partie",position:"insideBottom",offset:-10},tickFormatter:t=>`Jour ${t}`}),e.jsx(b,{yAxisId:"left",label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(b,{yAxisId:"right",orientation:"right",label:{value:"Nombre de parties",angle:90,position:"right",style:{textAnchor:"middle"}},domain:[0,"auto"]}),e.jsx(N,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const o=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:6,border:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Jour ",o.day]}),e.jsxs("div",{style:{fontSize:"0.9rem"},children:[e.jsxs("div",{style:{color:"#4CAF50",marginBottom:4},children:["üü¢ Villageois: ",o.villageoisWinRate.toFixed(1),"% (",o.villageoisWins,"/",o.totalGames,")"]}),e.jsxs("div",{style:{color:"#f44336",marginBottom:4},children:["üî¥ Loups: ",o.loupsWinRate.toFixed(1),"% (",o.loupsWins,"/",o.totalGames,")"]}),e.jsxs("div",{style:{color:"#FF9800"},children:["üü† Solo: ",o.soloWinRate.toFixed(1),"% (",o.soloWins,"/",o.totalGames,")"]})]}),e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid var(--border-color)",fontSize:"0.85rem",color:"var(--text-secondary)"},children:["Total: ",o.totalGames," parties"]})]})}return null}}),e.jsx(re,{wrapperStyle:{paddingTop:"20px"},formatter:t=>t==="villageoisWinRate"?"Villageois":t==="loupsWinRate"?"Loups":t==="soloWinRate"?"Solo":t==="totalGames"?"Nombre de parties":t}),e.jsx(M,{yAxisId:"right",dataKey:"totalGames",name:"totalGames",fill:"rgba(128, 128, 128, 0.2)",radius:[4,4,0,0]}),e.jsx(R,{yAxisId:"left",type:"monotone",dataKey:"villageoisWinRate",name:"villageoisWinRate",stroke:"#4CAF50",strokeWidth:3,activeDot:{r:8},dot:t=>{const{cx:s,cy:o,payload:p}=t,y=3+p.totalGames/Math.max(...u.map(j=>j.totalGames))*5;return e.jsx("circle",{cx:s,cy:o,r:y,fill:"#4CAF50",stroke:"#4CAF50",strokeWidth:2})}}),e.jsx(R,{yAxisId:"left",type:"monotone",dataKey:"loupsWinRate",name:"loupsWinRate",stroke:"#f44336",strokeWidth:3,activeDot:{r:8},dot:t=>{const{cx:s,cy:o,payload:p}=t,y=3+p.totalGames/Math.max(...u.map(j=>j.totalGames))*5;return e.jsx("circle",{cx:s,cy:o,r:y,fill:"#f44336",stroke:"#f44336",strokeWidth:2})}}),e.jsx(R,{yAxisId:"left",type:"monotone",dataKey:"soloWinRate",name:"soloWinRate",stroke:"#FF9800",strokeWidth:3,activeDot:{r:8},dot:t=>{const{cx:s,cy:o,payload:p}=t,y=3+p.totalGames/Math.max(...u.map(j=>j.totalGames))*5;return e.jsx("circle",{cx:s,cy:o,r:y,fill:"#FF9800",stroke:"#FF9800",strokeWidth:2})}})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-secondary)"},children:"Aucune donn√©e disponible (minimum 5 parties par jour requis)"})})}),e.jsx("div",{style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--text-secondary)",padding:"0 1rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Analyse des victoires selon la dur√©e :"})," Ce graphique montre le taux de victoire de chaque camp en fonction du jour o√π la partie s'est termin√©e. Les phases Jour, Nuit et Meeting de chaque journ√©e sont regroup√©es ensemble.",e.jsx("br",{}),'La taille des points refl√®te le nombre de parties termin√©es ce "jour"-l√†. Les barres grises en arri√®re-plan indiquent le volume de parties.',e.jsx("br",{}),"Seuls les jours avec au moins 5 parties sont affich√©s pour garantir la fiabilit√© statistique."]})})]})]})]})]})}export{Je as GameDurationInsights};
