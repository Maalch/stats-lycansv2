import{g as M,b as $,f as z,u as N,r as f,j as e,c as W,a as K}from"./index-C_TODTpW.js";import{u as G}from"./usePlayerStatsFromRaw-CzHIb-uW.js";import{g as L,a as E,u as V}from"./datasyncExport-VKVPEJXl.js";import{g as B}from"./gameUtils-DvAVSzAw.js";import{F as w,C,X as k,Y as S,B as R,a as P,b as j}from"./FullscreenChart-D9LQT2b3.js";import{R as y,T as b}from"./CategoricalChart-DpMO8UBE.js";import{L as I,a as H}from"./LineChart-BVyzTHKw.js";import{a as O,l as T,u as J}from"./api-C9_gkKNS.js";import{P as _,a as U}from"./PieChart-BMWUCP_Y.js";import{R as F}from"./ReferenceLine-oWWMSwap.js";import{u as X}from"./useJoueursData-CatgFEQE.js";import"./ActivePoints-C55Xi55h.js";import"./PolarChart-DTEteTfd.js";function Y(c,d){if(!c||c.trim()===""||d.length===0)return null;const p=[];let m=c;d.forEach(t=>{const r=t.PlayerStats.find(s=>M(s)===c||s.Username.toLowerCase()===c.toLowerCase());if(r){m=$(r);const s=L(E(r.MainRoleInitial,r.MainRoleChanges||[])),i=B(t),h=r.Victorious,g=z(new Date(t.StartDate));p.push({gameId:t.Id,date:g,camp:s,won:h,winnerCamp:i,playersInGame:t.PlayerStats.length,mapName:t.MapName})}}),p.sort((t,r)=>{const s=i=>{const h=i.split("/");return h.length===3?new Date(parseInt(h[2]),parseInt(h[1])-1,parseInt(h[0])):new Date(i)};return s(r.date).getTime()-s(t.date).getTime()});const u=p.length,o=p.filter(t=>t.won).length,l=u>0?(o/u*100).toFixed(2):"0.00",n={};p.forEach(t=>{n[t.camp]||(n[t.camp]={appearances:0,wins:0,winRate:"0.00"}),n[t.camp].appearances++,t.won&&n[t.camp].wins++}),Object.keys(n).forEach(t=>{const r=n[t];r.winRate=r.appearances>0?(r.wins/r.appearances*100).toFixed(2):"0.00"});const a={};return p.forEach(t=>{a[t.mapName]||(a[t.mapName]={appearances:0,wins:0,winRate:"0.00"}),a[t.mapName].appearances++,t.won&&a[t.mapName].wins++}),Object.keys(a).forEach(t=>{const r=a[t];r.winRate=r.appearances>0?(r.wins/r.appearances*100).toFixed(2):"0.00"}),{playerName:m,totalGames:u,totalWins:o,winRate:l,games:p,campStats:n,mapStats:a}}function Q(c){const d={};let p=0,m=0;return Object.entries(c).forEach(([u,o])=>{u==="Village"||u==="Ch√¢teau"?d[u]={...o}:(p+=o.appearances,m+=o.wins)}),p>=10&&(d.Autres={appearances:p,wins:m,winRate:p>0?(m/p*100).toFixed(2):"0.00"}),d}function A(c){const{data:d,isLoading:p,error:m}=V(u=>c?Y(c,u):null);return{data:d,isLoading:p,error:m}}function Z({selectedPlayerName:c,groupingMethod:d}){const{navigateToGameDetails:p}=N(),{data:m,isLoading:u,error:o}=A(c),l=f.useMemo(()=>{if(!m?.games)return new Map;const r=new Map;return m.games.forEach(s=>{if(!r.has(s.date)){const i=s.date.split("/");i.length===3?r.set(s.date,new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])).getTime()):r.set(s.date,new Date(s.date).getTime())}}),r},[m?.games]),n=f.useMemo(()=>{if(!m?.games)return[];const r={};return m.games.forEach(s=>{let i;if(d==="month"){const h=s.date.split("/");h.length===3?i=`${h[1]}/${h[2]}`:i=s.date}else i=s.date;r[i]||(r[i]={games:[],wins:0,total:0}),r[i].games.push(s),r[i].total++,s.won&&r[i].wins++}),Object.entries(r).map(([s,i])=>({period:s,totalGames:i.total,victories:i.wins,defeats:i.total-i.wins,winRate:i.total>0?(i.wins/i.total*100).toFixed(1):"0.0",winRateNum:i.total>0?i.wins/i.total*100:0})).sort((s,i)=>{if(d==="month"){const[h,g]=s.period.split("/"),[D,x]=i.period.split("/"),v=new Date(parseInt(g),parseInt(h)-1,1),q=new Date(parseInt(x),parseInt(D)-1,1);return v.getTime()-q.getTime()}else{const h=l.get(s.period)||0,g=l.get(i.period)||0;return h-g}})},[m,d,l]),t=(r=>r<=15?{fontSize:12,angle:-45,height:80,interval:0}:r<=30?{fontSize:12,angle:-45,height:85,interval:1}:r<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(r/12)})(n.length);return u?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):o?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",o]}):m?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["√âvolution des Performances ",d==="month"?"par Mois":"par Session"]}),e.jsx(w,{title:`√âvolution des Performances ${d==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(I,{data:n,margin:{top:20,right:30,left:20,bottom:20},onClick:r=>{if(r&&r.activeLabel){const s=n.find(i=>i.period===r.activeLabel);s&&p({selectedPlayer:c,selectedDate:s.period,fromComponent:`√âvolution des Performances ${d==="month"?"par Mois":"par Session"}`})}},style:{cursor:"pointer"},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"period",angle:t.angle,textAnchor:"end",height:t.height,interval:t.interval,fontSize:t.fontSize}),e.jsx(S,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(b,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Parties: ",i.totalGames]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(H,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["R√©partition Victoires/D√©faites ",d==="month"?"par Mois":"par Session"]}),e.jsx(w,{title:`R√©partition Victoires/D√©faites ${d==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(R,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"period",angle:t.angle,textAnchor:"end",height:t.height,interval:t.interval,fontSize:t.fontSize}),e.jsx(S,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(b,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const i=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Total: ",i.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["D√©faites: ",i.defeats]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(P,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:n.map((r,s)=>e.jsx(j,{fill:"var(--accent-tertiary)",onClick:()=>{p({selectedPlayer:c,selectedDate:r.period,fromComponent:`Historique Joueur - Victoires ${d==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-victories-${s}`))}),e.jsx(P,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"D√©faites",children:n.map((r,s)=>e.jsx(j,{fill:"var(--chart-color-4)",onClick:()=>{p({selectedPlayer:c,selectedDate:r.period,fromComponent:`Historique Joueur - D√©faites ${d==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-defeats-${s}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e d'historique disponible"})}function ee({selectedPlayerName:c}){const{navigateToGameDetails:d}=N(),{data:p,isLoading:m,error:u}=A(c),o=O(),l=f.useMemo(()=>p?.campStats?Object.entries(p.campStats).map(([a,t])=>({name:a,value:t.appearances,winRate:t.winRate,winRateDisplay:Math.max(parseFloat(t.winRate),1),wins:t.wins,percentage:(t.appearances/p.totalGames*100).toFixed(1)})):[],[p]),n=f.useMemo(()=>{if(!l.length)return[];const a=5;let t=0;const r=[],s=[];if(l.forEach(i=>{parseFloat(i.percentage)<a?(t+=Number(i.value),r.push(i)):s.push(i)}),t>0){const i=l.reduce((h,g)=>h+Number(g.value),0);s.push({name:"Autres",value:t,winRate:"0.0",winRateDisplay:1,wins:r.reduce((h,g)=>h+g.wins,0),percentage:(t/i*100).toFixed(1),_details:r})}return s},[l]);return m?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):u?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]}):p?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(_,{children:[e.jsx(U,{data:n,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:a=>{const t=a.percent!==void 0?a.percent:0;return a.name==="Autres"?`Autres : ${a.value} (${(t*100).toFixed(1)}%)`:`${a.name}: ${a.value} (${(t*100).toFixed(1)}%)`},children:n.map((a,t)=>e.jsx(j,{fill:a.name==="Autres"?T:o[a.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{if(a.name==="Autres"){const r=a._details?.map(s=>s.name)||[];d({selectedPlayer:c,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:r},fromComponent:"Distribution par Camps"})}else a.name==="Tra√Ætre"||a.name==="Louveteau"?d({selectedPlayer:c,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):a.name==="Loup"?d({selectedPlayer:c,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):d({selectedPlayer:c,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${t}`))}),e.jsx(b,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;if(r.name==="Autres"&&r._details){const s=[...r._details].sort((i,h)=>h.value-i.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{children:s.map((i,h)=>e.jsxs("div",{children:[i.name,": ",i.value," parties (",i.percentage,"%)"]},h))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[r.name," (",r.percentage,"%)"]})}),e.jsxs("div",{children:["Apparitions: ",r.value]}),e.jsxs("div",{children:["Victoires: ",r.wins," (",r.winRate,"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(w,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(R,{data:l,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(S,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(b,{content:({active:a,payload:t})=>{if(a&&t&&t.length>0){const r=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.value]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(P,{dataKey:"winRateDisplay",children:l.map((a,t)=>e.jsx(j,{fill:parseFloat(a.winRate)===0?`${o[a.name]||`var(--chart-color-${t%6+1})`}50`:o[a.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{a.name==="Tra√Ætre"||a.name==="Louveteau"?d({selectedPlayer:c,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):a.name==="Loup"?d({selectedPlayer:c,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):d({selectedPlayer:c,campFilter:{selectedCamp:a.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${t}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e d'historique disponible"})}function re({selectedPlayerName:c}){const{navigateToGameDetails:d}=N(),{data:p,isLoading:m,error:u}=A(c),o=f.useMemo(()=>{if(!p?.mapStats)return[];const l=Q(p.mapStats);return Object.entries(l).map(([n,a])=>({name:n,value:a.appearances,winRate:a.winRate,winRateDisplay:Math.max(parseFloat(a.winRate),.1),wins:a.wins,percentage:(a.appearances/p.totalGames*100).toFixed(1)}))},[p]);return m?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):u?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]}):p?o.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donn√©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Carte"}),e.jsx(w,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(R,{data:o,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(S,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(F,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(o.length>0){const l=o.reduce((t,r)=>t+r.value,0),n=o.reduce((t,r)=>t+r.wins,0),a=l>0?n/l*100:0;if(a!==50)return e.jsx(F,{y:a,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${a.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(b,{content:({active:l,payload:n})=>{if(l&&n&&n.length>0){const a=n[0].payload,t=[];return o.forEach(r=>{if(r.name!==a.name&&r.value>=5){const s=parseFloat(a.winRate)-parseFloat(r.winRate);Math.abs(s)>=2&&t.push({map:r.name,diff:s,better:s>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.name})}),e.jsxs("div",{children:["Parties: ",a.value]}),e.jsxs("div",{children:["Victoires: ",a.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",a.winRate,"%"]})}),t.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),t.map((r,s)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:r.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[r.better?"‚Üó":"‚Üò"," ",Math.abs(r.diff).toFixed(1),"% vs ",r.map]},s))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(P,{dataKey:"winRateDisplay",label:l=>{const{x:n,y:a,width:t,payload:r}=l;if(n===void 0||a===void 0||t===void 0||!r)return null;const s=r.winRate||"0";return e.jsxs("text",{x:n+t/2,y:a-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[s,"%"]})},onClick:l=>{l&&l.name&&d({selectedPlayer:c,selectedMapName:l.name,fromComponent:"Performance par Carte"})},children:o.map((l,n)=>{let a;l.name==="Village"?a="var(--accent-secondary)":l.name==="Ch√¢teau"?a="var(--accent-tertiary)":l.name==="Autres"?a=T:a=`var(--chart-color-${n%6+1})`;const t=Math.max(...o.map(s=>parseFloat(s.winRate))),r=parseFloat(l.winRate)===t&&t>0;return e.jsx(j,{fill:parseFloat(l.winRate)===0?`${a}30`:a,stroke:"transparent",strokeWidth:r?3:1,style:{cursor:"pointer"}},`cell-map-${n}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e d'historique disponible"})}function te({selectedPlayerName:c}){const{gameData:d}=W(),{joueursData:p}=X(),m=J(p),u=f.useMemo(()=>{if(!d||!c)return{playersKilled:[],killedBy:[]};const o={},l={};d.forEach(t=>{const r=t.PlayerStats.find(s=>s.Username.toLowerCase()===c.toLowerCase());r&&(t.PlayerStats.forEach(s=>{s.KillerName?.toLowerCase()===c.toLowerCase()&&(o[s.Username]=(o[s.Username]||0)+1)}),r.KillerName&&(l[r.KillerName]=(l[r.KillerName]||0)+1))});const n=Object.entries(o).map(([t,r])=>({player:t,kills:r})).sort((t,r)=>r.kills-t.kills).slice(0,10),a=Object.entries(l).map(([t,r])=>({player:t,kills:r})).sort((t,r)=>r.kills-t.kills).slice(0,10);return{playersKilled:n,killedBy:a}},[d,c]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[u.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Joueurs les plus souvent tu√©s"}),e.jsx(w,{title:"Joueurs les plus souvent tu√©s",children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(R,{data:u.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(S,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(b,{content:({active:o,payload:l})=>{if(o&&l&&l.length>0){const n=l[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.player})}),e.jsxs("div",{children:["Tu√© ",n.kills," fois par ",c]})]})}return null}}),e.jsx(P,{dataKey:"kills",children:u.playersKilled.map((o,l)=>e.jsx(j,{fill:m[o.player]||"var(--chart-color-3)"},`cell-killed-${l}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistr√©"}),e.jsxs("p",{children:[c," n'a tu√© aucun joueur dans les parties enregistr√©es."]})]}),u.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Le plus souvent tu√© par"}),e.jsx(w,{title:"Le plus souvent tu√© par",children:e.jsx("div",{style:{height:400},children:e.jsx(y,{width:"100%",height:"100%",children:e.jsxs(R,{data:u.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(S,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(b,{content:({active:o,payload:l})=>{if(o&&l&&l.length>0){const n=l[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:n.player})}),e.jsxs("div",{children:["A tu√© ",c," ",n.kills," fois"]})]})}return null}}),e.jsx(P,{dataKey:"kills",children:u.killedBy.map((o,l)=>e.jsx(j,{fill:m[o.player]||"var(--chart-color-4)"},`cell-killer-${l}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[c," n'a jamais √©t√© tu√© par un autre joueur dans les parties enregistr√©es."]})]})]})}function ge(){const{navigateToGameDetails:c,navigationState:d,updateNavigationState:p}=N(),{settings:m}=K(),{data:u}=G(),o=f.useMemo(()=>{if(!u?.playerStats)return["Ponce"];const x=u.playerStats.filter(v=>v.gamesPlayed>0).map(v=>v.player).sort();return m.highlightedPlayer&&!x.includes(m.highlightedPlayer)&&u.playerStats.some(v=>v.player===m.highlightedPlayer&&v.gamesPlayed>0)&&(x.push(m.highlightedPlayer),x.sort()),x},[u,m.highlightedPlayer]),n=d.selectedPlayerName&&o.includes(d.selectedPlayerName)?d.selectedPlayerName:m.highlightedPlayer&&o.includes(m.highlightedPlayer)?m.highlightedPlayer:o.includes("Ponce")?"Ponce":o[0]||"",a=d.groupingMethod||"session",t=d.selectedViewType||"performance",r=x=>{p({selectedPlayerName:x})},s=x=>{p({groupingMethod:x})},i=x=>{p({selectedViewType:x})},{data:h,isLoading:g,error:D}=A(n);return g?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):D?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",D]}):h?e.jsxs("div",{className:"lycans-player-history",children:[e.jsx("h2",{children:"Historique D√©taill√© d'un Joueur"}),e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Joueur:"}),e.jsx("select",{id:"player-select",value:n,onChange:x=>r(x.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:o.map(x=>e.jsx("option",{value:x,children:x},x))})]})}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${t==="performance"?"active":""}`,onClick:()=>i("performance"),children:"√âvolution"}),e.jsx("button",{className:`lycans-categorie-btn ${t==="camp"?"active":""}`,onClick:()=>i("camp"),children:"Camp"}),e.jsx("button",{className:`lycans-categorie-btn ${t==="map"?"active":""}`,onClick:()=>i("map"),children:"Map"}),e.jsx("button",{className:`lycans-categorie-btn ${t==="kills"?"active":""}`,onClick:()=>i("kills"),children:"Kills"})]}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{c({selectedPlayer:n,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${n}`,children:h.totalGames}),e.jsx("p",{children:"parties jou√©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{c({selectedPlayer:n,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${n}`,children:h.totalWins}),e.jsx("p",{children:"parties gagn√©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",children:[h.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),t==="performance"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:a,onChange:x=>s(x.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"})]})]})}),e.jsx(Z,{selectedPlayerName:n,groupingMethod:a})]}),t==="camp"&&e.jsx(ee,{selectedPlayerName:n}),t==="map"&&e.jsx(re,{selectedPlayerName:n}),t==="kills"&&e.jsx(te,{selectedPlayerName:n})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e d'historique disponible"})}export{ge as PlayerGameHistoryChart};
