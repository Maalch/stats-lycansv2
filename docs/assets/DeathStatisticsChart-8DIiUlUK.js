import{u as pe,r as z,c as ye,a as ve,j as e}from"./index-Ba-J9jAi.js";import{u as se}from"./baseStatsHook-vRazKlmo.js";import{D as a,g as V}from"./datasyncExport-CGiAFcIr.js";import{c as te,a as xe,m as ae}from"./api-DzNTSzjN.js";import{F as H,B as G,C as W,X as U,Y,a as q}from"./FullscreenChart-B2Z4HGCN.js";import{R as w,T as $}from"./CategoricalChart-BdwHkdMG.js";function fe(S){const y=new Set;S.filter(c=>!c.LegacyData||c.LegacyData.deathInformationFilled===!0).forEach(c=>{c.PlayerStats.forEach(F=>{const I=V(F.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});y.add(I)})});const r=Array.from(y);return[...te.filter(c=>r.includes(c)),...r.filter(c=>!te.includes(c)).sort()]}function re(S){switch(S){case a.SURVIVOR:return"Survivant";case a.VOTED:return"Mort aux votes";case a.BY_WOLF:return"Tué par un loup";case a.BY_WOLF_REZ:return"Tué par un loup ressuscité";case a.BY_WOLF_LOVER:return"Tué par un loup amoureux";case a.BY_ZOMBIE:return"Tué par un zombie";case a.BY_BEAST:return"Dévoré par la Bête";case a.BY_AVATAR_CHAIN:return"Mort liée à l'Avatar";case a.BULLET:return"Abattu par un chasseur";case a.BULLET_BOUNTYHUNTER:return"Tué par un chasseur de primes";case a.SHERIF:return"Abattu par le Shérif";case a.OTHER_AGENT:return"Éliminé par l'Agent";case a.AVENGER:return"Tué par un vengeur";case a.SEER:return"Rôle deviné par un loup";case a.ASSASSIN:return"Tué par une potion (Assassin)";case a.LOVER_DEATH:return"Mort par amoureux";case a.LOVER_DEATH_OWN:return"Tué par son amoureux";case a.BOMB:return"Mort dans une explosion";case a.CRUSHED:return"Écrasé";case a.STARVATION:return"Mort de faim";case a.STARVATION_AS_BEAST:return"Mort bestiale";case a.FALL:return"Mort de chute";case a.UNKNOWN:default:return"Mort inconnue"}}function ie(S){switch(S){case a.SURVIVOR:return"Survivant";case a.VOTED:return"Mort aux votes";case a.BY_WOLF:return"Kill en Loup";case a.BY_WOLF_REZ:return"Kill en Loup ressuscité";case a.BY_WOLF_LOVER:return"Kill en Loup amoureux";case a.BY_ZOMBIE:return"Kill en Zombie";case a.BY_BEAST:return"Kill en Bête";case a.BY_AVATAR_CHAIN:return"Mort d'Avatar";case a.BULLET:return"Tir de Chasseur";case a.BULLET_BOUNTYHUNTER:return"Kill en Chasseur de primes";case a.SHERIF:return"Kill en Shérif";case a.OTHER_AGENT:return"Kill en Agent";case a.AVENGER:return"Kill en Vengeur";case a.SEER:return"Kill en Devin";case a.ASSASSIN:return"Kill avec Potion (Assassin)";case a.LOVER_DEATH:return"Kill de son amoureux";case a.LOVER_DEATH_OWN:return"Kill de son propre amoureux";case a.BOMB:return"Explosion";case a.CRUSHED:return"Écrasement";case a.STARVATION:return"Famine";case a.STARVATION_AS_BEAST:return"Tuerie bestiale";case a.FALL:return"Chute mortelle";case a.UNKNOWN:default:return"Kill inconnu"}}function Se(S){const y=new Set;S.forEach(u=>{u.PlayerStats.forEach(c=>{c.DeathType&&c.DeathType!==a.SURVIVOR&&c.DeathType!==""&&y.add(c.DeathType)})});const x=Array.from(y),r=[a.BY_WOLF,a.VOTED,a.BULLET,a.BY_ZOMBIE,a.ASSASSIN,a.AVENGER,a.LOVER_DEATH,a.SURVIVOR];return[...r.filter(u=>x.includes(u)),...x.filter(u=>!r.includes(u)).sort()]}function Te(S,y){return S.PlayerStats.filter(x=>x.DeathType&&x.DeathType!==a.SURVIVOR&&x.DeathType!==""&&(x.DeathTiming||x.DeathType)).map(x=>{let r=null;if(x.KillerName){const u=S.PlayerStats.find(c=>c.Username===x.KillerName);u&&(r=V(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1}),u.MainRoleFinal&&u.MainRoleFinal!==u.MainRoleInitial&&(u.MainRoleFinal==="Loup"?r="Loup":u.MainRoleFinal==="Zombie"&&(r="Vaudou")))}return{playerName:x.Username,deathType:x.DeathType,killerName:x.KillerName,killerCamp:r}}).filter(x=>{if(!y||y==="Tous les camps")return!0;const r=S.PlayerStats.find(c=>c.Username===x.playerName);return r?V(r.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===y:!1})}function je(S,y){const x=[];return S.PlayerStats.forEach(r=>{if(r.KillerName&&r.DeathType){if(r.DeathType===a.SURVIVOR||r.DeathType===a.VOTED||r.DeathType===a.STARVATION||r.DeathType===a.FALL||r.DeathType===a.BY_AVATAR_CHAIN||r.DeathType==="")return;const u=S.PlayerStats.find(F=>F.Username===r.KillerName);if(!u)return;let c=V(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});u.MainRoleFinal&&u.MainRoleFinal!==u.MainRoleInitial&&(u.MainRoleFinal==="Loup"?c="Loup":u.MainRoleFinal==="Zombie"&&(c="Vaudou")),x.push({killerName:r.KillerName,victimName:r.Username,deathType:r.DeathType,killerCamp:c})}}),y&&y!=="Tous les camps"?x.filter(r=>r.killerCamp===y):x}function De(S,y){if(S.length===0)return null;const x=S.filter(m=>!m.LegacyData||m.LegacyData.deathInformationFilled===!0);if(x.length===0)return null;const r=[],u={};x.forEach(m=>{Te(m,y).forEach(j=>{r.push({...j,gameId:m.Id})}),m.PlayerStats.forEach(j=>{const M=j.Username;(!y||y==="Tous les camps"||V(j.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===y)&&(u[M]=(u[M]||0)+1)})});const c=r.length,F=x.length,I=F>0?c/F:0,P={};r.forEach(m=>{P[m.deathType]=(P[m.deathType]||0)+1});const _=Object.entries(P).map(([m,p])=>({type:m,count:p||0,percentage:c>0?(p||0)/c*100:0})).sort((m,p)=>p.count-m.count),L={};x.forEach(m=>{je(m,y).forEach(j=>{L[j.killerName]||(L[j.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),L[j.killerName].kills++,L[j.killerName].victims.add(j.victimName),L[j.killerName].killsByDeathType[j.deathType]=(L[j.killerName].killsByDeathType[j.deathType]||0)+1})});const K=Object.entries(L).map(([m,p])=>{const j=u[m]||0,M=j>0?p.kills/j:0;return{killerName:m,kills:p.kills,victims:Array.from(p.victims),percentage:c>0?p.kills/c*100:0,gamesPlayed:j,averageKillsPerGame:M,killsByDeathType:p.killsByDeathType}}).sort((m,p)=>p.kills-m.kills),n={};r.forEach(m=>{n[m.playerName]||(n[m.playerName]={totalDeaths:0,deathsByType:{},killedBy:{},deathDays:[]});const p=n[m.playerName];p.totalDeaths++,p.deathsByType[m.deathType]=(p.deathsByType[m.deathType]||0)+1,m.killerName&&(p.killedBy[m.killerName]=(p.killedBy[m.killerName]||0)+1)});const O=Object.entries(n).map(([m,p])=>({playerName:m,totalDeaths:p.totalDeaths,deathsByType:p.deathsByType,killedBy:p.killedBy,averageDeathDay:p.deathDays.length>0?p.deathDays.reduce((j,M)=>j+M,0)/p.deathDays.length:null,deathRate:u[m]>0?p.totalDeaths/u[m]:0})).sort((m,p)=>p.totalDeaths-m.totalDeaths),T=_.length>0?_[0].type:null,E=K.length>0?K[0].killerName:null;return{totalDeaths:c,totalGames:F,averageDeathsPerGame:I,deathsByType:_,killerStats:K,playerDeathStats:O,mostCommonDeathType:T,mostDeadlyKiller:E}}function Ae(S){return se(y=>De(y,S))}function Pe(){return se(S=>fe(S))}function Me(){const{navigateToGameDetails:S,navigationState:y,updateNavigationState:x}=pe(),[r,u]=z.useState(y.deathStatisticsState?.selectedCamp||y.deathStatsSelectedCamp||"Tous les camps"),[c,F]=z.useState(y.deathStatisticsState?.minGamesForAverage||10),{data:I}=Pe(),{data:P,isLoading:_,error:L}=Ae(r),{data:K}=ye(),{settings:n}=ve(),O=xe();z.useEffect(()=>{(!y.deathStatisticsState||y.deathStatisticsState.selectedCamp!==r||y.deathStatisticsState.minGamesForAverage!==c)&&x({deathStatisticsState:{selectedCamp:r,minGamesForAverage:c,focusChart:y.deathStatisticsState?.focusChart}})},[r,c,y.deathStatisticsState,x]);const T=z.useMemo(()=>K?Se(K):[],[K]),E=z.useMemo(()=>{const t={};T.forEach(i=>{i===a.BY_WOLF||i===a.BY_WOLF_REZ||i===a.BY_WOLF_LOVER?t[i]=O.Loup:i===a.VOTED?t[i]="var(--chart-color-1)":i===a.BULLET||i===a.BULLET_BOUNTYHUNTER?t[i]=O.Chasseur:i===a.BY_ZOMBIE?t[i]=O.Vaudou:i===a.ASSASSIN?t[i]=O.Alchimiste:i===a.AVENGER?t[i]="var(--chart-color-2)":i===a.LOVER_DEATH||i===a.LOVER_DEATH_OWN?t[i]=O.Amoureux:i===a.BY_BEAST?t[i]="var(--chart-color-3)":i===a.SURVIVOR?t[i]="var(--chart-color-4)":i===a.SHERIF&&(t[i]="var(--chart-color-5)")});const d=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let o=0;return T.forEach(i=>{t[i]||(t[i]=d[o%d.length],o++)}),t},[T,O]),m=t=>{u(t),x({deathStatsSelectedCamp:t,deathStatisticsState:{selectedCamp:t,minGamesForAverage:c,focusChart:y.deathStatisticsState?.focusChart}})},p=t=>{F(t),x({deathStatisticsState:{selectedCamp:r,minGamesForAverage:t,focusChart:y.deathStatisticsState?.focusChart}})},{totalKillsData:j,averageKillsData:M,highlightedPlayerAddedToTotal:X,highlightedPlayerAddedToAverage:le,gamesWithKillers:ne,totalEligibleForAverage:oe}=z.useMemo(()=>{if(!P)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1,gamesWithKillers:0,totalEligibleForAverage:0};const t=P.killerStats.sort((l,v)=>v.kills-l.kills).slice(0,15),d=n.highlightedPlayer&&t.some(l=>l.killerName===n.highlightedPlayer),o=t.map(l=>{const v={name:l.killerName,value:l.kills,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!1};return T.forEach(A=>{v[A]=l.killsByDeathType[A]||0}),v});let i=!1;if(n.highlightedPlayer&&!d){const l=P.killerStats.find(v=>v.killerName===n.highlightedPlayer);if(l){const v={name:l.killerName,value:l.kills,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!0};T.forEach(A=>{v[A]=l.killsByDeathType[A]||0}),o.push(v),i=!0}}const D=P.killerStats.filter(l=>l.gamesPlayed>=c),B=D.sort((l,v)=>v.averageKillsPerGame-l.averageKillsPerGame).slice(0,15),N=n.highlightedPlayer&&B.some(l=>l.killerName===n.highlightedPlayer),g=B.map(l=>{const v={name:l.killerName,value:l.averageKillsPerGame,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!1};return T.forEach(A=>{const C=l.killsByDeathType[A]||0;v[A]=l.gamesPlayed>0?C/l.gamesPlayed:0}),v});let R=!1;if(n.highlightedPlayer&&!N){const l=P.killerStats.find(v=>v.killerName===n.highlightedPlayer);if(l){const v={name:l.killerName,value:l.averageKillsPerGame,victims:l.victims.length,percentage:l.percentage,gamesPlayed:l.gamesPlayed,averageKillsPerGame:l.averageKillsPerGame,isHighlightedAddition:!0};T.forEach(A=>{const C=l.killsByDeathType[A]||0;v[A]=l.gamesPlayed>0?C/l.gamesPlayed:0}),g.push(v),R=!0}}return{totalKillsData:o,averageKillsData:g,highlightedPlayerAddedToTotal:i,highlightedPlayerAddedToAverage:R,gamesWithKillers:P.totalGames,totalEligibleForAverage:D.length}},[P,n.highlightedPlayer,c,T]),{totalDeathsData:Q,survivalRateData:ee,highlightedPlayerAddedToDeaths:ce,highlightedPlayerAddedToSurvival:he}=z.useMemo(()=>{if(!P||!K)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const t={},d=K.filter(s=>!s.LegacyData||s.LegacyData.deathInformationFilled===!0);d.forEach(s=>{s.PlayerStats.forEach(h=>{const f=h.Username;(!r||r==="Tous les camps"||V(h.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===r)&&(t[f]=(t[f]||0)+1)})});const o=P.playerDeathStats.sort((s,h)=>h.totalDeaths-s.totalDeaths).slice(0,15),i=n.highlightedPlayer&&o.some(s=>s.playerName===n.highlightedPlayer),D=o.map(s=>{const h=t[s.playerName]||0,f=h>0?(h-s.totalDeaths)/h*100:0,b={name:s.playerName,value:s.totalDeaths,totalDeaths:s.totalDeaths,gamesPlayed:h,deathRate:s.deathRate,survivalRate:f,isHighlightedAddition:!1};return T.forEach(k=>{b[k]=s.deathsByType[k]||0}),b});let B=!1;if(n.highlightedPlayer&&!i){const s=P.playerDeathStats.find(h=>h.playerName===n.highlightedPlayer);if(s){const h=t[s.playerName]||0,f=h>0?(h-s.totalDeaths)/h*100:0,b={name:s.playerName,value:s.totalDeaths,totalDeaths:s.totalDeaths,gamesPlayed:h,deathRate:s.deathRate,survivalRate:f,isHighlightedAddition:!0};T.forEach(k=>{b[k]=s.deathsByType[k]||0}),D.push(b),B=!0}}const N={},g={};d.forEach(s=>{s.PlayerStats.forEach(h=>{const f=h.Username;if((!r||r==="Tous les camps"||V(h.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===r)&&h.DeathType&&h.DeathType!=="N/A"){g[f]||(g[f]={totalDeaths:0,deathsByType:{}}),g[f].totalDeaths++;const k=h.DeathType;g[f].deathsByType[k]=(g[f].deathsByType[k]||0)+1}})}),Object.entries(t).forEach(([s,h])=>{if(h>=c){const f=g[s],b=f?f.totalDeaths:0,k=f?f.deathsByType:{},Z=h>0?(h-b)/h*100:0,J=h>0?b/h:0;N[s]={playerName:s,totalDeaths:b,deathsByType:k,gamesPlayed:h,survivalRate:Z,deathRate:J}}});const l=Object.values(N).sort((s,h)=>h.survivalRate-s.survivalRate).slice(0,15),v=n.highlightedPlayer&&l.some(s=>s.playerName===n.highlightedPlayer),A=l.map(s=>{const h={name:s.playerName,value:s.survivalRate,totalDeaths:s.totalDeaths,gamesPlayed:s.gamesPlayed,deathRate:s.deathRate,survivalRate:s.survivalRate,isHighlightedAddition:!1};return T.forEach(f=>{const b=s.deathsByType[f]||0;h[f]=s.gamesPlayed>0?b/s.gamesPlayed*100:0}),h});let C=!1;if(n.highlightedPlayer&&!v){let s=N[n.highlightedPlayer];if(!s){const h=t[n.highlightedPlayer]||0,f=g[n.highlightedPlayer],b=f?f.totalDeaths:0,k=f?f.deathsByType:{},Z=h>0?(h-b)/h*100:0,J=h>0?b/h:0;s={playerName:n.highlightedPlayer,totalDeaths:b,deathsByType:k,gamesPlayed:h,survivalRate:Z,deathRate:J}}if(s){const h={name:s.playerName,value:s.survivalRate,totalDeaths:s.totalDeaths,gamesPlayed:s.gamesPlayed,deathRate:s.deathRate,survivalRate:s.survivalRate,isHighlightedAddition:!0};T.forEach(f=>{const b=s.deathsByType[f]||0;h[f]=s.gamesPlayed>0?b/s.gamesPlayed*100:0}),A.push(h),C=!0}}return{totalDeathsData:D,survivalRateData:A,highlightedPlayerAddedToDeaths:B,highlightedPlayerAddedToSurvival:C}},[P,K,n.highlightedPlayer,c,T,r]);if(_)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."});if(L)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",L]});if(!P)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"});const de=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const i=d[0].payload,D=i.isHighlightedAddition,B=n.highlightedPlayer===i.name,N=T.reduce((g,R)=>g+(i[R]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",N]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),T.map(g=>{const R=i[g]||0;return R===0?null:e.jsxs("p",{style:{color:E[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:E[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ie(g),":"]})," ",R]},g)})]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},me=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const i=d[0].payload,D=i.isHighlightedAddition,B=n.highlightedPlayer===i.name,N=i.gamesPlayed>=c,g=P?.killerStats.find(v=>v.killerName===i.name),R=T.reduce((v,A)=>v+(i[A]||0),0),l=g?g.kills:Math.round(R*i.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",R.toFixed(2)," (",l," kills /",i.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),T.map(v=>{const A=i[v]||0;if(A===0)return null;const C=g?g.killsByDeathType[v]||0:Math.round(A*i.gamesPlayed);return e.jsxs("p",{style:{color:E[v],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:E[v],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ie(v),":"]})," ",A.toFixed(2)," (",C," kills /",i.gamesPlayed," games)"]},v)})]}),D&&!N&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",c," parties)"]}),D&&N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},ge=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const i=d[0].payload,D=i.isHighlightedAddition,B=n.highlightedPlayer===i.name,N=T.reduce((g,R)=>g+(i[R]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",N]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",i.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),T.map(g=>{const R=i[g]||0;return R===0?null:e.jsxs("p",{style:{color:E[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:E[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[re(g),":"]})," ",R]},g)})]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},ue=({active:t,payload:d,label:o})=>{if(t&&d&&d.length){const i=d[0].payload,D=i.isHighlightedAddition,B=n.highlightedPlayer===i.name,N=i.gamesPlayed>=c;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[o,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",i.survivalRate.toFixed(1),"% (",i.gamesPlayed-i.totalDeaths," survies / ",i.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",i.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),T.map(g=>{const R=i[g]||0;return R===0?null:e.jsxs("p",{style:{color:E[g],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:E[g],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[re(g),":"]})," ",R.toFixed(1),"%"]},g)})]}),D&&!N&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",c," parties)"]}),D&&N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),B&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:r,onChange:t=>m(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),I?.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:P.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:P.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:ne})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:r==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${r} (Total)`}),X&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(H,{title:r==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${r} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(G,{data:j,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(W,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(de,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"kills",fill:E[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};r!=="Tous les camps"&&(o.campFilter={selectedCamp:r,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,j.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:r==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${r} (Moyenne par partie)`}),le&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:c,onChange:t=>p(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ae.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(H,{title:r==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${r} (Moyenne par partie)`,children:e.jsx("div",{style:{height:400},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(G,{data:M,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(W,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(me,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"averageKills",fill:E[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};r!=="Tous les camps"&&(o.campFilter={selectedCamp:r,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,M.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",oe," ayant au moins ",c," partie",c>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:r==="Tous les camps"?"Morts (Total)":`Morts en ${r} (Total)`}),ce&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(H,{title:r==="Tous les camps"?"Morts (Total)":`Morts en ${r} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(G,{data:Q,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(W,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(ge,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"deaths",fill:E[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};r!=="Tous les camps"&&(o.campFilter={selectedCamp:r,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,Q.filter(t=>!t.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",r==="Tous les camps"?"(Total)":` en ${r}`]}),he&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',n.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:c,onChange:t=>p(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ae.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(H,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(G,{data:ee,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(W,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:d,payload:o})=>e.jsx("text",{x:t,y:d,dy:16,textAnchor:"end",fill:n.highlightedPlayer===o.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===o.value?14:13,fontWeight:n.highlightedPlayer===o.value?"bold":"italic",transform:`rotate(-45 ${t} ${d})`,children:o.value})}),e.jsx(Y,{label:{value:"Taux de mort (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(ue,{})}),T.map(t=>e.jsx(q,{dataKey:t,name:t,stackId:"survivalRate",fill:E[t],onClick:d=>{const o={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};r!=="Tous les camps"&&(o.campFilter={selectedCamp:r,campFilterMode:"all-assignments"}),S(o)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,ee.filter(t=>!t.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",c," partie",c>1?"s":"",")"]})]})]}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]})}export{Me as DeathStatisticsChart};
