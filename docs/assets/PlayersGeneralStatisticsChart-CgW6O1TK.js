import{r as h,u as ie,a as re,j as e}from"./index-B3wecELc.js";import{u as ae}from"./usePlayerStatsFromRaw-rdUySbqf.js";import{u as ne}from"./useJoueursData-CJdyOtyA.js";import{u as le,m as se}from"./api-BwWWltfz.js";import{c as oe,r as ce,F as G,C as B,X as V,Y as q,a as $}from"./FullscreenChart-D9sCUYmF.js";import{u as de,a as he,r as ge,b as ue,c as me,d as F,s as ye,e as pe,f as K,g as fe,h as ve,L as xe,i as Pe,C as je,j as be,k as J,l as X,R as Y,T as _}from"./CategoricalChart-BIxr-SH-.js";import{B as Q,a as U}from"./BarChart-CUwAbdxX.js";import"./baseStatsHook-CBPp9vwk.js";import"./datasyncExport-CjB7UYqV.js";function Z(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(t,m).enumerable})),n.push.apply(n,o)}return n}function ee(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Z(Object(n),!0).forEach(function(o){I(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function I(t,r,n){return(r=Se(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Se(t){var r=Ae(t,"string");return typeof r=="symbol"?r:r+""}function Ae(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,r);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function D(){return D=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},D.apply(null,arguments)}var Re=(t,r)=>{var n;return h.isValidElement(t)?n=h.cloneElement(t,r):typeof t=="function"?n=t(r):n=h.createElement("line",D({},r,{className:"recharts-reference-line-line"})),n},we=(t,r,n,o,m,f,l,g,y)=>{var{x:u,y:S,width:A,height:v}=m;if(n){var{y:C}=y,p=t.y.apply(C,{position:f});if(J(p)||y.ifOverflow==="discard"&&!t.y.isInRange(p))return null;var j=[{x:u+A,y:p},{x:u,y:p}];return g==="left"?j.reverse():j}if(r){var{x:R}=y,x=t.x.apply(R,{position:f});if(J(x)||y.ifOverflow==="discard"&&!t.x.isInRange(x))return null;var W=[{x,y:S+v},{x,y:S}];return l==="top"?W.reverse():W}if(o){var{segment:E}=y,w=E.map(i=>t.apply(i,{position:f}));return y.ifOverflow==="discard"&&w.some(i=>!t.isInRange(i))?null:w}return null};function Oe(t){var r=de();return h.useEffect(()=>(r(he(t)),()=>{r(ge(t))})),null}function Te(t){var{x:r,y:n,segment:o,xAxisId:m,yAxisId:f,shape:l,className:g,ifOverflow:y}=t,u=ue(),S=me(),A=F(P=>ye(P,m)),v=F(P=>pe(P,f)),C=F(P=>K(P,"xAxis",m,u)),p=F(P=>K(P,"yAxis",f,u)),j=fe(),R=X(r),x=X(n);if(!S||!j||A==null||v==null||C==null||p==null)return null;var W=oe({x:C,y:p}),E=o&&o.length===2,w=we(W,R,x,E,j,t.position,A.orientation,v.orientation,t);if(!w)return null;var[{x:i,y:s},{x:a,y:d}]=w,O=y==="hidden"?"url(#".concat(S,")"):void 0,T=ee(ee({clipPath:O},ve(t)),{},{x1:i,y1:s,x2:a,y2:d});return h.createElement(xe,{className:Pe("recharts-reference-line",g)},Re(l,T),h.createElement(je,ce({x1:i,y1:s,x2:a,y2:d}),h.createElement(be,{label:t.label}),t.children))}function Ce(t){return h.createElement(h.Fragment,null,h.createElement(Oe,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y}),h.createElement(Te,t))}class k extends h.Component{render(){return h.createElement(Ce,this.props)}}I(k,"displayName","ReferenceLine");I(k,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});const We=400;function Me(){const{data:t,isLoading:r,error:n}=ae(),{navigateToGameDetails:o,navigationState:m,updateNavigationState:f}=ie(),{settings:l}=re(),[g,y]=h.useState(m.playersGeneralState?.minGamesForWinRate||10),[u,S]=h.useState(m.playersGeneralState?.winRateOrder||"best"),[A,v]=h.useState(null),{joueursData:C}=ne(),p=le(C);h.useEffect(()=>{const i=m.playersGeneralState;(!i||i.minGamesForWinRate!==g||i.winRateOrder!==u)&&f({playersGeneralState:{minGamesForWinRate:g,winRateOrder:u,focusChart:i?.focusChart}})},[g,u,f]);const{participationData:j,winRateData:R,averageWinRate:x,totalEligiblePlayers:W,highlightedPlayerInParticipation:E,highlightedPlayerInWinRate:w}=h.useMemo(()=>{if(!t?.playerStats)return{participationData:[],winRateData:[],averageWinRate:"0",totalEligiblePlayers:0,highlightedPlayerInParticipation:!1,highlightedPlayerInWinRate:!1};const i=t.playerStats,s=[],a=[];let d=0;for(const c of i)d+=parseFloat(c.winPercent),c.gamesPlayed>=g&&s.push(c),c.gamesPlayed>2&&a.push(c);const O=i.length>0?(d/i.length).toFixed(1):"0",T=a.sort((c,b)=>b.gamesPlayed-c.gamesPlayed).slice(0,15),P=l.highlightedPlayer&&T.some(c=>c.player===l.highlightedPlayer);let N=[...T],H=!1;if(l.highlightedPlayer&&!P){const c=a.find(b=>b.player===l.highlightedPlayer);c&&(N.push({...c,isHighlightedAddition:!0}),H=!0)}const z=s.sort((c,b)=>u==="best"?parseFloat(b.winPercent)-parseFloat(c.winPercent):parseFloat(c.winPercent)-parseFloat(b.winPercent)).slice(0,15),te=l.highlightedPlayer&&z.some(c=>c.player===l.highlightedPlayer);let L=[...z],M=!1;if(l.highlightedPlayer&&!te){const c=i.find(b=>b.player===l.highlightedPlayer);c&&(L.push({...c,isHighlightedAddition:!0}),M=!0)}return{participationData:N,winRateData:L,averageWinRate:O,totalEligiblePlayers:s.length,highlightedPlayerInParticipation:H,highlightedPlayerInWinRate:M}},[t,g,u,l.highlightedPlayer]);return r?e.jsx("div",{className:"donnees-attente",children:"RÃ©cupÃ©ration des statistiques des joueurs..."}):n?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",n]}):t?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques des Joueurs"}),e.jsxs("p",{className:"lycans-stats-info",children:["Total de ",t.totalGames," parties analysÃ©es avec ",t.playerStats.length," joueurs"]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Top Participations"}),E&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Top Participations",children:e.jsx("div",{style:{height:450},children:e.jsx(Y,{width:"100%",height:"100%",children:e.jsxs(Q,{data:j,margin:{top:100,right:30,left:20,bottom:10},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:i,y:s,payload:a})=>e.jsx("text",{x:i,y:s,dy:16,textAnchor:"end",fill:l.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===a.value?14:13,fontWeight:l.highlightedPlayer===a.value?"bold":"italic",transform:`rotate(-45 ${i} ${s})`,children:a.value})}),e.jsx(q,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:({active:i,payload:s})=>{if(i&&s&&s.length>0){const a=s[0].payload,d=a.isHighlightedAddition,O=l.highlightedPlayer===a.player;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:a.player})}),e.jsxs("div",{children:["Parties jouÃ©es : ",a.gamesPlayed]}),e.jsxs("div",{children:["Pourcentage : ",a.gamesPlayedPercent,"%"]}),d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),O&&!d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(U,{dataKey:"gamesPlayed",name:"Parties jouÃ©es",fill:"#00C49F",children:j.map(i=>{const s=l.highlightedPlayer===i.player,a=A===i.player,d=i.isHighlightedAddition;return e.jsx($,{fill:p[i.player]||"#00C49F",stroke:s?"var(--accent-primary)":a?"var(--text-primary)":"none",strokeWidth:s?3:a?2:0,strokeDasharray:d?"5,5":"none",opacity:d?.8:1,onClick:()=>{o({selectedPlayer:i.player,fromComponent:"Statistiques Joueurs"})},onMouseEnter:()=>v(i.player),onMouseLeave:()=>v(null),style:{cursor:"pointer"}},`cell-participation-${i.player}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:u==="best"?"Meilleurs Taux de Victoire":"Moins Bons Taux de Victoire"}),w&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsxs("select",{value:u,onChange:i=>S(i.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[e.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),e.jsx("option",{value:"worst",children:"Moins Bons Taux de Victoire"})]}),e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:g,onChange:i=>y(Number(i.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:se.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsx(G,{title:u==="best"?"Meilleurs Taux de Victoire":"Moins Bons Taux de Victoire",children:e.jsx("div",{style:{height:We},children:e.jsx(Y,{width:"100%",height:"100%",children:e.jsxs(Q,{data:R,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(B,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:i,y:s,payload:a})=>e.jsx("text",{x:i,y:s,dy:16,textAnchor:"end",fill:l.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===a.value?14:13,fontWeight:l.highlightedPlayer===a.value?"bold":"italic",transform:`rotate(-45 ${i} ${s})`,children:a.value})}),e.jsx(q,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(_,{content:({active:i,payload:s})=>{if(i&&s&&s.length>0){const a=s[0].payload,d=a.isHighlightedAddition,O=l.highlightedPlayer===a.player,T=a.gamesPlayed>=g;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:a.player})}),e.jsxs("div",{children:["Taux de victoire : ",a.winPercent,"%"]}),e.jsxs("div",{children:["Victoires : ",a.wins," / ",a.gamesPlayed]}),d&&!T&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",g," parties)"]}),d&&T&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),O&&!d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(U,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:R.map(i=>{const s=l.highlightedPlayer===i.player,a=A===i.player,d=i.isHighlightedAddition;return e.jsx($,{fill:p[i.player]||"#8884d8",stroke:s?"var(--accent-primary)":a?"var(--text-primary)":"none",strokeWidth:s?3:a?2:0,strokeDasharray:d?"5,5":"none",opacity:d?.8:1,onClick:()=>{o({selectedPlayer:i.player,selectedPlayerWinMode:"wins-only",fromComponent:"Taux de Victoire"})},onMouseEnter:()=>v(i.player),onMouseLeave:()=>v(null),style:{cursor:"pointer"}},`cell-winrate-${i.player}`)})}),e.jsx(k,{y:parseFloat(x),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${x}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",R.length," des joueurs (sur ",W," ayant au moins ",g," partie",g>1?"s":"",")"]})]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de joueur disponible"})}export{Me as PlayersGeneralStatisticsChart};
