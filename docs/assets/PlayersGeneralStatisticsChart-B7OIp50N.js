import{r as c,u as H,j as r}from"./index-BQ0kkpX9.js";import{u as Q}from"./usePlayerStatsFromRaw-D8zTlIUh.js";import{p as N,m as U}from"./api-beq3FXpM.js";import{c as Z,r as _,F as D,B as I,C as L,X as k,Y as W,a as B,b as V}from"./FullscreenChart-DUPQ9FcI.js";import{u as ee,a as re,r as te,b as ae,c as ie,d as O,s as ne,e as se,f as M,g as le,h as oe,L as ce,i as de,j as ue,k as q,l as z,R as G,T as K}from"./CategoricalChart-B9XBdh-E.js";import"./useRawGameData-DP6-F-OP.js";function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?X(Object(a),!0).forEach(function(n){A(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function A(e,t,a){return(t=me(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function me(e){var t=xe(e,"string");return typeof t=="symbol"?t:t+""}function xe(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var n=a.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)({}).hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},R.apply(null,arguments)}var ye=(e,t)=>{var a;return c.isValidElement(e)?a=c.cloneElement(e,t):typeof e=="function"?a=e(t):a=c.createElement("line",R({},t,{className:"recharts-reference-line-line"})),a},fe=(e,t,a,n,d,f,x,w,u)=>{var{x:y,y:p,width:j,height:i}=d;if(a){var{y:l}=u,s=e.y.apply(l,{position:f});if(q(s)||u.ifOverflow==="discard"&&!e.y.isInRange(s))return null;var v=[{x:y+j,y:s},{x:y,y:s}];return w==="left"?v.reverse():v}if(t){var{x:S}=u,h=e.x.apply(S,{position:f});if(q(h)||u.ifOverflow==="discard"&&!e.x.isInRange(h))return null;var b=[{x:h,y:p+i},{x:h,y:p}];return x==="top"?b.reverse():b}if(n){var{segment:o}=u,m=o.map(P=>e.apply(P,{position:f}));return u.ifOverflow==="discard"&&m.some(P=>!e.isInRange(P))?null:m}return null};function pe(e){var t=ee();return c.useEffect(()=>(t(re(e)),()=>{t(te(e))})),null}function ve(e){var{x:t,y:a,segment:n,xAxisId:d,yAxisId:f,shape:x,className:w,ifOverflow:u}=e,y=ae(),p=ie(),j=O(g=>ne(g,d)),i=O(g=>se(g,f)),l=O(g=>M(g,"xAxis",d,y)),s=O(g=>M(g,"yAxis",f,y)),v=le(),S=z(t),h=z(a);if(!p||!v||j==null||i==null||l==null||s==null)return null;var b=Z({x:l,y:s}),o=n&&n.length===2,m=fe(b,S,h,o,v,e.position,j.orientation,i.orientation,e);if(!m)return null;var[{x:P,y:T},{x:E,y:F}]=m,$=u==="hidden"?"url(#".concat(p,")"):void 0,J=Y(Y({clipPath:$},oe(e,!0)),{},{x1:P,y1:T,x2:E,y2:F});return c.createElement(ce,{className:de("recharts-reference-line",w)},ye(x,J),ue.renderCallByParent(e,_({x1:P,y1:T,x2:E,y2:F})))}function he(e){return c.createElement(c.Fragment,null,c.createElement(pe,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),c.createElement(ve,e))}class C extends c.Component{render(){return c.createElement(he,this.props)}}A(C,"displayName","ReferenceLine");A(C,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Oe(){const{data:e,isLoading:t,error:a}=Q(),{navigateToGameDetails:n}=H(),[d,f]=c.useState(50),[x,w]=c.useState("best"),{participationData:u,winRateData:y,averageWinRate:p,totalEligiblePlayers:j}=c.useMemo(()=>{if(!e?.playerStats)return{participationData:[],winRateData:[],averageWinRate:"0",totalEligiblePlayers:0};const i=e.playerStats,l=[],s=[];let v=0;for(const o of i)v+=parseFloat(o.winPercent),o.gamesPlayed>=d&&l.push(o),o.gamesPlayed>2&&s.push(o);const S=i.length>0?(v/i.length).toFixed(1):"0",h=s.sort((o,m)=>m.gamesPlayed-o.gamesPlayed).slice(0,20),b=l.sort((o,m)=>x==="best"?parseFloat(m.winPercent)-parseFloat(o.winPercent):parseFloat(o.winPercent)-parseFloat(m.winPercent)).slice(0,20);return{participationData:h,winRateData:b,averageWinRate:S,totalEligiblePlayers:l.length}},[e,d,x]);return t?r.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques des joueurs..."}):a?r.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",a]}):e?r.jsxs("div",{className:"lycans-players-stats",children:[r.jsx("h2",{children:"Statistiques des Joueurs"}),r.jsxs("p",{className:"lycans-stats-info",children:["Total de ",e.totalGames," parties analysées avec ",e.playerStats.length," joueurs"]}),r.jsxs("div",{className:"lycans-graphiques-groupe",children:[r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsx("h3",{children:"Top Participations"}),r.jsx(D,{title:"Top Participations",children:r.jsx("div",{style:{height:400},children:r.jsx(G,{width:"100%",height:"100%",children:r.jsxs(I,{data:u,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(L,{strokeDasharray:"3 3"}),r.jsx(k,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(W,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),r.jsx(K,{content:({active:i,payload:l})=>{if(i&&l&&l.length>0){const s=l[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:s.player})}),r.jsxs("div",{children:["Parties jouées : ",s.gamesPlayed]}),r.jsxs("div",{children:["Pourcentage : ",s.gamesPlayedPercent,"%"]}),r.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir les parties"})]})}return null}}),r.jsx(B,{dataKey:"gamesPlayed",name:"Parties jouées",fill:"#00C49F",children:u.map(i=>r.jsx(V,{fill:N[i.player]||"#00C49F",onClick:()=>{n({selectedPlayer:i.player,fromComponent:"Statistiques Joueurs"})},style:{cursor:"pointer"}},`cell-participation-${i.player}`))})]})})})})]}),r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[r.jsx("h3",{children:x==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),r.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),r.jsx("select",{id:"min-games-select",value:d,onChange:i=>f(Number(i.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:U.map(i=>r.jsx("option",{value:i,children:i},i))}),r.jsxs("select",{value:x,onChange:i=>w(i.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[r.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),r.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),r.jsx(D,{title:x==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire",children:r.jsx("div",{style:{height:400},children:r.jsx(G,{width:"100%",height:"100%",children:r.jsxs(I,{data:y,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(L,{strokeDasharray:"3 3"}),r.jsx(k,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(W,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),r.jsx(K,{content:({active:i,payload:l})=>{if(i&&l&&l.length>0){const s=l[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:s.player})}),r.jsxs("div",{children:["Taux de victoire : ",s.winPercent,"%"]}),r.jsxs("div",{children:["Victoires : ",s.wins," / ",s.gamesPlayed]}),r.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir les parties"})]})}return null}}),r.jsx(B,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:y.map(i=>r.jsx(V,{fill:N[i.player]||"#8884d8",onClick:()=>{n({selectedPlayer:i.player,fromComponent:"Taux de Victoire"})},style:{cursor:"pointer"}},`cell-winrate-${i.player}`))}),r.jsx(C,{y:parseFloat(p),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${p}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})})}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",y.length," des joueurs (sur ",j," ayant au moins ",d," partie",d>1?"s":"",")"]})]})]})]}):r.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de joueur disponible"})}export{Oe as PlayersGeneralStatisticsChart};
