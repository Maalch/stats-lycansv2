import{u as J,a as _,r as M,j as e,h as ae}from"./index-BVFt3X19.js";import{g as Q,u as re,a as se,b as le,c as ne}from"./useDeathStatisticsFromRaw-D7qFeIZ9.js";import{u as oe}from"./baseStatsHook-CFxsVQYF.js";import{g as ce,D as E}from"./datasyncExport-CjB7UYqV.js";import{m as Y,u as X,a as ie}from"./api-Blw0Uzvd.js";import{D as C,g as ee}from"./deathTypes-gHH1w6_X.js";import{F as W,C as V,X as F,Y as q,a as U}from"./FullscreenChart-BweZfKwi.js";import{R as G,T as $}from"./CategoricalChart-DsnLyAn9.js";import{B as w,a as O}from"./BarChart-Dy7esl00.js";import{u as Z}from"./useJoueursData-C3eJ-r8b.js";function te(o){if(!o||o.trim()==="")return null;const g=o.trim().slice(1),v=parseInt(g,10);return isNaN(v)||v<1?null:v}function de(o,j){if(o.length===0)return null;const g={},v={};o.forEach(b=>{let l=1;if(b.EndTiming){const p=te(b.EndTiming);p&&(l=p)}b.PlayerStats.forEach(p=>{if(j&&j!=="Tous les camps"&&ce(p.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==j)return;const D=p.Username;g[D]||(g[D]={playerName:D,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const R=g[D];R.totalGames++;let T=null;p.DeathTiming&&(T=te(p.DeathTiming));for(let N=1;N<=l;N++)R.gamesPlayedByDay[N]||(R.gamesPlayedByDay[N]=0,R.survivalsByDay[N]=0),v[N]||(v[N]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),R.gamesPlayedByDay[N]++,v[N].playersOnDay++,(!T||T>N)&&(R.survivalsByDay[N]++,v[N].survivorsOnDay++)});for(let p=1;p<=l;p++)v[p]||(v[p]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),v[p].gamesReachingDay++}),Object.values(g).forEach(b=>{Object.keys(b.gamesPlayedByDay).forEach(l=>{const p=parseInt(l),D=b.gamesPlayedByDay[p],R=b.survivalsByDay[p];D>0?b.survivalRatesByDay[p]=R/D*100:b.survivalRatesByDay[p]=0})});const y=Object.values(g).filter(b=>b.totalGames>0).sort((b,l)=>l.totalGames-b.totalGames),K=Object.entries(v).map(([b,l])=>({dayNumber:parseInt(b),totalGamesReachingDay:l.gamesReachingDay,totalPlayersOnDay:l.playersOnDay,averageSurvivalRate:l.playersOnDay>0?l.survivorsOnDay/l.playersOnDay*100:0})).sort((b,l)=>b.dayNumber-l.dayNumber);return{totalGames:o.length,totalPlayersAnalyzed:y.length,playerSurvivalStats:y,dayStats:K}}function he(o,j,g=10){return o.playerSurvivalStats.filter(v=>v.totalGames>=g&&(v.gamesPlayedByDay[j]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[j]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[j]||0,timesSurvivedDay:v.survivalsByDay[j]||0})).sort((v,y)=>y.survivalRate-v.survivalRate).slice(0,15)}function ge(o,j,g=10){return o.playerSurvivalStats.filter(v=>v.totalGames>=g&&(v.gamesPlayedByDay[j]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[j]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[j]||0,timesSurvivedDay:v.survivalsByDay[j]||0})).sort((v,y)=>v.survivalRate-y.survivalRate).slice(0,15)}function me(o){return oe(j=>de(j,o))}function ue({deathStats:o,selectedCamp:j,victimCampFilter:g,minGamesForAverage:v,onMinGamesChange:y,availableDeathTypes:K,deathTypeColors:b,totalEligibleForAverage:l}){const{navigateToGameDetails:p}=J(),{settings:D}=_(),R=a=>{if(g==="Tous les camps"){const t=a.filter(n=>n!==C.BULLET_HUMAN&&n!==C.BULLET_WOLF);return(a.includes(C.BULLET_HUMAN)||a.includes(C.BULLET_WOLF))&&!t.includes(C.BULLET)&&t.push(C.BULLET),t}return a},T=M.useMemo(()=>R(K),[K,g]),N=M.useMemo(()=>{const a={...b};if(g==="Tous les camps"&&!a[C.BULLET]){const t=b[C.BULLET_HUMAN]||b[C.BULLET_WOLF];t&&(a[C.BULLET]=t)}return a},[b,g]),z=a=>{if(g==="Tous les camps"){const t=a.killsByDeathType[C.BULLET_HUMAN]||0,n=a.killsByDeathType[C.BULLET_WOLF]||0,d=a.killsByDeathType[C.BULLET]||0,m={...a.killsByDeathType};return m[C.BULLET]=t+n+d,delete m[C.BULLET_HUMAN],delete m[C.BULLET_WOLF],{...a,killsByDeathType:m}}return a},L=a=>{let t="Top Tueurs";return j!=="Tous les camps"&&(t+=` en ${j}`),g!=="Tous les camps"&&(g==="Roles solo"?t+=" (victimes: Roles solo)":t+=` (victimes: ${g})`),a==="total"?t+=" (Total)":t+=" (Moyenne par Partie)",t},{totalKillsData:A,averageKillsData:f,highlightedPlayerAddedToTotal:k,highlightedPlayerAddedToAverage:c}=M.useMemo(()=>{if(!o)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const a=o.killerStats.sort((s,u)=>u.kills-s.kills).slice(0,15),t=D.highlightedPlayer&&a.some(s=>s.killerName===D.highlightedPlayer),n=a.map(s=>{const u=z(s),B={name:u.killerName,value:u.kills,victims:u.victims.length,percentage:u.percentage,gamesPlayed:u.gamesPlayed,averageKillsPerGame:u.averageKillsPerGame,isHighlightedAddition:!1};return T.forEach(S=>{B[S]=u.killsByDeathType[S]||0}),B});let d=!1;if(D.highlightedPlayer&&!t){const s=o.killerStats.find(u=>u.killerName===D.highlightedPlayer);if(s){const u=z(s),B={name:u.killerName,value:u.kills,victims:u.victims.length,percentage:u.percentage,gamesPlayed:u.gamesPlayed,averageKillsPerGame:u.averageKillsPerGame,isHighlightedAddition:!0};T.forEach(S=>{B[S]=u.killsByDeathType[S]||0}),n.push(B),d=!0}}const i=o.killerStats.filter(s=>s.gamesPlayed>=v).sort((s,u)=>u.averageKillsPerGame-s.averageKillsPerGame).slice(0,15),r=D.highlightedPlayer&&i.some(s=>s.killerName===D.highlightedPlayer),x=i.map(s=>{const u=z(s),B={name:u.killerName,value:u.averageKillsPerGame,victims:u.victims.length,percentage:u.percentage,gamesPlayed:u.gamesPlayed,averageKillsPerGame:u.averageKillsPerGame,isHighlightedAddition:!1};return T.forEach(S=>{const I=u.killsByDeathType[S]||0;B[S]=u.gamesPlayed>0?I/u.gamesPlayed:0}),B});let H=!1;if(D.highlightedPlayer&&!r){const s=o.killerStats.find(u=>u.killerName===D.highlightedPlayer);if(s){const u=z(s),B={name:u.killerName,value:u.averageKillsPerGame,victims:u.victims.length,percentage:u.percentage,gamesPlayed:u.gamesPlayed,averageKillsPerGame:u.averageKillsPerGame,isHighlightedAddition:!0};T.forEach(S=>{const I=u.killsByDeathType[S]||0;B[S]=u.gamesPlayed>0?I/u.gamesPlayed:0}),x.push(B),H=!0}}return{totalKillsData:n,averageKillsData:x,highlightedPlayerAddedToTotal:d,highlightedPlayerAddedToAverage:H}},[o,D.highlightedPlayer,v,T,g]),h=({active:a,payload:t,label:n})=>{if(a&&t&&t.length){const d=t[0].payload,m=d.isHighlightedAddition,i=D.highlightedPlayer===d.name,r=T.reduce((x,H)=>x+(d[H]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:i?"var(--accent-primary)":"var(--text-primary)"},children:[n,m&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",r]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",d.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),T.map(x=>({deathType:x,count:d[x]||0})).filter(x=>x.count>0).sort((x,H)=>H.count-x.count).map(({deathType:x,count:H})=>e.jsxs("p",{style:{color:N[x],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[Q(x),":"]})," ",H]},x))]}),m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),i&&!m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},P=({active:a,payload:t,label:n})=>{if(a&&t&&t.length){const d=t[0].payload,m=d.isHighlightedAddition,i=D.highlightedPlayer===d.name,r=d.gamesPlayed>=v,x=o?.killerStats.find(B=>B.killerName===d.name),H=x?z(x):null,s=T.reduce((B,S)=>B+(d[S]||0),0),u=H?H.kills:Math.round(s*d.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:i?"var(--accent-primary)":"var(--text-primary)"},children:[n,m&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",s.toFixed(2)," (",u," kills /",d.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",d.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),T.map(B=>({deathType:B,avgCount:d[B]||0,totalKillsForDeathType:H?H.killsByDeathType[B]||0:Math.round((d[B]||0)*d.gamesPlayed)})).filter(B=>B.avgCount>0).sort((B,S)=>S.avgCount-B.avgCount).map(({deathType:B,avgCount:S,totalKillsForDeathType:I})=>e.jsxs("p",{style:{color:N[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[Q(B),":"]})," ",S.toFixed(2)," (",I," kills /",d.gamesPlayed," games)"]},B))]}),m&&!r&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",v," parties)"]}),m&&r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),i&&!m&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:L("total")}),k&&D.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',D.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:L("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:A,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:t,payload:n})=>e.jsx("text",{x:a,y:t,dy:10,fill:D.highlightedPlayer===n.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:D.highlightedPlayer===n.value?14:12,fontWeight:D.highlightedPlayer===n.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${t})`,children:n.value})}),e.jsx(q,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(h,{})}),T.map(a=>e.jsx(O,{dataKey:a,name:a,stackId:"kills",fill:N[a],onClick:t=>{const n={selectedPlayer:t?.name,fromComponent:"Statistiques de Mort"};j!=="Tous les camps"&&(n.campFilter={selectedCamp:j,campFilterMode:"all-assignments"}),p(n)}},a))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,A.filter(a=>!a.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:L("average")}),c&&D.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',D.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:v,onChange:a=>y(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx(W,{title:L("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:f,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:a,y:t,payload:n})=>e.jsx("text",{x:a,y:t,dy:10,fill:D.highlightedPlayer===n.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:D.highlightedPlayer===n.value?14:12,fontWeight:D.highlightedPlayer===n.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${a} ${t})`,children:n.value})}),e.jsx(q,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(P,{})}),T.map(a=>e.jsx(O,{dataKey:a,name:a,stackId:"averageKills",fill:N[a],onClick:t=>{const n={selectedPlayer:t?.name,fromComponent:"Statistiques de Mort"};j!=="Tous les camps"&&(n.campFilter={selectedCamp:j,campFilterMode:"all-assignments"}),p(n)}},a))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(a=>!a.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",l," ayant au moins ",v," partie",v>1?"s":"",")"]})]})]})}function ye({deathStats:o,selectedCamp:j,minGamesForAverage:g,onMinGamesChange:v,availableDeathTypes:y,deathTypeColors:K}){const{navigateToGameDetails:b}=J(),{settings:l}=_(),{joueursData:p}=Z(),D=X(p),[R,T]=M.useState(null),{totalDeathsData:N,survivalRateData:z,highlightedPlayerAddedToDeaths:L,highlightedPlayerAddedToSurvival:A}=M.useMemo(()=>{if(!o)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const c=o.playerDeathStats.sort((r,x)=>x.totalDeaths-r.totalDeaths).slice(0,15),h=l.highlightedPlayer&&c.some(r=>r.playerName===l.highlightedPlayer),P=c.map(r=>{const x=r.gamesPlayed,H=x>0?(x-r.totalDeaths)/x*100:0,s={name:r.playerName,value:r.totalDeaths,totalDeaths:r.totalDeaths,gamesPlayed:x,deathRate:r.deathRate,survivalRate:H,isHighlightedAddition:!1};return y.forEach(u=>{s[u]=r.deathsByType[u]||0}),s});let a=!1;if(l.highlightedPlayer&&!h){const r=o.playerDeathStats.find(x=>x.playerName===l.highlightedPlayer);if(r){const x=r.gamesPlayed,H=x>0?(x-r.totalDeaths)/x*100:0,s={name:r.playerName,value:r.totalDeaths,totalDeaths:r.totalDeaths,gamesPlayed:x,deathRate:r.deathRate,survivalRate:H,isHighlightedAddition:!0};y.forEach(u=>{s[u]=r.deathsByType[u]||0}),P.push(s),a=!0}}const n=o.playerDeathStats.filter(r=>r.gamesPlayed>=g).map(r=>({...r,survivalRate:r.gamesPlayed>0?(r.gamesPlayed-r.totalDeaths)/r.gamesPlayed*100:0})).sort((r,x)=>x.survivalRate-r.survivalRate).slice(0,15),d=l.highlightedPlayer&&n.some(r=>r.playerName===l.highlightedPlayer),m=n.map(r=>{const x={name:r.playerName,value:r.survivalRate,totalDeaths:r.totalDeaths,gamesPlayed:r.gamesPlayed,deathRate:r.deathRate,survivalRate:r.survivalRate,isHighlightedAddition:!1};return y.forEach(H=>{x[H]=r.deathsByType[H]||0}),x});let i=!1;if(l.highlightedPlayer&&!d){const r=o.playerDeathStats.find(x=>x.playerName===l.highlightedPlayer);if(r){const x=r.gamesPlayed>0?(r.gamesPlayed-r.totalDeaths)/r.gamesPlayed*100:0,H={name:r.playerName,value:x,totalDeaths:r.totalDeaths,gamesPlayed:r.gamesPlayed,deathRate:r.deathRate,survivalRate:x,isHighlightedAddition:!0};y.forEach(s=>{H[s]=r.deathsByType[s]||0}),m.push(H),i=!0}}return{totalDeathsData:P,survivalRateData:m,highlightedPlayerAddedToDeaths:a,highlightedPlayerAddedToSurvival:i}},[o,l.highlightedPlayer,g,y]),f=({active:c,payload:h,label:P})=>{if(c&&h&&h.length){const a=h[0].payload,t=a.isHighlightedAddition,n=l.highlightedPlayer===a.name,d=y.reduce((m,i)=>m+(a[i]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:n?"var(--accent-primary)":"var(--text-primary)"},children:[P,t&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",d]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",a.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",a.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),y.map(m=>{const i=a[m]||0;return i===0?null:e.jsxs("p",{style:{color:K[m],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ee(m),":"]})," ",i]},m)})]}),t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),n&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},k=({active:c,payload:h,label:P})=>{if(c&&h&&h.length){const a=h[0].payload,t=a.isHighlightedAddition,n=l.highlightedPlayer===a.name,d=a.gamesPlayed>=g;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:n?"var(--accent-primary)":"var(--text-primary)"},children:[P,t&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",a.survivalRate.toFixed(1),"% (",a.gamesPlayed-a.totalDeaths," survies / ",a.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",a.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",a.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),y.map(m=>{const i=a[m]||0;return i===0?null:e.jsxs("p",{style:{color:K[m],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ee(m),":"]})," ",i]},m)})]}),t&&!d&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",g," parties)"]}),t&&d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),n&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:j==="Tous les camps"?"Morts (Total)":`Morts en ${j} (Total)`}),L&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:j==="Tous les camps"?"Morts (Total)":`Morts en ${j} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:N,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:h,payload:P})=>e.jsx("text",{x:c,y:h,dy:10,fill:l.highlightedPlayer===P.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===P.value?14:12,fontWeight:l.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${h})`,children:P.value})}),e.jsx(q,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(f,{})}),y.map(c=>e.jsx(O,{dataKey:c,name:c,stackId:"deaths",fill:K[c],onClick:h=>{const P={selectedPlayer:h?.name,fromComponent:"Statistiques de Mort"};j!=="Tous les camps"&&(P.campFilter={selectedCamp:j,campFilterMode:"all-assignments"}),b(P)}},c))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,N.filter(c=>!c.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",j==="Tous les camps"?"(Total)":` en ${j}`]}),A&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:g,onChange:c=>v(Number(c.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsx(W,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:z,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:h,payload:P})=>e.jsx("text",{x:c,y:h,dy:10,fill:l.highlightedPlayer===P.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===P.value?14:12,fontWeight:l.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${h})`,children:P.value})}),e.jsx(q,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(k,{})}),e.jsx(O,{dataKey:"value",onClick:c=>{const h={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};j!=="Tous les camps"&&(h.campFilter={selectedCamp:j,campFilterMode:"all-assignments"}),b(h)},onMouseEnter:c=>T(c?.name||null),onMouseLeave:()=>T(null),style:{cursor:"pointer"},children:z.map((c,h)=>{const P=l.highlightedPlayer===c.name,a=c.isHighlightedAddition;return e.jsx(U,{fill:D[c.name]||"var(--chart-primary)",stroke:P?"var(--accent-primary)":R===c.name?"var(--text-primary)":"none",strokeWidth:P?3:R===c.name?2:0,strokeDasharray:a?"5,5":"none",opacity:a?.8:1},`cell-${h}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,z.filter(c=>!c.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",g," partie",g>1?"s":"",")"]})]})]})}function ve({hunterStats:o,isLoading:j,error:g}){const{navigateToGameDetails:v}=J(),{settings:y}=_(),K=ie(),{joueursData:b}=Z(),l=X(b),[p,D]=M.useState(null);if(j)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(g)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",g]});if(!o||o.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:R,highlightedPlayerAddedToBest:T,finalBadHuntersData:N,highlightedPlayerAddedToBad:z}=(()=>{const k=o.hunterStats.filter(i=>i.gamesPlayedAsHunter>=5).sort((i,r)=>r.averageNonVillageoisKillsPerGame-i.averageNonVillageoisKillsPerGame).slice(0,15),c=y.highlightedPlayer&&k.some(i=>i.hunterName===y.highlightedPlayer);let h=[...k],P=!1;if(y.highlightedPlayer&&!c){const i=o.hunterStats.find(r=>r.hunterName===y.highlightedPlayer);i&&(h.push({...i,isHighlightedAddition:!0}),P=!0)}const a=o.hunterStats.filter(i=>i.gamesPlayedAsHunter>=5).map(i=>({name:i.hunterName,averageVillageoisKills:Number((i.villageoisKills/i.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:i.villageoisKills,totalNonVillageoisKills:i.nonVillageoisKills,totalKills:i.totalKills,gamesPlayed:i.gamesPlayedAsHunter,victimsByCamp:i.victimsByCamp,goodVictimsByCamp:i.goodVictimsByCamp,badVictimsByCamp:i.badVictimsByCamp,hunterName:i.hunterName})),t=a.sort((i,r)=>r.averageVillageoisKills-i.averageVillageoisKills).slice(0,15),n=y.highlightedPlayer&&t.some(i=>i.hunterName===y.highlightedPlayer);let d=[...t],m=!1;if(y.highlightedPlayer&&!n){const i=a.find(r=>r.hunterName===y.highlightedPlayer);i&&(d.push({...i,isHighlightedAddition:!0}),m=!0)}return{finalBestHuntersData:h,highlightedPlayerAddedToBest:P,finalBadHuntersData:d,highlightedPlayerAddedToBad:m}})(),L=({active:f,payload:k,label:c})=>{if(f&&k&&k.length){const h=k[0].payload,P=h.isHighlightedAddition,a=y.highlightedPlayer===h.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:a?"var(--accent-primary)":"var(--text-primary)"},children:[c,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",h.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",h.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",h.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",h.totalKills]}),h.goodVictimsByCamp&&Object.keys(h.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(h.goodVictimsByCamp).map(([t,n])=>e.jsxs("p",{style:{color:K[t]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[t,":"]})," ",n]},t))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),a&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},A=({active:f,payload:k,label:c})=>{if(f&&k&&k.length){const h=k[0].payload,P=h.isHighlightedAddition,a=y.highlightedPlayer===h.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:a?"var(--accent-primary)":"var(--text-primary)"},children:[c,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",h.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",h.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",h.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",h.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",h.totalKills]}),h.badVictimsByCamp&&Object.keys(h.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(h.badVictimsByCamp).map(([t,n])=>e.jsxs("p",{style:{color:K[t]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[t,":"]})," ",n]},t))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),a&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),T&&y.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',y.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:f,y:k,payload:c})=>e.jsx("text",{x:f,y:k,dy:10,fill:y.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:y.highlightedPlayer===c.value?14:12,fontWeight:y.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${f} ${k})`,children:c.value})}),e.jsx(q,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(L,{})}),e.jsx(O,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:f=>{f?.hunterName&&v({selectedPlayer:f.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:f=>D(f?.hunterName||null),onMouseLeave:()=>D(null),style:{cursor:"pointer"},children:R.map((f,k)=>{const c=y.highlightedPlayer===f.hunterName,h=f.isHighlightedAddition;return e.jsx(U,{fill:l[f.hunterName]||K.Chasseur||"#8884d8",stroke:c?"var(--accent-primary)":p===f.hunterName?"var(--text-primary)":"none",strokeWidth:c?3:p===f.hunterName?2:0,strokeDasharray:h?"5,5":"none",opacity:h?.8:1},`cell-${k}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(f=>!f.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),z&&y.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',y.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:N,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:f,y:k,payload:c})=>e.jsx("text",{x:f,y:k,dy:10,fill:y.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:y.highlightedPlayer===c.value?14:12,fontWeight:y.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${f} ${k})`,children:c.value})}),e.jsx(q,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(A,{})}),e.jsx(O,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:f=>{f?.hunterName&&v({selectedPlayer:f.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:f=>D(f?.hunterName||null),onMouseLeave:()=>D(null),style:{cursor:"pointer"},children:N.map((f,k)=>{const c=y.highlightedPlayer===f.hunterName,h=f.isHighlightedAddition;return e.jsx(U,{fill:l[f.hunterName]||K.Chasseur||"#8884d8",stroke:c?"var(--accent-primary)":p===f.hunterName?"var(--text-primary)":"none",strokeWidth:c?3:p===f.hunterName?2:0,strokeDasharray:h?"5,5":"none",opacity:h?.8:1},`cell-${k}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,N.filter(f=>!f.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function pe({survivalStats:o,selectedCamp:j,minGamesForAverage:g,onMinGamesChange:v,isLoading:y,error:K}){const{navigateToGameDetails:b}=J(),{settings:l}=_(),{joueursData:p}=Z(),D=X(p),[R,T]=M.useState(1),[N,z]=M.useState(null),L=M.useMemo(()=>o?o.dayStats.filter(n=>n.totalGamesReachingDay>0).map(n=>n.dayNumber).sort((n,d)=>n-d):[],[o]),A=M.useMemo(()=>L.includes(R)?R:L.length>0?L[0]:1,[R,L]),{highestSurvivalData:f,highlightedPlayerAddedToHighest:k}=M.useMemo(()=>{if(!o)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const t=he(o,A,g),n=l.highlightedPlayer&&t.some(i=>i.playerName===l.highlightedPlayer),d=t.map(i=>({name:i.playerName,value:i.survivalRate,gamesPlayed:i.gamesPlayed,timesReachedDay:i.timesReachedDay,timesSurvivedDay:i.timesSurvivedDay,isHighlightedAddition:!1}));let m=!1;if(l.highlightedPlayer&&!n){const i=o.playerSurvivalStats.find(r=>r.playerName===l.highlightedPlayer);if(i&&i.totalGames>=g&&(i.gamesPlayedByDay[A]||0)>0){const r=i.survivalRatesByDay[A]||0;d.push({name:l.highlightedPlayer,value:r,gamesPlayed:i.totalGames,timesReachedDay:i.gamesPlayedByDay[A]||0,timesSurvivedDay:i.survivalsByDay[A]||0,isHighlightedAddition:!0}),m=!0}}return{highestSurvivalData:d,highlightedPlayerAddedToHighest:m}},[o,A,g,l.highlightedPlayer]),{lowestSurvivalData:c,highlightedPlayerAddedToLowest:h}=M.useMemo(()=>{if(!o)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const t=ge(o,A,g),n=l.highlightedPlayer&&t.some(i=>i.playerName===l.highlightedPlayer),d=t.map(i=>({name:i.playerName,value:i.survivalRate,gamesPlayed:i.gamesPlayed,timesReachedDay:i.timesReachedDay,timesSurvivedDay:i.timesSurvivedDay,isHighlightedAddition:!1}));let m=!1;if(l.highlightedPlayer&&!n){const i=o.playerSurvivalStats.find(r=>r.playerName===l.highlightedPlayer);if(i&&i.totalGames>=g&&(i.gamesPlayedByDay[A]||0)>0){const r=i.survivalRatesByDay[A]||0;d.push({name:l.highlightedPlayer,value:r,gamesPlayed:i.totalGames,timesReachedDay:i.gamesPlayedByDay[A]||0,timesSurvivedDay:i.survivalsByDay[A]||0,isHighlightedAddition:!0}),m=!0}}return{lowestSurvivalData:d,highlightedPlayerAddedToLowest:m}},[o,A,g,l.highlightedPlayer]),P=t=>{b({selectedPlayer:t,fromComponent:"Statistiques de Survie"})},a=({active:t,payload:n,label:d})=>{if(t&&n&&n.length>0){const m=n[0].payload,i=m.isHighlightedAddition,r=l.highlightedPlayer===m.name,x=m.gamesPlayed>=g,H=m.timesReachedDay-m.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:d})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",A,": ",m.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",A,": ",m.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",A,": ",m.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",A,": ",H]}),e.jsxs("div",{children:["Total de parties: ",m.gamesPlayed]}),i&&!x&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",g," parties au total)"]}),i&&x&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),r&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return y?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):K?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",K]}):o?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",A," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",k||h?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:A,onChange:t=>T(parseInt(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:L.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:g,onChange:t=>v(parseInt(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:Y.map(t=>e.jsx("option",{value:t,children:t},t))})]})]})}),A&&o.dayStats.find(t=>t.dayNumber===A)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:A===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${A}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:o.dayStats.find(t=>t.dayNumber===A)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",A]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(o.dayStats.find(t=>t.dayNumber===A)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",g," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:o.playerSurvivalStats.filter(t=>t.totalGames>=g&&(t.gamesPlayedByDay[A]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",A]}),k&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${A}`,children:e.jsx("div",{style:{height:400},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:f,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(F,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:t,y:n,payload:d})=>e.jsx("text",{x:t,y:n,dy:16,textAnchor:"end",transform:`rotate(-45, ${t}, ${n})`,fill:l.highlightedPlayer===d.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===d.value?14:12,fontWeight:l.highlightedPlayer===d.value?"bold":"normal",children:d.value})}),e.jsx(q,{tickFormatter:t=>`${t.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(a,{})}),e.jsx(O,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:f.map((t,n)=>{const d=l.highlightedPlayer===t.name,m=N===t.name,i=t.isHighlightedAddition;return e.jsx(U,{fill:D[t.name]||"var(--chart-primary)",stroke:d?"var(--accent-primary)":m?"var(--text-primary)":"none",strokeWidth:d?3:m?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1,onClick:()=>P(t.name),onMouseEnter:()=>z(t.name),onMouseLeave:()=>z(null),style:{cursor:"pointer"}},`cell-highest-${n}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",A]}),h&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(W,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${A}`,children:e.jsx("div",{style:{height:400},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(w,{data:c,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(F,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:t,y:n,payload:d})=>e.jsx("text",{x:t,y:n,dy:16,textAnchor:"end",transform:`rotate(-45, ${t}, ${n})`,fill:l.highlightedPlayer===d.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===d.value?14:12,fontWeight:l.highlightedPlayer===d.value?"bold":"normal",children:d.value})}),e.jsx(q,{tickFormatter:t=>`${t.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx($,{content:e.jsx(a,{})}),e.jsx(O,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:c.map((t,n)=>{const d=l.highlightedPlayer===t.name,m=N===t.name,i=t.isHighlightedAddition;return e.jsx(U,{fill:D[t.name]||"var(--chart-color-4)",stroke:d?"var(--accent-primary)":m?"var(--text-primary)":"none",strokeWidth:d?3:m?2:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1,onClick:()=>P(t.name),onMouseEnter:()=>z(t.name),onMouseLeave:()=>z(null),style:{cursor:"pointer"}},`cell-lowest-${n}`)})})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function Ne(){const{navigationState:o,updateNavigationState:j}=J(),[g,v]=M.useState(o.deathStatisticsState?.selectedCamp||o.deathStatsSelectedCamp||"Tous les camps"),[y,K]=M.useState(o.deathStatisticsState?.victimCampFilter||"Tous les camps"),[b,l]=M.useState(o.deathStatisticsState?.minGamesForAverage||25),[p,D]=M.useState(()=>{const s=o.deathStatisticsState?.selectedView;return s&&s!=="location"?s:"killers"}),{data:R}=re(),{data:T,isLoading:N,error:z}=se(g,y),{data:L,isLoading:A,error:f}=le(),{data:k,isLoading:c,error:h}=me(g),{data:P}=ae(),a=ie();M.useEffect(()=>{(!o.deathStatisticsState||o.deathStatisticsState.selectedCamp!==g||o.deathStatisticsState.victimCampFilter!==y||o.deathStatisticsState.minGamesForAverage!==b||o.deathStatisticsState.selectedView!==p)&&j({deathStatisticsState:{selectedCamp:g,victimCampFilter:y,minGamesForAverage:b,selectedView:p,focusChart:o.deathStatisticsState?.focusChart}})},[g,y,b,p,o.deathStatisticsState,j]);const t=M.useMemo(()=>P?ne(P):[],[P]),n=M.useMemo(()=>{const s={};t.forEach(S=>{S===E.BY_WOLF?s[S]=a.Loup:S===E.VOTED?s[S]="var(--chart-color-1)":S===E.BULLET||S===E.BULLET_HUMAN||S===E.BULLET_WOLF?s[S]=a.Chasseur:S===E.BY_ZOMBIE?s[S]=a.Vaudou:S===E.ASSASSIN?s[S]=a.Alchimiste:S===E.AVENGER?s[S]="var(--chart-color-2)":S===E.LOVER_DEATH?s[S]=a.Amoureux:S===E.BY_BEAST?s[S]="var(--chart-color-3)":S===E.SHERIF_SUCCESS?s[S]="var(--chart-color-4)":S===E.SMUGGLER_HUNT_KILL&&(s[S]=a.Contrebandier)});const u=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let B=0;return t.forEach(S=>{s[S]||(s[S]=u[B%u.length],B++)}),s},[t,a]),d=s=>{v(s),j({deathStatsSelectedCamp:s,deathStatisticsState:{selectedCamp:s,victimCampFilter:y,minGamesForAverage:b,selectedView:p,focusChart:o.deathStatisticsState?.focusChart}})},m=s=>{K(s),j({deathStatisticsState:{selectedCamp:g,victimCampFilter:s,minGamesForAverage:b,selectedView:p,focusChart:o.deathStatisticsState?.focusChart}})},i=s=>{l(s),j({deathStatisticsState:{selectedCamp:g,victimCampFilter:y,minGamesForAverage:s,selectedView:p,focusChart:o.deathStatisticsState?.focusChart}})},r=s=>{D(s),j({deathStatisticsState:{selectedCamp:g,victimCampFilter:y,minGamesForAverage:b,selectedView:s,focusChart:o.deathStatisticsState?.focusChart}})},{gamesWithKillers:x,totalEligibleForAverage:H}=M.useMemo(()=>{if(!T)return{gamesWithKillers:0,totalEligibleForAverage:0};const s=T.killerStats.filter(u=>u.gamesPlayed>=b);return{gamesWithKillers:T.totalGames,totalEligibleForAverage:s.length}},[T,b]);return N?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):z?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",z]}):T?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="killers"?"active":""}`,onClick:()=>r("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="deaths"?"active":""}`,onClick:()=>r("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="survival"?"active":""}`,onClick:()=>r("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="hunter"?"active":""}`,onClick:()=>r("hunter"),children:"Chasseur"})]}),(p==="killers"||p==="deaths"||p==="survival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:g,onChange:s=>d(s.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),R?.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),p==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:y,onChange:s=>m(s.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(p==="killers"||p==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:T.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:T.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:x})]})]}),p==="killers"&&e.jsx(ue,{deathStats:T,selectedCamp:g,victimCampFilter:y,minGamesForAverage:b,onMinGamesChange:i,availableDeathTypes:t,deathTypeColors:n,totalEligibleForAverage:H}),p==="deaths"&&e.jsx(ye,{deathStats:T,selectedCamp:g,minGamesForAverage:b,onMinGamesChange:i,availableDeathTypes:t,deathTypeColors:n}),p==="hunter"&&e.jsx(ve,{hunterStats:L,isLoading:A,error:f}),p==="survival"&&e.jsx(pe,{survivalStats:k,selectedCamp:g,minGamesForAverage:b,onMinGamesChange:i,isLoading:c,error:h}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"DonnÃ©es en cours de rÃ©cupÃ©ration (donnÃ©es partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{Ne as DeathStatisticsChart};
