import{a as ae,r as T,g as te,f as be,u as X,j as e,c as he,m as Ce}from"./index-DSLds8yr.js";import{u as re}from"./useJoueursData-DUXcbNzd.js";import{u as ge}from"./baseStatsHook-B7UxA7ku.js";import{g as we}from"./gameUtils-BxMCEZkU.js";import{a as xe,g as se,c as Re}from"./datasyncExport-Sk8THFwE.js";import{u as le,g as Se,a as ie,l as fe}from"./api-BmETgy1n.js";import{d as ke}from"./durationFormatters-C9UyWcKX.js";import{F as B,C as K,X as H,Y as O,a as _}from"./FullscreenChart-BI-qcLrQ.js";import{R as q,T as E}from"./CategoricalChart-xBfzbqpo.js";import{L as Ne,a as Te}from"./LineChart-8vIGPK5B.js";import{B as J,a as Y}from"./BarChart-BIAqFgxV.js";import{P as Pe,a as Me}from"./PieChart-DARYRNpk.js";import{u as De}from"./useDeathStatisticsFromRaw-C_IziKtg.js";import{R as oe}from"./ReferenceLine-B8784Jyc.js";import{g as ee}from"./deathTypes-T5wVOxX_.js";import{i as ce,g as de,V as Fe}from"./roleUtils-C8smGkiJ.js";import{e as pe,a as Ae,b as $e,d as ze,R as Ie}from"./deathLocationUtils-CM-gHH3b.js";import{S as We,a as Le}from"./ScatterChart-D2nRQ9jD.js";import{a as qe,u as Ee}from"./useClips-pmOM-9QT.js";import{C as Ge,f as ue,a as Ve}from"./ClipViewer-Cy7Du7H8.js";import"./ActivePoints-CbyyAbGc.js";import"./PolarChart-Bo7HKxfQ.js";function Be(l){const{settings:R}=ae(),{joueursData:j}=re(),[v,k]=T.useState(null),[x,b]=T.useState(!1),[y,d]=T.useState(null);T.useEffect(()=>{let r=!0;return(async()=>{try{b(!0),d(null);const a=R.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",o=await fetch(a);if(!o.ok)throw new Error(`Failed to load achievements: ${o.status} ${o.statusText}`);const i=await o.json();r&&k(i)}catch(a){r&&d(a instanceof Error?a.message:"Failed to load achievements")}finally{r&&b(!1)}})(),()=>{r=!1}},[R.dataSource]);const u=(()=>{if(!l||!v)return null;const s=j?.Players?.find(a=>a.Joueur===l)?.SteamID;return s?v.achievements[s]||null:(console.warn(`âš ï¸ No Steam ID found for player: ${l}`),null)})();return T.useEffect(()=>{l&&v&&j&&j.Players?.find(a=>a.Joueur===l)?.SteamID},[l,v,j,R.dataSource]),{data:u,isLoading:x,error:y,metadata:{generatedAt:v?.generatedAt||null,totalPlayers:v?.totalPlayers||0,totalGames:v?.totalGames||0,totalModdedGames:v?.totalModdedGames||0}}}function Ke(l,R,j){if(!l||l.trim()===""||R.length===0)return null;const v=[];let k=l;R.forEach(s=>{const a=s.PlayerStats.find(o=>te(o)===l||o.Username.toLowerCase()===l.toLowerCase());if(a){k=a.Username;const o=a.MainRoleInitial==="Louveteau"?a.MainRoleInitial:xe(a.MainRoleInitial,a.MainRoleChanges||[]),i=se(o);if(j&&j!=="Tous les camps"&&i!==j)return;const g=we(s),n=a.Victorious,C=be(new Date(s.StartDate)),w=Re(s.StartDate,s.EndDate)||0;v.push({gameId:s.Id,date:C,camp:i,won:n,winnerCamp:g,playersInGame:s.PlayerStats.length,mapName:s.MapName,duration:w})}}),v.sort((s,a)=>{const o=i=>{const g=i.split("/");return g.length===3?new Date(parseInt(g[2]),parseInt(g[1])-1,parseInt(g[0])):new Date(i)};return o(a.date).getTime()-o(s.date).getTime()});const x=v.length,b=v.filter(s=>s.won).length,y=x>0?(b/x*100).toFixed(2):"0.00",d={};v.forEach(s=>{d[s.camp]||(d[s.camp]={appearances:0,wins:0,winRate:"0.00"}),d[s.camp].appearances++,s.won&&d[s.camp].wins++}),Object.keys(d).forEach(s=>{const a=d[s];a.winRate=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00"});const u={};v.forEach(s=>{u[s.mapName]||(u[s.mapName]={appearances:0,wins:0,winRate:"0.00"}),u[s.mapName].appearances++,s.won&&u[s.mapName].wins++}),Object.keys(u).forEach(s=>{const a=u[s];a.winRate=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00"});const r=v.reduce((s,a)=>s+a.duration,0);return{playerName:k,totalGames:x,totalWins:b,winRate:y,totalPlayTime:r,games:v,campStats:d,mapStats:u}}function He(l){const R={};let j=0,v=0;return Object.entries(l).forEach(([k,x])=>{k==="Village"||k==="ChÃ¢teau"?R[k]={...x}:(j+=x.appearances,v+=x.wins)}),j>=10&&(R.Autres={appearances:j,wins:v,winRate:j>0?(v/j*100).toFixed(2):"0.00"}),R}function ne(l,R){const{data:j,isLoading:v,error:k}=ge(x=>l?Ke(l,x,R):null);return{data:j,isLoading:v,error:k}}function Oe({achievements:l,title:R,emptyMessage:j,achievementType:v="all"}){const{navigateToTab:k,updateNavigationState:x,clearNavigation:b}=X(),{settings:y,updateSettings:d}=ae(),{joueursData:u}=re(),r=le(u),s=(t,p)=>{if(p.stopPropagation(),!t.redirectTo)return;b();const S=y.highlightedPlayer;if(d(v==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:S,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:S,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),t.category==="comparison"&&t.redirectTo.subTab==="comparison"){const c=y.highlightedPlayer||"",m=a(t.description,c);m&&x({playerComparisonState:{selectedPlayer1:c,selectedPlayer2:m,showDetailedStats:!0}})}if(t.category==="comparison"&&t.redirectTo.subTab==="pairing"){const c=t.description.toLowerCase().includes("loup");x({selectedPairingTab:c?"wolves":"lovers"})}if(t.category==="kills"&&t.redirectTo.subTab==="deathStats"){const c=t.description.match(/(Villageois|Loups|Autres)/i);c&&x({deathStatsSelectedCamp:c[1]});let m=10;const f=t.description.match(/min\.\s*(\d+)/);f&&(m=parseInt(f[1],10));let N="totalKills",D="killers";const M=t.redirectTo.chartSection;M&&(M==="killers-total"?(N="totalKills",D="killers"):M==="killers-average"?(N="averageKills",D="killers"):M==="deaths-total"?(N="totalDeaths",D="deaths"):M==="survivors-average"?(N="survivalRate",D="deaths"):(M==="hunters-good"||M==="hunters-bad")&&(D="hunter",N="averageKills")),x({deathStatisticsState:{selectedCamp:c?.[1]||"Tous les camps",minGamesForAverage:m,selectedView:D,focusChart:N}})}if(t.category==="map"&&t.redirectTo.subTab==="playersGeneral"){const c=t.redirectTo.mapFilter||"all";let m=10;const f=t.description.match(/min\.\s*(\d+)/);f&&(m=parseInt(f[1])),d(v==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:c,playerFilter:{mode:"none",players:[]},highlightedPlayer:S,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:c,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:c,playerFilter:{mode:"none",players:[]},highlightedPlayer:S,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:c,playerFilter:{mode:"none",players:[]}}}),x({playersGeneralState:{minGamesForWinRate:m,winRateOrder:"best",focusChart:"winRate"}}),k("players","playersGeneral");return}if(t.category==="history"&&t.redirectTo.subTab==="history"&&x({selectedPlayerName:y.highlightedPlayer||"",groupingMethod:"session"}),t.category==="series"&&t.redirectTo.subTab==="series"){let c="wins";const m=t.title.toLowerCase(),f=t.description.toLowerCase();m.includes("dÃ©faite")||f.includes("dÃ©faite")?c="losses":m.includes("loup")||f.includes("loup")?c="loup":m.includes("villageois")||f.includes("villageois")?c="villageois":(m.includes("victoire")||f.includes("victoire"))&&(c="wins"),x({selectedSeriesType:c})}if(t.category==="general"&&t.redirectTo.subTab==="playersGeneral"){let c=10;const m=t.description.match(/min\.\s*(\d+)/);m&&(c=parseInt(m[1],10));let f="winRate",N="best";const D=t.title.toLowerCase(),M=t.description.toLowerCase();D.includes("participation")||M.includes("participation")?f="participation":(D.includes("taux de victoire")||M.includes("taux de victoire"))&&(f="winRate",(D.includes("moins bon")||D.includes("mauvais")||M.includes("moins bon")||M.includes("mauvais"))&&(N="worst")),x({playersGeneralState:{minGamesForWinRate:c,winRateOrder:N,focusChart:f}})}if(t.category==="performance"&&t.redirectTo.subTab==="campStats"){const c=t.redirectTo.chartSection;let m="Villageois",f=1;c&&(c==="camp-loup"?m="Loup":c==="camp-villageois"?m="Villageois":c==="camp-idiot"?m="Idiot du Village":c==="camp-amoureux"?m="Amoureux":(c==="solo-roles"||c==="hall-of-fame")&&(m="Villageois"));const N=t.description.match(/min\.\s*(\d+)/);N&&(f=parseInt(N[1],10)),c==="solo-roles"?m="RÃ´les spÃ©ciaux":c==="hall-of-fame"&&(m="Tous les camps"),x({campPerformanceState:{selectedCampPerformanceCamp:m,selectedCampPerformanceMinGames:f,viewMode:"performance"}})}if(t.category==="voting"&&t.redirectTo.subTab==="votingStats"){const c=t.title.toLowerCase();let m="overview",f="behavior";c.includes("agressivitÃ©")?(m="overview",f="behavior"):c.includes("taux de vote")?(m="behavior",f="voteRate"):c.includes("prÃ©cision")&&(m="overview",f="accuracy"),x({votingStatsState:{selectedCategory:m,selectedView:f}})}k(t.redirectTo.tab,t.redirectTo.subTab)},a=(t,p)=>{const S=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const c of S){const m=t.match(c);if(m&&m[1]){const f=m[1].trim();if(f!==p)return f}}return null},o=t=>{if(!t.redirectTo)return"Aucune navigation disponible";switch(t.category){case"general":if(t.redirectTo.subTab==="playersGeneral"){const c=t.description.match(/min\.\s*(\d+)/),m=c?parseInt(c[1],10):10,f=t.title.toLowerCase(),N=v==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return f.includes("taux de victoire")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${m} parties)${N}`:f.includes("participation")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les participations${N}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${N}`}break;case"map":if(t.redirectTo.subTab==="playersGeneral"){const c=t.redirectTo.mapFilter,m=c==="village"?"Village":c==="chateau"?"ChÃ¢teau":"map",f=v==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${m}${f}`}break;case"history":if(t.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(t.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${a(t.description,y.highlightedPlayer||"")||"ce joueur"}`;if(t.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(t.redirectTo.subTab==="deathStats"){const c=t.description.match(/(Villageois|Loups|Autres)/i),m=t.description.match(/min\.\s*(\d+)/),f=m?parseInt(m[1],10):10,N=c?.[1]||"Tous les camps",D=t.redirectTo.chartSection;let M="kills et morts";return D==="killers-total"?M="total des kills":D==="killers-average"?M=`moyenne des kills (min. ${f} parties)`:D==="deaths-total"?M="total des morts":D==="survivors-average"&&(M=`taux de survie (min. ${f} parties)`),`Cliquez pour voir les statistiques de ${M} ${N!=="Tous les camps"?`en ${N}`:""}`}break;case"series":if(t.redirectTo.subTab==="series"){const c=t.title.toLowerCase(),m=t.description.toLowerCase();return c.includes("dÃ©faite")||m.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":c.includes("loup")||m.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":c.includes("villageois")||m.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":c.includes("victoire")||m.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(t.redirectTo.subTab==="campStats"){const c=t.redirectTo.chartSection,m=v==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return c==="camp-loup"?`Cliquez pour voir les performances camp Loup${m}`:c==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${m}`:c==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${m}`:c==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${m}`:c==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${m}`:c==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${m}`:`Cliquez pour voir les performances par camp${m}`}break;case"voting":if(t.redirectTo.subTab==="votingStats"){const c=t.description.match(/min\.\s*(\d+)/),m=c?parseInt(c[1],10):25,f=v==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",N=t.title.toLowerCase();return N.includes("agressivitÃ©")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${m} meetings)${f}`:N.includes("taux de vote")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${m} meetings)${f}`:N.includes("prÃ©cision")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${f}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${f}`}break}return`Cliquez pour voir ${t.redirectTo.subTab}`+(v==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},i=t=>r[t]||Se(t),g=t=>{const p=[/avec ([^:]+?):/,/contre ([^:]+?):/];let S=t;return p.forEach(c=>{const m=t.match(c);if(m&&m[1]){const f=m[1].trim(),D=`<span class="player-name-highlight" style="color: ${i(f)};">${f}</span>`;S=S.replace(f,D)}}),S};if(l.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:R}),e.jsx("p",{children:j||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const n=t=>t===1?"ðŸ¥‡":t===2?"ðŸ¥ˆ":t===3?"ðŸ¥‰":"",C=t=>t===1?"rank-1":t===2?"rank-2":t===3?"rank-3":t&&t<=10?"rank-top-10":"",w=l.filter(t=>t.category!=="comparison"&&(t.type==="good"||t.type==="neutral")).sort((t,p)=>(t.rank??999)-(p.rank??999)),A=l.filter(t=>t.category!=="comparison"&&t.type==="bad").sort((t,p)=>(t.rank??999)-(p.rank??999)),P=l.filter(t=>t.category==="comparison"),$=w.filter(t=>t.rank&&t.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:R}),$>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:w.filter(t=>t.rank&&t.rank<=3).map((t,p)=>e.jsxs("div",{className:`top3-card ${C(t.rank)} animate-slide-in`,style:{animationDelay:`${p*.15}s`},onClick:S=>s(t,S),title:o(t),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:n(t.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:t.title}),e.jsx("p",{className:"top3-achievement-description",children:t.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},t.id))})]}),w.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:w.filter(t=>!t.rank||t.rank>3).map((t,p)=>e.jsxs("div",{className:`achievement-card good ${C(t.rank)}`,onClick:S=>s(t,S),title:o(t),style:{animationDelay:`${p*.05}s`},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id))})]}),A.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:A.map(t=>e.jsxs("div",{className:`achievement-card bad rank-${t.rank}`,onClick:p=>s(t,p),title:o(t),children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id))})]}),P.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:P.map(t=>e.jsxs("div",{className:"achievement-card comparison",onClick:p=>s(t,p),title:o(t),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:t.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:g(t.description)}})]},t.id))})]})]})}function _e({selectedPlayerName:l,groupingMethod:R,campFilter:j="all"}){const{navigateToGameDetails:v}=X(),{data:k,isLoading:x,error:b}=ne(l),y=T.useMemo(()=>{switch(R){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[R]),d=T.useMemo(()=>{if(!k?.games)return new Map;const a=new Map;return k.games.forEach(o=>{if(!a.has(o.date)){const i=o.date.split("/");i.length===3?a.set(o.date,new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])).getTime()):a.set(o.date,new Date(o.date).getTime())}}),a},[k?.games]),u=T.useMemo(()=>{if(!k?.games)return[];const a={};return k.games.forEach(o=>{if(j!=="all"){if(j==="solo"){if(o.camp==="Villageois"||o.camp==="Loup")return}else if(o.camp!==j)return}let i;const g=o.date.split("/");if(R==="month")if(g.length===3)i=`${g[1].padStart(2,"0")}/${g[2]}`;else{const n=new Date(o.date);i=`${String(n.getMonth()+1).padStart(2,"0")}/${n.getFullYear()}`}else if(R==="quarter")if(g.length===3){const n=parseInt(g[1],10);i=`T${Math.floor((n-1)/3)+1}/${g[2]}`}else{const n=new Date(o.date);i=`T${Math.floor(n.getMonth()/3)+1}/${n.getFullYear()}`}else R==="year"?g.length===3?i=`${g[2]}`:i=`${new Date(o.date).getFullYear()}`:i=o.date;a[i]||(a[i]={games:[],wins:0,total:0}),a[i].games.push(o),a[i].total++,o.won&&a[i].wins++}),Object.entries(a).map(([o,i])=>({period:o,totalGames:i.total,victories:i.wins,defeats:i.total-i.wins,winRate:i.total>0?(i.wins/i.total*100).toFixed(1):"0.0",winRateNum:i.total>0?i.wins/i.total*100:0})).sort((o,i)=>{if(R==="month"){const[g,n]=o.period.split("/"),[C,w]=i.period.split("/"),A=new Date(parseInt(n),parseInt(g)-1,1),P=new Date(parseInt(w),parseInt(C)-1,1);return A.getTime()-P.getTime()}else if(R==="quarter"){const[g,n]=o.period.split("/"),[C,w]=i.period.split("/"),A=parseInt(g.replace(/\D/g,""),10)||1,P=parseInt(C.replace(/\D/g,""),10)||1,$=new Date(parseInt(n,10),(A-1)*3,1),t=new Date(parseInt(w,10),(P-1)*3,1);return $.getTime()-t.getTime()}else if(R==="year"){const g=parseInt(o.period,10),n=parseInt(i.period,10);return g-n}else{const g=d.get(o.period)||0,n=d.get(i.period)||0;return g-n}})},[k,R,d,j]),s=(a=>a<=15?{fontSize:12,angle:-45,height:80,interval:0}:a<=30?{fontSize:12,angle:-45,height:85,interval:1}:a<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(a/12)})(u.length);return x?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):b?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",b]}):k?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",y]}),e.jsx(B,{title:`Ã‰volution des Performances ${y}`,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(Ne,{data:u,margin:{top:20,right:30,left:20,bottom:20},onClick:a=>{if(a&&a.activeLabel){const o=u.find(i=>i.period===a.activeLabel);o&&v({selectedPlayer:l,selectedDate:o.period,fromComponent:`Ã‰volution des Performances ${y}`})}},style:{cursor:"pointer"},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"period",angle:s.angle,textAnchor:"end",height:s.height,interval:s.interval,fontSize:s.fontSize}),e.jsx(O,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(E,{content:({active:a,payload:o})=>{if(a&&o&&o.length>0){const i=o[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Parties: ",i.totalGames]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(Te,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",y]}),e.jsx(B,{title:`RÃ©partition Victoires/DÃ©faites ${y}`,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:u,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"period",angle:s.angle,textAnchor:"end",height:s.height,interval:s.interval,fontSize:s.fontSize}),e.jsx(O,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(E,{content:({active:a,payload:o})=>{if(a&&o&&o.length>0){const i=o[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.period})}),e.jsxs("div",{children:["Total: ",i.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",i.victories]}),e.jsxs("div",{children:["DÃ©faites: ",i.defeats]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(Y,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:u.map((a,o)=>e.jsx(_,{fill:"var(--accent-tertiary)",onClick:()=>{v({selectedPlayer:l,selectedDate:a.period,fromComponent:`Historique Joueur - Victoires ${y}`})},style:{cursor:"pointer"}},`cell-victories-${o}`))}),e.jsx(Y,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:u.map((a,o)=>e.jsx(_,{fill:"var(--chart-color-4)",onClick:()=>{v({selectedPlayer:l,selectedDate:a.period,fromComponent:`Historique Joueur - DÃ©faites ${y}`})},style:{cursor:"pointer"}},`cell-defeats-${o}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Ue({selectedPlayerName:l}){const{navigateToGameDetails:R}=X(),{data:j,isLoading:v,error:k}=ne(l),x=ie(),b=T.useMemo(()=>j?.campStats?Object.entries(j.campStats).map(([d,u])=>({name:d,value:u.appearances,winRate:u.winRate,winRateDisplay:Math.max(parseFloat(u.winRate),1),wins:u.wins,percentage:(u.appearances/j.totalGames*100).toFixed(1)})):[],[j]),y=T.useMemo(()=>{if(!b.length)return[];const d=5;let u=0;const r=[],s=[];if(b.forEach(a=>{parseFloat(a.percentage)<d?(u+=Number(a.value),r.push(a)):s.push(a)}),u>0){const a=b.reduce((o,i)=>o+Number(i.value),0);s.push({name:"Autres",value:u,winRate:"0.0",winRateDisplay:1,wins:r.reduce((o,i)=>o+i.wins,0),percentage:(u/a*100).toFixed(1),_details:r})}return s},[b]);return v?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):j?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(Pe,{children:[e.jsx(Me,{data:y,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:d=>{const u=d.percent!==void 0?d.percent:0;return d.name==="Autres"?`Autres : ${d.value} (${(u*100).toFixed(1)}%)`:`${d.name}: ${d.value} (${(u*100).toFixed(1)}%)`},children:y.map((d,u)=>e.jsx(_,{fill:d.name==="Autres"?fe:x[d.name]||`var(--chart-color-${u%6+1})`,onClick:()=>{if(d.name==="Autres"){const r=d._details?.map(s=>s.name)||[];R({selectedPlayer:l,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:r},fromComponent:"Distribution par Camps"})}else d.name==="TraÃ®tre"||d.name==="Louveteau"?R({selectedPlayer:l,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):d.name==="Loup"?R({selectedPlayer:l,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):R({selectedPlayer:l,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${u}`))}),e.jsx(E,{content:({active:d,payload:u})=>{if(d&&u&&u.length>0){const r=u[0].payload;if(r.name==="Autres"&&r._details){const s=[...r._details].sort((a,o)=>o.value-a.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{children:s.map((a,o)=>e.jsxs("div",{children:[a.name,": ",a.value," parties (",a.percentage,"%)"]},o))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[r.name," - ",r.value," parties (",r.percentage,"%)"]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(B,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:b,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(E,{content:({active:d,payload:u})=>{if(d&&u&&u.length>0){const r=u[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.value]}),e.jsxs("div",{children:["Taux: ",r.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(Y,{dataKey:"winRateDisplay",children:b.map((d,u)=>e.jsx(_,{fill:parseFloat(d.winRate)===0?`${x[d.name]||`var(--chart-color-${u%6+1})`}50`:x[d.name]||`var(--chart-color-${u%6+1})`,onClick:()=>{d.name==="TraÃ®tre"||d.name==="Louveteau"?R({selectedPlayer:l,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):d.name==="Loup"?R({selectedPlayer:l,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):R({selectedPlayer:l,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${u}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Ye({selectedPlayerName:l}){const{navigateToGameDetails:R,navigationState:j,updateNavigationState:v}=X(),[k,x]=T.useState(j.playerHistoryMapState?.selectedCamp||"Tous les camps"),{data:b}=De(),{data:y,isLoading:d,error:u}=ne(l,k);T.useEffect(()=>{(!j.playerHistoryMapState||j.playerHistoryMapState.selectedCamp!==k)&&v({playerHistoryMapState:{selectedCamp:k}})},[k,j.playerHistoryMapState,v]);const r=a=>{x(a),v({playerHistoryMapState:{selectedCamp:a}})},s=T.useMemo(()=>{if(!y?.mapStats)return[];const a=He(y.mapStats);return Object.entries(a).map(([o,i])=>({name:o,value:i.appearances,winRate:i.winRate,winRateDisplay:Math.max(parseFloat(i.winRate),.1),wins:i.wins,percentage:(i.appearances/y.totalGames*100).toFixed(1)}))},[y]);return d?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):u?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",u]}):y?s.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Performance par Carte",k!=="Tous les camps"?` (${k})`:""]}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select-map",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select-map",value:k,onChange:a=>r(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),b?.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsx(B,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:s,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(oe,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(s.length>0){const a=s.reduce((g,n)=>g+n.value,0),o=s.reduce((g,n)=>g+n.wins,0),i=a>0?o/a*100:0;if(i!==50)return e.jsx(oe,{y:i,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${i.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(E,{content:({active:a,payload:o})=>{if(a&&o&&o.length>0){const i=o[0].payload,g=[];return s.forEach(n=>{if(n.name!==i.name&&n.value>=5){const C=parseFloat(i.winRate)-parseFloat(n.winRate);Math.abs(C)>=2&&g.push({map:n.name,diff:C,better:C>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Parties: ",i.value]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",i.winRate,"%"]})}),g.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),g.map((n,C)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:n.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[n.better?"â†—":"â†˜"," ",Math.abs(n.diff).toFixed(1),"% vs ",n.map]},C))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(Y,{dataKey:"winRateDisplay",label:a=>{const{x:o,y:i,width:g,payload:n}=a;if(o===void 0||i===void 0||g===void 0||!n)return null;const C=n.winRate||"0";return e.jsxs("text",{x:o+g/2,y:i-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[C,"%"]})},onClick:a=>{if(a&&a.name){const o={selectedPlayer:l,selectedMapName:a.name,fromComponent:"Performance par Carte"};k!=="Tous les camps"&&(o.campFilter={selectedCamp:k,campFilterMode:"all-assignments"}),R(o)}},children:s.map((a,o)=>{let i;a.name==="Village"?i="var(--accent-secondary)":a.name==="ChÃ¢teau"?i="var(--accent-tertiary)":a.name==="Autres"?i=fe:i=`var(--chart-color-${o%6+1})`;const g=Math.max(...s.map(C=>parseFloat(C.winRate))),n=parseFloat(a.winRate)===g&&g>0;return e.jsx(_,{fill:parseFloat(a.winRate)===0?`${i}30`:i,stroke:"transparent",strokeWidth:n?3:1,style:{cursor:"pointer"}},`cell-map-${o}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Je({selectedPlayerName:l}){const{gameData:R}=he(),{joueursData:j}=re(),v=le(j),k=ie(),x=T.useMemo(()=>{if(!R||!l)return{playersKilled:[],killedBy:[],deathTypes:[],availableDeathTypes:[]};const y={},d={},u={},r=new Set;R.forEach(g=>{const n=g.PlayerStats.find(C=>C.Username.toLowerCase()===l.toLowerCase());if(n&&(g.PlayerStats.forEach(C=>{C.KillerName?.toLowerCase()===l.toLowerCase()&&(y[C.Username]=(y[C.Username]||0)+1)}),n.KillerName&&(d[n.KillerName]=(d[n.KillerName]||0)+1),n.DeathType)){const C=n.DeathType,w=ee(C);u[w]||(u[w]={count:0,byDeathType:{}}),u[w].count+=1,u[w].byDeathType[C]=(u[w].byDeathType[C]||0)+1,r.add(C)}});const s=Object.entries(y).map(([g,n])=>({player:g,kills:n})).sort((g,n)=>n.kills-g.kills).slice(0,10),a=Object.entries(d).map(([g,n])=>({player:g,kills:n})).sort((g,n)=>n.kills-g.kills).slice(0,10),o=Object.entries(u).map(([g,n])=>{const C={deathType:g,count:n.count};return C[g]=n.count,C}).sort((g,n)=>n.count-g.count).slice(0,10),i=Object.keys(u);return{playersKilled:s,killedBy:a,deathTypes:o,availableDeathTypes:i}},[R,l]),b=T.useMemo(()=>{const y={};x.availableDeathTypes.forEach(r=>{r==="TuÃ© par Loup"?y[r]=k.Loup:r==="Mort aux votes"?y[r]="var(--chart-color-1)":r.includes("Chasseur")?y[r]=k.Chasseur:r==="TuÃ© par Zombie"?y[r]=k.Vaudou:r==="TuÃ© par potion assassin"?y[r]=k.Alchimiste:r==="TuÃ© par Vengeur"?y[r]="var(--chart-color-2)":r==="Amoureux mort"?y[r]=k.Amoureux:r==="TuÃ© par La BÃªte"?y[r]="var(--chart-color-3)":r==="TuÃ© par ShÃ©rif"&&(y[r]="var(--chart-color-4)")});const d=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let u=0;return x.availableDeathTypes.forEach(r=>{y[r]||(y[r]=d[u%d.length],u++)}),y},[x.availableDeathTypes,k]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[x.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Victimes"}),e.jsx(B,{title:"Les Victimes",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:x.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(E,{content:({active:y,payload:d})=>{if(y&&d&&d.length>0){const u=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:u.player})}),e.jsxs("div",{children:["TuÃ© ",u.kills," fois par ",l]})]})}return null}}),e.jsx(Y,{dataKey:"kills",children:x.playersKilled.map((y,d)=>e.jsx(_,{fill:v[y.player]||"var(--chart-color-3)"},`cell-killed-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[l," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),x.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Tueurs"}),e.jsx(B,{title:"Les Tueurs",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:x.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(O,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(E,{content:({active:y,payload:d})=>{if(y&&d&&d.length>0){const u=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:u.player})}),e.jsxs("div",{children:["A tuÃ© ",l," ",u.kills," fois"]})]})}return null}}),e.jsx(Y,{dataKey:"kills",children:x.killedBy.map((y,d)=>e.jsx(_,{fill:v[y.player]||"var(--chart-color-4)"},`cell-killer-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[l," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]}),x.deathTypes.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Mort les Plus FrÃ©quents"}),e.jsx(B,{title:"Types de Mort les Plus FrÃ©quents",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:x.deathTypes,margin:{top:20,right:30,left:20,bottom:90},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"deathType",angle:-45,textAnchor:"end",height:120,interval:0,fontSize:12}),e.jsx(O,{label:{value:"Nombre de morts",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(E,{content:({active:y,payload:d})=>{if(y&&d&&d.length>0){const u=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:u.deathType})}),e.jsxs("div",{children:[l," est mort ",u.count," fois ainsi"]})]})}return null}}),x.availableDeathTypes.map(y=>e.jsx(Y,{dataKey:y,name:y,stackId:"deaths",fill:b[y]||"var(--chart-color-5)"},y))]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de mort"}),e.jsxs("p",{children:["Aucune information de mort disponible pour ",l,"."]})]})]})}function Xe(l,R){if(!l||l.trim()===""||R.length===0)return null;const j=new Map,v=new Map,k=new Map;R.forEach(u=>{if(!u.Modded)return;const r=u.PlayerStats.find(s=>te(s)===l||s.Username.toLowerCase()===l.toLowerCase());if(r){if(r.MainRoleInitial==="Inconnu")return;const s=r.Victorious,o=xe(r.MainRoleInitial,r.MainRoleChanges||[])!==r.MainRoleInitial,i=se(r.MainRoleInitial),g=i==="Loup"||i==="TraÃ®tre"||i==="Louveteau";if(i==="Villageois"&&ce(r)){const n=de(r);if(n&&Fe.includes(n)){const C=j.get(n)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};j.set(n,{appearances:C.appearances+1,wins:C.wins+(s?1:0),winsWithoutRoleChange:C.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:C.gamesWithoutRoleChange+(o?0:1)})}}else if(r.Power&&r.Power.trim()!==""&&r.Power!=="Inconnu"){if(i==="Villageois"){const n=j.get(r.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};j.set(r.Power,{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1)})}else if(g){const n=v.get(r.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},C=n.roleBreakdown;C.set(r.MainRoleInitial,(C.get(r.MainRoleInitial)||0)+1),v.set(r.Power,{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1),roleBreakdown:C})}}else if((i==="Villageois"||g)&&r.Power!=="Inconnu")if(i==="Villageois"){const n=j.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};j.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1)})}else{const n=v.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},C=n.roleBreakdown;C.set(r.MainRoleInitial,(C.get(r.MainRoleInitial)||0)+1),v.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1),roleBreakdown:C})}if(r.SecondaryRole&&r.SecondaryRole.trim()!==""&&r.SecondaryRole!=="Inconnu"){const n=k.get(r.SecondaryRole)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};k.set(r.SecondaryRole,{appearances:n.appearances+1,wins:n.wins+(s?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!o&&s?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(o?0:1)})}}});const x=new Map;R.forEach(u=>{const r=u.PlayerStats.find(s=>te(s)===l||s.Username.toLowerCase()===l.toLowerCase());if(r&&ce(r)){const s=de(r);s&&x.set(s,(x.get(s)||0)+1)}});const b=u=>Array.from(u.entries()).map(([r,s])=>({name:r,appearances:s.appearances,wins:s.wins,winsWithoutRoleChange:s.winsWithoutRoleChange,gamesWithoutRoleChange:s.gamesWithoutRoleChange,winRate:s.gamesWithoutRoleChange>0?(s.winsWithoutRoleChange/s.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Villageois",...x.has(r)&&{totalGamesAllModes:x.get(r)}})).sort((r,s)=>s.appearances-r.appearances),y=u=>Array.from(u.entries()).map(([r,s])=>({name:r,appearances:s.appearances,wins:s.wins,winsWithoutRoleChange:s.winsWithoutRoleChange,gamesWithoutRoleChange:s.gamesWithoutRoleChange,winRate:s.gamesWithoutRoleChange>0?(s.winsWithoutRoleChange/s.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Loup",roleBreakdown:Array.from(s.roleBreakdown.entries()).map(([a,o])=>({role:a,count:o})).sort((a,o)=>o.count-a.count)})).sort((r,s)=>s.appearances-r.appearances),d=u=>Array.from(u.entries()).map(([r,s])=>({name:r,appearances:s.appearances,wins:s.wins,winsWithoutRoleChange:s.winsWithoutRoleChange,gamesWithoutRoleChange:s.gamesWithoutRoleChange,winRate:s.gamesWithoutRoleChange>0?(s.winsWithoutRoleChange/s.gamesWithoutRoleChange*100).toFixed(1):"0.0"})).sort((r,s)=>s.appearances-r.appearances);return{villageoisPowers:b(j),loupPowers:y(v),secondaryRoles:d(k)}}function Ze({selectedPlayerName:l}){const{navigateToGameDetails:R,navigationState:j,updateNavigationState:v}=X(),{settings:k}=ae(),x=ie(),[b,y]=T.useState(j.playerHistoryRolesState?.chartMode||"appearances"),{data:d,isLoading:u,error:r}=ge(w=>Xe(l,w));T.useEffect(()=>{(!j.playerHistoryRolesState||j.playerHistoryRolesState.chartMode!==b)&&v({playerHistoryRolesState:{chartMode:b}})},[b,j.playerHistoryRolesState,v]);const s=w=>{y(w),v({playerHistoryRolesState:{chartMode:w}})},a=T.useMemo(()=>{if(!d)return{villageoisPowers:[],loupPowers:[],secondaryRoles:[]};const w=1,A=1,P=15,$=b==="winRate"?(p,S)=>parseFloat(S.winRate)-parseFloat(p.winRate):(p,S)=>S.appearances-p.appearances,t=p=>({...p,winRateDisplay:Math.max(parseFloat(p.winRate),1)});return{villageoisPowers:d.villageoisPowers.filter(p=>p.appearances>=w).map(t).sort($).slice(0,P),loupPowers:d.loupPowers.filter(p=>p.appearances>=w).map(t).sort($).slice(0,P),secondaryRoles:d.secondaryRoles.filter(p=>p.appearances>=A).map(t).sort($).slice(0,P)}},[d,b]);if(u)return e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique des rÃ´les..."});if(r)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",r]});if(!d)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de rÃ´le disponible"});const o=a.villageoisPowers.length>0,i=a.loupPowers.length>0,g=a.secondaryRoles.length>0;if(!o&&!i&&!g)return e.jsx("div",{className:"donnees-manquantes",children:"Aucun pouvoir ou rÃ´le secondaire trouvÃ©"});const n=({active:w,payload:A})=>{if(w&&A&&A.length>0){const P=A[0].payload,$=P.gamesWithoutRoleChange<P.appearances;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:P.name})}),e.jsxs("div",{children:["Apparitions: ",P.appearances]}),$&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"0.25rem"},children:["dont ",P.appearances-P.gamesWithoutRoleChange," avec changement de rÃ´le (exclu du calcul)"]}),e.jsxs("div",{children:["Victoires: ",P.winsWithoutRoleChange]}),e.jsx("div",{children:e.jsxs("strong",{children:["Taux de victoire: ",P.winRate,"%"]})}),P.totalGamesAllModes&&P.totalGamesAllModes!==P.appearances&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic"},children:["(Total avec parties non moddÃ©es: ",P.totalGamesAllModes,")"]}),P.roleBreakdown&&P.roleBreakdown.length>0&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:[e.jsx("div",{style:{fontStyle:"italic"},children:"RÃ©partition par rÃ´le:"}),P.roleBreakdown.map((t,p)=>e.jsxs("div",{style:{marginLeft:"0.5rem"},children:["â€¢ ",t.role,": ",t.count]},p))]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},C=(w,A,P,$,t)=>{const p=b==="appearances"?"appearances":"winRateDisplay",S=b==="appearances"?"Nombre d'apparitions":"Taux de victoire (%)",c=b==="winRate"?[0,100]:void 0;return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:A}),e.jsx(B,{title:A,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(J,{data:w,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:12,tick:({x:m,y:f,payload:N})=>e.jsx("text",{x:m,y:f,textAnchor:"end",transform:`rotate(-45, ${m}, ${f})`,fill:k.highlightedPlayer===l?"var(--text-primary)":"var(--text-secondary)",fontSize:12,children:N.value})}),e.jsx(O,{label:{value:S,angle:270,position:"left",style:{textAnchor:"middle"}},domain:c}),e.jsx(E,{content:e.jsx(n,{})}),e.jsx(Y,{dataKey:p,label:b==="winRate"?m=>{const{x:f,y:N,width:D,payload:M}=m;if(f===void 0||N===void 0||D===void 0||!M)return null;const L=M.winRate||"0";return e.jsxs("text",{x:f+D/2,y:N-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[L,"%"]})}:void 0,children:w.map((m,f)=>e.jsx(_,{fill:t?t(m.name,f):P,onClick:()=>$(m.name),style:{cursor:"pointer"}},`cell-${f}`))})]})})})})]})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"chart-mode-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Affichage :"}),e.jsxs("select",{id:"chart-mode-select",value:b,onChange:w=>s(w.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"180px"},children:[e.jsx("option",{value:"appearances",children:"Apparitions"}),e.jsx("option",{value:"winRate",children:"Taux de victoire"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[o&&C(a.villageoisPowers,"Camp Villageois","var(--chart-color-1)",w=>{R({selectedPlayer:l,campFilter:{selectedCamp:"Villageois",campFilterMode:b==="winRate"?"wins-only":"all-assignments"},selectedPower:w,fromComponent:`Historique des RÃ´les - Pouvoir: ${w}`})},w=>w==="Chasseur"&&x.Chasseur?x.Chasseur:w==="Alchimiste"&&x.Alchimiste?x.Alchimiste:w==="Protecteur"&&x.Protecteur?x.Protecteur:w==="Disciple"&&x.Disciple?x.Disciple:"var(--chart-color-1)"),i&&C(a.loupPowers,"Camp Loups","var(--chart-color-2)",w=>{R({selectedPlayer:l,campFilter:{selectedCamp:"Loup",campFilterMode:b==="winRate"?"wins-only":"all-assignments"},selectedPower:w,fromComponent:`Historique des RÃ´les - Pouvoir: ${w}`})},()=>x.Loup||"var(--chart-color-2)"),g&&C(a.secondaryRoles,"RÃ´les Secondaires","var(--chart-color-3)",w=>{R({selectedPlayer:l,selectedSecondaryRole:w,fromComponent:`Historique des RÃ´les - RÃ´le Secondaire: ${w}`})}),e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"16px",padding:"8px",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)"},children:"â„¹ï¸ Les victoires et le taux de victoire excluent les parties oÃ¹ le rÃ´le principal a changÃ© en cours de partie (ex: Garde en Chasseur, rÃ©ssucitÃ© en Zombie par un Vaudou, etc...)."})]})]})}function me(l){return l==="SURVIVALIST_NOT_SAVED"?"BY_WOLF":l}function Qe({selectedPlayerName:l}){const{navigateToGameDetails:R}=X(),{gameData:j,isLoading:v,error:k}=he(),x=ie(),[b,y]=T.useState("deaths"),[d,u]=T.useState(""),[r,s]=T.useState(0),a=T.useMemo(()=>{if(!j)return[];const t=new Set;return j.forEach(p=>{const S=p.PlayerStats.find(c=>c.Username.toLowerCase()===l.toLowerCase());S&&(S.DeathPosition!==null&&p.MapName&&t.add(p.MapName),p.PlayerStats.forEach(c=>{c.KillerName?.toLowerCase()===l.toLowerCase()&&c.DeathPosition!==null&&p.MapName&&t.add(p.MapName)}))}),Array.from(t).filter(p=>p==="Village"||p==="ChÃ¢teau").sort((p,S)=>p==="Village"?-1:S==="Village"?1:p.localeCompare(S))},[j,l]),o=a.length>0?a[0]:"";d===""&&o!==""&&u(o);const i=T.useMemo(()=>{if(!j||!l)return[];const t=[];return j.forEach(p=>{if(d&&p.MapName!==d)return;const S=p.PlayerStats.find(c=>c.Username.toLowerCase()===l.toLowerCase());if(S)if(b==="deaths"){if(S.DeathPosition){const c=se(S.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0}),m=pe(S.DeathPosition.x,S.DeathPosition.z,p.MapName);t.push({x:m.x,z:m.z,victimName:S.Username,killerName:S.KillerName||null,deathType:me(S.DeathType),mapName:p.MapName,camp:c,gameId:p.DisplayedId,displayedGameId:p.DisplayedId})}}else p.PlayerStats.forEach(c=>{if(c.KillerName?.toLowerCase()===l.toLowerCase()&&c.DeathPosition){const m=se(c.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0}),f=pe(c.DeathPosition.x,c.DeathPosition.z,p.MapName);t.push({x:f.x,z:f.z,victimName:c.Username,killerName:l,deathType:me(c.DeathType),mapName:p.MapName,camp:m,gameId:p.DisplayedId,displayedGameId:p.DisplayedId})}})}),t},[j,l,b,d]),g=T.useMemo(()=>Ae(i,r).map((p,S)=>{const c=p.items[0],m=$e(p.items);return{x:p.centroidX,z:p.centroidZ,count:p.items.length,allLocations:p.items,victimName:p.items.length===1?c.victimName:null,killerName:p.items.length===1?c.killerName:null,deathType:m,mapName:c.mapName,camp:c.camp,gameId:p.items.length===1?c.gameId:null,displayedGameId:p.items.length===1?c.displayedGameId:null,clusterIndex:S}}),[i,r]),n=T.useMemo(()=>ze(d),[d]),{xDomain:C,zDomain:w}=T.useMemo(()=>{if(n)return{xDomain:[n.xMin,n.xMax],zDomain:[n.zMin,n.zMax]};if(g.length===0)return{xDomain:[0,100],zDomain:[0,100]};const t=g.map(M=>M.x),p=g.map(M=>M.z),S=Math.min(...t),c=Math.max(...t),m=Math.min(...p),f=Math.max(...p),N=(c-S)*.1||10,D=(f-m)*.1||10;return{xDomain:[S-N,c+N],zDomain:[m-D,f+D]}},[g,n]),A=t=>t?t==="BY_WOLF"||t==="SURVIVALIST_NOT_SAVED"?x.Loup:t==="VOTED"?"var(--chart-color-1)":t==="BULLET"||t==="BULLET_HUMAN"||t==="BULLET_WOLF"?x.Chasseur:t==="BY_ZOMBIE"?x.Vaudou:t==="ASSASSIN"?x.Alchimiste:t==="AVENGER"?"var(--chart-color-2)":t==="LOVER_DEATH"?x.Amoureux:t==="BY_BEAST"?"var(--chart-color-3)":t==="SHERIF_SUCCESS"?"var(--chart-color-4)":"var(--accent-primary)":"var(--text-secondary)",P=({active:t,payload:p})=>{if(!t||!p||p.length===0)return null;const S=p[0].payload,c=S.allLocations||[S];if(c.length>1){const N=new Map,D=new Map,M=new Set;c.forEach(z=>{N.set(z.victimName,(N.get(z.victimName)||0)+1);const I=z.deathType?ee(z.deathType):"Inconnu";D.set(I,(D.get(I)||0)+1),M.add(z.gameId)});const L=Array.from(N.entries()).sort((z,I)=>I[1]-z[1]).slice(0,3),Q=Array.from(D.entries()).sort((z,I)=>I[1]-z[1]).slice(0,3);return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"350px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[b==="deaths"?"ðŸ’€":"âš”ï¸"," ",c.length," ",b==="deaths"?"morts":"kills"," Ã  cet endroit"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:b==="deaths"?"Par:":"Victimes:"}),L.map(([z,I])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",z," (",I,"x)"]},z)),N.size>3&&e.jsxs("div",{style:{paddingLeft:"0.5rem",color:"var(--text-secondary)"},children:["+",N.size-3," autres..."]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Types de mort:"}),Q.map(([z,I])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",z," (",I,"x)"]},z))]}),e.jsxs("div",{style:{marginTop:"8px",color:"var(--text-secondary)"},children:["ðŸ“ ",M.size," partie",M.size>1?"s":""," diffÃ©rente",M.size>1?"s":""]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les parties concernÃ©es"})]})}const f=c[0];return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[b==="deaths"?"ðŸ’€":"âš”ï¸"," ",b==="deaths"?"Mort de":"Kill de"," ",l]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[b==="deaths"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"TuÃ© par:"})," ",f.killerName||"Inconnu"]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",f.deathType?ee(f.deathType):"Inconnue"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"Victime:"})," ",f.victimName]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",f.deathType?ee(f.deathType):"Inconnue"]}),e.jsxs("div",{children:["ðŸ‘¥ ",e.jsx("strong",{children:"Camp victime:"})," ",f.camp]})]}),e.jsxs("div",{children:["ðŸ—ºï¸ ",e.jsx("strong",{children:"Carte:"})," ",f.mapName]}),e.jsxs("div",{children:["ðŸŽ® ",e.jsx("strong",{children:"Partie:"})," #",f.gameId]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les dÃ©tails de la partie"})]})},$=t=>{if(!t)return;const p=t.allLocations||[t];if(p.length===1)R({selectedGame:p[0].gameId,fromComponent:"Player Death Map"});else{const S=p.map(c=>c.gameId).filter(c=>c);R({selectedGameIds:S,fromComponent:"Player Death Map"})}};return v?e.jsx("div",{className:"donnees-attente",children:"Chargement des donnÃ©es..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):j?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{style:{flex:"1 1 100%",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Afficher :"}),e.jsxs("div",{style:{display:"flex",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)",overflow:"hidden"},children:[e.jsx("button",{type:"button",onClick:()=>y("deaths"),style:{background:b==="deaths"?"var(--accent-primary)":"transparent",color:b==="deaths"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:b==="deaths"?"bold":"normal",transition:"all 0.2s"},children:"ðŸ’€ Morts"}),e.jsx("button",{type:"button",onClick:()=>y("kills"),style:{background:b==="kills"?"var(--accent-primary)":"transparent",color:b==="kills"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:b==="kills"?"bold":"normal",transition:"all 0.2s"},children:"âš”ï¸ Kills"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-map-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Carte :"}),e.jsx("select",{id:"player-map-select",value:d,onChange:t=>u(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:a.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"cluster-slider",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Regroupement :"}),e.jsx("input",{id:"cluster-slider",type:"range",min:"0",max:"50",step:"5",value:r,onChange:t=>s(parseInt(t.target.value)),style:{width:"80px"}}),e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",minWidth:"60px"},children:r===0?"Aucun":`${r} unitÃ©${r>1?"s":""}`})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{flex:"1 1 100%",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:b==="deaths"?"Morts localisÃ©es":"Kills localisÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:b==="deaths"?"var(--accent-secondary)":"var(--accent-primary)"},children:i.length}),r>0&&g.length<i.length&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginTop:"4px"},children:["â†’ ",g.length," points groupÃ©s"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Carte"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-2)",fontSize:"1.2rem"},children:d||"Aucune"})]})]}),e.jsx("div",{className:"lycans-graphique-section",style:{flex:"1 1 100%",minWidth:"100%"},children:i.length>0?e.jsx(B,{title:b==="deaths"?`Carte des Morts de ${l}`:`Carte des Kills de ${l}`,children:e.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto",aspectRatio:"1640 / 922"},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(We,{margin:{top:20,right:30,left:60,bottom:60},children:[n&&e.jsx(Ie,{x1:n.zMin,x2:n.zMax,y1:n.xMin,y2:n.xMax,fill:"transparent",stroke:"none",shape:t=>{const{x:p,y:S,width:c,height:m}=t;return e.jsx("image",{x:p,y:S,width:c,height:m,href:n.src,preserveAspectRatio:"xMidYMid slice",style:{opacity:.85}})}}),e.jsx(K,{strokeDasharray:"3 3",stroke:n?"rgba(255,255,255,0.3)":"var(--border-color)"}),e.jsx(H,{dataKey:"z",type:"number",name:"Position Z",label:{value:"Position Z",position:"bottom",offset:10,style:{fill:"var(--text-secondary)"}},domain:w,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:t=>Math.round(t).toString()}),e.jsx(O,{dataKey:"x",type:"number",name:"Position X",label:{value:"Position X",angle:-90,position:"left",offset:20,style:{fill:"var(--text-secondary)"}},domain:C,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:t=>Math.round(t).toString()}),e.jsx(E,{content:e.jsx(P,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(Le,{data:g,onClick:t=>$(t),style:{cursor:"pointer"},isAnimationActive:!1,children:g.map((t,p)=>{const S=Math.min(Math.log2(t.count+1)*3+5,18),c=Math.round(S);return e.jsx(_,{fill:A(t.deathType),stroke:t.count>1?"white":"rgba(255,255,255,0.5)",strokeWidth:t.count>1?2:1,opacity:.85,r:c},`cell-${p}`)})})]})})})}):e.jsxs("div",{className:"donnees-manquantes",style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"0.5rem"},children:b==="deaths"?`Aucune mort localisÃ©e pour ${l} sur cette carte.`:`Aucun kill localisÃ© pour ${l} sur cette carte.`}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Les donnÃ©es de position ne sont disponibles que pour les parties rÃ©centes."})]})}),e.jsxs("div",{className:"lycans-section-description",style:{flex:"1 1 100%",marginTop:"1.5rem"},children:[e.jsx("h4",{children:"Ã€ propos de cette carte"}),e.jsxs("p",{children:["Cette carte affiche ",b==="deaths"?`les emplacements oÃ¹ ${l} est mort`:`les emplacements oÃ¹ ${l} a Ã©liminÃ© d'autres joueurs`," au cours des parties. Les couleurs indiquent le type de mort. Cliquez sur un point pour voir les dÃ©tails de la partie."]}),e.jsxs("p",{style:{marginTop:"0.5rem"},children:["Les points regroupÃ©s ont une petite bordure blanche.",e.jsx("br",{}),e.jsx("strong",{children:"ðŸ’€ Morts:"})," OÃ¹ le joueur a Ã©tÃ© Ã©liminÃ©",e.jsx("br",{}),e.jsx("strong",{children:"âš”ï¸ Kills:"})," OÃ¹ le joueur a Ã©liminÃ© d'autres joueurs"]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e disponible"})}function wt(){const{settings:l,updateSettings:R}=ae(),{navigateToGameDetails:j,navigationState:v,updateNavigationState:k}=X(),{data:x,isLoading:b,error:y}=Ce(),{joueursData:d,isLoading:u}=re(),{data:r,isLoading:s,error:a}=Be(l.highlightedPlayer),o=le(d),[i,g]=T.useState(""),[n,C]=T.useState(null),{clips:w}=qe(l.highlightedPlayer),{clips:A}=Ee(),[P,$]=T.useState(()=>l.useIndependentFilters&&l.independentFilters?.gameTypeEnabled?l.independentFilters.gameFilter==="modded"?"modded":"all":l.gameFilter==="modded"?"modded":"all"),t=T.useMemo(()=>l.useIndependentFilters&&l.independentFilters?.gameTypeEnabled?l.independentFilters.gameFilter==="modded":l.gameFilter==="modded",[l.useIndependentFilters,l.independentFilters?.gameTypeEnabled,l.independentFilters?.gameFilter,l.gameFilter]),[p,S]=T.useState(v.selectedPlayerSelectionView||"achievements"),[c,m]=T.useState("session"),[f,N]=T.useState("all");T.useEffect(()=>{if(l.useIndependentFilters&&l.independentFilters?.gameTypeEnabled){const h=l.independentFilters.gameFilter==="modded"?"modded":"all";$(h)}else if(!l.useIndependentFilters){const h=l.gameFilter==="modded"?"modded":"all";$(h)}},[l.gameFilter,l.useIndependentFilters,l.independentFilters?.gameTypeEnabled,l.independentFilters?.gameFilter]),T.useEffect(()=>{t&&P!=="modded"&&$("modded")},[t,P]),T.useEffect(()=>{v.selectedPlayerSelectionView&&S(v.selectedPlayerSelectionView)},[v.selectedPlayerSelectionView]);const{data:D}=ne(l.highlightedPlayer||""),M=T.useMemo(()=>{if(!x||!x.GameStats)return[];const h=t?x.GameStats.filter(G=>G.Modded===!0):x.GameStats,F=new Map;return h.forEach(G=>{const W=new Date(G.StartDate);G.PlayerStats.forEach(V=>{const U=te(V),ve=d?.Players?.find(je=>je.SteamID===U)?.Joueur||V.Username;F.has(U)||F.set(U,{games:0,wins:0,firstDate:W,lastDate:W,displayName:ve});const Z=F.get(U);Z.games++,V.Victorious&&Z.wins++,W<Z.firstDate&&(Z.firstDate=W),W>Z.lastDate&&(Z.lastDate=W)})}),Array.from(F.entries()).map(([G,W])=>{let V=d?.Players?.find(U=>U.SteamID===G);return V||(V=d?.Players?.find(U=>U.Joueur===W.displayName)),{id:G,name:W.displayName,totalGames:W.games,totalWins:W.wins,winRate:W.games>0?W.wins/W.games*100:0,firstGameDate:W.firstDate.toLocaleDateString("fr-FR"),lastGameDate:W.lastDate.toLocaleDateString("fr-FR"),isHighlighted:W.displayName===l.highlightedPlayer,image:V?.Image||null,twitch:V?.Twitch||null,youtube:V?.Youtube||null}})},[x,l.highlightedPlayer,d,t]),L=T.useMemo(()=>{if(!i.trim())return M;const h=i.toLowerCase();return M.filter(F=>F.name.toLowerCase().includes(h))},[M,i]),Q=T.useMemo(()=>[...L].sort((h,F)=>F.totalGames-h.totalGames),[L]),z=h=>{R({highlightedPlayer:h}),g("")},I=h=>{S(h),k({selectedPlayerSelectionView:h})},ye=()=>{if(w.length===0)return;const h=Math.floor(Math.random()*w.length);C(w[h])};return b||u?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):y?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",y]})]}):!x||M.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!l.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:i,onChange:h=>g(h.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[L.length," joueur",L.length!==1?"s":"",i&&` (filtrÃ©${L.length!==1?"s":""} de ${M.length})`]})]})]}),e.jsx("div",{className:"player-display",children:i?L.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{type:"button",className:"clear-search-btn",onClick:()=>g(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:Q.map(h=>e.jsxs("button",{type:"button",className:`suggestion-btn ${h.isHighlighted?"highlighted":""}`,onClick:()=>z(h.name),children:[h.image?e.jsx("img",{src:h.image,alt:`Photo de profil de ${h.name}`,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":o[h.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[h.name,h.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[h.totalGames," parties â€¢ ",h.winRate.toFixed(1),"% victoires"]})]})]},h.id))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',i,'"']}),e.jsx("button",{type:"button",className:"clear-search-btn",onClick:()=>g(""),children:"Effacer la recherche"})]}):l.highlightedPlayer?(()=>{const h=M.find(F=>F.name===l.highlightedPlayer);return h?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:h.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[h.image?e.jsx("img",{src:h.image,alt:`Photo de profil de ${h.name}`,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":o[h.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[h.totalGames," parties â€¢ ",h.totalWins," victoires â€¢ ",h.winRate.toFixed(1),"% taux de victoire"]}),(h.twitch||h.youtube||w.length>0)&&e.jsxs("div",{className:"social-links",children:[h.twitch&&e.jsx("a",{href:h.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),h.youtube&&e.jsx("a",{href:h.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"}),w.length>0&&e.jsxs("button",{type:"button",className:"social-link clips-btn",onClick:F=>{F.stopPropagation(),ye()},title:`${w.length} clip${w.length>1?"s":""} disponible${w.length>1?"s":""}`,children:["ðŸŽ¬ Clip alÃ©atoire (",w.length,")"]})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="achievements"?"active":""}`,onClick:()=>I("achievements"),children:"Classement"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="evolution"?"active":""}`,onClick:()=>I("evolution"),children:"Ã‰volution"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="camps"?"active":""}`,onClick:()=>I("camps"),children:"Camps"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="roles"?"active":""}`,onClick:()=>I("roles"),children:"RÃ´les"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="maps"?"active":""}`,onClick:()=>I("maps"),children:"Maps"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="kills"?"active":""}`,onClick:()=>I("kills"),children:"Kills"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${p==="deathmap"?"active":""}`,onClick:()=>I("deathmap"),children:"Carte"})]}),p==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[s?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):a?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",a]})}):r?e.jsx(Oe,{achievements:P==="all"?r.allGamesAchievements:r.moddedOnlyAchievements,title:P==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:P}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[!t&&e.jsx("button",{type:"button",className:`filter-btn ${P==="all"?"active":""}`,onClick:F=>{F.stopPropagation(),$("all")},children:"Toutes les parties"}),e.jsx("button",{type:"button",className:`filter-btn ${P==="modded"?"active":""}`,onClick:F=>{F.stopPropagation(),$("modded")},disabled:t,children:"Parties moddÃ©es"})]})]}),p==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[D&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{j({selectedPlayer:h.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${h.name}`,style:{fontSize:"1.3rem"},children:D.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Temps de jeu cumulÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:ke(D.totalPlayTime)}),e.jsx("p",{children:"temps total de jeu"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{j({selectedPlayer:h.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${h.name}`,style:{fontSize:"1.3rem"},children:D.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:[D.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:c,onChange:F=>m(F.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-filter-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsxs("select",{id:"camp-filter-select",value:f,onChange:F=>N(F.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"all",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loups"}),e.jsx("option",{value:"solo",children:"RÃ´les solo"})]})]})]}),e.jsx(_e,{selectedPlayerName:h.name,groupingMethod:c,campFilter:f})]}),p==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ue,{selectedPlayerName:h.name})}),p==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ye,{selectedPlayerName:h.name})}),p==="roles"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ze,{selectedPlayerName:h.name})}),p==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Je,{selectedPlayerName:h.name})}),p==="deathmap"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Qe,{selectedPlayerName:h.name})}),e.jsx("button",{type:"button",className:"highlight-btn active",onClick:F=>{F.stopPropagation(),R({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[h.firstGameDate," - ",h.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',l.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{type:"button",className:"clear-selection-btn",onClick:()=>R({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:Q.map(h=>e.jsxs("div",{className:`character-card ${h.isHighlighted?"highlighted":""}`,onClick:()=>z(h.name),title:`${h.name} - ${h.totalGames} parties, ${h.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:h.image?e.jsx("img",{src:h.image,alt:`Photo de profil de ${h.name}`,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":o[h.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:h.name}),(h.twitch||h.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[h.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),h.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},h.id))})})}),n&&e.jsx(Ge,{clip:n,onClose:()=>C(null),relatedClips:Ve(n,A),nextClip:ue(n,A),onNextClip:()=>{const h=ue(n,A);h&&C(h)},onRelatedClip:h=>{const F=A.find(G=>G.ClipId===h);F&&C(F)}})]})}export{wt as PlayerSelectionPage};
