import{a as te,r as M,g as Q,f as he,u as X,j as e,c as oe,m as ge}from"./index-mVkbdXau.js";import{u as ae}from"./useJoueursData-DvQxFOgh.js";import{u as ce}from"./baseStatsHook-DmPqT9H6.js";import{g as xe}from"./gameUtils-CCGRmivF.js";import{a as de,g as ee,c as fe}from"./datasyncExport-D6_8Fmuy.js";import{u as ie,g as ve,a as se,l as ue}from"./api-BfXzialC.js";import{d as ye}from"./durationFormatters-C9UyWcKX.js";import{F as E,C as G,X as V,Y as B,a as K}from"./FullscreenChart-DURYIO7N.js";import{R as W,T as L}from"./CategoricalChart-B4OHOSCd.js";import{L as je,a as be}from"./LineChart-Bh1rBDL6.js";import{B as Y,a as U}from"./BarChart-Dspo8JTd.js";import{P as Ce,a as we}from"./PieChart-Ch0X3XNS.js";import{u as Re}from"./useDeathStatisticsFromRaw-C132POsf.js";import{R as ne}from"./ReferenceLine-CbRR-3dk.js";import{g as J}from"./deathTypes-CGUOTngO.js";import{a as Se,R as ke}from"./deathLocationUtils-CJxVVigC.js";import{S as Ne,a as Te}from"./ScatterChart-KzS_h2My.js";import"./ActivePoints-sxN85K_c.js";import"./PolarChart-Denzda1k.js";function Me(o){const{settings:R}=te(),{joueursData:j}=ae(),[y,S]=M.useState(null),[f,b]=M.useState(!1),[v,d]=M.useState(null);M.useEffect(()=>{let i=!0;return(async()=>{try{b(!0),d(null);const s=R.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",c=await fetch(s);if(!c.ok)throw new Error(`Failed to load achievements: ${c.status} ${c.statusText}`);const l=await c.json();i&&S(l)}catch(s){i&&d(s instanceof Error?s.message:"Failed to load achievements")}finally{i&&b(!1)}})(),()=>{i=!1}},[R.dataSource]);const h=(()=>{if(!o||!y)return null;const a=j?.Players?.find(s=>s.Joueur===o)?.SteamID;return a?y.achievements[a]||null:(console.warn(`âš ï¸ No Steam ID found for player: ${o}`),null)})();return M.useEffect(()=>{o&&y&&j&&j.Players?.find(s=>s.Joueur===o)?.SteamID},[o,y,j,R.dataSource]),{data:h,isLoading:f,error:v,metadata:{generatedAt:y?.generatedAt||null,totalPlayers:y?.totalPlayers||0,totalGames:y?.totalGames||0,totalModdedGames:y?.totalModdedGames||0}}}function Fe(o,R,j){if(!o||o.trim()===""||R.length===0)return null;const y=[];let S=o;R.forEach(a=>{const s=a.PlayerStats.find(c=>Q(c)===o||c.Username.toLowerCase()===o.toLowerCase());if(s){S=s.Username;const c=s.MainRoleInitial==="Louveteau"?s.MainRoleInitial:de(s.MainRoleInitial,s.MainRoleChanges||[]),l=ee(c);if(j&&j!=="Tous les camps"&&l!==j)return;const x=xe(a),n=s.Victorious,w=he(new Date(a.StartDate)),k=fe(a.StartDate,a.EndDate)||0;y.push({gameId:a.Id,date:w,camp:l,won:n,winnerCamp:x,playersInGame:a.PlayerStats.length,mapName:a.MapName,duration:k})}}),y.sort((a,s)=>{const c=l=>{const x=l.split("/");return x.length===3?new Date(parseInt(x[2]),parseInt(x[1])-1,parseInt(x[0])):new Date(l)};return c(s.date).getTime()-c(a.date).getTime()});const f=y.length,b=y.filter(a=>a.won).length,v=f>0?(b/f*100).toFixed(2):"0.00",d={};y.forEach(a=>{d[a.camp]||(d[a.camp]={appearances:0,wins:0,winRate:"0.00"}),d[a.camp].appearances++,a.won&&d[a.camp].wins++}),Object.keys(d).forEach(a=>{const s=d[a];s.winRate=s.appearances>0?(s.wins/s.appearances*100).toFixed(2):"0.00"});const h={};y.forEach(a=>{h[a.mapName]||(h[a.mapName]={appearances:0,wins:0,winRate:"0.00"}),h[a.mapName].appearances++,a.won&&h[a.mapName].wins++}),Object.keys(h).forEach(a=>{const s=h[a];s.winRate=s.appearances>0?(s.wins/s.appearances*100).toFixed(2):"0.00"});const i=y.reduce((a,s)=>a+s.duration,0);return{playerName:S,totalGames:f,totalWins:b,winRate:v,totalPlayTime:i,games:y,campStats:d,mapStats:h}}function Pe(o){const R={};let j=0,y=0;return Object.entries(o).forEach(([S,f])=>{S==="Village"||S==="ChÃ¢teau"?R[S]={...f}:(j+=f.appearances,y+=f.wins)}),j>=10&&(R.Autres={appearances:j,wins:y,winRate:j>0?(y/j*100).toFixed(2):"0.00"}),R}function re(o,R){const{data:j,isLoading:y,error:S}=ce(f=>o?Fe(o,f,R):null);return{data:j,isLoading:y,error:S}}function De({achievements:o,title:R,emptyMessage:j,achievementType:y="all"}){const{navigateToTab:S,updateNavigationState:f,clearNavigation:b}=X(),{settings:v,updateSettings:d}=te(),{joueursData:h}=ae(),i=ie(h),a=(t,u)=>{if(u.stopPropagation(),!t.redirectTo)return;b();const C=v.highlightedPlayer;if(d(y==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:C,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:C,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),t.category==="comparison"&&t.redirectTo.subTab==="comparison"){const r=v.highlightedPlayer||"",p=s(t.description,r);p&&f({playerComparisonState:{selectedPlayer1:r,selectedPlayer2:p,showDetailedStats:!0}})}if(t.category==="comparison"&&t.redirectTo.subTab==="pairing"){const r=t.description.toLowerCase().includes("loup");f({selectedPairingTab:r?"wolves":"lovers"})}if(t.category==="kills"&&t.redirectTo.subTab==="deathStats"){const r=t.description.match(/(Villageois|Loups|Autres)/i);r&&f({deathStatsSelectedCamp:r[1]});let p=10;const m=t.description.match(/min\.\s*(\d+)/);m&&(p=parseInt(m[1],10));let N="totalKills",F="killers";const T=t.redirectTo.chartSection;T&&(T==="killers-total"?(N="totalKills",F="killers"):T==="killers-average"?(N="averageKills",F="killers"):T==="deaths-total"?(N="totalDeaths",F="deaths"):T==="survivors-average"?(N="survivalRate",F="deaths"):(T==="hunters-good"||T==="hunters-bad")&&(F="hunter",N="averageKills")),f({deathStatisticsState:{selectedCamp:r?.[1]||"Tous les camps",minGamesForAverage:p,selectedView:F,focusChart:N}})}if(t.category==="map"&&t.redirectTo.subTab==="playersGeneral"){const r=t.redirectTo.mapFilter||"all";let p=10;const m=t.description.match(/min\.\s*(\d+)/);m&&(p=parseInt(m[1])),d(y==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:r,playerFilter:{mode:"none",players:[]},highlightedPlayer:C,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:r,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:r,playerFilter:{mode:"none",players:[]},highlightedPlayer:C,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:r,playerFilter:{mode:"none",players:[]}}}),f({playersGeneralState:{minGamesForWinRate:p,winRateOrder:"best",focusChart:"winRate"}}),S("players","playersGeneral");return}if(t.category==="history"&&t.redirectTo.subTab==="history"&&f({selectedPlayerName:v.highlightedPlayer||"",groupingMethod:"session"}),t.category==="series"&&t.redirectTo.subTab==="series"){let r="wins";const p=t.title.toLowerCase(),m=t.description.toLowerCase();p.includes("dÃ©faite")||m.includes("dÃ©faite")?r="losses":p.includes("loup")||m.includes("loup")?r="loup":p.includes("villageois")||m.includes("villageois")?r="villageois":(p.includes("victoire")||m.includes("victoire"))&&(r="wins"),f({selectedSeriesType:r})}if(t.category==="general"&&t.redirectTo.subTab==="playersGeneral"){let r=10;const p=t.description.match(/min\.\s*(\d+)/);p&&(r=parseInt(p[1],10));let m="winRate",N="best";const F=t.title.toLowerCase(),T=t.description.toLowerCase();F.includes("participation")||T.includes("participation")?m="participation":(F.includes("taux de victoire")||T.includes("taux de victoire"))&&(m="winRate",(F.includes("moins bon")||F.includes("mauvais")||T.includes("moins bon")||T.includes("mauvais"))&&(N="worst")),f({playersGeneralState:{minGamesForWinRate:r,winRateOrder:N,focusChart:m}})}if(t.category==="performance"&&t.redirectTo.subTab==="campPerformance"){const r=t.redirectTo.chartSection;let p="Villageois",m=1;r&&(r==="camp-loup"?p="Loup":r==="camp-villageois"?p="Villageois":r==="camp-idiot"?p="Idiot du Village":r==="camp-amoureux"?p="Amoureux":(r==="solo-roles"||r==="hall-of-fame")&&(p="Villageois"));const N=t.description.match(/min\.\s*(\d+)/);N&&(m=parseInt(N[1],10)),r==="solo-roles"?p="RÃ´les spÃ©ciaux":r==="hall-of-fame"&&(p="Tous les camps"),f({campPerformanceState:{selectedCampPerformanceCamp:p,selectedCampPerformanceMinGames:m}})}if(t.category==="voting"&&t.redirectTo.subTab==="votingStats"){const r=t.title.toLowerCase();let p="overview",m="behavior";r.includes("agressivitÃ©")?(p="overview",m="behavior"):r.includes("taux de vote")?(p="behavior",m="voteRate"):r.includes("prÃ©cision")&&(p="overview",m="accuracy"),f({votingStatsState:{selectedCategory:p,selectedView:m}})}S(t.redirectTo.tab,t.redirectTo.subTab)},s=(t,u)=>{const C=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const r of C){const p=t.match(r);if(p&&p[1]){const m=p[1].trim();if(m!==u)return m}}return null},c=t=>{if(!t.redirectTo)return"Aucune navigation disponible";switch(t.category){case"general":if(t.redirectTo.subTab==="playersGeneral"){const r=t.description.match(/min\.\s*(\d+)/),p=r?parseInt(r[1],10):10,m=t.title.toLowerCase(),N=y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return m.includes("taux de victoire")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${p} parties)${N}`:m.includes("participation")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les participations${N}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${N}`}break;case"map":if(t.redirectTo.subTab==="playersGeneral"){const r=t.redirectTo.mapFilter,p=r==="village"?"Village":r==="chateau"?"ChÃ¢teau":"map",m=y==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${p}${m}`}break;case"history":if(t.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(t.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${s(t.description,v.highlightedPlayer||"")||"ce joueur"}`;if(t.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(t.redirectTo.subTab==="deathStats"){const r=t.description.match(/(Villageois|Loups|Autres)/i),p=t.description.match(/min\.\s*(\d+)/),m=p?parseInt(p[1],10):10,N=r?.[1]||"Tous les camps",F=t.redirectTo.chartSection;let T="kills et morts";return F==="killers-total"?T="total des kills":F==="killers-average"?T=`moyenne des kills (min. ${m} parties)`:F==="deaths-total"?T="total des morts":F==="survivors-average"&&(T=`taux de survie (min. ${m} parties)`),`Cliquez pour voir les statistiques de ${T} ${N!=="Tous les camps"?`en ${N}`:""}`}break;case"series":if(t.redirectTo.subTab==="series"){const r=t.title.toLowerCase(),p=t.description.toLowerCase();return r.includes("dÃ©faite")||p.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":r.includes("loup")||p.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":r.includes("villageois")||p.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":r.includes("victoire")||p.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(t.redirectTo.subTab==="campPerformance"){const r=t.redirectTo.chartSection,p=y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return r==="camp-loup"?`Cliquez pour voir les performances camp Loup${p}`:r==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${p}`:r==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${p}`:r==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${p}`:r==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${p}`:r==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${p}`:`Cliquez pour voir les performances par camp${p}`}break;case"voting":if(t.redirectTo.subTab==="votingStats"){const r=t.description.match(/min\.\s*(\d+)/),p=r?parseInt(r[1],10):25,m=y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",N=t.title.toLowerCase();return N.includes("agressivitÃ©")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${p} meetings)${m}`:N.includes("taux de vote")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${p} meetings)${m}`:N.includes("prÃ©cision")?`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${m}`:`Classement: ${t.rank}${t.totalRanked?`/${t.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${m}`}break}return`Cliquez pour voir ${t.redirectTo.subTab}`+(y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},l=t=>i[t]||ve(t),x=t=>{const u=[/avec ([^:]+?):/,/contre ([^:]+?):/];let C=t;return u.forEach(r=>{const p=t.match(r);if(p&&p[1]){const m=p[1].trim(),F=`<span class="player-name-highlight" style="color: ${l(m)};">${m}</span>`;C=C.replace(m,F)}}),C};if(o.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:R}),e.jsx("p",{children:j||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const n=t=>t===1?"ðŸ¥‡":t===2?"ðŸ¥ˆ":t===3?"ðŸ¥‰":"",w=t=>t===1?"rank-1":t===2?"rank-2":t===3?"rank-3":t&&t<=10?"rank-top-10":"",k=o.filter(t=>t.category!=="comparison"&&(t.type==="good"||t.type==="neutral")).sort((t,u)=>(t.rank??999)-(u.rank??999)),D=o.filter(t=>t.category!=="comparison"&&t.type==="bad").sort((t,u)=>(t.rank??999)-(u.rank??999)),P=o.filter(t=>t.category==="comparison"),$=k.filter(t=>t.rank&&t.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:R}),$>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:k.filter(t=>t.rank&&t.rank<=3).map((t,u)=>e.jsxs("div",{className:`top3-card ${w(t.rank)} animate-slide-in`,style:{animationDelay:`${u*.15}s`},onClick:C=>a(t,C),title:c(t),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:n(t.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:t.title}),e.jsx("p",{className:"top3-achievement-description",children:t.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},t.id))})]}),k.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:k.filter(t=>!t.rank||t.rank>3).map((t,u)=>e.jsxs("div",{className:`achievement-card good ${w(t.rank)}`,onClick:C=>a(t,C),title:c(t),style:{animationDelay:`${u*.05}s`},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id))})]}),D.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:D.map(t=>e.jsxs("div",{className:`achievement-card bad rank-${t.rank}`,onClick:u=>a(t,u),title:c(t),children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:t.title}),e.jsxs("span",{className:"achievement-rank",children:["#",t.rank,t.totalRanked?`/${t.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:t.description})]},t.id))})]}),P.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:P.map(t=>e.jsxs("div",{className:"achievement-card comparison",onClick:u=>a(t,u),title:c(t),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:t.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:x(t.description)}})]},t.id))})]})]})}function Ae({selectedPlayerName:o,groupingMethod:R,campFilter:j="all"}){const{navigateToGameDetails:y}=X(),{data:S,isLoading:f,error:b}=re(o),v=M.useMemo(()=>{switch(R){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[R]),d=M.useMemo(()=>{if(!S?.games)return new Map;const s=new Map;return S.games.forEach(c=>{if(!s.has(c.date)){const l=c.date.split("/");l.length===3?s.set(c.date,new Date(parseInt(l[2]),parseInt(l[1])-1,parseInt(l[0])).getTime()):s.set(c.date,new Date(c.date).getTime())}}),s},[S?.games]),h=M.useMemo(()=>{if(!S?.games)return[];const s={};return S.games.forEach(c=>{if(j!=="all"){if(j==="solo"){if(c.camp==="Villageois"||c.camp==="Loup")return}else if(c.camp!==j)return}let l;const x=c.date.split("/");if(R==="month")if(x.length===3)l=`${x[1].padStart(2,"0")}/${x[2]}`;else{const n=new Date(c.date);l=`${String(n.getMonth()+1).padStart(2,"0")}/${n.getFullYear()}`}else if(R==="quarter")if(x.length===3){const n=parseInt(x[1],10);l=`T${Math.floor((n-1)/3)+1}/${x[2]}`}else{const n=new Date(c.date);l=`T${Math.floor(n.getMonth()/3)+1}/${n.getFullYear()}`}else R==="year"?x.length===3?l=`${x[2]}`:l=`${new Date(c.date).getFullYear()}`:l=c.date;s[l]||(s[l]={games:[],wins:0,total:0}),s[l].games.push(c),s[l].total++,c.won&&s[l].wins++}),Object.entries(s).map(([c,l])=>({period:c,totalGames:l.total,victories:l.wins,defeats:l.total-l.wins,winRate:l.total>0?(l.wins/l.total*100).toFixed(1):"0.0",winRateNum:l.total>0?l.wins/l.total*100:0})).sort((c,l)=>{if(R==="month"){const[x,n]=c.period.split("/"),[w,k]=l.period.split("/"),D=new Date(parseInt(n),parseInt(x)-1,1),P=new Date(parseInt(k),parseInt(w)-1,1);return D.getTime()-P.getTime()}else if(R==="quarter"){const[x,n]=c.period.split("/"),[w,k]=l.period.split("/"),D=parseInt(x.replace(/\D/g,""),10)||1,P=parseInt(w.replace(/\D/g,""),10)||1,$=new Date(parseInt(n,10),(D-1)*3,1),t=new Date(parseInt(k,10),(P-1)*3,1);return $.getTime()-t.getTime()}else if(R==="year"){const x=parseInt(c.period,10),n=parseInt(l.period,10);return x-n}else{const x=d.get(c.period)||0,n=d.get(l.period)||0;return x-n}})},[S,R,d,j]),a=(s=>s<=15?{fontSize:12,angle:-45,height:80,interval:0}:s<=30?{fontSize:12,angle:-45,height:85,interval:1}:s<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(s/12)})(h.length);return f?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):b?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",b]}):S?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",v]}),e.jsx(E,{title:`Ã‰volution des Performances ${v}`,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(je,{data:h,margin:{top:20,right:30,left:20,bottom:20},onClick:s=>{if(s&&s.activeLabel){const c=h.find(l=>l.period===s.activeLabel);c&&y({selectedPlayer:o,selectedDate:c.period,fromComponent:`Ã‰volution des Performances ${v}`})}},style:{cursor:"pointer"},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"period",angle:a.angle,textAnchor:"end",height:a.height,interval:a.interval,fontSize:a.fontSize}),e.jsx(B,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(L,{content:({active:s,payload:c})=>{if(s&&c&&c.length>0){const l=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:l.period})}),e.jsxs("div",{children:["Parties: ",l.totalGames]}),e.jsxs("div",{children:["Victoires: ",l.victories]}),e.jsxs("div",{children:["Taux: ",l.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(be,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",v]}),e.jsx(E,{title:`RÃ©partition Victoires/DÃ©faites ${v}`,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:h,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"period",angle:a.angle,textAnchor:"end",height:a.height,interval:a.interval,fontSize:a.fontSize}),e.jsx(B,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(L,{content:({active:s,payload:c})=>{if(s&&c&&c.length>0){const l=c[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:l.period})}),e.jsxs("div",{children:["Total: ",l.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",l.victories]}),e.jsxs("div",{children:["DÃ©faites: ",l.defeats]}),e.jsxs("div",{children:["Taux: ",l.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(U,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:h.map((s,c)=>e.jsx(K,{fill:"var(--accent-tertiary)",onClick:()=>{y({selectedPlayer:o,selectedDate:s.period,fromComponent:`Historique Joueur - Victoires ${v}`})},style:{cursor:"pointer"}},`cell-victories-${c}`))}),e.jsx(U,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:h.map((s,c)=>e.jsx(K,{fill:"var(--chart-color-4)",onClick:()=>{y({selectedPlayer:o,selectedDate:s.period,fromComponent:`Historique Joueur - DÃ©faites ${v}`})},style:{cursor:"pointer"}},`cell-defeats-${c}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ze({selectedPlayerName:o}){const{navigateToGameDetails:R}=X(),{data:j,isLoading:y,error:S}=re(o),f=se(),b=M.useMemo(()=>j?.campStats?Object.entries(j.campStats).map(([d,h])=>({name:d,value:h.appearances,winRate:h.winRate,winRateDisplay:Math.max(parseFloat(h.winRate),1),wins:h.wins,percentage:(h.appearances/j.totalGames*100).toFixed(1)})):[],[j]),v=M.useMemo(()=>{if(!b.length)return[];const d=5;let h=0;const i=[],a=[];if(b.forEach(s=>{parseFloat(s.percentage)<d?(h+=Number(s.value),i.push(s)):a.push(s)}),h>0){const s=b.reduce((c,l)=>c+Number(l.value),0);a.push({name:"Autres",value:h,winRate:"0.0",winRateDisplay:1,wins:i.reduce((c,l)=>c+l.wins,0),percentage:(h/s*100).toFixed(1),_details:i})}return a},[b]);return y?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):S?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",S]}):j?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Ce,{children:[e.jsx(we,{data:v,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:d=>{const h=d.percent!==void 0?d.percent:0;return d.name==="Autres"?`Autres : ${d.value} (${(h*100).toFixed(1)}%)`:`${d.name}: ${d.value} (${(h*100).toFixed(1)}%)`},children:v.map((d,h)=>e.jsx(K,{fill:d.name==="Autres"?ue:f[d.name]||`var(--chart-color-${h%6+1})`,onClick:()=>{if(d.name==="Autres"){const i=d._details?.map(a=>a.name)||[];R({selectedPlayer:o,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:i},fromComponent:"Distribution par Camps"})}else d.name==="TraÃ®tre"||d.name==="Louveteau"?R({selectedPlayer:o,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):d.name==="Loup"?R({selectedPlayer:o,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):R({selectedPlayer:o,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${h}`))}),e.jsx(L,{content:({active:d,payload:h})=>{if(d&&h&&h.length>0){const i=h[0].payload;if(i.name==="Autres"&&i._details){const a=[...i._details].sort((s,c)=>c.value-s.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",i.value," parties (",i.percentage,"%)"]})}),e.jsx("div",{children:a.map((s,c)=>e.jsxs("div",{children:[s.name,": ",s.value," parties (",s.percentage,"%)"]},c))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[i.name," - ",i.value," parties (",i.percentage,"%)"]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(E,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:b,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(B,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(L,{content:({active:d,payload:h})=>{if(d&&h&&h.length>0){const i=h[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.value]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(U,{dataKey:"winRateDisplay",children:b.map((d,h)=>e.jsx(K,{fill:parseFloat(d.winRate)===0?`${f[d.name]||`var(--chart-color-${h%6+1})`}50`:f[d.name]||`var(--chart-color-${h%6+1})`,onClick:()=>{d.name==="TraÃ®tre"||d.name==="Louveteau"?R({selectedPlayer:o,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):d.name==="Loup"?R({selectedPlayer:o,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):R({selectedPlayer:o,campFilter:{selectedCamp:d.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${h}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function Ie({selectedPlayerName:o}){const{navigateToGameDetails:R,navigationState:j,updateNavigationState:y}=X(),[S,f]=M.useState(j.playerHistoryMapState?.selectedCamp||"Tous les camps"),{data:b}=Re(),{data:v,isLoading:d,error:h}=re(o,S);M.useEffect(()=>{(!j.playerHistoryMapState||j.playerHistoryMapState.selectedCamp!==S)&&y({playerHistoryMapState:{selectedCamp:S}})},[S,j.playerHistoryMapState,y]);const i=s=>{f(s),y({playerHistoryMapState:{selectedCamp:s}})},a=M.useMemo(()=>{if(!v?.mapStats)return[];const s=Pe(v.mapStats);return Object.entries(s).map(([c,l])=>({name:c,value:l.appearances,winRate:l.winRate,winRateDisplay:Math.max(parseFloat(l.winRate),.1),wins:l.wins,percentage:(l.appearances/v.totalGames*100).toFixed(1)}))},[v]);return d?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):h?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",h]}):v?a.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Performance par Carte",S!=="Tous les camps"?` (${S})`:""]}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select-map",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select-map",value:S,onChange:s=>i(s.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),b?.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx(E,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:a,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(B,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(ne,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(a.length>0){const s=a.reduce((x,n)=>x+n.value,0),c=a.reduce((x,n)=>x+n.wins,0),l=s>0?c/s*100:0;if(l!==50)return e.jsx(ne,{y:l,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${l.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(L,{content:({active:s,payload:c})=>{if(s&&c&&c.length>0){const l=c[0].payload,x=[];return a.forEach(n=>{if(n.name!==l.name&&n.value>=5){const w=parseFloat(l.winRate)-parseFloat(n.winRate);Math.abs(w)>=2&&x.push({map:n.name,diff:w,better:w>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:l.name})}),e.jsxs("div",{children:["Parties: ",l.value]}),e.jsxs("div",{children:["Victoires: ",l.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",l.winRate,"%"]})}),x.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),x.map((n,w)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:n.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[n.better?"â†—":"â†˜"," ",Math.abs(n.diff).toFixed(1),"% vs ",n.map]},w))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(U,{dataKey:"winRateDisplay",label:s=>{const{x:c,y:l,width:x,payload:n}=s;if(c===void 0||l===void 0||x===void 0||!n)return null;const w=n.winRate||"0";return e.jsxs("text",{x:c+x/2,y:l-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[w,"%"]})},onClick:s=>{if(s&&s.name){const c={selectedPlayer:o,selectedMapName:s.name,fromComponent:"Performance par Carte"};S!=="Tous les camps"&&(c.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),R(c)}},children:a.map((s,c)=>{let l;s.name==="Village"?l="var(--accent-secondary)":s.name==="ChÃ¢teau"?l="var(--accent-tertiary)":s.name==="Autres"?l=ue:l=`var(--chart-color-${c%6+1})`;const x=Math.max(...a.map(w=>parseFloat(w.winRate))),n=parseFloat(s.winRate)===x&&x>0;return e.jsx(K,{fill:parseFloat(s.winRate)===0?`${l}30`:l,stroke:"transparent",strokeWidth:n?3:1,style:{cursor:"pointer"}},`cell-map-${c}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function $e({selectedPlayerName:o}){const{gameData:R}=oe(),{joueursData:j}=ae(),y=ie(j),S=se(),f=M.useMemo(()=>{if(!R||!o)return{playersKilled:[],killedBy:[],deathTypes:[],availableDeathTypes:[]};const v={},d={},h={},i=new Set;R.forEach(x=>{const n=x.PlayerStats.find(w=>w.Username.toLowerCase()===o.toLowerCase());if(n&&(x.PlayerStats.forEach(w=>{w.KillerName?.toLowerCase()===o.toLowerCase()&&(v[w.Username]=(v[w.Username]||0)+1)}),n.KillerName&&(d[n.KillerName]=(d[n.KillerName]||0)+1),n.DeathType)){const w=n.DeathType,k=J(w);h[k]||(h[k]={count:0,byDeathType:{}}),h[k].count+=1,h[k].byDeathType[w]=(h[k].byDeathType[w]||0)+1,i.add(w)}});const a=Object.entries(v).map(([x,n])=>({player:x,kills:n})).sort((x,n)=>n.kills-x.kills).slice(0,10),s=Object.entries(d).map(([x,n])=>({player:x,kills:n})).sort((x,n)=>n.kills-x.kills).slice(0,10),c=Object.entries(h).map(([x,n])=>{const w={deathType:x,count:n.count};return w[x]=n.count,w}).sort((x,n)=>n.count-x.count).slice(0,10),l=Object.keys(h);return{playersKilled:a,killedBy:s,deathTypes:c,availableDeathTypes:l}},[R,o]),b=M.useMemo(()=>{const v={};f.availableDeathTypes.forEach(i=>{i==="TuÃ© par Loup"?v[i]=S.Loup:i==="Mort aux votes"?v[i]="var(--chart-color-1)":i.includes("Chasseur")?v[i]=S.Chasseur:i==="TuÃ© par Zombie"?v[i]=S.Vaudou:i==="TuÃ© par potion assassin"?v[i]=S.Alchimiste:i==="TuÃ© par Vengeur"?v[i]="var(--chart-color-2)":i==="Amoureux mort"?v[i]=S.Amoureux:i==="TuÃ© par La BÃªte"?v[i]="var(--chart-color-3)":i==="TuÃ© par ShÃ©rif"&&(v[i]="var(--chart-color-4)")});const d=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let h=0;return f.availableDeathTypes.forEach(i=>{v[i]||(v[i]=d[h%d.length],h++)}),v},[f.availableDeathTypes,S]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[f.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Victimes"}),e.jsx(E,{title:"Les Victimes",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:f.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(B,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(L,{content:({active:v,payload:d})=>{if(v&&d&&d.length>0){const h=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:h.player})}),e.jsxs("div",{children:["TuÃ© ",h.kills," fois par ",o]})]})}return null}}),e.jsx(U,{dataKey:"kills",children:f.playersKilled.map((v,d)=>e.jsx(K,{fill:y[v.player]||"var(--chart-color-3)"},`cell-killed-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[o," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),f.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Les Tueurs"}),e.jsx(E,{title:"Les Tueurs",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:f.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(B,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(L,{content:({active:v,payload:d})=>{if(v&&d&&d.length>0){const h=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:h.player})}),e.jsxs("div",{children:["A tuÃ© ",o," ",h.kills," fois"]})]})}return null}}),e.jsx(U,{dataKey:"kills",children:f.killedBy.map((v,d)=>e.jsx(K,{fill:y[v.player]||"var(--chart-color-4)"},`cell-killer-${d}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[o," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]}),f.deathTypes.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Types de Mort les Plus FrÃ©quents"}),e.jsx(E,{title:"Types de Mort les Plus FrÃ©quents",children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:f.deathTypes,margin:{top:20,right:30,left:20,bottom:90},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"deathType",angle:-45,textAnchor:"end",height:120,interval:0,fontSize:12}),e.jsx(B,{label:{value:"Nombre de morts",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(L,{content:({active:v,payload:d})=>{if(v&&d&&d.length>0){const h=d[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:h.deathType})}),e.jsxs("div",{children:[o," est mort ",h.count," fois ainsi"]})]})}return null}}),f.availableDeathTypes.map(v=>e.jsx(U,{dataKey:v,name:v,stackId:"deaths",fill:b[v]||"var(--chart-color-5)"},v))]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de mort"}),e.jsxs("p",{children:["Aucune information de mort disponible pour ",o,"."]})]})]})}function We(o,R){if(!o||o.trim()===""||R.length===0)return null;const j=new Map,y=new Map,S=new Map;R.forEach(h=>{if(!h.Modded)return;const i=h.PlayerStats.find(a=>Q(a)===o||a.Username.toLowerCase()===o.toLowerCase());if(i){if(i.MainRoleInitial==="Inconnu")return;const a=i.Victorious,c=de(i.MainRoleInitial,i.MainRoleChanges||[])!==i.MainRoleInitial,l=ee(i.MainRoleInitial),x=l==="Loup"||l==="TraÃ®tre"||l==="Louveteau";if(l==="Villageois"&&(i.MainRoleInitial==="Chasseur"||i.MainRoleInitial==="Alchimiste")){const n=j.get(i.MainRoleInitial)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};j.set(i.MainRoleInitial,{appearances:n.appearances+1,wins:n.wins+(a?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!c&&a?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(c?0:1)})}else if(i.Power&&i.Power.trim()!==""&&i.Power!=="Inconnu"){if(l==="Villageois"){const n=j.get(i.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};j.set(i.Power,{appearances:n.appearances+1,wins:n.wins+(a?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!c&&a?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(c?0:1)})}else if(x){const n=y.get(i.Power)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},w=n.roleBreakdown;w.set(i.MainRoleInitial,(w.get(i.MainRoleInitial)||0)+1),y.set(i.Power,{appearances:n.appearances+1,wins:n.wins+(a?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!c&&a?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(c?0:1),roleBreakdown:w})}}else if((l==="Villageois"||x)&&i.Power!=="Inconnu")if(l==="Villageois"){const n=j.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};j.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(a?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!c&&a?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(c?0:1)})}else{const n=y.get("Aucun pouvoir")||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0,roleBreakdown:new Map},w=n.roleBreakdown;w.set(i.MainRoleInitial,(w.get(i.MainRoleInitial)||0)+1),y.set("Aucun pouvoir",{appearances:n.appearances+1,wins:n.wins+(a?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!c&&a?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(c?0:1),roleBreakdown:w})}if(i.SecondaryRole&&i.SecondaryRole.trim()!==""&&i.SecondaryRole!=="Inconnu"){const n=S.get(i.SecondaryRole)||{appearances:0,wins:0,winsWithoutRoleChange:0,gamesWithoutRoleChange:0};S.set(i.SecondaryRole,{appearances:n.appearances+1,wins:n.wins+(a?1:0),winsWithoutRoleChange:n.winsWithoutRoleChange+(!c&&a?1:0),gamesWithoutRoleChange:n.gamesWithoutRoleChange+(c?0:1)})}}});const f=new Map;R.forEach(h=>{const i=h.PlayerStats.find(a=>Q(a)===o||a.Username.toLowerCase()===o.toLowerCase());if(i&&(i.MainRoleInitial==="Chasseur"||i.MainRoleInitial==="Alchimiste")){const a=i.MainRoleInitial;f.set(a,(f.get(a)||0)+1)}});const b=h=>Array.from(h.entries()).map(([i,a])=>({name:i,appearances:a.appearances,wins:a.wins,winsWithoutRoleChange:a.winsWithoutRoleChange,gamesWithoutRoleChange:a.gamesWithoutRoleChange,winRate:a.gamesWithoutRoleChange>0?(a.winsWithoutRoleChange/a.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Villageois",...f.has(i)&&{totalGamesAllModes:f.get(i)}})).sort((i,a)=>a.appearances-i.appearances),v=h=>Array.from(h.entries()).map(([i,a])=>({name:i,appearances:a.appearances,wins:a.wins,winsWithoutRoleChange:a.winsWithoutRoleChange,gamesWithoutRoleChange:a.gamesWithoutRoleChange,winRate:a.gamesWithoutRoleChange>0?(a.winsWithoutRoleChange/a.gamesWithoutRoleChange*100).toFixed(1):"0.0",camp:"Loup",roleBreakdown:Array.from(a.roleBreakdown.entries()).map(([s,c])=>({role:s,count:c})).sort((s,c)=>c.count-s.count)})).sort((i,a)=>a.appearances-i.appearances),d=h=>Array.from(h.entries()).map(([i,a])=>({name:i,appearances:a.appearances,wins:a.wins,winsWithoutRoleChange:a.winsWithoutRoleChange,gamesWithoutRoleChange:a.gamesWithoutRoleChange,winRate:a.gamesWithoutRoleChange>0?(a.winsWithoutRoleChange/a.gamesWithoutRoleChange*100).toFixed(1):"0.0"})).sort((i,a)=>a.appearances-i.appearances);return{villageoisPowers:b(j),loupPowers:v(y),secondaryRoles:d(S)}}function Le({selectedPlayerName:o}){const{navigateToGameDetails:R,navigationState:j,updateNavigationState:y}=X(),{settings:S}=te(),f=se(),[b,v]=M.useState(j.playerHistoryRolesState?.chartMode||"appearances"),{data:d,isLoading:h,error:i}=ce(k=>We(o,k));M.useEffect(()=>{(!j.playerHistoryRolesState||j.playerHistoryRolesState.chartMode!==b)&&y({playerHistoryRolesState:{chartMode:b}})},[b,j.playerHistoryRolesState,y]);const a=k=>{v(k),y({playerHistoryRolesState:{chartMode:k}})},s=M.useMemo(()=>{if(!d)return{villageoisPowers:[],loupPowers:[],secondaryRoles:[]};const k=1,D=1,P=15,$=b==="winRate"?(u,C)=>parseFloat(C.winRate)-parseFloat(u.winRate):(u,C)=>C.appearances-u.appearances,t=u=>({...u,winRateDisplay:Math.max(parseFloat(u.winRate),1)});return{villageoisPowers:d.villageoisPowers.filter(u=>u.appearances>=k).map(t).sort($).slice(0,P),loupPowers:d.loupPowers.filter(u=>u.appearances>=k).map(t).sort($).slice(0,P),secondaryRoles:d.secondaryRoles.filter(u=>u.appearances>=D).map(t).sort($).slice(0,P)}},[d,b]);if(h)return e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique des rÃ´les..."});if(i)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",i]});if(!d)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de rÃ´le disponible"});const c=s.villageoisPowers.length>0,l=s.loupPowers.length>0,x=s.secondaryRoles.length>0;if(!c&&!l&&!x)return e.jsx("div",{className:"donnees-manquantes",children:"Aucun pouvoir ou rÃ´le secondaire trouvÃ©"});const n=({active:k,payload:D})=>{if(k&&D&&D.length>0){const P=D[0].payload,$=P.gamesWithoutRoleChange<P.appearances;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:P.name})}),e.jsxs("div",{children:["Apparitions: ",P.appearances]}),$&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"0.25rem"},children:["dont ",P.appearances-P.gamesWithoutRoleChange," avec changement de rÃ´le (exclu du calcul)"]}),e.jsxs("div",{children:["Victoires: ",P.winsWithoutRoleChange]}),e.jsx("div",{children:e.jsxs("strong",{children:["Taux de victoire: ",P.winRate,"%"]})}),P.totalGamesAllModes&&P.totalGamesAllModes!==P.appearances&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic"},children:["(Total avec parties non moddÃ©es: ",P.totalGamesAllModes,")"]}),P.roleBreakdown&&P.roleBreakdown.length>0&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:[e.jsx("div",{style:{fontStyle:"italic"},children:"RÃ©partition par rÃ´le:"}),P.roleBreakdown.map((t,u)=>e.jsxs("div",{style:{marginLeft:"0.5rem"},children:["â€¢ ",t.role,": ",t.count]},u))]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},w=(k,D,P,$,t)=>{const u=b==="appearances"?"appearances":"winRateDisplay",C=b==="appearances"?"Nombre d'apparitions":"Taux de victoire (%)",r=b==="winRate"?[0,100]:void 0;return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:D}),e.jsx(E,{title:D,children:e.jsx("div",{style:{height:400},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Y,{data:k,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:12,tick:({x:p,y:m,payload:N})=>e.jsx("text",{x:p,y:m,textAnchor:"end",transform:`rotate(-45, ${p}, ${m})`,fill:S.highlightedPlayer===o?"var(--text-primary)":"var(--text-secondary)",fontSize:12,children:N.value})}),e.jsx(B,{label:{value:C,angle:270,position:"left",style:{textAnchor:"middle"}},domain:r}),e.jsx(L,{content:e.jsx(n,{})}),e.jsx(U,{dataKey:u,label:b==="winRate"?p=>{const{x:m,y:N,width:F,payload:T}=p;if(m===void 0||N===void 0||F===void 0||!T)return null;const g=T.winRate||"0";return e.jsxs("text",{x:m+F/2,y:N-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[g,"%"]})}:void 0,children:k.map((p,m)=>e.jsx(K,{fill:t?t(p.name,m):P,onClick:()=>$(p.name),style:{cursor:"pointer"}},`cell-${m}`))})]})})})})]})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"chart-mode-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Affichage :"}),e.jsxs("select",{id:"chart-mode-select",value:b,onChange:k=>a(k.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"180px"},children:[e.jsx("option",{value:"appearances",children:"Apparitions"}),e.jsx("option",{value:"winRate",children:"Taux de victoire"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[c&&w(s.villageoisPowers,"Camp Villageois","var(--chart-color-1)",k=>{R({selectedPlayer:o,campFilter:{selectedCamp:"Villageois",campFilterMode:b==="winRate"?"wins-only":"all-assignments"},selectedPower:k,fromComponent:`Historique des RÃ´les - Pouvoir: ${k}`})},k=>k==="Chasseur"&&f.Chasseur?f.Chasseur:k==="Alchimiste"&&f.Alchimiste?f.Alchimiste:"var(--chart-color-1)"),l&&w(s.loupPowers,"Camp Loups","var(--chart-color-2)",k=>{R({selectedPlayer:o,campFilter:{selectedCamp:"Loup",campFilterMode:b==="winRate"?"wins-only":"all-assignments"},selectedPower:k,fromComponent:`Historique des RÃ´les - Pouvoir: ${k}`})},()=>f.Loup||"var(--chart-color-2)"),x&&w(s.secondaryRoles,"RÃ´les Secondaires","var(--chart-color-3)",k=>{R({selectedPlayer:o,selectedSecondaryRole:k,fromComponent:`Historique des RÃ´les - RÃ´le Secondaire: ${k}`})}),e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",fontStyle:"italic",marginTop:"16px",padding:"8px",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)"},children:"â„¹ï¸ Les victoires et le taux de victoire excluent les parties oÃ¹ le rÃ´le principal a changÃ© en cours de partie (ex: Garde en Chasseur, rÃ©ssucitÃ© en Zombie par un Vaudou, etc...)."})]})]})}const O={x:166.35,z:176.22,multiplier:5.45},_={x:403.32,z:-121.11,multiplier:18.4};function le(o){return o==="SURVIVALIST_NOT_SAVED"?"BY_WOLF":o}function qe({selectedPlayerName:o}){const{navigateToGameDetails:R}=X(),{gameData:j,isLoading:y,error:S}=oe(),f=se(),[b,v]=M.useState("deaths"),[d,h]=M.useState(""),[i,a]=M.useState(0),s=M.useMemo(()=>{if(!j)return[];const t=new Set;return j.forEach(u=>{const C=u.PlayerStats.find(r=>r.Username.toLowerCase()===o.toLowerCase());C&&(C.DeathPosition!==null&&u.MapName&&t.add(u.MapName),u.PlayerStats.forEach(r=>{r.KillerName?.toLowerCase()===o.toLowerCase()&&r.DeathPosition!==null&&u.MapName&&t.add(u.MapName)}))}),Array.from(t).filter(u=>u==="Village"||u==="ChÃ¢teau").sort((u,C)=>u==="Village"?-1:C==="Village"?1:u.localeCompare(C))},[j,o]),c=s.length>0?s[0]:"";d===""&&c!==""&&h(c);const l=M.useMemo(()=>{if(!j||!o)return[];const t=[];return j.forEach(u=>{if(d&&u.MapName!==d)return;const C=u.PlayerStats.find(r=>r.Username.toLowerCase()===o.toLowerCase());if(C)if(b==="deaths"){if(C.DeathPosition){const r=ee(C.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0});let p=C.DeathPosition.x,m=C.DeathPosition.z;u.MapName==="Village"?(p=(p-O.x)*O.multiplier,m=(m-O.z)*O.multiplier*-1):u.MapName==="ChÃ¢teau"&&(p=(p-_.x)*_.multiplier,m=(m-_.z)*_.multiplier*-1),t.push({x:p,z:m,victimName:C.Username,killerName:C.KillerName||null,deathType:le(C.DeathType),mapName:u.MapName,camp:r,gameId:u.DisplayedId,displayedGameId:u.DisplayedId})}}else u.PlayerStats.forEach(r=>{if(r.KillerName?.toLowerCase()===o.toLowerCase()&&r.DeathPosition){const p=ee(r.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!0});let m=r.DeathPosition.x,N=r.DeathPosition.z;u.MapName==="Village"?(m=(m-O.x)*O.multiplier,N=(N-O.z)*O.multiplier*-1):u.MapName==="ChÃ¢teau"&&(m=(m-_.x)*_.multiplier,N=(N-_.z)*_.multiplier*-1),t.push({x:m,z:N,victimName:r.Username,killerName:o,deathType:le(r.DeathType),mapName:u.MapName,camp:p,gameId:u.DisplayedId,displayedGameId:u.DisplayedId})}})}),t},[j,o,b,d]),x=M.useMemo(()=>{if(i===0)return l.map((u,C)=>({...u,count:1,allLocations:[u],clusterIndex:C}));const t=[];return l.forEach(u=>{let C=!1;for(const r of t)if(Math.sqrt(Math.pow(u.x-r.centroidX,2)+Math.pow(u.z-r.centroidZ,2))<=i){const m=r.locations.length;r.centroidX=(r.centroidX*m+u.x)/(m+1),r.centroidZ=(r.centroidZ*m+u.z)/(m+1),r.locations.push(u),C=!0;break}C||t.push({centroidX:u.x,centroidZ:u.z,locations:[u]})}),t.map((u,C)=>{const r=u.locations[0],p=new Map;u.locations.forEach(F=>{p.set(F.deathType,(p.get(F.deathType)||0)+1)});let m=r.deathType,N=0;return p.forEach((F,T)=>{F>N&&(N=F,m=T)}),{x:u.centroidX,z:u.centroidZ,count:u.locations.length,allLocations:u.locations,victimName:u.locations.length===1?r.victimName:null,killerName:u.locations.length===1?r.killerName:null,deathType:m,mapName:r.mapName,camp:r.camp,gameId:u.locations.length===1?r.gameId:null,displayedGameId:u.locations.length===1?r.displayedGameId:null,clusterIndex:C}})},[l,i]),n=M.useMemo(()=>Se(d),[d]),{xDomain:w,zDomain:k}=M.useMemo(()=>{if(n)return{xDomain:[n.xMin,n.xMax],zDomain:[n.zMin,n.zMax]};if(x.length===0)return{xDomain:[0,100],zDomain:[0,100]};const t=x.map(T=>T.x),u=x.map(T=>T.z),C=Math.min(...t),r=Math.max(...t),p=Math.min(...u),m=Math.max(...u),N=(r-C)*.1||10,F=(m-p)*.1||10;return{xDomain:[C-N,r+N],zDomain:[p-F,m+F]}},[x,n]),D=t=>t?t==="BY_WOLF"||t==="SURVIVALIST_NOT_SAVED"?f.Loup:t==="VOTED"?"var(--chart-color-1)":t==="BULLET"||t==="BULLET_HUMAN"||t==="BULLET_WOLF"?f.Chasseur:t==="BY_ZOMBIE"?f.Vaudou:t==="ASSASSIN"?f.Alchimiste:t==="AVENGER"?"var(--chart-color-2)":t==="LOVER_DEATH"?f.Amoureux:t==="BY_BEAST"?"var(--chart-color-3)":t==="SHERIF_SUCCESS"?"var(--chart-color-4)":"var(--accent-primary)":"var(--text-secondary)",P=({active:t,payload:u})=>{if(!t||!u||u.length===0)return null;const C=u[0].payload,r=C.allLocations||[C];if(r.length>1){const N=new Map,F=new Map,T=new Set;r.forEach(z=>{N.set(z.victimName,(N.get(z.victimName)||0)+1);const A=z.deathType?J(z.deathType):"Inconnu";F.set(A,(F.get(A)||0)+1),T.add(z.gameId)});const g=Array.from(N.entries()).sort((z,A)=>A[1]-z[1]).slice(0,3),I=Array.from(F.entries()).sort((z,A)=>A[1]-z[1]).slice(0,3);return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"350px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[b==="deaths"?"ðŸ’€":"âš”ï¸"," ",r.length," ",b==="deaths"?"morts":"kills"," Ã  cet endroit"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:b==="deaths"?"Par:":"Victimes:"}),g.map(([z,A])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",z," (",A,"x)"]},z)),N.size>3&&e.jsxs("div",{style:{paddingLeft:"0.5rem",color:"var(--text-secondary)"},children:["+",N.size-3," autres..."]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Types de mort:"}),I.map(([z,A])=>e.jsxs("div",{style:{paddingLeft:"0.5rem"},children:["â€¢ ",z," (",A,"x)"]},z))]}),e.jsxs("div",{style:{marginTop:"8px",color:"var(--text-secondary)"},children:["ðŸ“ ",T.size," partie",T.size>1?"s":""," diffÃ©rente",T.size>1?"s":""]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les parties concernÃ©es"})]})}const m=r[0];return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[b==="deaths"?"ðŸ’€":"âš”ï¸"," ",b==="deaths"?"Mort de":"Kill de"," ",o]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[b==="deaths"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"TuÃ© par:"})," ",m.killerName||"Inconnu"]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",m.deathType?J(m.deathType):"Inconnue"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["ðŸŽ¯ ",e.jsx("strong",{children:"Victime:"})," ",m.victimName]}),e.jsxs("div",{children:["âš°ï¸ ",e.jsx("strong",{children:"Cause:"})," ",m.deathType?J(m.deathType):"Inconnue"]}),e.jsxs("div",{children:["ðŸ‘¥ ",e.jsx("strong",{children:"Camp victime:"})," ",m.camp]})]}),e.jsxs("div",{children:["ðŸ—ºï¸ ",e.jsx("strong",{children:"Carte:"})," ",m.mapName]}),e.jsxs("div",{children:["ðŸŽ® ",e.jsx("strong",{children:"Partie:"})," #",m.gameId]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les dÃ©tails de la partie"})]})},$=t=>{if(!t)return;const u=t.allLocations||[t];if(u.length===1)R({selectedGame:u[0].gameId,fromComponent:"Player Death Map"});else{const C=u.map(r=>r.gameId).filter(r=>r);R({selectedGameIds:C,fromComponent:"Player Death Map"})}};return y?e.jsx("div",{className:"donnees-attente",children:"Chargement des donnÃ©es..."}):S?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",S]}):j?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{style:{flex:"1 1 100%",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Afficher :"}),e.jsxs("div",{style:{display:"flex",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)",overflow:"hidden"},children:[e.jsx("button",{onClick:()=>v("deaths"),style:{background:b==="deaths"?"var(--accent-primary)":"transparent",color:b==="deaths"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:b==="deaths"?"bold":"normal",transition:"all 0.2s"},children:"ðŸ’€ Morts"}),e.jsx("button",{onClick:()=>v("kills"),style:{background:b==="kills"?"var(--accent-primary)":"transparent",color:b==="kills"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:b==="kills"?"bold":"normal",transition:"all 0.2s"},children:"âš”ï¸ Kills"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"player-map-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Carte :"}),e.jsx("select",{id:"player-map-select",value:d,onChange:t=>h(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:s.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"cluster-slider",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Groupement :"}),e.jsx("input",{id:"cluster-slider",type:"range",min:"0",max:"50",step:"5",value:i,onChange:t=>a(parseInt(t.target.value)),style:{width:"80px"}}),e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",minWidth:"60px"},children:i===0?"Aucun":`${i}u`})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{flex:"1 1 100%",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:b==="deaths"?"Morts localisÃ©es":"Kills localisÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:b==="deaths"?"var(--accent-secondary)":"var(--accent-primary)"},children:l.length}),i>0&&x.length<l.length&&e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginTop:"4px"},children:["â†’ ",x.length," points groupÃ©s"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Carte"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-2)",fontSize:"1.2rem"},children:d||"Aucune"})]})]}),e.jsx("div",{className:"lycans-graphique-section",style:{flex:"1 1 100%",minWidth:"100%"},children:l.length>0?e.jsx(E,{title:b==="deaths"?`Carte des Morts de ${o}`:`Carte des Kills de ${o}`,children:e.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto",aspectRatio:"1640 / 922"},children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(Ne,{margin:{top:20,right:30,left:60,bottom:60},children:[n&&e.jsx(ke,{x1:n.zMin,x2:n.zMax,y1:n.xMin,y2:n.xMax,fill:"transparent",stroke:"none",shape:t=>{const{x:u,y:C,width:r,height:p}=t;return e.jsx("image",{x:u,y:C,width:r,height:p,href:n.src,preserveAspectRatio:"xMidYMid slice",style:{opacity:.85}})}}),e.jsx(G,{strokeDasharray:"3 3",stroke:n?"rgba(255,255,255,0.3)":"var(--border-color)"}),e.jsx(V,{dataKey:"z",type:"number",name:"Position Z",label:{value:"Position Z",position:"bottom",offset:10,style:{fill:"var(--text-secondary)"}},domain:k,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:t=>Math.round(t).toString()}),e.jsx(B,{dataKey:"x",type:"number",name:"Position X",label:{value:"Position X",angle:-90,position:"left",offset:20,style:{fill:"var(--text-secondary)"}},domain:w,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:t=>Math.round(t).toString()}),e.jsx(L,{content:e.jsx(P,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(Te,{data:x,onClick:t=>$(t),style:{cursor:"pointer"},children:x.map((t,u)=>{const C=Math.min(Math.log2(t.count+1)*3+5,18),r=Math.round(C);return e.jsx(K,{fill:D(t.deathType),stroke:t.count>1?"white":"rgba(255,255,255,0.5)",strokeWidth:t.count>1?2:1,opacity:.85,r},`cell-${u}`)})})]})})})}):e.jsxs("div",{className:"donnees-manquantes",style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"0.5rem"},children:b==="deaths"?`Aucune mort localisÃ©e pour ${o} sur cette carte.`:`Aucun kill localisÃ© pour ${o} sur cette carte.`}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Les donnÃ©es de position ne sont disponibles que pour les parties rÃ©centes."})]})}),e.jsxs("div",{className:"lycans-section-description",style:{flex:"1 1 100%",marginTop:"1.5rem"},children:[e.jsx("h4",{children:"Ã€ propos de cette carte"}),e.jsxs("p",{children:["Cette carte affiche ",b==="deaths"?`les emplacements oÃ¹ ${o} est mort`:`les emplacements oÃ¹ ${o} a Ã©liminÃ© d'autres joueurs`," au cours des parties. Les couleurs indiquent le type de mort. Cliquez sur un point pour voir les dÃ©tails de la partie."]}),e.jsxs("p",{style:{marginTop:"0.5rem"},children:[e.jsx("strong",{children:"ðŸ’€ Morts:"})," OÃ¹ le joueur a Ã©tÃ© Ã©liminÃ©",e.jsx("br",{}),e.jsx("strong",{children:"âš”ï¸ Kills:"})," OÃ¹ le joueur a Ã©liminÃ© d'autres joueurs"]})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e disponible"})}function nt(){const{settings:o,updateSettings:R}=te(),{navigateToGameDetails:j,navigationState:y,updateNavigationState:S}=X(),{data:f,isLoading:b,error:v}=ge(),{joueursData:d,isLoading:h}=ae(),{data:i,isLoading:a,error:s}=Me(o.highlightedPlayer),c=ie(d),[l,x]=M.useState(""),[n,w]=M.useState(()=>o.useIndependentFilters&&o.independentFilters?.gameTypeEnabled?o.independentFilters.gameFilter==="modded"?"modded":"all":o.gameFilter==="modded"?"modded":"all"),k=M.useMemo(()=>o.useIndependentFilters&&o.independentFilters?.gameTypeEnabled?o.independentFilters.gameFilter==="modded":o.gameFilter==="modded",[o.useIndependentFilters,o.independentFilters?.gameTypeEnabled,o.independentFilters?.gameFilter,o.gameFilter]),[D,P]=M.useState(y.selectedPlayerSelectionView||"achievements"),[$,t]=M.useState("session"),[u,C]=M.useState("all");M.useEffect(()=>{if(o.useIndependentFilters&&o.independentFilters?.gameTypeEnabled){const g=o.independentFilters.gameFilter==="modded"?"modded":"all";w(g)}else if(!o.useIndependentFilters){const g=o.gameFilter==="modded"?"modded":"all";w(g)}},[o.gameFilter,o.useIndependentFilters,o.independentFilters?.gameTypeEnabled,o.independentFilters?.gameFilter]),M.useEffect(()=>{k&&n!=="modded"&&w("modded")},[k,n]),M.useEffect(()=>{y.selectedPlayerSelectionView&&P(y.selectedPlayerSelectionView)},[y.selectedPlayerSelectionView]);const{data:r}=re(o.highlightedPlayer||""),p=M.useMemo(()=>{if(!f||!f.GameStats)return[];const g=k?f.GameStats.filter(z=>z.Modded===!0):f.GameStats,I=new Map;return g.forEach(z=>{const A=new Date(z.StartDate);z.PlayerStats.forEach(q=>{const H=Q(q),pe=d?.Players?.find(me=>me.SteamID===H)?.Joueur||q.Username;I.has(H)||I.set(H,{games:0,wins:0,firstDate:A,lastDate:A,displayName:pe});const Z=I.get(H);Z.games++,q.Victorious&&Z.wins++,A<Z.firstDate&&(Z.firstDate=A),A>Z.lastDate&&(Z.lastDate=A)})}),Array.from(I.entries()).map(([z,A])=>{let q=d?.Players?.find(H=>H.SteamID===z);return q||(q=d?.Players?.find(H=>H.Joueur===A.displayName)),{id:z,name:A.displayName,totalGames:A.games,totalWins:A.wins,winRate:A.games>0?A.wins/A.games*100:0,firstGameDate:A.firstDate.toLocaleDateString("fr-FR"),lastGameDate:A.lastDate.toLocaleDateString("fr-FR"),isHighlighted:A.displayName===o.highlightedPlayer,image:q?.Image||null,twitch:q?.Twitch||null,youtube:q?.Youtube||null}})},[f,o.highlightedPlayer,d,k]),m=M.useMemo(()=>{if(!l.trim())return p;const g=l.toLowerCase();return p.filter(I=>I.name.toLowerCase().includes(g))},[p,l]),N=M.useMemo(()=>[...m].sort((g,I)=>I.totalGames-g.totalGames),[m]),F=g=>{R({highlightedPlayer:g}),x("")},T=g=>{P(g),S({selectedPlayerSelectionView:g})};return b||h?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):v?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",v]})]}):!f||p.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!o.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:l,onChange:g=>x(g.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[m.length," joueur",m.length!==1?"s":"",l&&` (filtrÃ©${m.length!==1?"s":""} de ${p.length})`]})]})]}),e.jsx("div",{className:"player-display",children:l?m.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{className:"clear-search-btn",onClick:()=>x(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:N.map(g=>e.jsxs("button",{className:`suggestion-btn ${g.isHighlighted?"highlighted":""}`,onClick:()=>F(g.name),children:[g.image?e.jsx("img",{src:g.image,alt:g.name,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":c[g.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[g.name,g.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[g.totalGames," parties â€¢ ",g.winRate.toFixed(1),"% victoires"]})]})]},g.id))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',l,'"']}),e.jsx("button",{className:"clear-search-btn",onClick:()=>x(""),children:"Effacer la recherche"})]}):o.highlightedPlayer?(()=>{const g=p.find(I=>I.name===o.highlightedPlayer);return g?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:g.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[g.image?e.jsx("img",{src:g.image,alt:g.name,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":c[g.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[g.totalGames," parties â€¢ ",g.totalWins," victoires â€¢ ",g.winRate.toFixed(1),"% taux de victoire"]}),(g.twitch||g.youtube)&&e.jsxs("div",{className:"social-links",children:[g.twitch&&e.jsx("a",{href:g.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),g.youtube&&e.jsx("a",{href:g.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{className:`lycans-categorie-btn ${D==="achievements"?"active":""}`,onClick:()=>T("achievements"),children:"Classement"}),e.jsx("button",{className:`lycans-categorie-btn ${D==="evolution"?"active":""}`,onClick:()=>T("evolution"),children:"Ã‰volution"}),e.jsx("button",{className:`lycans-categorie-btn ${D==="camps"?"active":""}`,onClick:()=>T("camps"),children:"Camps"}),e.jsx("button",{className:`lycans-categorie-btn ${D==="roles"?"active":""}`,onClick:()=>T("roles"),children:"RÃ´les"}),e.jsx("button",{className:`lycans-categorie-btn ${D==="maps"?"active":""}`,onClick:()=>T("maps"),children:"Maps"}),e.jsx("button",{className:`lycans-categorie-btn ${D==="kills"?"active":""}`,onClick:()=>T("kills"),children:"Kills"}),e.jsx("button",{className:`lycans-categorie-btn ${D==="deathmap"?"active":""}`,onClick:()=>T("deathmap"),children:"ðŸ—ºï¸ Carte"})]}),D==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[a?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):s?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",s]})}):i?e.jsx(De,{achievements:n==="all"?i.allGamesAchievements:i.moddedOnlyAchievements,title:n==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:n}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[!k&&e.jsx("button",{className:`filter-btn ${n==="all"?"active":""}`,onClick:I=>{I.stopPropagation(),w("all")},children:"Toutes les parties"}),e.jsx("button",{className:`filter-btn ${n==="modded"?"active":""}`,onClick:I=>{I.stopPropagation(),w("modded")},disabled:k,children:"Parties moddÃ©es"})]})]}),D==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[r&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{j({selectedPlayer:g.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${g.name}`,style:{fontSize:"1.3rem"},children:r.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Temps de jeu cumulÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:ye(r.totalPlayTime)}),e.jsx("p",{children:"temps total de jeu"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{j({selectedPlayer:g.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${g.name}`,style:{fontSize:"1.3rem"},children:r.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",style:{fontSize:"0.9rem"},children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",style:{fontSize:"1.3rem"},children:[r.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:$,onChange:I=>t(I.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-filter-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsxs("select",{id:"camp-filter-select",value:u,onChange:I=>C(I.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"all",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loups"}),e.jsx("option",{value:"solo",children:"RÃ´les solo"})]})]})]}),e.jsx(Ae,{selectedPlayerName:g.name,groupingMethod:$,campFilter:u})]}),D==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ze,{selectedPlayerName:g.name})}),D==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Ie,{selectedPlayerName:g.name})}),D==="roles"&&e.jsx("div",{className:"player-history-section",children:e.jsx(Le,{selectedPlayerName:g.name})}),D==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx($e,{selectedPlayerName:g.name})}),D==="deathmap"&&e.jsx("div",{className:"player-history-section",children:e.jsx(qe,{selectedPlayerName:g.name})}),e.jsx("button",{className:"highlight-btn active",onClick:I=>{I.stopPropagation(),R({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[g.firstGameDate," - ",g.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',o.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{className:"clear-selection-btn",onClick:()=>R({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:N.map(g=>e.jsxs("div",{className:`character-card ${g.isHighlighted?"highlighted":""}`,onClick:()=>F(g.name),title:`${g.name} - ${g.totalGames} parties, ${g.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:g.image?e.jsx("img",{src:g.image,alt:g.name,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":c[g.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:g.name}),(g.twitch||g.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[g.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),g.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},g.id))})})})]})}export{nt as PlayerSelectionPage};
