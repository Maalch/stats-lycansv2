import{a as C,r as d,j as e}from"./index-C9KRHo0I.js";function D(){const{settings:s,updateSettings:n,resetSettings:F}=C(),[u,b]=d.useState(null),c=d.useRef({filterMode:s.filterMode,gameFilter:s.gameFilter,dateStart:s.dateRange.start,dateEnd:s.dateRange.end});d.useEffect(()=>{(async()=>{try{const r=await(await fetch("/stats-lycansv2/data/rawGameData.json")).json();b(r.data||[])}catch(t){console.error("Error fetching raw game data:",t)}})()},[]),d.useEffect(()=>{const a={filterMode:s.filterMode,gameFilter:s.gameFilter,dateStart:s.dateRange.start,dateEnd:s.dateRange.end};(c.current.filterMode!==a.filterMode||c.current.gameFilter!==a.gameFilter||c.current.dateStart!==a.dateStart||c.current.dateEnd!==a.dateEnd)&&s.playerFilter.players.length>0&&n({playerFilter:{mode:s.playerFilter.mode,players:[]}}),c.current=a},[s.filterMode,s.gameFilter,s.dateRange.start,s.dateRange.end,s.playerFilter.players.length,n]);const v=a=>{if(!a)return null;const[t,r,i]=a.split("/");return!t||!r||!i?null:new Date(Number(i),Number(r)-1,Number(t))},o=d.useMemo(()=>u?u.filter(a=>{if(s.filterMode==="gameType"&&(s.gameFilter==="modded"&&!a["Game Moddée"]||s.gameFilter==="non-modded"&&a["Game Moddée"]))return!1;if(s.filterMode==="dateRange"&&(s.dateRange.start||s.dateRange.end)){const t=v(a.Date);if(!t)return!1;if(s.dateRange.start){const r=new Date(s.dateRange.start);if(t<r)return!1}if(s.dateRange.end){const r=new Date(s.dateRange.end);if(t>r)return!1}}return!0}):[],[u,s.filterMode,s.gameFilter,s.dateRange]),y=d.useMemo(()=>{const a=new Set;return o.forEach(t=>{const r=t["Liste des joueurs"];r&&r.split(",").map(l=>l.trim()).filter(l=>l.length>0).forEach(l=>a.add(l))}),Array.from(a)},[o]),x=d.useMemo(()=>{const a={};return o.forEach(t=>{const r=t["Liste des joueurs"];if(r){const i=r.split(",").map(l=>l.trim()).filter(l=>l.length>0);i.forEach(l=>{a[l]||(a[l]=new Set),i.forEach(p=>{l!==p&&a[l].add(p)})})}}),a},[o]),{availablePlayers:N,selectablePlayers:m}=d.useMemo(()=>{const a=y.sort();if(s.playerFilter.mode==="none"||s.playerFilter.players.length===0)return{availablePlayers:a,selectablePlayers:new Set(a)};const t=new Set;return s.playerFilter.mode==="include"?a.forEach(r=>{(s.playerFilter.players.includes(r)||s.playerFilter.players.every(l=>x[r]?.has(l)||!1))&&t.add(r)}):s.playerFilter.mode==="exclude"&&a.forEach(r=>{(s.playerFilter.players.includes(r)||o.some(l=>{const p=l["Liste des joueurs"].toLowerCase();return p.includes(r.toLowerCase())?!s.playerFilter.players.some(P=>p.includes(P.toLowerCase())):!1}))&&t.add(r)}),{availablePlayers:a,selectablePlayers:t}},[y,s.playerFilter,x,o]),f=a=>{n({filterMode:a})},g=a=>{n({gameFilter:a})},j=(a,t)=>{n({dateRange:{...s.dateRange,[a]:t||null}})},h=a=>{n({playerFilter:{...s.playerFilter,mode:a}})},R=a=>{const t=s.playerFilter.players;if(t.includes(a)){const i=t.filter(l=>l!==a);n({playerFilter:{...s.playerFilter,players:i}})}else n({playerFilter:{...s.playerFilter,players:[...t,a]}})},M=()=>{n({playerFilter:{...s.playerFilter,players:[...m]}})},k=()=>{n({playerFilter:{...s.playerFilter,players:[]}})};return e.jsxs("div",{className:"settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"Paramètres de Filtrage"}),e.jsx("button",{onClick:F,className:"settings-reset-btn",type:"button",children:"Réinitialiser"})]}),e.jsxs("div",{className:"settings-sections-container",children:[e.jsxs("div",{className:"settings-section",children:[e.jsx("div",{className:"settings-section-header",children:e.jsx("h3",{children:"1. Filtre Principal"})}),e.jsxs("div",{className:"settings-group",children:[e.jsx("h4",{children:"Mode de Filtrage"}),e.jsxs("div",{className:"settings-radio-group",style:{flexDirection:"row",gap:"2rem"},children:[e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"filterMode",value:"gameType",checked:s.filterMode==="gameType",onChange:()=>f("gameType")}),e.jsx("span",{className:"radio-mark"}),e.jsx("span",{className:"settings-radio-content",children:"Par type de partie"})]}),e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"filterMode",value:"dateRange",checked:s.filterMode==="dateRange",onChange:()=>f("dateRange")}),e.jsx("span",{className:"radio-mark"}),e.jsx("span",{className:"settings-radio-content",children:"Par plage de dates"})]})]})]}),s.filterMode==="gameType"&&e.jsxs("div",{className:"settings-group",children:[e.jsx("h4",{children:"Filtres de Parties"}),e.jsxs("div",{className:"settings-radio-group",children:[e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"gameFilter",value:"all",checked:s.gameFilter==="all",onChange:()=>g("all")}),e.jsx("span",{className:"radio-mark"}),e.jsxs("span",{className:"settings-radio-content",children:["Toutes les parties",e.jsx("small",{children:"Affiche toutes les parties disponibles"})]})]}),e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"gameFilter",value:"modded",checked:s.gameFilter==="modded",onChange:()=>g("modded")}),e.jsx("span",{className:"radio-mark"}),e.jsxs("span",{className:"settings-radio-content",children:["Parties moddées uniquement",e.jsx("small",{children:"Affiche uniquement les parties avec des rôles modifiés"})]})]}),e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"gameFilter",value:"non-modded",checked:s.gameFilter==="non-modded",onChange:()=>g("non-modded")}),e.jsx("span",{className:"radio-mark"}),e.jsxs("span",{className:"settings-radio-content",children:["Parties non-moddées uniquement",e.jsx("small",{children:"Affiche uniquement les parties avec des rôles standards"})]})]})]})]}),s.filterMode==="dateRange"&&e.jsxs("div",{className:"settings-group",children:[e.jsx("h4",{children:"Plage de dates"}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem",alignItems:"center"},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",fontWeight:500},children:["Début",e.jsx("input",{type:"date",value:s.dateRange.start||"",onChange:a=>j("start",a.target.value),style:{marginTop:4,fontSize:"1rem",padding:"4px 8px",borderRadius:4,border:"1px solid #ccc"},max:s.dateRange.end||void 0})]}),e.jsx("span",{style:{fontWeight:600},children:"—"}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",fontWeight:500},children:["Fin",e.jsx("input",{type:"date",value:s.dateRange.end||"",onChange:a=>j("end",a.target.value),style:{marginTop:4,fontSize:"1rem",padding:"4px 8px",borderRadius:4,border:"1px solid #ccc"},min:s.dateRange.start||void 0})]})]}),e.jsx("small",{style:{color:"var(--text-secondary, #6c757d)",marginTop:8,display:"block"},children:"Affiche uniquement les parties comprises dans la plage de dates sélectionnée."})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("div",{className:"settings-section-header",children:e.jsx("h3",{children:"2. Filtre Additionnel par Joueurs"})}),e.jsxs("div",{className:"settings-group",children:[e.jsxs("div",{className:"settings-radio-group",children:[e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"playerFilterMode",value:"none",checked:s.playerFilter.mode==="none",onChange:()=>h("none")}),e.jsx("span",{className:"radio-mark"}),e.jsxs("span",{className:"settings-radio-content",children:["Aucun filtre par joueur",e.jsx("small",{children:"Affiche toutes les parties sans restriction par joueur"})]})]}),e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"playerFilterMode",value:"include",checked:s.playerFilter.mode==="include",onChange:()=>h("include")}),e.jsx("span",{className:"radio-mark"}),e.jsxs("span",{className:"settings-radio-content",children:["Inclure seulement les parties avec ces joueurs",e.jsx("small",{children:"Affiche uniquement les parties où TOUS les joueurs sélectionnés ont participé ensemble"})]})]}),e.jsxs("label",{className:"settings-radio",children:[e.jsx("input",{type:"radio",name:"playerFilterMode",value:"exclude",checked:s.playerFilter.mode==="exclude",onChange:()=>h("exclude")}),e.jsx("span",{className:"radio-mark"}),e.jsxs("span",{className:"settings-radio-content",children:["Exclure les parties avec ces joueurs",e.jsx("small",{children:"Affiche uniquement les parties où aucun des joueurs listés n'a participé"})]})]})]}),(s.playerFilter.mode==="include"||s.playerFilter.mode==="exclude")&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("label",{style:{fontWeight:500},children:["Sélection des joueurs (",s.playerFilter.players.length," sélectionné",s.playerFilter.players.length!==1?"s":""," sur ",m.size," disponible",m.size!==1?"s":"",")"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{type:"button",onClick:M,style:{padding:"4px 8px",fontSize:"0.8rem",border:"1px solid var(--border-color, #ccc)",borderRadius:"4px",background:"var(--bg-tertiary, #f0f0f0)",color:"var(--text-primary, #333)",cursor:"pointer"},children:"Tout sélectionner"}),e.jsx("button",{type:"button",onClick:k,style:{padding:"4px 8px",fontSize:"0.8rem",border:"1px solid var(--border-color, #ccc)",borderRadius:"4px",background:"var(--bg-tertiary, #f0f0f0)",color:"var(--text-primary, #333)",cursor:"pointer"},children:"Tout désélectionner"})]})]}),e.jsx("div",{className:"settings-player-grid",children:N.map(a=>{const t=m.has(a),r=s.playerFilter.players.includes(a);return e.jsxs("label",{className:`settings-player-checkbox ${t?"":"disabled"}`,style:{opacity:t?1:.5,cursor:t?"pointer":"not-allowed"},children:[e.jsx("input",{type:"checkbox",checked:r,onChange:()=>t&&R(a),disabled:!t}),e.jsx("span",{className:"settings-player-checkmark"}),e.jsx("span",{className:"settings-player-name",title:!t&&!r?`${a} n'a ${s.playerFilter.mode==="include"?"pas joué avec tous les joueurs sélectionnés":"que des parties avec les joueurs exclus"}`:a,children:a})]},a)})}),e.jsxs("small",{style:{color:"var(--text-secondary, #6c757d)",marginTop:8,display:"block"},children:["Sélectionnez les joueurs à ",s.playerFilter.mode==="include"?"inclure":"exclure"," dans le filtrage."]})]})]})]})]}),e.jsx("div",{className:"settings-info",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," Les changements de paramètres sont sauvegardés automatiquement et s'appliquent à toutes les statistiques affichées."]})})]})}export{D as SettingsPanel};
