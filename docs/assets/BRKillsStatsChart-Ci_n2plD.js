import{a as O,r as B,j as e}from"./index-CJw4exqE.js";import{F as S,B as K,C as N,X as k,Y as C,a as T,b as P}from"./FullscreenChart-DJnVED8Y.js";import{u as $}from"./useRawBRData-BlLLavRO.js";import{u as E}from"./useJoueursData-Bt0aVGEG.js";import{u as G,g as I}from"./api-Dk75epw7.js";import{R as A,T as w}from"./CategoricalChart-BEA6YnmZ.js";import{P as L,a as W}from"./PieChart-RyN_pERa.js";import"./PolarChart-DfCfckwx.js";function ee(){const{data:g,isLoading:z,error:R}=$(),{settings:n}=O(),{joueursData:F}=E(),[H,D]=B.useState(null),M=G(F),u=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],q=a=>M[a]||I(a),d=B.useMemo(()=>{if(!g)return null;const a=g.length,i=g.reduce((r,s)=>{const o=s.Participants;return r[o]||(r[o]={name:o,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),r[o].participations++,r[o].totalScore+=s.Score,s.Gagnant&&r[o].wins++,r},{});Object.values(i).forEach(r=>{r.averageScore=r.totalScore/r.participations,r.winRate=r.wins/r.participations*100});const l=Object.values(i).filter(r=>r.participations>=3).sort((r,s)=>s.averageScore-r.averageScore).slice(0,15),h=Object.values(i).sort((r,s)=>s.participations-r.participations),f=n.highlightedPlayer&&l.some(r=>r.name===n.highlightedPlayer);let m=!1,p=[...l];if(n.highlightedPlayer&&!f){const r=h.find(s=>s.name===n.highlightedPlayer);r&&(p.push({...r,isHighlightedAddition:!0}),m=!0)}const v=g.reduce((r,s)=>{const o=s.Score,x=o===0?"0":o===1?"1":o===2?"2":o===3?"3":o===4?"4":o<=6?"5-6":"7+";return r[x]||(r[x]={count:0,wins:0}),r[x].count++,s.Gagnant&&r[x].wins++,r},{}),y=Object.entries(v).map(([r,s])=>({range:r,count:s.count,wins:s.wins,percentage:(s.count/a*100).toFixed(1),winRate:s.count>0?(s.wins/s.count*100).toFixed(1):"0.0"})),j=g.filter(r=>r.Gagnant).reduce((r,s)=>{const o=s.Score;return r[o]||(r[o]=0),r[o]++,r},{}),b=Object.entries(j).map(([r,s])=>({score:parseInt(r),count:s,percentage:(s/Object.values(j).reduce((o,x)=>o+x,0)*100).toFixed(1)})).sort((r,s)=>r.score-s.score);return{topPlayersByAverageScore:p,scoreData:y,winnerScoreData:b,highlightedPlayerInAverageScore:m}},[g,n.highlightedPlayer]);return z?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):R?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",R]}):d?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Statistiques Kills - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Kill Moyen par Partie (min. 3 parties)"}),d.highlightedPlayerInAverageScore&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",n.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(S,{title:"Kill Moyen par Partie - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(A,{width:"100%",height:400,children:e.jsxs(K,{data:d.topPlayersByAverageScore,children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:a,y:i,payload:t})=>e.jsx("text",{x:a,y:i,dy:16,textAnchor:"end",fill:n.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===t.value?14:12,fontWeight:n.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${a} ${i})`,children:t.value})}),e.jsx(C,{}),e.jsx(w,{content:({active:a,payload:i})=>{if(a&&i&&i.length>0){const t=i[0].payload,c=t.isHighlightedAddition,l=n.highlightedPlayer===t.name,h=t.participations>=3;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,l&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Kill total: ",e.jsx("strong",{children:t.totalScore})]}),e.jsxs("div",{children:["Kill moyen: ",e.jsx("strong",{children:t.averageScore.toFixed(2)})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate.toFixed(1),"%"]})]})]}),c&&!h&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (< 3 parties)"}),c&&h&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(T,{dataKey:"averageScore",name:"Kill moyen par partie",children:d.topPlayersByAverageScore.map((a,i)=>{const t=n.highlightedPlayer===a.name,c=H===a.name,l=a.isHighlightedAddition;return e.jsx(P,{fill:t?"var(--accent-primary)":l?"var(--accent-secondary)":q(a.name),stroke:t?"var(--accent-primary)":c?"var(--text-primary)":"none",strokeWidth:t?3:c?2:0,strokeDasharray:l?"5,5":"none",opacity:l?.8:1,onMouseEnter:()=>D(a.name),onMouseLeave:()=>D(null),style:{cursor:"pointer"}},`cell-${i}`)})})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills"}),e.jsx(S,{title:"Distribution des Kills",className:"lycans-chart-wrapper",children:e.jsx(A,{width:"100%",height:400,children:e.jsxs(L,{children:[e.jsx(W,{data:d.scoreData,cx:"50%",cy:"50%",labelLine:!1,label:a=>{const{cx:i,cy:t,midAngle:c,outerRadius:l,range:h,percentage:f,fill:m}=a,p=Math.PI/180,v=l+30,y=i+v*Math.cos(-c*p),j=t+v*Math.sin(-c*p),b=h==="7+"?-12:0;return e.jsx("text",{x:y,y:j+b,fill:m,textAnchor:y>i?"start":"end",dominantBaseline:"central",children:`${h}: ${f}%`})},outerRadius:140,fill:"#8884d8",dataKey:"count",children:d.scoreData.map((a,i)=>e.jsx(P,{fill:u[i%u.length]},`cell-${i}`))}),e.jsx(w,{content:({active:a,payload:i})=>{if(a&&i&&i.length>0){const t=i[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.range," ",t.range==="1"?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Nombre de parties: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate,"%"]})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"4px"},children:["(",t.wins," victoire",t.wins!==1?"s":"",")"]})]})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills des Gagnants"}),e.jsx(S,{title:"Distribution des Kills des Gagnants",className:"lycans-chart-wrapper",children:e.jsx(A,{width:"100%",height:400,children:e.jsxs(K,{data:d.winnerScoreData,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(k,{dataKey:"score",label:{value:"Nombre de kills",position:"insideBottom",offset:-5}}),e.jsx(C,{label:{value:"Nombre de victoires",angle:-90,position:"insideLeft"}}),e.jsx(w,{content:({active:a,payload:i})=>{if(a&&i&&i.length>0){const t=i[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.score," ",t.score===1?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]})]})]})}return null}}),e.jsx(T,{dataKey:"count",name:"Victoires",children:d.winnerScoreData.map((a,i)=>e.jsx(P,{fill:u[i%u.length]},`cell-${i}`))})]})})})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{ee as BRKillsStatsChart};
