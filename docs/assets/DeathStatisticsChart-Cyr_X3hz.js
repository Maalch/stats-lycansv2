import{u as O,a as W,r as R,j as e,c as $}from"./index-Djv7Jup7.js";import{u as _}from"./baseStatsHook-DCPMmbQ2.js";import{D as l,g as K}from"./datasyncExport-BEMYPrh7.js";import{b as I,m as Y,a as w,u as Z}from"./api-CtlC9lgT.js";import{F as k,B as L,C as M,X as H,Y as V,a as z,b as U}from"./FullscreenChart-j_7O-MWf.js";import{R as C,T as F}from"./CategoricalChart-jflfZsaO.js";import{u as J}from"./useJoueursData-DpWjPl00.js";function X(h){const m=new Set;h.filter(x=>!x.LegacyData||x.LegacyData.deathInformationFilled===!0).forEach(x=>{x.PlayerStats.forEach(j=>{const N=K(j.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});m.add(N)})});const p=Array.from(m);return[...I.filter(x=>p.includes(x)),...p.filter(x=>!I.includes(x)).sort()]}function G(h){switch(h){case l.VOTED:return"Mort aux votes";case l.BY_WOLF:return"Tué par un loup";case l.BY_WOLF_REZ:return"Tué par un loup ressuscité";case l.BY_WOLF_LOVER:return"Tué par un loup amoureux";case l.BY_ZOMBIE:return"Tué par un zombie";case l.BY_BEAST:return"Dévoré par la Bête";case l.BY_AVATAR_CHAIN:return"Mort liée à l'Avatar";case l.BULLET:return"Abattu par un chasseur";case l.BULLET_HUMAN:return"Tué par un chasseur en humain";case l.BULLET_WOLF:return"Tué par un chasseur en loup";case l.BULLET_BOUNTYHUNTER:return"Tué par un chasseur de primes";case l.SHERIF:return"Abattu par le Shérif";case l.OTHER_AGENT:return"Éliminé par l'Agent";case l.AVENGER:return"Tué par un vengeur";case l.SEER:return"Rôle deviné par un loup";case l.HANTED:return"Tué par une potion hantée";case l.ASSASSIN:return"Tué par une potion (Assassin)";case l.LOVER_DEATH:return"Mort par amoureux";case l.LOVER_DEATH_OWN:return"Tué par son amoureux";case l.BOMB:return"Mort dans une explosion";case l.CRUSHED:return"Écrasé";case l.STARVATION:return"Mort de faim";case l.STARVATION_AS_BEAST:return"Mort bestiale";case l.FALL:return"Mort de chute";case l.UNKNOWN:return"Mort inconnue";default:return""}}function q(h){switch(h){case l.VOTED:return"Mort aux votes";case l.BY_WOLF:return"Kill en Loup";case l.BY_WOLF_REZ:return"Kill en Loup ressuscité";case l.BY_WOLF_LOVER:return"Kill en Loup amoureux";case l.BY_ZOMBIE:return"Kill en Zombie";case l.BY_BEAST:return"Kill en Bête";case l.BY_AVATAR_CHAIN:return"Mort d'Avatar";case l.BULLET:return"Tir de Chasseur";case l.BULLET_HUMAN:return"Kill en Chasseur (sur humain)";case l.BULLET_WOLF:return"Kill en Chasseur (sur loup)";case l.BULLET_BOUNTYHUNTER:return"Kill en Chasseur de primes";case l.SHERIF:return"Kill en Shérif";case l.OTHER_AGENT:return"Kill en Agent";case l.AVENGER:return"Kill en Vengeur";case l.SEER:return"Kill en Devin";case l.HANTED:return"Kill avec Potion hantée";case l.ASSASSIN:return"Kill avec Potion (Assassin)";case l.LOVER_DEATH:return"Kill de son amoureux";case l.LOVER_DEATH_OWN:return"Kill de son propre amoureux";case l.BOMB:return"Explosion";case l.CRUSHED:return"Écrasement";case l.STARVATION:return"Famine";case l.STARVATION_AS_BEAST:return"Tuerie bestiale";case l.FALL:return"Chute mortelle";case l.UNKNOWN:return"Kill inconnu";default:return""}}function Q(h){const m=new Set;h.forEach(a=>{a.PlayerStats.forEach(x=>{x.DeathType&&x.DeathType!==""&&m.add(x.DeathType)})});const g=Array.from(m),p=[l.BY_WOLF,l.VOTED,l.BULLET,l.BULLET_HUMAN,l.BULLET_WOLF,l.BY_ZOMBIE,l.ASSASSIN,l.AVENGER,l.LOVER_DEATH];return[...p.filter(a=>g.includes(a)),...g.filter(a=>!p.includes(a)).sort()]}function ee(h,m){return h.PlayerStats.filter(g=>g.DeathType&&g.DeathType!==""&&(g.DeathTiming||g.DeathType)).map(g=>{let p=null;if(g.KillerName){const a=h.PlayerStats.find(x=>x.Username===g.KillerName);a&&(p=K(a.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1}),a.MainRoleFinal&&a.MainRoleFinal!==a.MainRoleInitial&&(a.MainRoleFinal==="Loup"?p="Loup":a.MainRoleFinal==="Zombie"&&(p="Vaudou")))}return{playerName:g.Username,deathType:g.DeathType,killerName:g.KillerName,killerCamp:p}}).filter(g=>{if(!m||m==="Tous les camps")return!0;const p=h.PlayerStats.find(x=>x.Username===g.playerName);return p?K(p.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===m:!1})}function te(h,m){const g=[];return h.PlayerStats.forEach(p=>{if(p.KillerName&&p.DeathType){if(p.DeathType===l.VOTED||p.DeathType===l.STARVATION||p.DeathType===l.FALL||p.DeathType===l.BY_AVATAR_CHAIN||p.DeathType==="")return;const a=h.PlayerStats.find(j=>j.Username===p.KillerName);if(!a)return;let x=K(a.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});a.MainRoleFinal&&a.MainRoleFinal!==a.MainRoleInitial&&(a.MainRoleFinal==="Loup"?x="Loup":a.MainRoleFinal==="Zombie"&&(x="Vaudou")),g.push({killerName:p.KillerName,victimName:p.Username,deathType:p.DeathType,killerCamp:x})}}),m&&m!=="Tous les camps"?g.filter(p=>p.killerCamp===m):g}function re(h,m){if(h.length===0)return null;const g=h.filter(t=>!t.LegacyData||t.LegacyData.deathInformationFilled===!0);if(g.length===0)return null;const p=[],a={};g.forEach(t=>{ee(t,m).forEach(o=>{p.push({...o,gameId:t.Id})}),t.PlayerStats.forEach(o=>{const A=o.Username;(!m||m==="Tous les camps"||K(o.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})===m)&&(a[A]=(a[A]||0)+1)})});const x=p.length,j=g.length,N=j>0?x/j:0,S={};p.forEach(t=>{S[t.deathType]=(S[t.deathType]||0)+1});const P=Object.entries(S).map(([t,i])=>({type:t,count:i||0,percentage:x>0?(i||0)/x*100:0})).sort((t,i)=>i.count-t.count),T={};g.forEach(t=>{te(t,m).forEach(o=>{T[o.killerName]||(T[o.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),T[o.killerName].kills++,T[o.killerName].victims.add(o.victimName),T[o.killerName].killsByDeathType[o.deathType]=(T[o.killerName].killsByDeathType[o.deathType]||0)+1})});const D=Object.entries(T).map(([t,i])=>{const o=a[t]||0,A=o>0?i.kills/o:0;return{killerName:t,kills:i.kills,victims:Array.from(i.victims),percentage:x>0?i.kills/x*100:0,gamesPlayed:o,averageKillsPerGame:A,killsByDeathType:i.killsByDeathType}}).sort((t,i)=>i.kills-t.kills),b={};p.forEach(t=>{b[t.playerName]||(b[t.playerName]={totalDeaths:0,deathsByType:{},killedBy:{},deathDays:[]});const i=b[t.playerName];i.totalDeaths++,i.deathsByType[t.deathType]=(i.deathsByType[t.deathType]||0)+1,t.killerName&&(i.killedBy[t.killerName]=(i.killedBy[t.killerName]||0)+1)});const E=[];Object.entries(b).forEach(([t,i])=>{E.push({playerName:t,totalDeaths:i.totalDeaths,deathsByType:i.deathsByType,killedBy:i.killedBy,deathRate:a[t]>0?i.totalDeaths/a[t]:0,gamesPlayed:a[t]||0})}),Object.entries(a).forEach(([t,i])=>{b[t]||E.push({playerName:t,totalDeaths:0,deathsByType:{},killedBy:{},deathRate:0,gamesPlayed:i})});const v=E.sort((t,i)=>i.totalDeaths-t.totalDeaths),c=P.length>0?P[0].type:null,s=D.length>0?D[0].killerName:null;return{totalDeaths:x,totalGames:j,averageDeathsPerGame:N,deathsByType:P,killerStats:D,playerDeathStats:v,mostCommonDeathType:c,mostDeadlyKiller:s}}function ie(h,m){const g=h.filter(P=>!P.LegacyData||P.LegacyData.deathInformationFilled===!0),p={},a=g.length,x=[l.BULLET,l.BULLET_HUMAN,l.BULLET_WOLF,l.BULLET_BOUNTYHUNTER];g.forEach(P=>{const T=new Set;P.PlayerStats.forEach(D=>{const b=D.MainRoleInitial,E=D.MainRoleFinal;(b==="Chasseur"||E==="Chasseur")&&(T.add(D.Username),p[D.Username]||(p[D.Username]={kills:[],gamesPlayed:0,victimsCamps:[]}),p[D.Username].gamesPlayed++)}),P.PlayerStats.forEach(D=>{const b=D.DeathType,E=D.KillerName;if(b&&x.includes(b)&&E&&T.has(E)){const v=K(D.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1});p[E].kills.push(b),p[E].victimsCamps.push(v)}})});const j=Object.entries(p).map(([P,T])=>{const D=T.kills.length,b={};T.kills.forEach(i=>{b[i]=(b[i]||0)+1});const E={};T.victimsCamps.forEach(i=>{E[i]=(E[i]||0)+1});const v=T.victimsCamps.filter(i=>i!=="Villageois").length,c=T.victimsCamps.filter(i=>i==="Villageois").length,s=T.gamesPlayed>0?D/T.gamesPlayed:0,t=T.gamesPlayed>0?v/T.gamesPlayed:0;return{hunterName:P,totalKills:D,nonVillageoisKills:v,villageoisKills:c,gamesPlayedAsHunter:T.gamesPlayed,averageKillsPerGame:s,averageNonVillageoisKillsPerGame:t,killsByDeathType:b,victimsByCamp:E}}).sort((P,T)=>T.totalKills-P.totalKills),N=j.length>0?j[0].hunterName:null,S=j.length>0?j.sort((P,T)=>T.averageNonVillageoisKillsPerGame-P.averageNonVillageoisKillsPerGame)[0].hunterName:null;return{totalHunters:j.length,totalGames:a,hunterStats:j,bestHunter:N,bestAverageHunter:S}}function ae(h){return _(m=>re(m,h))}function se(){return _(h=>X(h))}function le(h){return _(m=>ie(m))}function ne({deathStats:h,selectedCamp:m,minGamesForAverage:g,onMinGamesChange:p,availableDeathTypes:a,deathTypeColors:x,totalEligibleForAverage:j}){const{navigateToGameDetails:N}=O(),{settings:S}=W(),{totalKillsData:P,averageKillsData:T,highlightedPlayerAddedToTotal:D,highlightedPlayerAddedToAverage:b}=R.useMemo(()=>{if(!h)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const c=h.killerStats.sort((r,y)=>y.kills-r.kills).slice(0,15),s=S.highlightedPlayer&&c.some(r=>r.killerName===S.highlightedPlayer),t=c.map(r=>{const y={name:r.killerName,value:r.kills,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!1};return a.forEach(d=>{y[d]=r.killsByDeathType[d]||0}),y});let i=!1;if(S.highlightedPlayer&&!s){const r=h.killerStats.find(y=>y.killerName===S.highlightedPlayer);if(r){const y={name:r.killerName,value:r.kills,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!0};a.forEach(d=>{y[d]=r.killsByDeathType[d]||0}),t.push(y),i=!0}}const A=h.killerStats.filter(r=>r.gamesPlayed>=g).sort((r,y)=>y.averageKillsPerGame-r.averageKillsPerGame).slice(0,15),B=S.highlightedPlayer&&A.some(r=>r.killerName===S.highlightedPlayer),f=A.map(r=>{const y={name:r.killerName,value:r.averageKillsPerGame,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!1};return a.forEach(d=>{const u=r.killsByDeathType[d]||0;y[d]=r.gamesPlayed>0?u/r.gamesPlayed:0}),y});let n=!1;if(S.highlightedPlayer&&!B){const r=h.killerStats.find(y=>y.killerName===S.highlightedPlayer);if(r){const y={name:r.killerName,value:r.averageKillsPerGame,victims:r.victims.length,percentage:r.percentage,gamesPlayed:r.gamesPlayed,averageKillsPerGame:r.averageKillsPerGame,isHighlightedAddition:!0};a.forEach(d=>{const u=r.killsByDeathType[d]||0;y[d]=r.gamesPlayed>0?u/r.gamesPlayed:0}),f.push(y),n=!0}}return{totalKillsData:t,averageKillsData:f,highlightedPlayerAddedToTotal:i,highlightedPlayerAddedToAverage:n}},[h,S.highlightedPlayer,g,a]),E=({active:c,payload:s,label:t})=>{if(c&&s&&s.length){const i=s[0].payload,o=i.isHighlightedAddition,A=S.highlightedPlayer===i.name,B=a.reduce((f,n)=>f+(i[n]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:A?"var(--accent-primary)":"var(--text-primary)"},children:[t,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",B]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),a.map(f=>{const n=i[f]||0;return n===0?null:e.jsxs("p",{style:{color:x[f],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[q(f),":"]})," ",n]},f)})]}),o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),A&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},v=({active:c,payload:s,label:t})=>{if(c&&s&&s.length){const i=s[0].payload,o=i.isHighlightedAddition,A=S.highlightedPlayer===i.name,B=i.gamesPlayed>=g,f=h?.killerStats.find(y=>y.killerName===i.name),n=a.reduce((y,d)=>y+(i[d]||0),0),r=f?f.kills:Math.round(n*i.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:A?"var(--accent-primary)":"var(--text-primary)"},children:[t,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",n.toFixed(2)," (",r," kills /",i.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),a.map(y=>{const d=i[y]||0;if(d===0)return null;const u=f?f.killsByDeathType[y]||0:Math.round(d*i.gamesPlayed);return e.jsxs("p",{style:{color:x[y],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[q(y),":"]})," ",d.toFixed(2)," (",u," kills /",i.gamesPlayed," games)"]},y)})]}),o&&!B&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",g," parties)"]}),o&&B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),A&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:m==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${m} (Total)`}),D&&S.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',S.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:m==="Tous les camps"?"Top Tueurs (Total)":`Top Tueurs en ${m} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:P,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:s,payload:t})=>e.jsx("text",{x:c,y:s,dy:10,fill:S.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:S.highlightedPlayer===t.value?14:12,fontWeight:S.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${s})`,children:t.value})}),e.jsx(V,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(F,{content:e.jsx(E,{})}),a.map(c=>e.jsx(z,{dataKey:c,name:c,stackId:"kills",fill:x[c],onClick:s=>{const t={selectedPlayer:s?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(t.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),N(t)}},c))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,P.filter(c=>!c.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:m==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${m} (Moyenne par partie)`}),b&&S.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',S.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:g,onChange:c=>p(Number(c.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsx(k,{title:m==="Tous les camps"?"Top Tueurs (Moyenne par Partie)":`Top Tueurs en ${m} (Moyenne par partie)`,children:e.jsx("div",{style:{height:400},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:s,payload:t})=>e.jsx("text",{x:c,y:s,dy:10,fill:S.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:S.highlightedPlayer===t.value?14:12,fontWeight:S.highlightedPlayer===t.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${s})`,children:t.value})}),e.jsx(V,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(F,{content:e.jsx(v,{})}),a.map(c=>e.jsx(z,{dataKey:c,name:c,stackId:"averageKills",fill:x[c],onClick:s=>{const t={selectedPlayer:s?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(t.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),N(t)}},c))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(c=>!c.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",j," ayant au moins ",g," partie",g>1?"s":"",")"]})]})]})}function oe({deathStats:h,selectedCamp:m,minGamesForAverage:g,onMinGamesChange:p,availableDeathTypes:a,deathTypeColors:x}){const{navigateToGameDetails:j}=O(),{settings:N}=W(),{totalDeathsData:S,survivalRateData:P,highlightedPlayerAddedToDeaths:T,highlightedPlayerAddedToSurvival:D}=R.useMemo(()=>{if(!h)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const v=h.playerDeathStats.sort((n,r)=>r.totalDeaths-n.totalDeaths).slice(0,15),c=N.highlightedPlayer&&v.some(n=>n.playerName===N.highlightedPlayer),s=v.map(n=>{const r=n.gamesPlayed,y=r>0?(r-n.totalDeaths)/r*100:0,d={name:n.playerName,value:n.totalDeaths,totalDeaths:n.totalDeaths,gamesPlayed:r,deathRate:n.deathRate,survivalRate:y,isHighlightedAddition:!1};return a.forEach(u=>{d[u]=n.deathsByType[u]||0}),d});let t=!1;if(N.highlightedPlayer&&!c){const n=h.playerDeathStats.find(r=>r.playerName===N.highlightedPlayer);if(n){const r=n.gamesPlayed,y=r>0?(r-n.totalDeaths)/r*100:0,d={name:n.playerName,value:n.totalDeaths,totalDeaths:n.totalDeaths,gamesPlayed:r,deathRate:n.deathRate,survivalRate:y,isHighlightedAddition:!0};a.forEach(u=>{d[u]=n.deathsByType[u]||0}),s.push(d),t=!0}}const o=h.playerDeathStats.filter(n=>n.gamesPlayed>=g).map(n=>({...n,survivalRate:n.gamesPlayed>0?(n.gamesPlayed-n.totalDeaths)/n.gamesPlayed*100:0})).sort((n,r)=>r.survivalRate-n.survivalRate).slice(0,15),A=N.highlightedPlayer&&o.some(n=>n.playerName===N.highlightedPlayer),B=o.map(n=>{const r={name:n.playerName,value:n.survivalRate,totalDeaths:n.totalDeaths,gamesPlayed:n.gamesPlayed,deathRate:n.deathRate,survivalRate:n.survivalRate,isHighlightedAddition:!1};return a.forEach(y=>{const d=n.deathsByType[y]||0;r[y]=n.gamesPlayed>0?d/n.gamesPlayed*100:0}),r});let f=!1;if(N.highlightedPlayer&&!A){const n=h.playerDeathStats.find(r=>r.playerName===N.highlightedPlayer);if(n){const r=n.gamesPlayed>0?(n.gamesPlayed-n.totalDeaths)/n.gamesPlayed*100:0,y={name:n.playerName,value:r,totalDeaths:n.totalDeaths,gamesPlayed:n.gamesPlayed,deathRate:n.deathRate,survivalRate:r,isHighlightedAddition:!0};a.forEach(d=>{const u=n.deathsByType[d]||0;y[d]=n.gamesPlayed>0?u/n.gamesPlayed*100:0}),B.push(y),f=!0}}return{totalDeathsData:s,survivalRateData:B,highlightedPlayerAddedToDeaths:t,highlightedPlayerAddedToSurvival:f}},[h,N.highlightedPlayer,g,a]),b=({active:v,payload:c,label:s})=>{if(v&&c&&c.length){const t=c[0].payload,i=t.isHighlightedAddition,o=N.highlightedPlayer===t.name,A=a.reduce((B,f)=>B+(t[f]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:o?"var(--accent-primary)":"var(--text-primary)"},children:[s,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",A]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",t.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",t.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),a.map(B=>{const f=t[B]||0;return f===0?null:e.jsxs("p",{style:{color:x[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[G(B),":"]})," ",f]},B)})]}),i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),o&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},E=({active:v,payload:c,label:s})=>{if(v&&c&&c.length){const t=c[0].payload,i=t.isHighlightedAddition,o=N.highlightedPlayer===t.name,A=t.gamesPlayed>=g;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:o?"var(--accent-primary)":"var(--text-primary)"},children:[s,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",t.survivalRate.toFixed(1),"% (",t.gamesPlayed-t.totalDeaths," survies / ",t.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",t.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",t.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),a.map(B=>{const f=t[B]||0;return f===0?null:e.jsxs("p",{style:{color:x[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[G(B),":"]})," ",f.toFixed(1),"%"]},B)})]}),i&&!A&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",g," parties)"]}),i&&A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),o&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:m==="Tous les camps"?"Morts (Total)":`Morts en ${m} (Total)`}),T&&N.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',N.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:m==="Tous les camps"?"Morts (Total)":`Morts en ${m} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:S,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:v,y:c,payload:s})=>e.jsx("text",{x:v,y:c,dy:10,fill:N.highlightedPlayer===s.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:N.highlightedPlayer===s.value?14:12,fontWeight:N.highlightedPlayer===s.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${v} ${c})`,children:s.value})}),e.jsx(V,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(F,{content:e.jsx(b,{})}),a.map(v=>e.jsx(z,{dataKey:v,name:v,stackId:"deaths",fill:x[v],onClick:c=>{const s={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(s.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),j(s)}},v))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,S.filter(v=>!v.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",m==="Tous les camps"?"(Total)":` en ${m}`]}),D&&N.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',N.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:g,onChange:v=>p(Number(v.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(v=>e.jsx("option",{value:v,children:v},v))})]}),e.jsx(k,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:P,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:v,y:c,payload:s})=>e.jsx("text",{x:v,y:c,dy:10,fill:N.highlightedPlayer===s.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:N.highlightedPlayer===s.value?14:12,fontWeight:N.highlightedPlayer===s.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${v} ${c})`,children:s.value})}),e.jsx(V,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(F,{content:e.jsx(E,{})}),a.map(v=>e.jsx(z,{dataKey:v,name:v,stackId:"survivalRate",fill:x[v],onClick:c=>{const s={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};m!=="Tous les camps"&&(s.campFilter={selectedCamp:m,campFilterMode:"all-assignments"}),j(s)}},v))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,P.filter(v=>!v.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",g," partie",g>1?"s":"",")"]})]})]})}function ce({hunterStats:h,isLoading:m,error:g}){const{navigateToGameDetails:p}=O(),{settings:a}=W(),x=w(),{joueursData:j}=J(),N=Z(j),[S,P]=R.useState(null);if(m)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(g)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",g]});if(!h||h.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnée Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:T,highlightedPlayerAddedToBest:D,finalBadHuntersData:b,highlightedPlayerAddedToBad:E}=(()=>{const t=h.hunterStats.filter(d=>d.gamesPlayedAsHunter>=5).sort((d,u)=>u.averageNonVillageoisKillsPerGame-d.averageNonVillageoisKillsPerGame).slice(0,15),i=a.highlightedPlayer&&t.some(d=>d.hunterName===a.highlightedPlayer);let o=[...t],A=!1;if(a.highlightedPlayer&&!i){const d=h.hunterStats.find(u=>u.hunterName===a.highlightedPlayer);d&&(o.push({...d,isHighlightedAddition:!0}),A=!0)}const B=h.hunterStats.filter(d=>d.gamesPlayedAsHunter>=5).map(d=>({name:d.hunterName,averageVillageoisKills:Number((d.villageoisKills/d.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:d.villageoisKills,totalNonVillageoisKills:d.nonVillageoisKills,totalKills:d.totalKills,gamesPlayed:d.gamesPlayedAsHunter,victimsByCamp:d.victimsByCamp,hunterName:d.hunterName})),f=B.sort((d,u)=>u.averageVillageoisKills-d.averageVillageoisKills).slice(0,15),n=a.highlightedPlayer&&f.some(d=>d.hunterName===a.highlightedPlayer);let r=[...f],y=!1;if(a.highlightedPlayer&&!n){const d=B.find(u=>u.hunterName===a.highlightedPlayer);d&&(r.push({...d,isHighlightedAddition:!0}),y=!0)}return{finalBestHuntersData:o,highlightedPlayerAddedToBest:A,finalBadHuntersData:r,highlightedPlayerAddedToBad:y}})(),v=({active:s,payload:t,label:i})=>{if(s&&t&&t.length){const o=t[0].payload,A=o.isHighlightedAddition,B=a.highlightedPlayer===o.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[i,A&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",o.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tués:"})," ",o.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",o.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",o.totalKills]}),o.victimsByCamp&&Object.keys(o.victimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Victimes par camp:"}),Object.entries(o.victimsByCamp).map(([f,n])=>e.jsxs("p",{style:{color:x[f]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[f,":"]})," ",n]},f))]}),A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},c=({active:s,payload:t,label:i})=>{if(s&&t&&t.length){const o=t[0].payload,A=o.isHighlightedAddition,B=a.highlightedPlayer===o.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:B?"var(--accent-primary)":"var(--text-primary)"},children:[i,A&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tués/partie:"})," ",o.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tués:"})," ",o.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tués:"})," ",o.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",o.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",o.totalKills]}),o.victimsByCamp&&Object.keys(o.victimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Victimes par camp:"}),Object.entries(o.victimsByCamp).map(([f,n])=>e.jsxs("p",{style:{color:x[f]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[f,":"]})," ",n]},f))]}),A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),B&&!A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Meilleurs Chasseurs"}),D&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',a.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:"Meilleurs Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:T,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:s,y:t,payload:i})=>e.jsx("text",{x:s,y:t,dy:10,fill:a.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:a.highlightedPlayer===i.value?14:12,fontWeight:a.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${s} ${t})`,children:i.value})}),e.jsx(V,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(F,{content:e.jsx(v,{})}),e.jsx(z,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:s=>{s?.hunterName&&p({selectedPlayer:s.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Meilleurs Chasseurs"})},onMouseEnter:s=>P(s?.hunterName||null),onMouseLeave:()=>P(null),style:{cursor:"pointer"},children:T.map((s,t)=>{const i=a.highlightedPlayer===s.hunterName,o=s.isHighlightedAddition;return e.jsx(U,{fill:N[s.hunterName]||x.Chasseur||"#8884d8",stroke:i?"var(--accent-primary)":S===s.hunterName?"var(--text-primary)":"none",strokeWidth:i?3:S===s.hunterName?2:0,strokeDasharray:o?"5,5":"none",opacity:o?.8:1},`cell-${t}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(s=>!s.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),E&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',a.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(k,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(L,{data:b,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(H,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:s,y:t,payload:i})=>e.jsx("text",{x:s,y:t,dy:10,fill:a.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:a.highlightedPlayer===i.value?14:12,fontWeight:a.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${s} ${t})`,children:i.value})}),e.jsx(V,{label:{value:"Moyenne Villageois tués/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(F,{content:e.jsx(c,{})}),e.jsx(z,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:s=>{s?.hunterName&&p({selectedPlayer:s.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:s=>P(s?.hunterName||null),onMouseLeave:()=>P(null),style:{cursor:"pointer"},children:b.map((s,t)=>{const i=a.highlightedPlayer===s.hunterName,o=s.isHighlightedAddition;return e.jsx(U,{fill:N[s.hunterName]||x.Chasseur||"#8884d8",stroke:i?"var(--accent-primary)":S===s.hunterName?"var(--text-primary)":"none",strokeWidth:i?3:S===s.hunterName?2:0,strokeDasharray:o?"5,5":"none",opacity:o?.8:1},`cell-${t}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,b.filter(s=>!s.isHighlightedAddition).length)," des chasseurs ayant le plus tué de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function xe(){const{navigationState:h,updateNavigationState:m}=O(),[g,p]=R.useState(h.deathStatisticsState?.selectedCamp||h.deathStatsSelectedCamp||"Tous les camps"),[a,x]=R.useState(h.deathStatisticsState?.minGamesForAverage||10),[j,N]=R.useState(h.deathStatisticsState?.selectedView||"killers"),{data:S}=se(),{data:P,isLoading:T,error:D}=ae(g),{data:b,isLoading:E,error:v}=le(),{data:c}=$(),s=w();R.useEffect(()=>{(!h.deathStatisticsState||h.deathStatisticsState.selectedCamp!==g||h.deathStatisticsState.minGamesForAverage!==a||h.deathStatisticsState.selectedView!==j)&&m({deathStatisticsState:{selectedCamp:g,minGamesForAverage:a,selectedView:j,focusChart:h.deathStatisticsState?.focusChart}})},[g,a,j,h.deathStatisticsState,m]);const t=R.useMemo(()=>c?Q(c):[],[c]),i=R.useMemo(()=>{const r={};t.forEach(u=>{u===l.BY_WOLF||u===l.BY_WOLF_REZ||u===l.BY_WOLF_LOVER?r[u]=s.Loup:u===l.VOTED?r[u]="var(--chart-color-1)":u===l.BULLET||u===l.BULLET_BOUNTYHUNTER||u===l.BULLET_HUMAN||u===l.BULLET_WOLF?r[u]=s.Chasseur:u===l.BY_ZOMBIE?r[u]=s.Vaudou:u===l.ASSASSIN?r[u]=s.Alchimiste:u===l.AVENGER?r[u]="var(--chart-color-2)":u===l.LOVER_DEATH||u===l.LOVER_DEATH_OWN?r[u]=s.Amoureux:u===l.BY_BEAST?r[u]="var(--chart-color-3)":u===l.SHERIF&&(r[u]="var(--chart-color-4)")});const y=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let d=0;return t.forEach(u=>{r[u]||(r[u]=y[d%y.length],d++)}),r},[t,s]),o=r=>{p(r),m({deathStatsSelectedCamp:r,deathStatisticsState:{selectedCamp:r,minGamesForAverage:a,selectedView:j,focusChart:h.deathStatisticsState?.focusChart}})},A=r=>{x(r),m({deathStatisticsState:{selectedCamp:g,minGamesForAverage:r,selectedView:j,focusChart:h.deathStatisticsState?.focusChart}})},B=r=>{N(r),m({deathStatisticsState:{selectedCamp:g,minGamesForAverage:a,selectedView:r,focusChart:h.deathStatisticsState?.focusChart}})},{gamesWithKillers:f,totalEligibleForAverage:n}=R.useMemo(()=>{if(!P)return{gamesWithKillers:0,totalEligibleForAverage:0};const r=P.killerStats.filter(y=>y.gamesPlayed>=a);return{gamesWithKillers:P.totalGames,totalEligibleForAverage:r.length}},[P,a]);return T?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):D?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",D]}):P?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${j==="killers"?"active":""}`,onClick:()=>B("killers"),children:"Tueurs"}),e.jsx("button",{className:`lycans-categorie-btn ${j==="deaths"?"active":""}`,onClick:()=>B("deaths"),children:"Morts"}),e.jsx("button",{className:`lycans-categorie-btn ${j==="hunter"?"active":""}`,onClick:()=>B("hunter"),children:"Chasseur"})]}),(j==="killers"||j==="deaths")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:g,onChange:r=>o(r.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),S?.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),(j==="killers"||j==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:P.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:P.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:f})]})]}),j==="killers"&&e.jsx(ne,{deathStats:P,selectedCamp:g,minGamesForAverage:a,onMinGamesChange:A,availableDeathTypes:t,deathTypeColors:i,totalEligibleForAverage:n}),j==="deaths"&&e.jsx(oe,{deathStats:P,selectedCamp:g,minGamesForAverage:a,onMinGamesChange:A,availableDeathTypes:t,deathTypeColors:i}),j==="hunter"&&e.jsx(ce,{hunterStats:b,isLoading:E,error:v}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"})}export{xe as DeathStatisticsChart};
