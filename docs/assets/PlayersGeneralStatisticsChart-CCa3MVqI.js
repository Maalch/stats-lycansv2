import{r as c,j as e}from"./index-Cf99x2AT.js";import{u as J}from"./usePlayerStats-B1C7TgCj.js";import{p as L,m as H,l as Q,g as U}from"./api-k9NQCCqr.js";import{F as k}from"./FullscreenChart-jjawtrut.js";import{u as Z,a as ee,r as re,b as te,c as ae,d as O,s as se,e as ie,f as B,g as ne,h as le,i as oe,L as ce,j as de,k as ue,l as xe,m as M,n as V,R as A,B as K,C as W,X as q,Y as $,T as R,o as G,p as C}from"./BarChart-LVM4BPya.js";import{P as me,a as pe}from"./PieChart-DV8LmOOU.js";import{L as he}from"./Legend-c9c2IBbj.js";function z(r,a){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),n.push.apply(n,l)}return n}function X(r){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?z(Object(n),!0).forEach(function(l){E(r,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(n,l))})}return r}function E(r,a,n){return(a=ye(a))in r?Object.defineProperty(r,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[a]=n,r}function ye(r){var a=ge(r,"string");return typeof a=="symbol"?a:a+""}function ge(r,a){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var l=n.call(r,a);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function N(){return N=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)({}).hasOwnProperty.call(n,l)&&(r[l]=n[l])}return r},N.apply(null,arguments)}var ve=(r,a)=>{var n;return c.isValidElement(r)?n=c.cloneElement(r,a):typeof r=="function"?n=r(a):n=c.createElement("line",N({},a,{className:"recharts-reference-line-line"})),n},fe=(r,a,n,l,h,x,S,y,m)=>{var{x:j,y:g,width:w,height:b}=h;if(n){var{y:v}=m,p=r.y.apply(v,{position:x});if(M(p)||m.ifOverflow==="discard"&&!r.y.isInRange(p))return null;var t=[{x:j+w,y:p},{x:j,y:p}];return y==="left"?t.reverse():t}if(a){var{x:i}=m,s=r.x.apply(i,{position:x});if(M(s)||m.ifOverflow==="discard"&&!r.x.isInRange(s))return null;var d=[{x:s,y:g+b},{x:s,y:g}];return S==="top"?d.reverse():d}if(l){var{segment:u}=m,o=u.map(f=>r.apply(f,{position:x}));return m.ifOverflow==="discard"&&o.some(f=>!r.isInRange(f))?null:o}return null};function je(r){var a=Z();return c.useEffect(()=>(a(ee(r)),()=>{a(re(r))})),null}function be(r){var{x:a,y:n,segment:l,xAxisId:h,yAxisId:x,shape:S,className:y,ifOverflow:m}=r,j=te(),g=ae(),w=O(P=>se(P,h)),b=O(P=>ie(P,x)),v=O(P=>B(P,"xAxis",h,j)),p=O(P=>B(P,"yAxis",x,j)),t=ne(),i=V(a),s=V(n);if(!g||!t||w==null||b==null||v==null||p==null)return null;var d=le({x:v,y:p}),u=l&&l.length===2,o=fe(d,i,s,u,t,r.position,w.orientation,b.orientation,r);if(!o)return null;var[{x:f,y:D},{x:T,y:I}]=o,Y=m==="hidden"?"url(#".concat(g,")"):void 0,_=X(X({clipPath:Y},oe(r,!0)),{},{x1:f,y1:D,x2:T,y2:I});return c.createElement(ce,{className:de("recharts-reference-line",y)},ve(S,_),ue.renderCallByParent(r,xe({x1:f,y1:D,x2:T,y2:I})))}function Pe(r){return c.createElement(c.Fragment,null,c.createElement(je,{yAxisId:r.yAxisId,xAxisId:r.xAxisId,ifOverflow:r.ifOverflow,x:r.x,y:r.y}),c.createElement(be,r))}class F extends c.Component{render(){return c.createElement(Pe,this.props)}}E(F,"displayName","ReferenceLine");E(F,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Ee(){const{playerStatsData:r,dataLoading:a,fetchError:n}=J(),[l,h]=c.useState(null),[x,S]=c.useState(50),[y,m]=c.useState("best"),j=t=>{const i=r?.playerStats.find(s=>s.player===t);return i?Object.entries(i.camps).filter(([s,d])=>d>0).map(([s,d])=>({name:s,value:d,percentage:(d/i.gamesPlayed*100).toFixed(1)})):[]},g=c.useMemo(()=>{if(!l||!r)return[];const t=j(l);if(!t.length)return[];const i=5;let s=0;const d=[],u=[];return t.forEach(o=>{parseFloat(o.percentage)<i?(s+=Number(o.value),d.push(o)):u.push(o)}),s>0&&u.push({name:"Autres",value:s,percentage:(s/t.reduce((o,f)=>o+Number(f.value),0)*100).toFixed(1),_details:d}),u},[l,r]);if(a)return e.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques des joueurs..."});if(n)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",n]});if(!r)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de joueur disponible"});const w=r.playerStats.filter(t=>t.gamesPlayed>=x).length,b=r.playerStats.filter(t=>t.gamesPlayed>2).sort((t,i)=>i.gamesPlayed-t.gamesPlayed).slice(0,20),v=r.playerStats.filter(t=>t.gamesPlayed>=x).sort((t,i)=>y==="best"?parseFloat(i.winPercent)-parseFloat(t.winPercent):parseFloat(t.winPercent)-parseFloat(i.winPercent)).slice(0,20),p=r.playerStats.length>0?(r.playerStats.reduce((t,i)=>t+parseFloat(i.winPercent),0)/r.playerStats.length).toFixed(1):"0";return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques des Joueurs"}),e.jsxs("p",{className:"lycans-stats-info",children:["Total de ",r.totalGames," parties analysées avec ",r.playerStats.length," joueurs"]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Top Participations"}),e.jsx(k,{title:"Top Participations",children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(K,{data:b,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(W,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx($,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),e.jsx(R,{content:({active:t,payload:i})=>{if(t&&i&&i.length>0){const s=i[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:s.player})}),e.jsxs("div",{children:["Parties jouées : ",s.gamesPlayed]}),e.jsxs("div",{children:["Pourcentage : ",s.gamesPlayedPercent,"%"]})]})}return null}}),e.jsx(G,{dataKey:"gamesPlayed",name:"Parties jouées",fill:"#00C49F",children:b.map(t=>e.jsx(C,{fill:L[t.player]||"#00C49F",onClick:()=>h(t.player),style:{cursor:"pointer"}},`cell-participation-${t.player}`))})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:y==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),e.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:x,onChange:t=>S(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:H.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("select",{value:y,onChange:t=>m(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[e.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),e.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),e.jsx(k,{title:y==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire",children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(K,{data:v,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(W,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx($,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(R,{content:({active:t,payload:i})=>{if(t&&i&&i.length>0){const s=i[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:s.player})}),e.jsxs("div",{children:["Taux de victoire : ",s.winPercent,"%"]}),e.jsxs("div",{children:["Victoires : ",s.wins," / ",s.gamesPlayed]})]})}return null}}),e.jsx(G,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:v.map(t=>e.jsx(C,{fill:L[t.player]||"#8884d8",onClick:()=>h(t.player),style:{cursor:"pointer"}},`cell-winrate-${t.player}`))}),e.jsx(F,{y:parseFloat(p),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${p}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",v.length," des joueurs (sur ",w," ayant au moins ",x," partie",x>1?"s":"",")"]})]})]}),l&&e.jsxs("div",{className:"lycans-graphique-section lycans-joueur-details",children:[e.jsxs("h3",{children:["Distribution des Camps - ",l]}),e.jsx("div",{style:{height:300},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(me,{children:[e.jsx(pe,{data:g,cx:"50%",cy:"50%",labelLine:!0,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:t,percentage:i})=>t==="Autres"?`Autres : ${i}%`:`${t}: ${i}%`,children:g.map((t,i)=>e.jsx(C,{fill:t.name==="Autres"?"#cccccc":Q[t.name]||U(t.name)},`cell-${i}`))}),e.jsx(R,{content:({active:t,payload:i})=>{if(t&&i&&i.length>0){const s=i[0].payload;if(s.name==="Autres"&&s._details){const d=[...s._details].sort((u,o)=>parseFloat(o.percentage)-parseFloat(u.percentage));return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:"Autres"})}),e.jsx("div",{children:d.map((u,o)=>e.jsxs("div",{children:[u.name,": ",u.value," parties (",u.percentage,"%)"]},o))}),e.jsxs("div",{style:{marginTop:4,fontWeight:"bold"},children:["Total: ",s.value," parties (",s.percentage,"%)"]})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:s.name})}),e.jsxs("div",{children:[s.value," parties (",s.percentage,"%)"]})]})}return null}}),e.jsx(he,{})]})})})]})]})}export{Ee as PlayersGeneralStatisticsChart};
