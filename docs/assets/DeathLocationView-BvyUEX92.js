import{r as D,j as t,u as Q,a as _,e as ee}from"./index-DUHObHKt.js";import{F as te,C as re,X as ne,Y as oe,a as se}from"./FullscreenChart-BSeE-zUD.js";import{b as ae,c as G}from"./deathStatisticsUtils-a6AcbP2-.js";import{g as $}from"./deathTypes-CGUOTngO.js";import{ak as ie,al as U,am as Y,an as le,ao as Z,R as ce,T as de}from"./CategoricalChart-Dntrz_Ud.js";import{S as ue,a as fe}from"./ScatterChart-DW_msXmH.js";import"./datasyncExport-D6_8Fmuy.js";import"./api-BYijIpLz.js";const he=me(pe);function me(e){return function(i,c,s=c){if(!((c=+c)>=0))throw new RangeError("invalid rx");if(!((s=+s)>=0))throw new RangeError("invalid ry");let{data:r,width:l,height:f}=i;if(!((l=Math.floor(l))>=0))throw new RangeError("invalid width");if(!((f=Math.floor(f!==void 0?f:r.length/l))>=0))throw new RangeError("invalid height");if(!l||!f||!c&&!s)return i;const g=c&&e(c),x=s&&e(s),a=r.slice();return g&&x?(q(g,a,r,l,f),q(g,r,a,l,f),q(g,a,r,l,f),F(x,r,a,l,f),F(x,a,r,l,f),F(x,r,a,l,f)):g?(q(g,r,a,l,f),q(g,a,r,l,f),q(g,r,a,l,f)):x&&(F(x,r,a,l,f),F(x,a,r,l,f),F(x,r,a,l,f)),i}}function q(e,i,c,s,r){for(let l=0,f=s*r;l<f;)e(i,c,l,l+=s,1)}function F(e,i,c,s,r){for(let l=0,f=s*r;l<s;++l)e(i,c,l,l+f,s)}function pe(e){const i=Math.floor(e);if(i===e)return xe(e);const c=e-i,s=2*e+1;return(r,l,f,g,x)=>{if(!((g-=x)>=f))return;let a=i*l[f];const u=x*i,j=u+x;for(let h=f,M=f+u;h<M;h+=x)a+=l[Math.min(g,h)];for(let h=f,M=g;h<=M;h+=x)a+=l[Math.min(g,h+u)],r[h]=(a+c*(l[Math.max(f,h-j)]+l[Math.min(g,h+j)]))/s,a-=l[Math.max(f,h-u)]}}function xe(e){const i=2*e+1;return(c,s,r,l,f)=>{if(!((l-=f)>=r))return;let g=e*s[r];const x=f*e;for(let a=r,u=r+x;a<u;a+=f)g+=s[Math.min(l,a)];for(let a=r,u=l;a<=u;a+=f)g+=s[Math.min(l,a+x)],c[a]=g/i,g-=s[Math.max(r,a-x)]}}function ge(e,i){let c=0;for(let s of e)s!=null&&(s=+s)>=s&&++c;return c}function ye(e,i){let c,s;if(i===void 0)for(const r of e)r!=null&&(c===void 0?r>=r&&(c=s=r):(c>r&&(c=r),s<r&&(s=r)));else{let r=-1;for(let l of e)(l=i(l,++r,e))!=null&&(c===void 0?l>=l&&(c=s=l):(c>l&&(c=l),s<l&&(s=l)))}return[c,s]}function ve(e,i,c){let s;for(;;){const r=ie(e,i,c);if(r===s||r===0||!isFinite(r))return[e,i];r>0?(e=Math.floor(e/r)*r,i=Math.ceil(i/r)*r):r<0&&(e=Math.ceil(e*r)/r,i=Math.floor(i*r)/r),s=r}}function be(e){return Math.max(1,Math.ceil(Math.log(ge(e))/Math.LN2)+1)}var je=Array.prototype,J=je.slice;function Me(e,i){return e-i}function ze(e){for(var i=0,c=e.length,s=e[c-1][1]*e[0][0]-e[c-1][0]*e[0][1];++i<c;)s+=e[i-1][1]*e[i][0]-e[i-1][0]*e[i][1];return s}const L=e=>()=>e;function we(e,i){for(var c=-1,s=i.length,r;++c<s;)if(r=Ce(e,i[c]))return r;return 0}function Ce(e,i){for(var c=i[0],s=i[1],r=-1,l=0,f=e.length,g=f-1;l<f;g=l++){var x=e[l],a=x[0],u=x[1],j=e[g],h=j[0],M=j[1];if(ke(x,j,i))return 0;u>s!=M>s&&c<(h-a)*(s-u)/(M-u)+a&&(r=-r)}return r}function ke(e,i,c){var s;return Se(e,i,c)&&Ee(e[s=+(e[0]===i[0])],c[s],i[s])}function Se(e,i,c){return(i[0]-e[0])*(c[1]-e[1])===(c[0]-e[0])*(i[1]-e[1])}function Ee(e,i,c){return e<=i&&i<=c||c<=i&&i<=e}function Ne(){}var I=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function K(){var e=1,i=1,c=be,s=x;function r(a){var u=c(a);if(Array.isArray(u))u=u.slice().sort(Me);else{const j=ye(a,De);for(u=U(...ve(j[0],j[1],u),u);u[u.length-1]>=j[1];)u.pop();for(;u[1]<j[0];)u.shift()}return u.map(j=>l(a,j))}function l(a,u){const j=u==null?NaN:+u;if(isNaN(j))throw new Error(`invalid value: ${u}`);var h=[],M=[];return f(a,j,function(y){s(y,a,j),ze(y)>0?h.push([y]):M.push(y)}),M.forEach(function(y){for(var w=0,v=h.length,d;w<v;++w)if(we((d=h[w])[0],y)!==-1){d.push(y);return}}),{type:"MultiPolygon",value:u,coordinates:h}}function f(a,u,j){var h=new Array,M=new Array,y,w,v,d,o,z;for(y=w=-1,d=B(a[0],u),I[d<<1].forEach(b);++y<e-1;)v=d,d=B(a[y+1],u),I[v|d<<1].forEach(b);for(I[d<<0].forEach(b);++w<i-1;){for(y=-1,d=B(a[w*e+e],u),o=B(a[w*e],u),I[d<<1|o<<2].forEach(b);++y<e-1;)v=d,d=B(a[w*e+e+y+1],u),z=o,o=B(a[w*e+y+1],u),I[v|d<<1|o<<2|z<<3].forEach(b);I[d|o<<3].forEach(b)}for(y=-1,o=a[w*e]>=u,I[o<<2].forEach(b);++y<e-1;)z=o,o=B(a[w*e+y+1],u),I[o<<2|z<<3].forEach(b);I[o<<3].forEach(b);function b(C){var k=[C[0][0]+y,C[0][1]+w],S=[C[1][0]+y,C[1][1]+w],E=g(k),A=g(S),n,m;(n=M[E])?(m=h[A])?(delete M[n.end],delete h[m.start],n===m?(n.ring.push(S),j(n.ring)):h[n.start]=M[m.end]={start:n.start,end:m.end,ring:n.ring.concat(m.ring)}):(delete M[n.end],n.ring.push(S),M[n.end=A]=n):(n=h[A])?(m=M[E])?(delete h[n.start],delete M[m.end],n===m?(n.ring.push(S),j(n.ring)):h[m.start]=M[n.end]={start:m.start,end:n.end,ring:m.ring.concat(n.ring)}):(delete h[n.start],n.ring.unshift(k),h[n.start=E]=n):h[E]=M[A]={start:E,end:A,ring:[k,S]}}}function g(a){return a[0]*2+a[1]*(e+1)*4}function x(a,u,j){a.forEach(function(h){var M=h[0],y=h[1],w=M|0,v=y|0,d=H(u[v*e+w]);M>0&&M<e&&w===M&&(h[0]=O(M,H(u[v*e+w-1]),d,j)),y>0&&y<i&&v===y&&(h[1]=O(y,H(u[(v-1)*e+w]),d,j))})}return r.contour=l,r.size=function(a){if(!arguments.length)return[e,i];var u=Math.floor(a[0]),j=Math.floor(a[1]);if(!(u>=0&&j>=0))throw new Error("invalid size");return e=u,i=j,r},r.thresholds=function(a){return arguments.length?(c=typeof a=="function"?a:Array.isArray(a)?L(J.call(a)):L(a),r):c},r.smooth=function(a){return arguments.length?(s=a?x:Ne,r):s===x},r}function De(e){return isFinite(e)?e:NaN}function B(e,i){return e==null?!1:+e>=i}function H(e){return e==null||isNaN(e=+e)?-1/0:e}function O(e,i,c,s){const r=s-i,l=c-i,f=isFinite(r)||isFinite(l)?r/l:Math.sign(r)/Math.sign(l);return isNaN(f)?e:e+f-.5}function Ae(e){return e[0]}function Te(e){return e[1]}function Re(){return 1}function Ie(){var e=Ae,i=Te,c=Re,s=960,r=500,l=20,f=2,g=l*3,x=s+g*2>>f,a=r+g*2>>f,u=L(20);function j(o){var z=new Float32Array(x*a),b=Math.pow(2,-f),C=-1;for(const N of o){var k=(e(N,++C,o)+g)*b,S=(i(N,C,o)+g)*b,E=+c(N,C,o);if(E&&k>=0&&k<x&&S>=0&&S<a){var A=Math.floor(k),n=Math.floor(S),m=k-A-.5,p=S-n-.5;z[A+n*x]+=(1-m)*(1-p)*E,z[A+1+n*x]+=m*(1-p)*E,z[A+1+(n+1)*x]+=m*p*E,z[A+(n+1)*x]+=(1-m)*p*E}}return he({data:z,width:x,height:a},l*b),z}function h(o){var z=j(o),b=u(z),C=Math.pow(2,2*f);return Array.isArray(b)||(b=U(Number.MIN_VALUE,Y(z)/C,b)),K().size([x,a]).thresholds(b.map(k=>k*C))(z).map((k,S)=>(k.value=+b[S],M(k)))}h.contours=function(o){var z=j(o),b=K().size([x,a]),C=Math.pow(2,2*f),k=S=>{S=+S;var E=M(b.contour(z,S*C));return E.value=S,E};return Object.defineProperty(k,"max",{get:()=>Y(z)/C}),k};function M(o){return o.coordinates.forEach(y),o}function y(o){o.forEach(w)}function w(o){o.forEach(v)}function v(o){o[0]=o[0]*Math.pow(2,f)-g,o[1]=o[1]*Math.pow(2,f)-g}function d(){return g=l*3,x=s+g*2>>f,a=r+g*2>>f,h}return h.x=function(o){return arguments.length?(e=typeof o=="function"?o:L(+o),h):e},h.y=function(o){return arguments.length?(i=typeof o=="function"?o:L(+o),h):i},h.weight=function(o){return arguments.length?(c=typeof o=="function"?o:L(+o),h):c},h.size=function(o){if(!arguments.length)return[s,r];var z=+o[0],b=+o[1];if(!(z>=0&&b>=0))throw new Error("invalid size");return s=z,r=b,d()},h.cellSize=function(o){if(!arguments.length)return 1<<f;if(!((o=+o)>=1))throw new Error("invalid cell size");return f=Math.floor(Math.log(o)/Math.LN2),d()},h.thresholds=function(o){return arguments.length?(u=typeof o=="function"?o:Array.isArray(o)?L(J.call(o)):L(o),h):u},h.bandwidth=function(o){if(!arguments.length)return Math.sqrt(l*(l+1));if(!((o=+o)>=0))throw new Error("invalid bandwidth");return l=(Math.sqrt(4*o*o+1)-1)/2,d()},h}function Le(e){for(var i=e.length/6|0,c=new Array(i),s=0;s<i;)c[s]="#"+e.slice(s*6,++s*6);return c}const Pe=e=>le(e[e.length-1]);var We=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Le);const Be=Pe(We);function qe({deathLocations:e,xDomain:i,zDomain:c,width:s=800,height:r=600,bandwidth:l=25,onRegionClick:f}){const g=D.useRef(null),x=D.useRef(null),a=D.useRef(null),u=D.useMemo(()=>Z().domain(i).range([0,s]),[i,s]),j=D.useMemo(()=>Z().domain(c).range([r,0]),[c,r]),h=D.useMemo(()=>e.length===0?[]:Ie().x(d=>u(d.x)).y(d=>j(d.z)).size([s,r]).bandwidth(l).thresholds(15)(e),[e,u,j,s,r,l]),M=D.useMemo(()=>{const v=h.length>0?Math.max(...h.map(d=>d.value)):1;return d=>{const o=d/v;return Be(o)}},[h]);D.useEffect(()=>{const v=g.current;if(!v||h.length===0)return;const d=v.getContext("2d");d&&(d.clearRect(0,0,s,r),h.forEach(o=>{d.fillStyle=M(o.value),d.globalAlpha=.6,o.coordinates.forEach(z=>{z.forEach(b=>{d.beginPath(),b.forEach((C,k)=>{k===0?d.moveTo(C[0],C[1]):d.lineTo(C[0],C[1])}),d.closePath(),d.fill()})})}),d.globalAlpha=1)},[h,s,r,M]),D.useEffect(()=>{const v=x.current;if(!v||e.length===0)return;const d=v.getContext("2d");d&&(d.clearRect(0,0,s,r),e.forEach(o=>{const z=u(o.x),b=j(o.z);d.beginPath(),d.arc(z,b,2,0,2*Math.PI),d.fillStyle="rgba(0, 0, 0, 0.3)",d.fill(),d.strokeStyle="rgba(255, 255, 255, 0.5)",d.lineWidth=.5,d.stroke()}))},[e,u,j,s,r]);const y=v=>{if(!f||!a.current)return;const d=a.current.getBoundingClientRect(),o=v.clientX-d.left,z=v.clientY-d.top,b=30,C=e.filter(k=>{const S=u(k.x),E=j(k.z);return Math.sqrt(Math.pow(S-o,2)+Math.pow(E-z,2))<=b});C.length>0&&f(C)},w=v=>{if(!a.current)return;const d=a.current.getBoundingClientRect(),o=v.clientX-d.left,z=v.clientY-d.top,b=20,C=e.filter(k=>{const S=u(k.x),E=j(k.z);return Math.sqrt(Math.pow(S-o,2)+Math.pow(E-z,2))<=b});a.current&&(a.current.style.cursor=C.length>0?"pointer":"default")};return t.jsxs("div",{ref:a,style:{position:"relative",width:`${s}px`,height:`${r}px`,margin:"0 auto"},onClick:y,onMouseMove:w,children:[t.jsx("canvas",{ref:g,width:s,height:r,style:{position:"absolute",top:0,left:0,border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--bg-tertiary)"}}),t.jsx("canvas",{ref:x,width:s,height:r,style:{position:"absolute",top:0,left:0,pointerEvents:"none"}}),t.jsx("div",{style:{position:"absolute",bottom:"-30px",left:"50%",transform:"translateX(-50%)",color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Position X"}),t.jsx("div",{style:{position:"absolute",left:"-50px",top:"50%",transform:"translateY(-50%) rotate(-90deg)",color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Position Z"}),t.jsxs("svg",{width:s,height:r,style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[[0,.25,.5,.75,1].map(v=>{const d=s*v,o=i[0]+(i[1]-i[0])*v;return t.jsxs("g",{children:[t.jsx("line",{x1:d,y1:r,x2:d,y2:r-5,stroke:"var(--text-secondary)",strokeWidth:1}),t.jsx("text",{x:d,y:r-10,textAnchor:"middle",fill:"var(--text-secondary)",fontSize:"0.75rem",children:Math.round(o)})]},`x-${v}`)}),[0,.25,.5,.75,1].map(v=>{const d=r*(1-v),o=c[0]+(c[1]-c[0])*v;return t.jsxs("g",{children:[t.jsx("line",{x1:0,y1:d,x2:5,y2:d,stroke:"var(--text-secondary)",strokeWidth:1}),t.jsx("text",{x:10,y:d,dominantBaseline:"middle",fill:"var(--text-secondary)",fontSize:"0.75rem",children:Math.round(o)})]},`z-${v}`)})]})]})}function Ke({selectedCamp:e,availableDeathTypes:i,deathTypeColors:c}){const{navigateToGameDetails:s}=Q(),{settings:r}=_(),{data:l,isLoading:f,error:g}=ee(),[x,a]=D.useState(""),[u,j]=D.useState("all"),[h,M]=D.useState(null),[y,w]=D.useState("scatter"),v=D.useMemo(()=>{if(!l)return[];const n=ae(l),m=G(l,e),p=new Map;return m.forEach(N=>{p.set(N.mapName,(p.get(N.mapName)||0)+1)}),n.sort((N,R)=>{const P=p.get(N)||0;return(p.get(R)||0)-P})},[l,e]),d=v.length>0?v[0]:"";x===""&&d!==""&&a(d);const o=D.useMemo(()=>{if(!l)return[];let n=G(l,e);return x&&(n=n.filter(m=>m.mapName===x)),u!=="all"&&(n=n.filter(m=>m.deathType===u)),n},[l,e,x,u]),z=D.useMemo(()=>{const n=new Map;return o.forEach(m=>{const p=`${Math.round(m.x)}_${Math.round(m.z)}`;n.has(p)||n.set(p,[]),n.get(p).push(m)}),n},[o]),b=D.useMemo(()=>Array.from(z.entries()).map(([n,m])=>({...m[0],deathCount:m.length,allDeaths:m,locationKey:n})),[z]),C=({active:n,payload:m})=>{if(!n||!m||m.length===0)return null;const p=m[0].payload,N=`${Math.round(p.x)}_${Math.round(p.z)}`,R=z.get(N)||[p];if(R.length>1){const W=new Map,X=new Set;return R.forEach(T=>{const V=T.deathType?$(T.deathType):"Inconnu";W.set(V,(W.get(V)||0)+1),X.add(T.gameId)}),t.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[t.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[R.length," morts à cet endroit"]}),t.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("strong",{children:"Position:"})," (",Math.round(p.x),", ",Math.round(p.z),")"]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("strong",{children:"Types de mort:"}),t.jsx("ul",{style:{margin:"4px 0 0 0",paddingLeft:"20px"},children:Array.from(W.entries()).map(([T,V])=>t.jsxs("li",{children:[T," (",V,")"]},T))})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Parties:"})," ",Array.from(X).filter(T=>T).map(T=>`#${T}`).join(", ")]})]}),t.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir une des parties"})]})}return t.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[t.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:p.playerName}),t.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Camp:"})," ",p.camp]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Type de mort:"})," ",p.deathType?$(p.deathType):"Inconnu"]}),p.killerName&&t.jsxs("div",{children:[t.jsx("strong",{children:"Tué par:"})," ",p.killerName]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Carte:"})," ",p.mapName]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Partie:"})," #",p.gameId]}),t.jsxs("div",{style:{marginTop:"4px",fontSize:"0.85rem",color:"var(--text-secondary)"},children:["Position: (",Math.round(p.x),", ",Math.round(p.z),")"]})]}),t.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les détails de la partie"})]})},k=n=>{if(!n)return;const m=n.allDeaths||[n];if(m.length===1)s({selectedGame:m[0].gameId,fromComponent:"Death Location View"});else{const p=m.map(N=>N.gameId).filter(N=>N);s({selectedGameIds:p,fromComponent:"Death Location View"})}},S=n=>n&&c[n]||"var(--text-secondary)",{xDomain:E,zDomain:A}=D.useMemo(()=>{if(b.length===0)return{xDomain:[0,100],zDomain:[0,100]};const n=b.map(T=>T.x),m=b.map(T=>T.z),p=Math.min(...n),N=Math.max(...n),R=Math.min(...m),P=Math.max(...m),W=(N-p)*.1||10,X=(P-R)*.1||10;return{xDomain:[p-W,N+W],zDomain:[R-X,P+X]}},[b]);return f?t.jsx("div",{className:"donnees-attente",children:"Chargement des localisations de mort..."}):g?t.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",g]}):l?t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("label",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Mode :"}),t.jsxs("div",{style:{display:"flex",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",border:"1px solid var(--border-color)",overflow:"hidden"},children:[t.jsx("button",{onClick:()=>w("scatter"),style:{background:y==="scatter"?"var(--accent-primary)":"transparent",color:y==="scatter"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:y==="scatter"?"bold":"normal",transition:"all 0.2s"},children:"Points"}),t.jsx("button",{onClick:()=>w("heatmap"),style:{background:y==="heatmap"?"var(--accent-primary)":"transparent",color:y==="heatmap"?"white":"var(--text-primary)",border:"none",padding:"0.5rem 1rem",fontSize:"0.9rem",cursor:"pointer",fontWeight:y==="heatmap"?"bold":"normal",transition:"all 0.2s"},children:"Carte de chaleur"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("label",{htmlFor:"map-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Carte :"}),t.jsx("select",{id:"map-select",value:x,onChange:n=>a(n.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:v.map(n=>t.jsx("option",{value:n,children:n},n))})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("label",{htmlFor:"death-type-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Type de mort :"}),t.jsxs("select",{id:"death-type-select",value:u,onChange:n=>j(n.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"180px"},children:[t.jsx("option",{value:"all",children:"Tous les types"}),i.map(n=>t.jsx("option",{value:n,children:$(n)},n))]})]})]}),t.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[t.jsxs("div",{className:"lycans-stat-carte",children:[t.jsx("h3",{children:"Morts localisées"}),t.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:o.length})]}),t.jsxs("div",{className:"lycans-stat-carte",children:[t.jsx("h3",{children:"Camp filtré"}),t.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)",fontSize:"1.2rem"},children:e})]}),t.jsxs("div",{className:"lycans-stat-carte",children:[t.jsx("h3",{children:"Type de mort"}),t.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-2)",fontSize:"1.2rem"},children:u==="all"?"Tous":$(u)})]})]}),o.length>0?t.jsx(te,{title:y==="scatter"?"Carte des Morts":"Carte de Chaleur des Morts",children:y==="scatter"?t.jsx("div",{style:{height:600},children:t.jsx(ce,{width:"100%",height:"100%",children:t.jsxs(ue,{margin:{top:20,right:30,left:60,bottom:60},children:[t.jsx(re,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),t.jsx(ne,{dataKey:"x",type:"number",name:"Position X",label:{value:"Position X",position:"bottom",offset:10,style:{fill:"var(--text-secondary)"}},domain:E,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:n=>Math.round(n).toString()}),t.jsx(oe,{dataKey:"z",type:"number",name:"Position Z",label:{value:"Position Z",angle:-90,position:"left",offset:20,style:{fill:"var(--text-secondary)"}},domain:A,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:n=>Math.round(n).toString()}),t.jsx(de,{content:t.jsx(C,{}),cursor:{strokeDasharray:"3 3"}}),t.jsx(fe,{data:b,onClick:n=>k(n),onMouseEnter:n=>M(n),onMouseLeave:()=>M(null),style:{cursor:"pointer"},children:b.map((n,m)=>{const p=r.highlightedPlayer===n.playerName,N=h?.playerName===n.playerName&&h?.gameId===n.gameId,R=n.deathCount>1?7:5,P=R+2;return t.jsx(se,{fill:p?"var(--accent-primary)":S(n.deathType),stroke:p||N?"white":n.deathCount>1?"var(--accent-secondary)":"none",strokeWidth:p?3:N?2:n.deathCount>1?1:0,opacity:p?1:.7,r:p?P:N?R+1:R},`cell-${m}`)})})]})})}):t.jsx("div",{style:{padding:"2rem 0",display:"flex",justifyContent:"center"},children:t.jsx(qe,{deathLocations:o,xDomain:E,zDomain:A,width:800,height:600,bandwidth:25,onRegionClick:n=>{if(n.length===1)s({selectedGame:n[0].gameId,fromComponent:"Death Location View (Heatmap)"});else{const m=n.map(p=>p.gameId).filter(p=>p);s({selectedGameIds:m,fromComponent:"Death Location View (Heatmap)"})}}})})}):t.jsxs("div",{className:"donnees-manquantes",style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[t.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"1rem"},children:"Aucune localisation de mort disponible pour les filtres sélectionnés"}),t.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Les données de position ne sont disponibles que pour les parties récentes (non-legacy)."})]}),o.length>0&&t.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--text-primary)"},children:"Légende des types de mort"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.5rem"},children:i.map(n=>{const m=o.filter(p=>p.deathType===n).length;return m===0?null:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[t.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:c[n],flexShrink:0}}),t.jsxs("span",{style:{color:"var(--text-primary)"},children:[$(n)," (",m,")"]})]},n)})})]}),t.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[t.jsx("p",{children:t.jsx("strong",{children:"À propos de cette visualisation :"})}),t.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[t.jsx("li",{children:"Les positions sont basées sur les coordonnées X et Z (vue 2D de la carte)"}),y==="scatter"?t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Chaque point représente la mort d'un joueur à un endroit précis"}),t.jsx("li",{children:"La couleur indique le type de mort (voir légende ci-dessus)"}),t.jsxs("li",{children:["Les joueurs en surbrillance sont affichés en "," ",t.jsx("span",{style:{color:"var(--accent-primary)",fontWeight:"bold"},children:"couleur primaire"})]}),t.jsx("li",{children:"Cliquez sur un point pour voir les détails de la partie"}),t.jsx("li",{children:"Survolez un point pour voir les informations détaillées"})]}):t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"La carte de chaleur montre les zones de forte densité de morts (du jaune au rouge)"}),t.jsx("li",{children:"Les points noirs indiquent l'emplacement exact de chaque mort"}),t.jsx("li",{children:"Les zones rouges indiquent une concentration élevée de morts"}),t.jsx("li",{children:"Cliquez sur une zone pour voir les détails des parties associées"}),t.jsx("li",{children:'Utilisez le mode "Points" pour voir les détails individuels par type de mort'})]})]}),t.jsx("p",{style:{marginTop:"0.5rem",fontStyle:"italic",color:"var(--text-secondary)"},children:"Note : Seules les parties récentes contiennent des données de position. Les parties legacy sont exclues."})]})]}):t.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée disponible"})}export{Ke as DeathLocationView};
