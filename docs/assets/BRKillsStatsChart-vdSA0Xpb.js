import{a as I,r as P,j as e}from"./index-jeiTTNsi.js";import{F as A,B as K,C as N,X as T,Y as k,a as z,b as w}from"./FullscreenChart-D4ItO_Im.js";import{u as O}from"./useRawBRData-CpkdkVI4.js";import{u as $}from"./useJoueursData-BQWrC3pW.js";import{u as L,g as W}from"./api-DNLfYS_r.js";import{R,T as B}from"./CategoricalChart-YMxQv2wp.js";import{P as V,a as X}from"./PieChart-DpdNMpbL.js";import"./PolarChart-qMYDx_lz.js";const Y=[3,10,25,50,100];function ie(){const{data:x,isLoading:F,error:D}=O(),{settings:o}=I(),{joueursData:H}=$(),[M,C]=P.useState(null),[h,G]=P.useState(3),q=L(H),u=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],E=i=>q[i]||W(i),l=P.useMemo(()=>{if(!x)return null;const i=x.length,s=x.reduce((r,a)=>{const n=a.Participants;return r[n]||(r[n]={name:n,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),r[n].participations++,r[n].totalScore+=a.Score,a.Gagnant&&r[n].wins++,r},{});Object.values(s).forEach(r=>{r.averageScore=r.totalScore/r.participations,r.winRate=r.wins/r.participations*100});const t=Object.values(s).filter(r=>r.participations>=h),c=t.sort((r,a)=>a.averageScore-r.averageScore).slice(0,15),g=Object.values(s).sort((r,a)=>a.participations-r.participations),b=o.highlightedPlayer&&c.some(r=>r.name===o.highlightedPlayer);let v=!1,m=[...c];if(o.highlightedPlayer&&!b){const r=g.find(a=>a.name===o.highlightedPlayer);r&&(m.push({...r,isHighlightedAddition:!0}),v=!0)}const y=x.reduce((r,a)=>{const n=a.Score,p=n===0?"0":n===1?"1":n===2?"2":n===3?"3":n===4?"4":n<=6?"5-6":"7+";return r[p]||(r[p]={count:0,wins:0}),r[p].count++,a.Gagnant&&r[p].wins++,r},{}),j=Object.entries(y).map(([r,a])=>({range:r,count:a.count,wins:a.wins,percentage:(a.count/i*100).toFixed(1),winRate:a.count>0?(a.wins/a.count*100).toFixed(1):"0.0"})),f=x.filter(r=>r.Gagnant).reduce((r,a)=>{const n=a.Score;return r[n]||(r[n]=0),r[n]++,r},{}),S=Object.entries(f).map(([r,a])=>({score:parseInt(r),count:a,percentage:(a/Object.values(f).reduce((n,p)=>n+p,0)*100).toFixed(1)})).sort((r,a)=>r.score-a.score);return{topPlayersByAverageScore:m,scoreData:j,winnerScoreData:S,highlightedPlayerInAverageScore:v,totalEligiblePlayers:t.length}},[x,o.highlightedPlayer,h]);return F?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):D?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",D]}):l?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Statistiques Kills - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Kill Moyen par Partie"}),l.highlightedPlayerInAverageScore&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",o.highlightedPlayer," affichÃ© en plus du top 15"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-avg-score-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-avg-score-select",value:h,onChange:i=>G(Number(i.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:Y.map(i=>e.jsx("option",{value:i,children:i},i))})]})]}),e.jsx(A,{title:"Kill Moyen par Partie - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(R,{width:"100%",height:400,children:e.jsxs(K,{data:l.topPlayersByAverageScore,children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:i,y:s,payload:t})=>e.jsx("text",{x:i,y:s,dy:16,textAnchor:"end",fill:o.highlightedPlayer===t.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===t.value?14:12,fontWeight:o.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${i} ${s})`,children:t.value})}),e.jsx(k,{}),e.jsx(B,{content:({active:i,payload:s})=>{if(i&&s&&s.length>0){const t=s[0].payload,d=t.isHighlightedAddition,c=o.highlightedPlayer===t.name,g=t.participations>=h;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,c&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Kill total: ",e.jsx("strong",{children:t.totalScore})]}),e.jsxs("div",{children:["Kill moyen: ",e.jsx("strong",{children:t.averageScore.toFixed(2)})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate.toFixed(1),"%"]})]})]}),d&&!g&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",h," partie",h>1?"s":"",")"]}),d&&g&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(z,{dataKey:"averageScore",name:"Kill moyen par partie",children:l.topPlayersByAverageScore.map((i,s)=>{const t=o.highlightedPlayer===i.name,d=M===i.name,c=i.isHighlightedAddition;return e.jsx(w,{fill:t?"var(--accent-primary)":c?"var(--accent-secondary)":E(i.name),stroke:t?"var(--accent-primary)":d?"var(--text-primary)":"none",strokeWidth:t?3:d?2:0,strokeDasharray:c?"5,5":"none",opacity:c?.8:1,onMouseEnter:()=>C(i.name),onMouseLeave:()=>C(null),style:{cursor:"pointer"}},`cell-${s}`)})})]})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",l.topPlayersByAverageScore.length," des joueurs (sur ",l.totalEligiblePlayers," ayant au moins ",h," partie",h>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills"}),e.jsx(A,{title:"Distribution des Kills",className:"lycans-chart-wrapper",children:e.jsx(R,{width:"100%",height:400,children:e.jsxs(V,{children:[e.jsx(X,{data:l.scoreData,cx:"50%",cy:"50%",labelLine:!1,label:i=>{const{cx:s,cy:t,midAngle:d,outerRadius:c,range:g,percentage:b,fill:v}=i,m=Math.PI/180,y=c+30,j=s+y*Math.cos(-d*m),f=t+y*Math.sin(-d*m),S=g==="7+"?-12:0;return e.jsx("text",{x:j,y:f+S,fill:v,textAnchor:j>s?"start":"end",dominantBaseline:"central",children:`${g}: ${b}%`})},outerRadius:140,fill:"#8884d8",dataKey:"count",children:l.scoreData.map((i,s)=>e.jsx(w,{fill:u[s%u.length]},`cell-${s}`))}),e.jsx(B,{content:({active:i,payload:s})=>{if(i&&s&&s.length>0){const t=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.range," ",t.range==="1"?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Nombre de parties: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate,"%"]})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"4px"},children:["(",t.wins," victoire",t.wins!==1?"s":"",")"]})]})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills des Gagnants"}),e.jsx(A,{title:"Distribution des Kills des Gagnants",className:"lycans-chart-wrapper",children:e.jsx(R,{width:"100%",height:400,children:e.jsxs(K,{data:l.winnerScoreData,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(N,{strokeDasharray:"3 3"}),e.jsx(T,{dataKey:"score",label:{value:"Nombre de kills",position:"insideBottom",offset:-5}}),e.jsx(k,{label:{value:"Nombre de victoires",angle:-90,position:"insideLeft"}}),e.jsx(B,{content:({active:i,payload:s})=>{if(i&&s&&s.length>0){const t=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.score," ",t.score===1?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]})]})]})}return null}}),e.jsx(z,{dataKey:"count",name:"Victoires",children:l.winnerScoreData.map((i,s)=>e.jsx(w,{fill:u[s%u.length]},`cell-${s}`))})]})})})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{ie as BRKillsStatsChart};
