import{r as c,j as e}from"./index-BFKR9s5X.js";import{l as u}from"./api-4z_uY0SA.js";import{R as m,B as p,C as x,X as g,Y as j,T as f,a as v,b as y}from"./BarChart-DDwYEYEi.js";import{L as R}from"./Legend-TsdIqW9E.js";function b(){const[r,l]=c.useState(null),[i,n]=c.useState(!0),[t,s]=c.useState(null);return c.useEffect(()=>{(async()=>{try{n(!0),s(null);const d=await fetch("https://script.google.com/macros/s/AKfycbxrhG1mb7N6q7Mg88ogw0mirXgSihPpNPurZwiEOy9miG24Cc3AlGZCn2uoGnygNhck/exec?action=campWinStats");if(!d.ok)throw new Error(`Erreur réseau: ${d.status}`);const h=await d.json();if(h.error)throw new Error(h.error);l(h)}catch(o){console.error("Erreur lors du chargement des statistiques de victoire:",o),s(o instanceof Error?o.message:"Erreur inconnue")}finally{n(!1)}})()},[]),{campWinStats:r,isLoading:i,errorInfo:t}}const w="#607D8B";function A(){const{campWinStats:r,isLoading:l,errorInfo:i}=b();if(l)return e.jsx("div",{className:"statistiques-chargement",children:"Chargement des statistiques de victoire..."});if(i)return e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",i]});if(!r||!r.campStats||r.campStats.length===0)return e.jsx("div",{className:"statistiques-vide",children:"Aucune donnée de victoire disponible"});const n=r?.soloCamps?.map(t=>({...t,pourcentage:(t.appearances/r.totalGames*100).toFixed(2)}))||[];return e.jsxs("div",{className:"lycans-stats-container",children:[e.jsx("h2",{children:"Statistiques de Victoire par Camp"}),e.jsxs("p",{children:["Total des parties: ",r.totalGames]}),e.jsx("div",{className:"lycans-chart-wrapper",style:{height:400},children:e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(p,{data:r.campStats,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(x,{strokeDasharray:"3 3"}),e.jsx(g,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(j,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(f,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const a=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:a.camp}),e.jsxs("div",{children:["Victoires : ",a.wins]}),e.jsxs("div",{children:["Taux de victoire : ",a.winRate,"%"]})]})}return null}}),e.jsx(R,{formatter:t=>t==="winRate"?"Taux de victoire":t}),e.jsx(v,{dataKey:"winRate",name:"winRate",fill:"#82ca9d",children:r.campStats.map((t,s)=>e.jsx(y,{fill:u[t.camp]||w},`cellule-${s}`))})]})})}),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Statistiques de Fréquence des rôles solo"}),e.jsx("div",{className:"lycans-chart-wrapper",style:{height:400},children:e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(p,{data:n,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(x,{strokeDasharray:"3 3"}),e.jsx(g,{dataKey:"soloRole",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(j,{label:{value:"Fréquence (%)",angle:-90,position:"insideLeft"},domain:[0,Math.max(...n.map(t=>parseFloat(t.pourcentage)))+5]}),e.jsx(f,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const a=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:a.soloRole}),e.jsxs("div",{children:["Apparitions : ",a.appearances]}),e.jsxs("div",{children:["Fréquence : ",a.pourcentage,"%"]})]})}return null}}),e.jsx(R,{formatter:t=>t==="pourcentage"?"Fréquence d'apparition":t}),e.jsx(v,{dataKey:"pourcentage",name:"pourcentage",fill:"#8884d8",children:n.map((t,s)=>e.jsx(y,{fill:u[t.soloRole]||w},`cellule-solo-${s}`))})]})})})]})]})}export{A as CampsAndRolesRateChart};
