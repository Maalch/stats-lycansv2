import{u as ee,a as te,d as me,r as I,g as se,e as le,j as e,h as ue}from"./index-LVYDAP6R.js";import{g as ne,u as ye,a as ve,b as pe,c as xe}from"./useDeathStatisticsFromRaw-C9Ip-2O5.js";import{u as fe}from"./baseStatsHook-Cm8zmMYM.js";import{g as je,D as q}from"./datasyncExport-CjB7UYqV.js";import{M as ce,C as he,u as ie,m as re,b as ge,a as Se}from"./api-BbOyYR7b.js";import{D as G,g as oe}from"./deathTypes-gHH1w6_X.js";import{F as $,C as w,X as U,Y as O,a as Z}from"./FullscreenChart-D1l801Md.js";import{u as ae}from"./useJoueursData-kbBChZhV.js";import{R as _,T as J}from"./CategoricalChart-BIFtBUB9.js";import{B as Y,a as X}from"./BarChart-D-L3xl4m.js";function de(n){if(!n||n.trim()==="")return null;const m=n.trim().slice(1),v=parseInt(m,10);return isNaN(v)||v<1?null:v}function Pe(n,x){if(n.length===0)return null;const m={},v={};n.forEach(A=>{let l=1;if(A.EndTiming){const y=de(A.EndTiming);y&&(l=y)}A.PlayerStats.forEach(y=>{if(x&&x!=="Tous les camps"&&je(y.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==x)return;const h=y.Username;m[h]||(m[h]={playerName:h,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const M=m[h];M.totalGames++;let E=null;y.DeathTiming&&(E=de(y.DeathTiming));for(let R=1;R<=l;R++)M.gamesPlayedByDay[R]||(M.gamesPlayedByDay[R]=0,M.survivalsByDay[R]=0),v[R]||(v[R]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),M.gamesPlayedByDay[R]++,v[R].playersOnDay++,(!E||E>R)&&(M.survivalsByDay[R]++,v[R].survivorsOnDay++)});for(let y=1;y<=l;y++)v[y]||(v[y]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),v[y].gamesReachingDay++}),Object.values(m).forEach(A=>{Object.keys(A.gamesPlayedByDay).forEach(l=>{const y=parseInt(l),h=A.gamesPlayedByDay[y],M=A.survivalsByDay[y];h>0?A.survivalRatesByDay[y]=M/h*100:A.survivalRatesByDay[y]=0})});const u=Object.values(m).filter(A=>A.totalGames>0).sort((A,l)=>l.totalGames-A.totalGames),W=Object.entries(v).map(([A,l])=>({dayNumber:parseInt(A),totalGamesReachingDay:l.gamesReachingDay,totalPlayersOnDay:l.playersOnDay,averageSurvivalRate:l.playersOnDay>0?l.survivorsOnDay/l.playersOnDay*100:0})).sort((A,l)=>A.dayNumber-l.dayNumber);return{totalGames:n.length,totalPlayersAnalyzed:u.length,playerSurvivalStats:u,dayStats:W}}function De(n,x,m=ce.MEDIUM){return n.playerSurvivalStats.filter(v=>v.totalGames>=m&&(v.gamesPlayedByDay[x]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[x]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[x]||0,timesSurvivedDay:v.survivalsByDay[x]||0})).sort((v,u)=>u.survivalRate-v.survivalRate).slice(0,he.TOP_15)}function be(n,x,m=ce.MEDIUM){return n.playerSurvivalStats.filter(v=>v.totalGames>=m&&(v.gamesPlayedByDay[x]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[x]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[x]||0,timesSurvivedDay:v.survivalsByDay[x]||0})).sort((v,u)=>v.survivalRate-u.survivalRate).slice(0,he.TOP_15)}function Ae(n){return fe(x=>Pe(x,n))}function Te({deathStats:n,selectedCamp:x,victimCampFilter:m,minGamesForAverage:v,onMinGamesChange:u,availableDeathTypes:W,deathTypeColors:A,totalEligibleForAverage:l}){const{navigateToGameDetails:y}=ee(),{settings:h}=te(),{gameData:M}=me(),{joueursData:E}=ae(),R=ie(E),V=t=>{if(m==="Tous les camps"){const r=t.filter(c=>c!==G.BULLET_HUMAN&&c!==G.BULLET_WOLF);return(t.includes(G.BULLET_HUMAN)||t.includes(G.BULLET_WOLF))&&!r.includes(G.BULLET)&&r.push(G.BULLET),r}return t},L=I.useMemo(()=>V(W),[W,m]),T=I.useMemo(()=>{const t={...A};if(m==="Tous les camps"&&!t[G.BULLET]){const r=A[G.BULLET_HUMAN]||A[G.BULLET_WOLF];r&&(t[G.BULLET]=r)}return t},[A,m]),p=t=>{if(m==="Tous les camps"){const r=t.killsByDeathType[G.BULLET_HUMAN]||0,c=t.killsByDeathType[G.BULLET_WOLF]||0,i=t.killsByDeathType[G.BULLET]||0,o={...t.killsByDeathType};return o[G.BULLET]=r+c+i,delete o[G.BULLET_HUMAN],delete o[G.BULLET_WOLF],{...t,killsByDeathType:o}}return t},H=t=>{let r="Top Tueurs";return x!=="Tous les camps"&&(r+=` en ${x}`),m!=="Tous les camps"&&(m==="Roles solo"?r+=" (victimes: Roles solo)":r+=` (victimes: ${m})`),t==="total"?r+=" (Total)":r+=" (Moyenne par Partie)",r},{totalKillsData:d,averageKillsData:g,highlightedPlayerAddedToTotal:b,highlightedPlayerAddedToAverage:j}=I.useMemo(()=>{if(!n)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const t=n.killerStats.sort((C,f)=>f.kills-C.kills).slice(0,15),r=h.highlightedPlayer&&t.some(C=>C.killerName===h.highlightedPlayer),c=t.map(C=>{const f=p(C),B={name:f.killerName,value:f.kills,victims:f.victims.length,percentage:f.percentage,gamesPlayed:f.gamesPlayed,averageKillsPerGame:f.averageKillsPerGame,isHighlightedAddition:!1};return L.forEach(F=>{B[F]=f.killsByDeathType[F]||0}),B});let i=!1;if(h.highlightedPlayer&&!r){const C=n.killerStats.find(f=>f.killerName===h.highlightedPlayer);if(C){const f=p(C),B={name:f.killerName,value:f.kills,victims:f.victims.length,percentage:f.percentage,gamesPlayed:f.gamesPlayed,averageKillsPerGame:f.averageKillsPerGame,isHighlightedAddition:!0};L.forEach(F=>{B[F]=f.killsByDeathType[F]||0}),c.push(B),i=!0}}const z=n.killerStats.filter(C=>C.gamesPlayed>=v).sort((C,f)=>f.averageKillsPerGame-C.averageKillsPerGame).slice(0,15),P=h.highlightedPlayer&&z.some(C=>C.killerName===h.highlightedPlayer),k=z.map(C=>{const f=p(C),B={name:f.killerName,value:f.averageKillsPerGame,victims:f.victims.length,percentage:f.percentage,gamesPlayed:f.gamesPlayed,averageKillsPerGame:f.averageKillsPerGame,isHighlightedAddition:!1};return L.forEach(F=>{const Q=f.killsByDeathType[F]||0;B[F]=f.gamesPlayed>0?Q/f.gamesPlayed:0}),B});let K=!1;if(h.highlightedPlayer&&!P){const C=n.killerStats.find(f=>f.killerName===h.highlightedPlayer);if(C){const f=p(C),B={name:f.killerName,value:f.averageKillsPerGame,victims:f.victims.length,percentage:f.percentage,gamesPlayed:f.gamesPlayed,averageKillsPerGame:f.averageKillsPerGame,isHighlightedAddition:!0};L.forEach(F=>{const Q=f.killsByDeathType[F]||0;B[F]=f.gamesPlayed>0?Q/f.gamesPlayed:0}),k.push(B),K=!0}}return{totalKillsData:c,averageKillsData:k,highlightedPlayerAddedToTotal:i,highlightedPlayerAddedToAverage:K}},[n,h.highlightedPlayer,v,L,m]),s=({active:t,payload:r,label:c})=>{if(t&&r&&r.length){const i=r[0].payload,o=i.isHighlightedAddition,z=h.highlightedPlayer===i.name,P=L.reduce((k,K)=>k+(i[K]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:z?"var(--accent-primary)":"var(--text-primary)"},children:[c,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",P]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),L.map(k=>({deathType:k,count:i[k]||0})).filter(k=>k.count>0).sort((k,K)=>K.count-k.count).map(({deathType:k,count:K})=>e.jsxs("p",{style:{color:T[k],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ne(k),":"]})," ",K]},k))]}),o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),z&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},D=({active:t,payload:r,label:c})=>{if(t&&r&&r.length){const i=r[0].payload,o=i.isHighlightedAddition,z=h.highlightedPlayer===i.name,P=i.gamesPlayed>=v,k=n?.killerStats.find(B=>B.killerName===i.name),K=k?p(k):null,C=L.reduce((B,F)=>B+(i[F]||0),0),f=K?K.kills:Math.round(C*i.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:z?"var(--accent-primary)":"var(--text-primary)"},children:[c,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",C.toFixed(2)," (",f," kills /",i.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),L.map(B=>({deathType:B,avgCount:i[B]||0,totalKillsForDeathType:K?K.killsByDeathType[B]||0:Math.round((i[B]||0)*i.gamesPlayed)})).filter(B=>B.avgCount>0).sort((B,F)=>F.avgCount-B.avgCount).map(({deathType:B,avgCount:F,totalKillsForDeathType:Q})=>e.jsxs("p",{style:{color:T[B],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ne(B),":"]})," ",F.toFixed(2)," (",Q," kills /",i.gamesPlayed," games)"]},B))]}),o&&!P&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",v," parties)"]}),o&&P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),z&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},N=I.useMemo(()=>{if(!M)return[];const t=new Map;M.forEach(i=>{i.PlayerStats.forEach(o=>{const z=se(o),P=le(o);let k=0;if(i.PlayerStats.forEach(K=>{K.KillerName===o.Username&&K.DeathTiming&&k++}),k>0){const K=t.get(z);K?k>K.maxKills?(K.maxKills=k,K.timesAchieved=1,K.gameIds=[i.DisplayedId]):k===K.maxKills&&(K.timesAchieved++,K.gameIds.includes(i.DisplayedId)||K.gameIds.push(i.DisplayedId)):t.set(z,{playerName:P,maxKills:k,timesAchieved:1,gameIds:[i.DisplayedId]})}})});const r=Array.from(t.values()).sort((i,o)=>o.maxKills!==i.maxKills?o.maxKills-i.maxKills:o.timesAchieved-i.timesAchieved).slice(0,15),c=h.highlightedPlayer&&r.some(i=>i.playerName===h.highlightedPlayer);if(h.highlightedPlayer&&!c){const i=Array.from(t.values()).find(o=>o.playerName===h.highlightedPlayer);i&&r.push({...i})}return r.map((i,o)=>({name:i.playerName,value:i.maxKills,timesAchieved:i.timesAchieved,gameIds:i.gameIds,isHighlightedAddition:o>=15}))},[M,h.highlightedPlayer]),S=I.useMemo(()=>{if(!M)return[];const t=new Map;M.forEach(i=>{const o=new Map;i.PlayerStats.forEach(z=>{if(z.KillerName&&z.DeathTiming&&z.DeathTiming.match(/^N\d+$/)){const P=z.KillerName,k=z.DeathTiming;o.has(P)||o.set(P,new Map);const K=o.get(P);K.set(k,(K.get(k)||0)+1)}}),o.forEach((z,P)=>{const k=Math.max(...Array.from(z.values())),K=i.PlayerStats.find(F=>F.Username===P);if(!K)return;const C=se(K),f=le(K),B=t.get(C);B?k>B.maxKills?(B.maxKills=k,B.timesAchieved=1,B.gameIds=[i.DisplayedId]):k===B.maxKills&&(B.timesAchieved++,B.gameIds.includes(i.DisplayedId)||B.gameIds.push(i.DisplayedId)):t.set(C,{playerName:f,maxKills:k,timesAchieved:1,gameIds:[i.DisplayedId]})})});const r=Array.from(t.values()).sort((i,o)=>o.maxKills!==i.maxKills?o.maxKills-i.maxKills:o.timesAchieved-i.timesAchieved).slice(0,15),c=h.highlightedPlayer&&r.some(i=>i.playerName===h.highlightedPlayer);if(h.highlightedPlayer&&!c){const i=Array.from(t.values()).find(o=>o.playerName===h.highlightedPlayer);i&&r.push({...i})}return r.map((i,o)=>({name:i.playerName,value:i.maxKills,timesAchieved:i.timesAchieved,gameIds:i.gameIds,isHighlightedAddition:o>=15}))},[M,h.highlightedPlayer]),a=({active:t,payload:r,label:c,chartType:i})=>{if(t&&r&&r.length){const o=r[0].payload,z=h.highlightedPlayer===o.name,P=o.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:z?"var(--accent-primary)":"var(--text-primary)"},children:[c,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsxs("strong",{children:[i==="game"?"Max kills en une partie":"Max kills en une nuit",":"]})," ",o.value]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Nombre de fois:"})," ",o.timesAchieved]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"4px 0",fontSize:"0.8rem"},children:[o.gameIds.length," partie",o.gameIds.length>1?"s":""," concernÃ©e",o.gameIds.length>1?"s":""]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),z&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:H("total")}),b&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:H("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:d,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:r,payload:c})=>e.jsx("text",{x:t,y:r,dy:10,fill:h.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===c.value?14:12,fontWeight:h.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${r})`,children:c.value})}),e.jsx(O,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(s,{})}),L.map(t=>e.jsx(X,{dataKey:t,name:t,stackId:"kills",fill:T[t],onClick:r=>{const c={selectedPlayer:r?.name,fromComponent:"Statistiques de Mort"};x!=="Tous les camps"&&(c.campFilter={selectedCamp:x,campFilterMode:"all-assignments"}),y(c)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,d.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:H("average")}),j&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:v,onChange:t=>u(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:re.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx($,{title:H("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:g,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:r,payload:c})=>e.jsx("text",{x:t,y:r,dy:10,fill:h.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===c.value?14:12,fontWeight:h.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${r})`,children:c.value})}),e.jsx(O,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(D,{})}),L.map(t=>e.jsx(X,{dataKey:t,name:t,stackId:"averageKills",fill:T[t],onClick:r=>{const c={selectedPlayer:r?.name,fromComponent:"Statistiques de Mort"};x!=="Tous les camps"&&(c.campFilter={selectedCamp:x,campFilterMode:"all-assignments"}),y(c)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,g.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",l," ayant au moins ",v," partie",v>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Record de Kills en une Partie"}),N.some(t=>t.isHighlightedAddition)&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:"Record de Kills en une Partie",children:e.jsx("div",{style:{height:440},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:N,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:r,payload:c})=>e.jsx("text",{x:t,y:r,dy:10,fill:h.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===c.value?14:12,fontWeight:h.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${r})`,children:c.value})}),e.jsx(O,{label:{value:"Nombre max de kills en une partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:t=>e.jsx(a,{...t,chartType:"game"})}),e.jsx(X,{dataKey:"value",children:N.map((t,r)=>{const c=h.highlightedPlayer===t.name,i=t.isHighlightedAddition;return e.jsx(Z,{fill:R[t.name]||(c?"var(--accent-primary)":i?"var(--accent-secondary)":"var(--chart-primary)"),stroke:c?"var(--accent-primary)":"none",strokeWidth:c?3:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1,onClick:()=>{if(t?.gameIds&&t.gameIds.length>0){const o={fromComponent:"Statistiques de Mort - Max Kills par Partie"};t.gameIds.length===1?o.selectedGame=t.gameIds[0]:o.selectedGameIds=t.gameIds,x!=="Tous les camps"&&(o.campFilter={selectedCamp:x,campFilterMode:"all-assignments"}),y(o)}},style:{cursor:"pointer"}},`cell-${r}`)})})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:"Nombre maximum de kills rÃ©alisÃ©s en une seule partie"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Record de Kills en une Nuit"}),S.some(t=>t.isHighlightedAddition)&&h.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',h.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:"Record de Kills en une Nuit",children:e.jsx("div",{style:{height:440},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:S,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:r,payload:c})=>e.jsx("text",{x:t,y:r,dy:10,fill:h.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:h.highlightedPlayer===c.value?14:12,fontWeight:h.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${r})`,children:c.value})}),e.jsx(O,{label:{value:"Nombre max de kills en une nuit",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:t=>e.jsx(a,{...t,chartType:"night"})}),e.jsx(X,{dataKey:"value",children:S.map((t,r)=>{const c=h.highlightedPlayer===t.name,i=t.isHighlightedAddition;return e.jsx(Z,{fill:R[t.name]||(c?"var(--accent-primary)":i?"var(--accent-secondary)":"var(--chart-secondary)"),stroke:c?"var(--accent-primary)":"none",strokeWidth:c?3:0,strokeDasharray:i?"5,5":"none",opacity:i?.8:1,onClick:()=>{if(t?.gameIds&&t.gameIds.length>0){const o={fromComponent:"Statistiques de Mort - Max Kills par Nuit"};t.gameIds.length===1?o.selectedGame=t.gameIds[0]:o.selectedGameIds=t.gameIds,x!=="Tous les camps"&&(o.campFilter={selectedCamp:x,campFilterMode:"all-assignments"}),y(o)}},style:{cursor:"pointer"}},`cell-${r}`)})})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:"Nombre maximum de kills rÃ©alisÃ©s en une seule nuit (timing NX)"})]})]})}function Ne({deathStats:n,selectedCamp:x,minGamesForAverage:m,onMinGamesChange:v,availableDeathTypes:u,deathTypeColors:W}){const{navigateToGameDetails:A}=ee(),{settings:l}=te(),{joueursData:y}=ae(),h=ie(y),[M,E]=I.useState(null),{totalDeathsData:R,survivalRateData:V,highlightedPlayerAddedToDeaths:L,highlightedPlayerAddedToSurvival:T}=I.useMemo(()=>{if(!n)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const d=n.playerDeathStats.sort((t,r)=>r.totalDeaths-t.totalDeaths).slice(0,15),g=l.highlightedPlayer&&d.some(t=>t.playerName===l.highlightedPlayer),b=d.map(t=>{const r=t.gamesPlayed,c=r>0?(r-t.totalDeaths)/r*100:0,i={name:t.playerName,value:t.totalDeaths,totalDeaths:t.totalDeaths,gamesPlayed:r,deathRate:t.deathRate,survivalRate:c,isHighlightedAddition:!1};return u.forEach(o=>{i[o]=t.deathsByType[o]||0}),i});let j=!1;if(l.highlightedPlayer&&!g){const t=n.playerDeathStats.find(r=>r.playerName===l.highlightedPlayer);if(t){const r=t.gamesPlayed,c=r>0?(r-t.totalDeaths)/r*100:0,i={name:t.playerName,value:t.totalDeaths,totalDeaths:t.totalDeaths,gamesPlayed:r,deathRate:t.deathRate,survivalRate:c,isHighlightedAddition:!0};u.forEach(o=>{i[o]=t.deathsByType[o]||0}),b.push(i),j=!0}}const D=n.playerDeathStats.filter(t=>t.gamesPlayed>=m).map(t=>({...t,survivalRate:t.gamesPlayed>0?(t.gamesPlayed-t.totalDeaths)/t.gamesPlayed*100:0})).sort((t,r)=>r.survivalRate-t.survivalRate).slice(0,15),N=l.highlightedPlayer&&D.some(t=>t.playerName===l.highlightedPlayer),S=D.map(t=>{const r={name:t.playerName,value:t.survivalRate,totalDeaths:t.totalDeaths,gamesPlayed:t.gamesPlayed,deathRate:t.deathRate,survivalRate:t.survivalRate,isHighlightedAddition:!1};return u.forEach(c=>{r[c]=t.deathsByType[c]||0}),r});let a=!1;if(l.highlightedPlayer&&!N){const t=n.playerDeathStats.find(r=>r.playerName===l.highlightedPlayer);if(t){const r=t.gamesPlayed>0?(t.gamesPlayed-t.totalDeaths)/t.gamesPlayed*100:0,c={name:t.playerName,value:r,totalDeaths:t.totalDeaths,gamesPlayed:t.gamesPlayed,deathRate:t.deathRate,survivalRate:r,isHighlightedAddition:!0};u.forEach(i=>{c[i]=t.deathsByType[i]||0}),S.push(c),a=!0}}return{totalDeathsData:b,survivalRateData:S,highlightedPlayerAddedToDeaths:j,highlightedPlayerAddedToSurvival:a}},[n,l.highlightedPlayer,m,u]),p=({active:d,payload:g,label:b})=>{if(d&&g&&g.length){const j=g[0].payload,s=j.isHighlightedAddition,D=l.highlightedPlayer===j.name,N=u.reduce((S,a)=>S+(j[a]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:D?"var(--accent-primary)":"var(--text-primary)"},children:[b,s&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",N]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",j.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",j.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),u.map(S=>{const a=j[S]||0;return a===0?null:e.jsxs("p",{style:{color:W[S],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[oe(S),":"]})," ",a]},S)})]}),s&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),D&&!s&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},H=({active:d,payload:g,label:b})=>{if(d&&g&&g.length){const j=g[0].payload,s=j.isHighlightedAddition,D=l.highlightedPlayer===j.name,N=j.gamesPlayed>=m;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:D?"var(--accent-primary)":"var(--text-primary)"},children:[b,s&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",j.survivalRate.toFixed(1),"% (",j.gamesPlayed-j.totalDeaths," survies / ",j.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",j.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",j.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),u.map(S=>{const a=j[S]||0;return a===0?null:e.jsxs("p",{style:{color:W[S],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[oe(S),":"]})," ",a]},S)})]}),s&&!N&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",m," parties)"]}),s&&N&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),D&&!s&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:x==="Tous les camps"?"Morts (Total)":`Morts en ${x} (Total)`}),L&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:x==="Tous les camps"?"Morts (Total)":`Morts en ${x} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:d,y:g,payload:b})=>e.jsx("text",{x:d,y:g,dy:10,fill:l.highlightedPlayer===b.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===b.value?14:12,fontWeight:l.highlightedPlayer===b.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${d} ${g})`,children:b.value})}),e.jsx(O,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(p,{})}),u.map(d=>e.jsx(X,{dataKey:d,name:d,stackId:"deaths",fill:W[d],onClick:g=>{const b={selectedPlayer:g?.name,fromComponent:"Statistiques de Mort"};x!=="Tous les camps"&&(b.campFilter={selectedCamp:x,campFilterMode:"all-assignments"}),A(b)}},d))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(d=>!d.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",x==="Tous les camps"?"(Total)":` en ${x}`]}),T&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:m,onChange:d=>v(Number(d.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:re.map(d=>e.jsx("option",{value:d,children:d},d))})]}),e.jsx($,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:V,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:d,y:g,payload:b})=>e.jsx("text",{x:d,y:g,dy:10,fill:l.highlightedPlayer===b.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===b.value?14:12,fontWeight:l.highlightedPlayer===b.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${d} ${g})`,children:b.value})}),e.jsx(O,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(H,{})}),e.jsx(X,{dataKey:"value",onClick:d=>{const g={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};x!=="Tous les camps"&&(g.campFilter={selectedCamp:x,campFilterMode:"all-assignments"}),A(g)},onMouseEnter:d=>E(d?.name||null),onMouseLeave:()=>E(null),style:{cursor:"pointer"},children:V.map((d,g)=>{const b=l.highlightedPlayer===d.name,j=d.isHighlightedAddition;return e.jsx(Z,{fill:h[d.name]||"var(--chart-primary)",stroke:b?"var(--accent-primary)":M===d.name?"var(--text-primary)":"none",strokeWidth:b?3:M===d.name?2:0,strokeDasharray:j?"5,5":"none",opacity:j?.8:1},`cell-${g}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,V.filter(d=>!d.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",m," partie",m>1?"s":"",")"]})]})]})}function Be({hunterStats:n,isLoading:x,error:m}){const{navigateToGameDetails:v}=ee(),{settings:u}=te(),W=ge(),{joueursData:A}=ae(),l=ie(A),[y,h]=I.useState(null);if(x)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(m)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",m]});if(!n||n.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:M,highlightedPlayerAddedToBest:E,finalBadHuntersData:R,highlightedPlayerAddedToBad:V}=(()=>{const H=n.hunterStats.filter(a=>a.gamesPlayedAsHunter>=5).sort((a,t)=>t.averageNonVillageoisKillsPerGame-a.averageNonVillageoisKillsPerGame).slice(0,15),d=u.highlightedPlayer&&H.some(a=>a.hunterName===u.highlightedPlayer);let g=[...H],b=!1;if(u.highlightedPlayer&&!d){const a=n.hunterStats.find(t=>t.hunterName===u.highlightedPlayer);a&&(g.push({...a,isHighlightedAddition:!0}),b=!0)}const j=n.hunterStats.filter(a=>a.gamesPlayedAsHunter>=5).map(a=>({name:a.hunterName,averageVillageoisKills:Number((a.villageoisKills/a.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:a.villageoisKills,totalNonVillageoisKills:a.nonVillageoisKills,totalKills:a.totalKills,gamesPlayed:a.gamesPlayedAsHunter,victimsByCamp:a.victimsByCamp,goodVictimsByCamp:a.goodVictimsByCamp,badVictimsByCamp:a.badVictimsByCamp,hunterName:a.hunterName})),s=j.sort((a,t)=>t.averageVillageoisKills-a.averageVillageoisKills).slice(0,15),D=u.highlightedPlayer&&s.some(a=>a.hunterName===u.highlightedPlayer);let N=[...s],S=!1;if(u.highlightedPlayer&&!D){const a=j.find(t=>t.hunterName===u.highlightedPlayer);a&&(N.push({...a,isHighlightedAddition:!0}),S=!0)}return{finalBestHuntersData:g,highlightedPlayerAddedToBest:b,finalBadHuntersData:N,highlightedPlayerAddedToBad:S}})(),L=({active:p,payload:H,label:d})=>{if(p&&H&&H.length){const g=H[0].payload,b=g.isHighlightedAddition,j=u.highlightedPlayer===g.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:j?"var(--accent-primary)":"var(--text-primary)"},children:[d,b&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",g.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",g.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",g.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",g.totalKills]}),g.goodVictimsByCamp&&Object.keys(g.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(g.goodVictimsByCamp).map(([s,D])=>e.jsxs("p",{style:{color:W[s]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[s,":"]})," ",D]},s))]}),b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),j&&!b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},T=({active:p,payload:H,label:d})=>{if(p&&H&&H.length){const g=H[0].payload,b=g.isHighlightedAddition,j=u.highlightedPlayer===g.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:j?"var(--accent-primary)":"var(--text-primary)"},children:[d,b&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",g.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",g.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",g.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",g.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",g.totalKills]}),g.badVictimsByCamp&&Object.keys(g.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(g.badVictimsByCamp).map(([s,D])=>e.jsxs("p",{style:{color:W[s]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[s,":"]})," ",D]},s))]}),b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),j&&!b&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),E&&u.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',u.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:M,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:p,y:H,payload:d})=>e.jsx("text",{x:p,y:H,dy:10,fill:u.highlightedPlayer===d.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:u.highlightedPlayer===d.value?14:12,fontWeight:u.highlightedPlayer===d.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${p} ${H})`,children:d.value})}),e.jsx(O,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(L,{})}),e.jsx(X,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:p=>{p?.hunterName&&v({selectedPlayer:p.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:p=>h(p?.hunterName||null),onMouseLeave:()=>h(null),style:{cursor:"pointer"},children:M.map((p,H)=>{const d=u.highlightedPlayer===p.hunterName,g=p.isHighlightedAddition;return e.jsx(Z,{fill:l[p.hunterName]||W.Chasseur||"#8884d8",stroke:d?"var(--accent-primary)":y===p.hunterName?"var(--text-primary)":"none",strokeWidth:d?3:y===p.hunterName?2:0,strokeDasharray:g?"5,5":"none",opacity:g?.8:1},`cell-${H}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,M.filter(p=>!p.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),V&&u.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',u.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:p,y:H,payload:d})=>e.jsx("text",{x:p,y:H,dy:10,fill:u.highlightedPlayer===d.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:u.highlightedPlayer===d.value?14:12,fontWeight:u.highlightedPlayer===d.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${p} ${H})`,children:d.value})}),e.jsx(O,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(T,{})}),e.jsx(X,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:p=>{p?.hunterName&&v({selectedPlayer:p.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:p=>h(p?.hunterName||null),onMouseLeave:()=>h(null),style:{cursor:"pointer"},children:R.map((p,H)=>{const d=u.highlightedPlayer===p.hunterName,g=p.isHighlightedAddition;return e.jsx(Z,{fill:l[p.hunterName]||W.Chasseur||"#8884d8",stroke:d?"var(--accent-primary)":y===p.hunterName?"var(--text-primary)":"none",strokeWidth:d?3:y===p.hunterName?2:0,strokeDasharray:g?"5,5":"none",opacity:g?.8:1},`cell-${H}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(p=>!p.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function ke({survivalStats:n,selectedCamp:x,minGamesForAverage:m,onMinGamesChange:v,isLoading:u,error:W}){const{navigateToGameDetails:A}=ee(),{settings:l}=te(),{joueursData:y}=ae(),h=ie(y),[M,E]=I.useState(Se.DEFAULT_SELECTED_DAY),[R,V]=I.useState(null),L=I.useMemo(()=>n?n.dayStats.filter(D=>D.totalGamesReachingDay>0).map(D=>D.dayNumber).sort((D,N)=>D-N):[],[n]),T=I.useMemo(()=>L.includes(M)?M:L.length>0?L[0]:1,[M,L]),{highestSurvivalData:p,highlightedPlayerAddedToHighest:H}=I.useMemo(()=>{if(!n)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const s=De(n,T,m),D=l.highlightedPlayer&&s.some(a=>a.playerName===l.highlightedPlayer),N=s.map(a=>({name:a.playerName,value:a.survivalRate,gamesPlayed:a.gamesPlayed,timesReachedDay:a.timesReachedDay,timesSurvivedDay:a.timesSurvivedDay,isHighlightedAddition:!1}));let S=!1;if(l.highlightedPlayer&&!D){const a=n.playerSurvivalStats.find(t=>t.playerName===l.highlightedPlayer);if(a&&a.totalGames>=m&&(a.gamesPlayedByDay[T]||0)>0){const t=a.survivalRatesByDay[T]||0;N.push({name:l.highlightedPlayer,value:t,gamesPlayed:a.totalGames,timesReachedDay:a.gamesPlayedByDay[T]||0,timesSurvivedDay:a.survivalsByDay[T]||0,isHighlightedAddition:!0}),S=!0}}return{highestSurvivalData:N,highlightedPlayerAddedToHighest:S}},[n,T,m,l.highlightedPlayer]),{lowestSurvivalData:d,highlightedPlayerAddedToLowest:g}=I.useMemo(()=>{if(!n)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const s=be(n,T,m),D=l.highlightedPlayer&&s.some(a=>a.playerName===l.highlightedPlayer),N=s.map(a=>({name:a.playerName,value:a.survivalRate,gamesPlayed:a.gamesPlayed,timesReachedDay:a.timesReachedDay,timesSurvivedDay:a.timesSurvivedDay,isHighlightedAddition:!1}));let S=!1;if(l.highlightedPlayer&&!D){const a=n.playerSurvivalStats.find(t=>t.playerName===l.highlightedPlayer);if(a&&a.totalGames>=m&&(a.gamesPlayedByDay[T]||0)>0){const t=a.survivalRatesByDay[T]||0;N.push({name:l.highlightedPlayer,value:t,gamesPlayed:a.totalGames,timesReachedDay:a.gamesPlayedByDay[T]||0,timesSurvivedDay:a.survivalsByDay[T]||0,isHighlightedAddition:!0}),S=!0}}return{lowestSurvivalData:N,highlightedPlayerAddedToLowest:S}},[n,T,m,l.highlightedPlayer]),b=s=>{A({selectedPlayer:s,fromComponent:"Statistiques de Survie"})},j=({active:s,payload:D,label:N})=>{if(s&&D&&D.length>0){const S=D[0].payload,a=S.isHighlightedAddition,t=l.highlightedPlayer===S.name,r=S.gamesPlayed>=m,c=S.timesReachedDay-S.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:N})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",T,": ",S.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",T,": ",S.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",T,": ",S.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",T,": ",c]}),e.jsxs("div",{children:["Total de parties: ",S.gamesPlayed]}),a&&!r&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",m," parties au total)"]}),a&&r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),t&&!a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return u?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):W?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",W]}):n?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",T," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",H||g?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:T,onChange:s=>E(parseInt(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:L.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:m,onChange:s=>v(parseInt(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:re.map(s=>e.jsx("option",{value:s,children:s},s))})]})]})}),T&&n.dayStats.find(s=>s.dayNumber===T)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:T===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${T}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:n.dayStats.find(s=>s.dayNumber===T)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",T]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(n.dayStats.find(s=>s.dayNumber===T)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",m," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:n.playerSurvivalStats.filter(s=>s.totalGames>=m&&(s.gamesPlayedByDay[T]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",T]}),H&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:p,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:s,y:D,payload:N})=>e.jsx("text",{x:s,y:D,dy:16,textAnchor:"end",transform:`rotate(-45, ${s}, ${D})`,fill:l.highlightedPlayer===N.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===N.value?14:12,fontWeight:l.highlightedPlayer===N.value?"bold":"normal",children:N.value})}),e.jsx(O,{tickFormatter:s=>`${s.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(j,{})}),e.jsx(X,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:p.map((s,D)=>{const N=l.highlightedPlayer===s.name,S=R===s.name,a=s.isHighlightedAddition;return e.jsx(Z,{fill:h[s.name]||"var(--chart-primary)",stroke:N?"var(--accent-primary)":S?"var(--text-primary)":"none",strokeWidth:N?3:S?2:0,strokeDasharray:a?"5,5":"none",opacity:a?.8:1,onClick:()=>b(s.name),onMouseEnter:()=>V(s.name),onMouseLeave:()=>V(null),style:{cursor:"pointer"}},`cell-highest-${D}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",T]}),g&&l.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',l.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx($,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(Y,{data:d,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:s,y:D,payload:N})=>e.jsx("text",{x:s,y:D,dy:16,textAnchor:"end",transform:`rotate(-45, ${s}, ${D})`,fill:l.highlightedPlayer===N.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:l.highlightedPlayer===N.value?14:12,fontWeight:l.highlightedPlayer===N.value?"bold":"normal",children:N.value})}),e.jsx(O,{tickFormatter:s=>`${s.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(J,{content:e.jsx(j,{})}),e.jsx(X,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:d.map((s,D)=>{const N=l.highlightedPlayer===s.name,S=R===s.name,a=s.isHighlightedAddition;return e.jsx(Z,{fill:h[s.name]||"var(--chart-color-4)",stroke:N?"var(--accent-primary)":S?"var(--text-primary)":"none",strokeWidth:N?3:S?2:0,strokeDasharray:a?"5,5":"none",opacity:a?.8:1,onClick:()=>b(s.name),onMouseEnter:()=>V(s.name),onMouseLeave:()=>V(null),style:{cursor:"pointer"}},`cell-lowest-${D}`)})})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function We(){const{navigationState:n,updateNavigationState:x}=ee(),[m,v]=I.useState(n.deathStatisticsState?.selectedCamp||n.deathStatsSelectedCamp||"Tous les camps"),[u,W]=I.useState(n.deathStatisticsState?.victimCampFilter||"Tous les camps"),[A,l]=I.useState(n.deathStatisticsState?.minGamesForAverage||25),[y,h]=I.useState(()=>{const i=n.deathStatisticsState?.selectedView;return i&&i!=="location"?i:"killers"}),{data:M}=ye(),{data:E,isLoading:R,error:V}=ve(m,u),{data:L,isLoading:T,error:p}=pe(),{data:H,isLoading:d,error:g}=Ae(m),{data:b}=ue(),j=ge();I.useEffect(()=>{(!n.deathStatisticsState||n.deathStatisticsState.selectedCamp!==m||n.deathStatisticsState.victimCampFilter!==u||n.deathStatisticsState.minGamesForAverage!==A||n.deathStatisticsState.selectedView!==y)&&x({deathStatisticsState:{selectedCamp:m,victimCampFilter:u,minGamesForAverage:A,selectedView:y,focusChart:n.deathStatisticsState?.focusChart}})},[m,u,A,y,n.deathStatisticsState,x]);const s=I.useMemo(()=>b?xe(b):[],[b]),D=I.useMemo(()=>{const i={};s.forEach(P=>{P===q.BY_WOLF?i[P]=j.Loup:P===q.VOTED?i[P]="var(--chart-color-1)":P===q.BULLET||P===q.BULLET_HUMAN||P===q.BULLET_WOLF?i[P]=j.Chasseur:P===q.BY_ZOMBIE?i[P]=j.Vaudou:P===q.ASSASSIN?i[P]=j.Alchimiste:P===q.AVENGER?i[P]="var(--chart-color-2)":P===q.LOVER_DEATH?i[P]=j.Amoureux:P===q.BY_BEAST?i[P]="var(--chart-color-3)":P===q.SHERIF_SUCCESS?i[P]="var(--chart-color-4)":P===q.SMUGGLER_HUNT_KILL&&(i[P]=j.Contrebandier)});const o=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let z=0;return s.forEach(P=>{i[P]||(i[P]=o[z%o.length],z++)}),i},[s,j]),N=i=>{v(i),x({deathStatsSelectedCamp:i,deathStatisticsState:{selectedCamp:i,victimCampFilter:u,minGamesForAverage:A,selectedView:y,focusChart:n.deathStatisticsState?.focusChart}})},S=i=>{W(i),x({deathStatisticsState:{selectedCamp:m,victimCampFilter:i,minGamesForAverage:A,selectedView:y,focusChart:n.deathStatisticsState?.focusChart}})},a=i=>{l(i),x({deathStatisticsState:{selectedCamp:m,victimCampFilter:u,minGamesForAverage:i,selectedView:y,focusChart:n.deathStatisticsState?.focusChart}})},t=i=>{h(i),x({deathStatisticsState:{selectedCamp:m,victimCampFilter:u,minGamesForAverage:A,selectedView:i,focusChart:n.deathStatisticsState?.focusChart}})},{gamesWithKillers:r,totalEligibleForAverage:c}=I.useMemo(()=>{if(!E)return{gamesWithKillers:0,totalEligibleForAverage:0};const i=E.killerStats.filter(o=>o.gamesPlayed>=A);return{gamesWithKillers:E.totalGames,totalEligibleForAverage:i.length}},[E,A]);return R?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):V?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",V]}):E?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${y==="killers"?"active":""}`,onClick:()=>t("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${y==="deaths"?"active":""}`,onClick:()=>t("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${y==="survival"?"active":""}`,onClick:()=>t("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${y==="hunter"?"active":""}`,onClick:()=>t("hunter"),children:"Chasseur"})]}),(y==="killers"||y==="deaths"||y==="survival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:m,onChange:i=>N(i.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),M?.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),y==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:u,onChange:i=>S(i.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(y==="killers"||y==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:E.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:E.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:r})]})]}),y==="killers"&&e.jsx(Te,{deathStats:E,selectedCamp:m,victimCampFilter:u,minGamesForAverage:A,onMinGamesChange:a,availableDeathTypes:s,deathTypeColors:D,totalEligibleForAverage:c}),y==="deaths"&&e.jsx(Ne,{deathStats:E,selectedCamp:m,minGamesForAverage:A,onMinGamesChange:a,availableDeathTypes:s,deathTypeColors:D}),y==="hunter"&&e.jsx(Be,{hunterStats:L,isLoading:T,error:p}),y==="survival"&&e.jsx(ke,{survivalStats:H,selectedCamp:m,minGamesForAverage:A,onMinGamesChange:a,isLoading:d,error:g}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"DonnÃ©es en cours de rÃ©cupÃ©ration (donnÃ©es partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{We as DeathStatisticsChart};
