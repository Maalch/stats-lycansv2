import{u as ue,r as C,c as pe,a as ye,j as e}from"./index-CWhhFXo9.js";import{u as ce}from"./baseStatsHook-DH_kQULa.js";import{g as F}from"./gameUtils-C0qLdSzT.js";import{F as U,B as G,C as w,X as q,Y as $,a as J}from"./FullscreenChart-BL1qIcDC.js";import{a as ve,m as le}from"./api-DUyicxr-.js";import{R as Z,T as X}from"./CategoricalChart-B4Hj_T4L.js";const r={SURVIVOR:"SURVIVOR",VOTE:"VOTE",WEREWOLF_KILL:"WEREWOLF_KILL",HUNTER_SHOT:"HUNTER_SHOT",BOUNTY_HUNTER:"BOUNTY_HUNTER",LOVER_DEATH:"LOVER_DEATH",LOVER_WEREWOLF:"LOVER_WEREWOLF",BEAST_KILL:"BEAST_KILL",ASSASSIN_POTION:"ASSASSIN_POTION",HAUNTED_POTION:"HAUNTED_POTION",ZOMBIE_KILL:"ZOMBIE_KILL",RESURRECTED_WEREWOLF:"RESURRECTED_WEREWOLF",AVENGER_KILL:"AVENGER_KILL",AGENT_KILL:"AGENT_KILL",SHERIFF_KILL:"SHERIFF_KILL",EXPLOSION:"EXPLOSION",CRUSHED:"CRUSHED",STARVATION:"STARVATION",FALL_DEATH:"FALL_DEATH",BESTIAL_DEATH:"BESTIAL_DEATH",AVATAR_DEATH:"AVATAR_DEATH",DISCONNECT:"DISCONNECT",UNKNOWN:"UNKNOWN"};function fe(v){const c=new Set;v.filter(N=>!N.LegacyData||N.LegacyData.deathInformationFilled===!0).forEach(N=>{N.PlayerStats.forEach(V=>{const D=F(V.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1});c.add(D)})});const g=Array.from(c),E=["Villageois","Loup","Amoureux"];return[...E.filter(N=>g.includes(N)),...g.filter(N=>!E.includes(N)).sort()]}function xe(v){if(!v)return null;const c=v.match(/^([NJM])(\d+)$/);if(!c)return null;const[,T,g]=c,E=parseInt(g,10);let u;switch(T){case"N":u="Nuit";break;case"J":u="Jour";break;case"M":u="Meeting";break;default:return null}return{phase:u,day:E,originalString:v}}function Y(v){if(!v||v==="N/A")return r.SURVIVOR;const c=v.trim().toLowerCase();if(c.includes("vote"))return r.VOTE;if(c.includes("tué par loup")||c.includes("tué par un loup")||c.includes("tué par loup ressuscité"))return c.includes("ressuscité")?r.RESURRECTED_WEREWOLF:r.WEREWOLF_KILL;if(c.includes("amoureux")||c.includes("son amoureux"))return c.includes("tué par loup amoureux")?r.LOVER_WEREWOLF:r.LOVER_DEATH;if(c.includes("chasseur")||c.includes("balle"))return c.includes("primes")?r.BOUNTY_HUNTER:r.HUNTER_SHOT;if(c.includes("potion")){if(c.includes("assassin"))return r.ASSASSIN_POTION;if(c.includes("hanté"))return r.HAUNTED_POTION}return c.includes("la bête")?r.BEAST_KILL:c.includes("zombie")?r.ZOMBIE_KILL:c.includes("vengeur")?r.AVENGER_KILL:c.includes("l'agent")?r.AGENT_KILL:c.includes("shérif")?r.SHERIFF_KILL:c.includes("explosé")?r.EXPLOSION:c.includes("écrasé")?r.CRUSHED:c.includes("faim")?r.STARVATION:c.includes("chute")?r.FALL_DEATH:c.includes("bestiale")?r.BESTIAL_DEATH:c.includes("avatar")?r.AVATAR_DEATH:c==="déco"?r.DISCONNECT:r.UNKNOWN}function ne(v){switch(v){case r.SURVIVOR:return"Survivant";case r.VOTE:return"Mort aux votes";case r.WEREWOLF_KILL:return"Tué par un loup";case r.HUNTER_SHOT:return"Abattu par un chasseur";case r.BOUNTY_HUNTER:return"Tué par un chasseur de primes";case r.LOVER_DEATH:return"Mort par amoureux";case r.LOVER_WEREWOLF:return"Tué par son amoureux loup";case r.BEAST_KILL:return"Dévoré par la Bête";case r.ASSASSIN_POTION:return"Tué par une potion (Assassin)";case r.HAUNTED_POTION:return"Tué par une potion (Hanté)";case r.ZOMBIE_KILL:return"Tué par un zombie";case r.RESURRECTED_WEREWOLF:return"Tué par un loup ressuscité";case r.AVENGER_KILL:return"Tué par un vengeur";case r.AGENT_KILL:return"Éliminé par l'Agent";case r.SHERIFF_KILL:return"Abattu par le Shérif";case r.EXPLOSION:return"Mort dans une explosion";case r.CRUSHED:return"Écrasé";case r.STARVATION:return"Mort de faim";case r.FALL_DEATH:return"Mort de chute";case r.BESTIAL_DEATH:return"Mort bestiale";case r.AVATAR_DEATH:return"Mort liée à l'Avatar";case r.DISCONNECT:return"Déconnexion";case r.UNKNOWN:default:return"Mort inconnue"}}function oe(v){switch(v){case r.SURVIVOR:return"Survivant";case r.VOTE:return"Mort aux votes";case r.WEREWOLF_KILL:return"Kill en Loup";case r.HUNTER_SHOT:return"Tir de Chasseur";case r.BOUNTY_HUNTER:return"Kill en Chasseur de primes";case r.LOVER_DEATH:return"Kill de son amoureux";case r.LOVER_WEREWOLF:return"Kill en Loup amoureux";case r.BEAST_KILL:return"Kill en Bête";case r.ASSASSIN_POTION:return"Kill avec Potion (Assassin)";case r.HAUNTED_POTION:return"Kill avec Potion (Hanté)";case r.ZOMBIE_KILL:return"Kill en Zombie";case r.RESURRECTED_WEREWOLF:return"Kill en Loup ressuscité";case r.AVENGER_KILL:return"Kill en Vengeur";case r.AGENT_KILL:return"Kill en Agent";case r.SHERIFF_KILL:return"Kill en Shérif";case r.EXPLOSION:return"Explosion";case r.CRUSHED:return"Écrasement";case r.STARVATION:return"Famine";case r.FALL_DEATH:return"Chute mortelle";case r.BESTIAL_DEATH:return"Tuerie bestiale";case r.AVATAR_DEATH:return"Mort d'Avatar";case r.DISCONNECT:return"Déconnexion";case r.UNKNOWN:default:return"Kill inconnu"}}function Te(v){const c=new Set;v.forEach(E=>{E.PlayerStats.forEach(u=>{if(u.DeathType){const N=Y(u.DeathType);c.add(N)}})});const T=Array.from(c),g=[r.WEREWOLF_KILL,r.VOTE,r.HUNTER_SHOT,r.ZOMBIE_KILL,r.ASSASSIN_POTION,r.HAUNTED_POTION,r.AVENGER_KILL,r.LOVER_DEATH,r.SURVIVOR];return[...g.filter(E=>T.includes(E)),...T.filter(E=>!g.includes(E)).sort()]}function Se(v,c){return v.PlayerStats.filter(T=>Y(T.DeathType)!=="SURVIVOR"&&(T.DeathTiming||T.DeathType)).map(T=>{let g=null;if(T.KillerName){const u=v.PlayerStats.find(N=>N.Username===T.KillerName);u&&(g=F(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1}))}const E=Y(T.DeathType);return{playerName:T.Username,deathTiming:xe(T.DeathTiming),deathType:E,killerName:T.KillerName,killerCamp:g}}).filter(T=>{if(!c||c==="Tous les camps")return!0;const g=v.PlayerStats.find(u=>u.Username===T.playerName);return g?F(g.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===c:!1})}function Ee(v,c){if(v.length===0)return null;const T=v.filter(a=>!a.LegacyData||a.LegacyData.deathInformationFilled===!0);if(T.length===0)return null;const g=[],E={};T.forEach(a=>{Se(a,c).forEach(S=>{g.push({...S,gameId:a.Id})}),a.PlayerStats.forEach(S=>{const K=S.Username;(!c||c==="Tous les camps"||F(S.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!1})===c)&&(E[K]=(E[K]||0)+1)})});const u=g.length,N=T.length,V=N>0?u/N:0,D={},W={Nuit:0,Jour:0,Meeting:0};g.forEach(a=>{if(a.deathTiming){const l=`${a.deathTiming.phase}-${a.deathTiming.day}`;D[l]=(D[l]||0)+1,W[a.deathTiming.phase]++}});const M=Object.entries(D).map(([a,l])=>{const[S,K]=a.split("-");return{phase:S,day:parseInt(K,10),count:l,percentage:u>0?l/u*100:0}}).sort((a,l)=>{if(a.phase!==l.phase){const S={Nuit:0,Jour:1,Meeting:2};return S[a.phase]-S[l.phase]}return a.day-l.day}),B={};g.forEach(a=>{B[a.deathType]=(B[a.deathType]||0)+1});const o=Object.entries(B).map(([a,l])=>({type:a,count:l,percentage:u>0?l/u*100:0})).sort((a,l)=>l.count-a.count),b={};g.forEach(a=>{if(a.killerName){b[a.killerName]||(b[a.killerName]={kills:0,victims:new Set,killsByDeathType:{}}),b[a.killerName].kills++,b[a.killerName].victims.add(a.playerName);const l=a.deathType;b[a.killerName].killsByDeathType[l]=(b[a.killerName].killsByDeathType[l]||0)+1}});const x=Object.entries(b).map(([a,l])=>{const S=E[a]||0,K=S>0?l.kills/S:0;return{killerName:a,kills:l.kills,victims:Array.from(l.victims),percentage:u>0?l.kills/u*100:0,gamesPlayed:S,averageKillsPerGame:K,killsByDeathType:l.killsByDeathType}}).sort((a,l)=>l.kills-a.kills),L={};g.forEach(a=>{L[a.playerName]||(L[a.playerName]={totalDeaths:0,deathsByPhase:{Nuit:0,Jour:0,Meeting:0},deathsByType:{},killedBy:{},deathDays:[]});const l=L[a.playerName];l.totalDeaths++,a.deathTiming&&(l.deathsByPhase[a.deathTiming.phase]++,l.deathDays.push(a.deathTiming.day)),l.deathsByType[a.deathType]=(l.deathsByType[a.deathType]||0)+1,a.killerName&&(l.killedBy[a.killerName]=(l.killedBy[a.killerName]||0)+1)});const Q=Object.entries(L).map(([a,l])=>({playerName:a,totalDeaths:l.totalDeaths,deathsByPhase:l.deathsByPhase,deathsByType:l.deathsByType,killedBy:l.killedBy,averageDeathDay:l.deathDays.length>0?l.deathDays.reduce((S,K)=>S+K,0)/l.deathDays.length:null,deathRate:E[a]>0?l.totalDeaths/E[a]:0})).sort((a,l)=>l.totalDeaths-a.totalDeaths),z=Object.entries(W).reduce((a,[l,S])=>S>a.count?{phase:l,count:S}:a,{phase:"Nuit",count:0}).phase,H={};g.forEach(a=>{a.deathTiming&&(H[a.deathTiming.day]=(H[a.deathTiming.day]||0)+1)});const ee=Object.entries(H).reduce((a,[l,S])=>S>a.count?{day:parseInt(l,10),count:S}:a,{day:1,count:0}).day,te=o.length>0?o[0].type:null,re=x.length>0?x[0].killerName:null;return{totalDeaths:u,totalGames:N,averageDeathsPerGame:V,deathsByTiming:M,deathsByPhase:W,deathsByType:o,killerStats:x,playerDeathStats:Q,mostDeadlyPhase:z,mostDeadlyDay:ee,mostCommonDeathType:te,mostDeadlyKiller:re}}function Ae(v){return ce(c=>Ee(c,v))}function De(){return ce(v=>fe(v))}function Ie(){const{navigateToGameDetails:v,navigationState:c,updateNavigationState:T}=ue(),[g,E]=C.useState(c.deathStatsSelectedCamp||"Tous les camps"),[u,N]=C.useState(5),{data:V}=De(),{data:D,isLoading:W,error:M}=Ae(g),{data:B}=pe(),{settings:o}=ye(),b=ve(),x=C.useMemo(()=>B?Te(B.GameStats):[],[B]),L=C.useMemo(()=>{const t={};x.forEach(i=>{i==="WEREWOLF_KILL"?t[i]=b.Loup:i==="VOTE"?t[i]="var(--chart-color-1)":i==="HUNTER_SHOT"?t[i]=b.Chasseur:i==="ZOMBIE_KILL"?t[i]=b.Vaudou:i==="ASSASSIN_POTION"||i==="HAUNTED_POTION"?t[i]=b.Alchimiste:i==="AVENGER_KILL"?t[i]="var(--chart-color-2)":i==="LOVER_DEATH"||i==="LOVER_WEREWOLF"?t[i]=b.Amoureux:i==="DISCONNECT"?t[i]="var(--chart-color-3)":i==="SURVIVOR"&&(t[i]="var(--chart-color-4)")});const m=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let h=0;return x.forEach(i=>{t[i]||(t[i]=m[h%m.length],h++)}),t},[x,b]),Q=t=>{E(t),T({deathStatsSelectedCamp:t})},{totalKillsData:z,averageKillsData:H,highlightedPlayerAddedToTotal:ee,highlightedPlayerAddedToAverage:te,gamesWithKillers:re,totalEligibleForAverage:a}=C.useMemo(()=>{if(!D)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1,gamesWithKillers:0,totalEligibleForAverage:0};const t=D.killerStats.sort((n,y)=>y.kills-n.kills).slice(0,15),m=o.highlightedPlayer&&t.some(n=>n.killerName===o.highlightedPlayer),h=t.map(n=>{const y={name:n.killerName,value:n.kills,victims:n.victims.length,percentage:n.percentage,gamesPlayed:n.gamesPlayed,averageKillsPerGame:n.averageKillsPerGame,isHighlightedAddition:!1};return x.forEach(j=>{y[j]=n.killsByDeathType[j]||0}),y});let i=!1;if(o.highlightedPlayer&&!m){const n=D.killerStats.find(y=>y.killerName===o.highlightedPlayer);if(n){const y={name:n.killerName,value:n.kills,victims:n.victims.length,percentage:n.percentage,gamesPlayed:n.gamesPlayed,averageKillsPerGame:n.averageKillsPerGame,isHighlightedAddition:!0};x.forEach(j=>{y[j]=n.killsByDeathType[j]||0}),h.push(y),i=!0}}const A=D.killerStats.filter(n=>n.gamesPlayed>=u),O=A.sort((n,y)=>y.averageKillsPerGame-n.averageKillsPerGame).slice(0,15),I=o.highlightedPlayer&&O.some(n=>n.killerName===o.highlightedPlayer),p=O.map(n=>{const y={name:n.killerName,value:n.averageKillsPerGame,victims:n.victims.length,percentage:n.percentage,gamesPlayed:n.gamesPlayed,averageKillsPerGame:n.averageKillsPerGame,isHighlightedAddition:!1};return x.forEach(j=>{const k=n.killsByDeathType[j]||0;y[j]=n.gamesPlayed>0?k/n.gamesPlayed:0}),y});let P=!1;if(o.highlightedPlayer&&!I){const n=D.killerStats.find(y=>y.killerName===o.highlightedPlayer);if(n){const y={name:n.killerName,value:n.averageKillsPerGame,victims:n.victims.length,percentage:n.percentage,gamesPlayed:n.gamesPlayed,averageKillsPerGame:n.averageKillsPerGame,isHighlightedAddition:!0};x.forEach(j=>{const k=n.killsByDeathType[j]||0;y[j]=n.gamesPlayed>0?k/n.gamesPlayed:0}),p.push(y),P=!0}}return{totalKillsData:h,averageKillsData:p,highlightedPlayerAddedToTotal:i,highlightedPlayerAddedToAverage:P,gamesWithKillers:D.totalGames,totalEligibleForAverage:A.length}},[D,o.highlightedPlayer,u,x]),{totalDeathsData:l,survivalRateData:S,highlightedPlayerAddedToDeaths:K,highlightedPlayerAddedToSurvival:se}=C.useMemo(()=>{if(!D||!B)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const t={},m=B.GameStats.filter(s=>!s.LegacyData||s.LegacyData.deathInformationFilled===!0);m.forEach(s=>{s.PlayerStats.forEach(d=>{const f=d.Username;(!g||g==="Tous les camps"||F(d.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!0})===g)&&(t[f]=(t[f]||0)+1)})});const h=D.playerDeathStats.sort((s,d)=>d.totalDeaths-s.totalDeaths).slice(0,15),i=o.highlightedPlayer&&h.some(s=>s.playerName===o.highlightedPlayer),A=h.map(s=>{const d=t[s.playerName]||0,f=d>0?(d-s.totalDeaths)/d*100:0,R={name:s.playerName,value:s.totalDeaths,totalDeaths:s.totalDeaths,gamesPlayed:d,deathRate:s.deathRate,survivalRate:f,isHighlightedAddition:!1};return x.forEach(_=>{R[_]=s.deathsByType[_]||0}),R});let O=!1;if(o.highlightedPlayer&&!i){const s=D.playerDeathStats.find(d=>d.playerName===o.highlightedPlayer);if(s){const d=t[s.playerName]||0,f=d>0?(d-s.totalDeaths)/d*100:0,R={name:s.playerName,value:s.totalDeaths,totalDeaths:s.totalDeaths,gamesPlayed:d,deathRate:s.deathRate,survivalRate:f,isHighlightedAddition:!0};x.forEach(_=>{R[_]=s.deathsByType[_]||0}),A.push(R),O=!0}}const I={},p={};m.forEach(s=>{s.PlayerStats.forEach(d=>{const f=d.Username;if((!g||g==="Tous les camps"||F(d.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupTraitor:!0})===g)&&d.DeathType&&d.DeathType!=="N/A"){p[f]||(p[f]={totalDeaths:0,deathsByType:{}}),p[f].totalDeaths++;const _=Y(d.DeathType);p[f].deathsByType[_]=(p[f].deathsByType[_]||0)+1}})}),Object.entries(t).forEach(([s,d])=>{if(d>=u){const f=p[s],R=f?f.totalDeaths:0,_=f?f.deathsByType:{},ae=d>0?(d-R)/d*100:0,ie=d>0?R/d:0;I[s]={playerName:s,totalDeaths:R,deathsByType:_,gamesPlayed:d,survivalRate:ae,deathRate:ie}}});const n=Object.values(I).sort((s,d)=>d.survivalRate-s.survivalRate).slice(0,15),y=o.highlightedPlayer&&n.some(s=>s.playerName===o.highlightedPlayer),j=n.map(s=>{const d={name:s.playerName,value:s.survivalRate,totalDeaths:s.totalDeaths,gamesPlayed:s.gamesPlayed,deathRate:s.deathRate,survivalRate:s.survivalRate,isHighlightedAddition:!1};return x.forEach(f=>{const R=s.deathsByType[f]||0;d[f]=s.gamesPlayed>0?R/s.gamesPlayed*100:0}),d});let k=!1;if(o.highlightedPlayer&&!y){let s=I[o.highlightedPlayer];if(!s){const d=t[o.highlightedPlayer]||0,f=p[o.highlightedPlayer],R=f?f.totalDeaths:0,_=f?f.deathsByType:{},ae=d>0?(d-R)/d*100:0,ie=d>0?R/d:0;s={playerName:o.highlightedPlayer,totalDeaths:R,deathsByType:_,gamesPlayed:d,survivalRate:ae,deathRate:ie}}if(s){const d={name:s.playerName,value:s.survivalRate,totalDeaths:s.totalDeaths,gamesPlayed:s.gamesPlayed,deathRate:s.deathRate,survivalRate:s.survivalRate,isHighlightedAddition:!0};x.forEach(f=>{const R=s.deathsByType[f]||0;d[f]=s.gamesPlayed>0?R/s.gamesPlayed*100:0}),j.push(d),k=!0}}return{totalDeathsData:A,survivalRateData:j,highlightedPlayerAddedToDeaths:O,highlightedPlayerAddedToSurvival:k}},[D,B,o.highlightedPlayer,u,x,g]);if(W)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."});if(M)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",M]});if(!D)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de mort disponible"});const he=({active:t,payload:m,label:h})=>{if(t&&m&&m.length){const i=m[0].payload,A=i.isHighlightedAddition,O=o.highlightedPlayer===i.name,I=x.reduce((p,P)=>p+(i[P]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:O?"var(--accent-primary)":"var(--text-primary)"},children:[h,A&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",I]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill:"}),x.map(p=>{const P=i[p]||0;return P===0?null:e.jsxs("p",{style:{color:L[p],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:L[p],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[oe(p),":"]})," ",P]},p)})]}),A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),O&&!A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},de=({active:t,payload:m,label:h})=>{if(t&&m&&m.length){const i=m[0].payload,A=i.isHighlightedAddition,O=o.highlightedPlayer===i.name,I=i.gamesPlayed>=u,p=D?.killerStats.find(y=>y.killerName===i.name),P=x.reduce((y,j)=>y+(i[j]||0),0),n=p?p.kills:Math.round(P*i.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:O?"var(--accent-primary)":"var(--text-primary)"},children:[h,A&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",P.toFixed(2)," (",n," kills /",i.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de kill (moyenne):"}),x.map(y=>{const j=i[y]||0;if(j===0)return null;const k=p?p.killsByDeathType[y]||0:Math.round(j*i.gamesPlayed);return e.jsxs("p",{style:{color:L[y],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:L[y],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[oe(y),":"]})," ",j.toFixed(2)," (",k," kills /",i.gamesPlayed," games)"]},y)})]}),A&&!I&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",u," parties)"]}),A&&I&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),O&&!A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},me=({active:t,payload:m,label:h})=>{if(t&&m&&m.length){const i=m[0].payload,A=i.isHighlightedAddition,O=o.highlightedPlayer===i.name,I=x.reduce((p,P)=>p+(i[P]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:O?"var(--accent-primary)":"var(--text-primary)"},children:[h,A&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",I]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",i.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort:"}),x.map(p=>{const P=i[p]||0;return P===0?null:e.jsxs("p",{style:{color:L[p],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:L[p],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ne(p),":"]})," ",P]},p)})]}),A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection personnelle"}),O&&!A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null},ge=({active:t,payload:m,label:h})=>{if(t&&m&&m.length){const i=m[0].payload,A=i.isHighlightedAddition,O=o.highlightedPlayer===i.name,I=i.gamesPlayed>=u;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:O?"var(--accent-primary)":"var(--text-primary)"},children:[h,A&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (🎯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",i.survivalRate.toFixed(1),"% (",i.gamesPlayed-i.totalDeaths," survies / ",i.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",i.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouées:"})," ",i.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Répartition par type de mort (taux %):"}),x.map(p=>{const P=i[p]||0;return P===0?null:e.jsxs("p",{style:{color:L[p],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsx("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:L[p],marginRight:"6px",verticalAlign:"middle"}}),e.jsxs("strong",{children:[ne(p),":"]})," ",P.toFixed(1),"%"]},p)})]}),A&&!I&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["🎯 Affiché via sélection (< ",u," parties)"]}),A&&I&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Affiché via sélection (hors top 15)"}),O&&!A&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"🎯 Joueur sélectionné"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques de Tueurs"}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp du tueur :"}),e.jsxs("select",{id:"camp-select",value:g,onChange:t=>Q(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),V?.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:D.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiés"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:D.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrées"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:re})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Top Tueurs (Total)"}),ee&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(U,{title:"Top Tueurs (Total)",children:e.jsx("div",{style:{height:440},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(G,{data:z,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:m,payload:h})=>e.jsx("text",{x:t,y:m,dy:16,textAnchor:"end",fill:o.highlightedPlayer===h.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===h.value?14:13,fontWeight:o.highlightedPlayer===h.value?"bold":"italic",transform:`rotate(-45 ${t} ${m})`,children:h.value})}),e.jsx($,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(he,{})}),x.map(t=>e.jsx(J,{dataKey:t,name:t,stackId:"kills",fill:L[t],onClick:m=>{const h={selectedPlayer:m?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(h.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),v(h)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,z.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Top Tueurs (Moyenne par Partie)"}),te&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:u,onChange:t=>N(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:le.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(U,{title:"Top Tueurs (Moyenne par Partie)",children:e.jsx("div",{style:{height:400},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(G,{data:H,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:m,payload:h})=>e.jsx("text",{x:t,y:m,dy:16,textAnchor:"end",fill:o.highlightedPlayer===h.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===h.value?14:13,fontWeight:o.highlightedPlayer===h.value?"bold":"italic",transform:`rotate(-45 ${t} ${m})`,children:h.value})}),e.jsx($,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(de,{})}),x.map(t=>e.jsx(J,{dataKey:t,name:t,stackId:"averageKills",fill:L[t],onClick:m=>{const h={selectedPlayer:m?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(h.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),v(h)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,H.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",a," ayant au moins ",u," partie",u>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Top Victimes"}),K&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsx(U,{title:"Top Victimes",children:e.jsx("div",{style:{height:440},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(G,{data:l,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:m,payload:h})=>e.jsx("text",{x:t,y:m,dy:16,textAnchor:"end",fill:o.highlightedPlayer===h.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===h.value?14:13,fontWeight:o.highlightedPlayer===h.value?"bold":"italic",transform:`rotate(-45 ${t} ${m})`,children:h.value})}),e.jsx($,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(me,{})}),x.map(t=>e.jsx(J,{dataKey:t,name:t,stackId:"deaths",fill:L[t],onClick:m=>{const h={selectedPlayer:m?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(h.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),v(h)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,l.filter(t=>!t.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Meilleurs Survivants"}),se&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['🎯 "',o.highlightedPlayer,'" affiché en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:u,onChange:t=>N(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:le.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(U,{title:"Meilleur Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(G,{data:S,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:m,payload:h})=>e.jsx("text",{x:t,y:m,dy:16,textAnchor:"end",fill:o.highlightedPlayer===h.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:o.highlightedPlayer===h.value?14:13,fontWeight:o.highlightedPlayer===h.value?"bold":"italic",transform:`rotate(-45 ${t} ${m})`,children:h.value})}),e.jsx($,{label:{value:"Taux de mort (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(X,{content:e.jsx(ge,{})}),x.map(t=>e.jsx(J,{dataKey:t,name:t,stackId:"survivalRate",fill:L[t],onClick:m=>{const h={selectedPlayer:m?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(h.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),v(h)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,S.filter(t=>!t.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",u," partie",u>1?"s":"",")"]})]})]}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"Données en cours de récupération (données partielles)."]})})]})}export{Ie as DeathStatisticsChart};
