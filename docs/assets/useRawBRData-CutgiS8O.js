import{a as R,p as g,r as o,k as p,D as F}from"./index-CzPRF2Gv.js";function D(){const{settings:t}=R(),[r,s]=o.useState(null),[f,i]=o.useState(null),[d,e]=o.useState(!0),[n,a]=o.useState(null);return o.useEffect(()=>{(async()=>{try{e(!0),a(null);const l=t.dataSource,c=await p(l,F.RAW_BR_DATA);c?(s(c.BRParties?.data||[]),i(c.BRRefParties?.data||[])):(s([]),i([]))}catch(l){console.error("Error fetching raw BR data:",l),a(l instanceof Error?l.message:"Unknown error")}finally{e(!1)}})()},[t.dataSource]),{brPartiesData:r,brRefPartiesData:f,isLoading:d,error:n}}function y(){const{settings:t}=R(),{brPartiesData:r,brRefPartiesData:s,isLoading:f,error:i}=D();return{data:r?.filter(e=>{if(!e.Game||!e.Participants)return!1;const n=s?.find(a=>a.Game===e.Game);if(!n)return m(e,t);if(t.independentFilters){const a=t.independentFilters;if(a.gameTypeEnabled&&a.gameFilter!=="all"){if(a.gameFilter==="modded"){if(!n["Game Moddée"])return!1}else if(a.gameFilter==="non-modded"&&n["Game Moddée"])return!1}if(a.dateRangeEnabled&&(a.dateRange.start||a.dateRange.end)){const u=g(n.Date);if(!u)return!1;if(a.dateRange.start){const l=new Date(a.dateRange.start);if(u<l)return!1}if(a.dateRange.end){const l=new Date(a.dateRange.end);if(u>l)return!1}}}return m(e,t)})||null,isLoading:f,error:i}}function w(){const{settings:t}=R(),{brRefPartiesData:r,isLoading:s,error:f}=D();return{data:r?.filter(d=>{if(!d.Game||!d.Date)return!1;if(t.independentFilters){const e=t.independentFilters;if(e.gameTypeEnabled&&e.gameFilter!=="all"){if(e.gameFilter==="modded"){if(!d["Game Moddée"])return!1}else if(e.gameFilter==="non-modded"&&d["Game Moddée"])return!1}if(e.dateRangeEnabled&&(e.dateRange.start||e.dateRange.end)){const n=g(d.Date);if(!n)return!1;if(e.dateRange.start){const a=new Date(e.dateRange.start);if(n<a)return!1}if(e.dateRange.end){const a=new Date(e.dateRange.end);if(n>a)return!1}}}return!0})||null,isLoading:s,error:f}}function m(t,r){if(r.playerFilter.mode!=="none"&&r.playerFilter.players.length>0){const s=t.Participants.toLowerCase();if(r.playerFilter.mode==="include"){if(!r.playerFilter.players.some(i=>i.toLowerCase()===s))return!1}else if(r.playerFilter.mode==="exclude"&&r.playerFilter.players.some(i=>i.toLowerCase()===s))return!1}return!0}export{w as a,y as u};
