import{u as Y,r as B,j as e}from"./index-B-Icvn-r.js";import{s as M,d as J,u as Z}from"./baseStatsHook-EGovfHPq.js";import{p as H}from"./api-beq3FXpM.js";import{F as L,B as T,C as q,X as F,Y as z,a as W,b as I}from"./FullscreenChart-CM-SbfgJ.js";import{R as G,T as $}from"./CategoricalChart-DB-YDVPj.js";function Q(j,f){if(j.length===0||f.length===0)return null;const y={};j.forEach(t=>{const a=t.Game?.toString(),x=t["Camp victorieux"];a&&x&&(y[a]=x.toString())});const n={},u={};let w=0,P=0;f.forEach(t=>{const a=t.Game?.toString();if(!a)return;const x=t.Loups,N=t.Amoureux,d=y[a];if(x){const l=M(x.toString());if(l.length>=2){w++;for(let o=0;o<l.length;o++)for(let h=o+1;h<l.length;h++){const m=l[o],v=l[h],b=[m,v].sort().join(" & ");n[b]||(n[b]={appearances:0,wins:0,players:[m,v]}),n[b].appearances++,J("Loups",d)&&n[b].wins++}}}if(N){const l=M(N.toString());if(l.length>=2){P++;for(let o=0;o<l.length;o+=2)if(o+1<l.length){const h=l[o],m=l[o+1],v=[h,m].sort().join(" & ");u[v]||(u[v]={appearances:0,wins:0,players:[h,m]}),u[v].appearances++,d==="Amoureux"&&u[v].wins++}}}});const A=Object.keys(n).map(t=>{const a=n[t],x=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:t,appearances:a.appearances,wins:a.wins,winRate:x,players:a.players}}),g=Object.keys(u).map(t=>{const a=u[t],x=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00";return{pair:t,appearances:a.appearances,wins:a.wins,winRate:x,players:a.players}});return A.sort((t,a)=>a.appearances-t.appearances),g.sort((t,a)=>a.appearances-t.appearances),{wolfPairs:{totalGames:w,pairs:A},loverPairs:{totalGames:P,pairs:g}}}function U(){const{data:j,isLoading:f,error:y}=Z((n,u)=>Q(n,u));return{data:j,isLoading:f,error:y}}function ie(){const{navigateToGameDetails:j,navigationState:f,updateNavigationState:y}=Y(),{data:n,isLoading:u,error:w}=U(),[P,A]=B.useState(f.selectedPairingTab||"wolves"),[g,t]=B.useState(2),[a,x]=B.useState(1),N=[1,2,3,4,5];if(u)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(w)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",w]});if(!n)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const d=s=>H[s]||"#8884d8",l=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,o=s=>s.map(r=>{const[i,p]=r.players,c=d(i),K=d(p),D=l(r.pair);return e.jsxs("linearGradient",{id:D,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:c}),e.jsx("stop",{offset:"50%",stopColor:c}),e.jsx("stop",{offset:"50%",stopColor:K}),e.jsx("stop",{offset:"100%",stopColor:K})]},D)}),h=n.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:l(s.pair)})),m=n.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:l(s.pair)})),v=h.filter(s=>s.appearances>=g).length,b=m.filter(s=>s.appearances>=a).length,E=h.filter(s=>s.appearances>=2),V=m.filter(s=>s.appearances>=2),S=[...h].sort((s,r)=>r.appearances-s.appearances).slice(0,10),C=[...h].filter(s=>s.appearances>=g).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),k=[...m].sort((s,r)=>r.appearances-s.appearances).slice(0,10),R=[...m].filter(s=>s.appearances>=a).sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),O=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:n.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:n.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:E.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),e.jsx(L,{title:"Paires de Loups les Plus Fréquentes",children:S.length>0?e.jsx("div",{style:{height:350},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:S,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:o(S)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(z,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx($,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(W,{dataKey:"appearances",name:"Apparitions",children:S.map((s,r)=>e.jsx(I,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"wolves"},fromComponent:"Paires de Loups les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-wolf-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-wolf-appearances-select",value:g,onChange:s=>t(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:N.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(L,{title:"Paires de Loups les Plus Performantes",children:[C.length>0?e.jsx("div",{style:{height:320},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:C,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:o(C)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(z,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx($,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]})]})}return null}}),e.jsx(W,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:C.map((s,r)=>e.jsx(I,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"wolves"},fromComponent:"Paires de Loups les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",C.length," des paires (sur ",v,") avec au moins ",g," apparition",g>1?"s":""]})]})]})]})]}),X=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:n.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:n.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:V.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),e.jsx(L,{title:"Paires d'Amoureux les Plus Fréquentes",children:k.length>0?e.jsx("div",{style:{height:350},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:k,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:o(k)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(z,{label:{value:"Apparitions",angle:-90,position:"insideLeft"},allowDecimals:!1}),e.jsx($,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Apparitions: ",i.appearances]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(W,{dataKey:"appearances",name:"Apparitions",children:k.map((s,r)=>e.jsx(I,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"lovers"},fromComponent:"Paires d'Amoureux les Plus Fréquentes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-lover-appearances-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. apparitions:"}),e.jsx("select",{id:"min-lover-appearances-select",value:a,onChange:s=>x(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:N.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs(L,{title:"Paires d'Amoureux les Plus Performantes",children:[R.length>0?e.jsx("div",{style:{height:320},children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(T,{data:R,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:o(R)}),e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(F,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(z,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx($,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const i=r[0].payload,[p,c]=i.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(p),borderRadius:"2px"}}),e.jsx("span",{children:p}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:d(c),borderRadius:"2px"}}),e.jsx("span",{children:c})]}),e.jsxs("div",{children:["Taux de victoire: ",i.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.appearances]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"🖱️ Cliquez pour voir les parties"})]})}return null}}),e.jsx(W,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:R.map((s,r)=>e.jsx(I,{fill:`url(#${s.gradientId})`,onClick:()=>{j({playerPairFilter:{selectedPlayerPair:s.players,selectedPairRole:"lovers"},fromComponent:"Paires d'Amoureux les Plus Performantes"})},style:{cursor:"pointer"}},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",R.length," des paires (sur ",b,") avec au moins ",a," apparition",a>1?"s":""]})]})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${P==="wolves"?" active":""}`,onClick:()=>{A("wolves"),y({selectedPairingTab:"wolves"})},type:"button",children:["Paires de Loups (",n.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${P==="lovers"?" active":""}`,onClick:()=>{A("lovers"),y({selectedPairingTab:"lovers"})},type:"button",children:["Paires d'Amoureux (",n.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:P==="wolves"?O():X()})]})}export{ie as PlayerPairingStatsChart};
