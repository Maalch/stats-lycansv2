import{r as c,j as e}from"./index-Bs3bDRRu.js";import{u as T}from"./usePlayerStats-B3OiaqQG.js";import{p as j,l as N,g as F}from"./api-BWHeASPZ.js";import{R as m,T as h,C as p}from"./CategoricalChart-BU4cfTzg.js";import{B as y,C as v,X as b,Y as f,a as P}from"./BarChart-CI6xdlqz.js";import{P as k,a as q}from"./PieChart-B9Kk3hhs.js";import{L as A}from"./Legend-BvYxJb_9.js";function z(){const{playerStatsData:t,dataLoading:C,fetchError:x}=T(),[n]=c.useState(null),[i,S]=c.useState(10),[o,R]=c.useState("best"),w=[5,8,10,15,20,25,30,50,100];if(C)return e.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques des joueurs..."});if(x)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",x]});if(!t)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de joueur disponible"});const D=t.playerStats.filter(a=>a.gamesPlayed>=i).length,u=t.playerStats.filter(a=>a.gamesPlayed>2).sort((a,r)=>r.gamesPlayed-a.gamesPlayed).slice(0,20),d=t.playerStats.filter(a=>a.gamesPlayed>=i).sort((a,r)=>o==="best"?parseFloat(r.winPercent)-parseFloat(a.winPercent):parseFloat(a.winPercent)-parseFloat(r.winPercent)).slice(0,20),g=n?(a=>{const r=t.playerStats.find(s=>s.player===a);return r?Object.entries(r.camps).filter(([s,l])=>l>0).map(([s,l])=>({name:s,value:l,percentage:(l/r.gamesPlayed*100).toFixed(1)})):[]})(n):[];return e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"Statistiques des Joueurs"}),e.jsxs("p",{className:"lycans-stats-info",children:["Total de ",t.totalGames," parties analysées avec ",t.playerStats.length," joueurs"]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Top Participations"}),e.jsx("div",{style:{height:400},children:e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(y,{data:u,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(f,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),e.jsx(h,{content:({active:a,payload:r})=>{if(a&&r&&r.length>0){const s=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:s.player})}),e.jsxs("div",{children:["Parties jouées : ",s.gamesPlayed]}),e.jsxs("div",{children:["Pourcentage : ",s.gamesPlayedPercent,"%"]})]})}return null}}),e.jsx(P,{dataKey:"gamesPlayed",name:"Parties jouées",fill:"#00C49F",children:u.map(a=>e.jsx(p,{fill:j[a.player]||"#00C49F"},`cell-participation-${a.player}`))})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{children:o==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:i,onChange:a=>S(Number(a.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:w.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsxs("select",{value:o,onChange:a=>R(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[e.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),e.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),e.jsx("div",{style:{height:400},children:e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(y,{data:d,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(f,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(h,{content:({active:a,payload:r})=>{if(a&&r&&r.length>0){const s=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:s.player})}),e.jsxs("div",{children:["Taux de victoire : ",s.winPercent,"%"]}),e.jsxs("div",{children:["Victoires : ",s.wins," / ",s.gamesPlayed]})]})}return null}}),e.jsx(P,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:d.map(a=>e.jsx(p,{fill:j[a.player]||"#8884d8"},`cell-winrate-${a.player}`))})]})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",d.length," des joueurs (sur ",D," ayant au moins ",i," partie",i>1?"s":"",")"]})]})]}),n&&e.jsxs("div",{className:"lycans-graphique-section lycans-joueur-details",children:[e.jsxs("h3",{children:["Distribution des Camps - ",n]}),e.jsx("div",{style:{height:300},children:e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(k,{children:[e.jsx(q,{data:g,cx:"50%",cy:"50%",labelLine:!0,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:a,percentage:r})=>`${a}: ${r}%`,children:g.map((a,r)=>e.jsx(p,{fill:N[a.name]||F(a.name)},`cell-${r}`))}),e.jsx(h,{content:({active:a,payload:r})=>{if(a&&r&&r.length>0){const s=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:s.name})}),e.jsxs("div",{children:[s.value," parties (",s.percentage,"%)"]})]})}return null}}),e.jsx(A,{})]})})})]})]})}export{z as PlayersGeneralStatisticsChart};
