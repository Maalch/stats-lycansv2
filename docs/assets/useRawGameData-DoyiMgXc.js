import{u as y,r as f}from"./index-DUftcxZ_.js";function m(e){if(!e)return null;const[s,l,i]=e.split("/");return!s||!l||!i?null:new Date(Number(i),Number(l)-1,Number(s))}function c(e){const[s,l]=f.useState(null),[i,o]=f.useState(!0),[d,t]=f.useState(null);return f.useEffect(()=>{(async()=>{try{o(!0),t(null);const a=await fetch(`/stats-lycansv2/data/${e}.json`);if(!a.ok)throw new Error(`Failed to fetch ${e}`);const n=await a.json();l(n.data||[])}catch(a){console.error(`Error fetching raw ${e}:`,a),t(a instanceof Error?a.message:"Unknown error")}finally{o(!1)}})()},[e]),{data:s,isLoading:i,error:d}}function w(){const{settings:e}=y(),{data:s,isLoading:l,error:i}=c("rawGameData");function o(t){if(!t)return null;const[r,a,n]=t.split("/");return!r||!a||!n?null:new Date(Number(n),Number(a)-1,Number(r))}return{data:s?.filter(t=>{if(e.filterMode==="gameType"){if(e.gameFilter!=="all"){if(e.gameFilter==="modded"){if(!t["Game Moddée"])return!1}else if(e.gameFilter==="non-modded"&&t["Game Moddée"])return!1}}else if(e.filterMode==="dateRange"&&(e.dateRange.start||e.dateRange.end)){const r=o(t.Date);if(!r)return!1;if(e.dateRange.start){const a=new Date(e.dateRange.start);if(r<a)return!1}if(e.dateRange.end){const a=new Date(e.dateRange.end);if(r>a)return!1}}if(e.playerFilter.mode!=="none"&&e.playerFilter.players.length>0){const r=t["Liste des joueurs"].toLowerCase();if(e.playerFilter.mode==="include"){if(!e.playerFilter.players.every(n=>r.includes(n.toLowerCase())))return!1}else if(e.playerFilter.mode==="exclude"&&e.playerFilter.players.some(n=>r.includes(n.toLowerCase())))return!1}return!0})||null,isLoading:l,error:i}}function D(){const{settings:e}=y(),{data:s,isLoading:l,error:i}=c("rawRoleData"),{data:o}=c("rawGameData");return{data:s?.filter(t=>{const r=o?.find(a=>a.Game===t.Game);if(!r)return!1;if(e.filterMode==="gameType"){if(e.gameFilter!=="all"){if(e.gameFilter==="modded"){if(!t["Game Moddée"])return!1}else if(e.gameFilter==="non-modded"&&t["Game Moddée"])return!1}}else if(e.filterMode==="dateRange"&&(e.dateRange.start||e.dateRange.end)){const a=m(r.Date);if(!a)return!1;if(e.dateRange.start){const n=new Date(e.dateRange.start);if(a<n)return!1}if(e.dateRange.end){const n=new Date(e.dateRange.end);if(a>n)return!1}}if(e.playerFilter.mode!=="none"&&e.playerFilter.players.length>0){const a=r["Liste des joueurs"].toLowerCase();if(e.playerFilter.mode==="include"){if(!e.playerFilter.players.every(u=>a.includes(u.toLowerCase())))return!1}else if(e.playerFilter.mode==="exclude"&&e.playerFilter.players.some(u=>a.includes(u.toLowerCase())))return!1}return!0})||null,isLoading:l,error:i}}export{D as a,w as u};
