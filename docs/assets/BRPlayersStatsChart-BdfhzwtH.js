import{a as K,r as k,j as e}from"./index-DbwxKScP.js";import{F as j,B as P,C as f,X as b,Y as S,a as y,b as v}from"./FullscreenChart-BEQqrwzv.js";import{u as L,a as V}from"./useRawBRData-o90II2sS.js";import{u as O}from"./useJoueursData-Cweoi4Im.js";import{u as J,g as X}from"./api-Dl1deQcS.js";import{R,T as B}from"./CategoricalChart-BwBqrdLC.js";function ae(){const{data:g,isLoading:F,error:w}=L(),{data:x,isLoading:z,error:A}=V(),{settings:s}=K(),{joueursData:C}=O(),[u,h]=k.useState(null),E=J(C),m=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],M=a=>E[a]||X(a),c=k.useMemo(()=>{if(!g||!x)return null;const a=x.length,r=g.length,i=g.filter(t=>t.Gagnant).length,l=g.reduce((t,o)=>{const d=o.Participants;return t[d]||(t[d]={name:d,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),t[d].participations++,t[d].totalScore+=o.Score,o.Gagnant&&t[d].wins++,t},{});Object.values(l).forEach(t=>{t.averageScore=t.totalScore/t.participations,t.winRate=t.wins/t.participations*100});const n=Object.values(l).sort((t,o)=>o.participations-t.participations),p=n.slice(0,15),G=s.highlightedPlayer&&p.some(t=>t.name===s.highlightedPlayer);let H=!1,N=[...p];if(s.highlightedPlayer&&!G){const t=n.find(o=>o.name===s.highlightedPlayer);t&&(N.push({...t,isHighlightedAddition:!0}),H=!0)}const T=Object.values(l).filter(t=>t.participations>=3).sort((t,o)=>o.winRate-t.winRate).slice(0,15),$=s.highlightedPlayer&&T.some(t=>t.name===s.highlightedPlayer);let W=!1,D=[...T];if(s.highlightedPlayer&&!$){const t=n.find(o=>o.name===s.highlightedPlayer);t&&(D.push({...t,isHighlightedAddition:!0}),W=!0)}const q=x.reduce((t,o)=>{const d=o["Nombre de participants"];return t[d]||(t[d]=0),t[d]++,t},{}),I=Object.entries(q).map(([t,o])=>({participants:parseInt(t),games:o,percentage:(o/a*100).toFixed(1)})).sort((t,o)=>t.participants-o.participants);return{totalGames:a,totalParticipations:r,totalWins:i,winRate:(i/r*100).toFixed(1),averageParticipantsPerGame:(r/a).toFixed(1),topPlayersByParticipations:N,topPlayersByWins:D,participantData:I,highlightedPlayerInParticipations:H,highlightedPlayerInWinRate:W}},[g,x,s.highlightedPlayer]);return F||z?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):w||A?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",w||A]}):c?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Statistiques Joueurs - Battle Royale"})}),e.jsxs("div",{className:"lycans-stats-grid",children:[e.jsxs("div",{className:"lycans-stat-card",children:[e.jsx("h3",{children:"Parties totales"}),e.jsx("div",{className:"lycans-stat-value",children:c.totalGames})]}),e.jsxs("div",{className:"lycans-stat-card",children:[e.jsx("h3",{children:"Participations"}),e.jsx("div",{className:"lycans-stat-value",children:c.totalParticipations})]}),e.jsxs("div",{className:"lycans-stat-card",children:[e.jsx("h3",{children:"Moy. participants/partie"}),e.jsx("div",{className:"lycans-stat-value",children:c.averageParticipantsPerGame})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Participations"}),c.highlightedPlayerInParticipations&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",s.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(j,{title:"Participations - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(R,{width:"100%",height:400,children:e.jsxs(P,{data:c.topPlayersByParticipations,children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:a,y:r,payload:i})=>e.jsx("text",{x:a,y:r,dy:16,textAnchor:"end",fill:s.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===i.value?14:12,fontWeight:s.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${a} ${r})`,children:i.value})}),e.jsx(S,{}),e.jsx(B,{content:({active:a,payload:r})=>{if(a&&r&&r.length>0){const i=r[0].payload,l=i.isHighlightedAddition,n=s.highlightedPlayer===i.name;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,n&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:i.participations})]}),e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:i.wins})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]})]}),l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(y,{dataKey:"participations",name:"Participations",children:c.topPlayersByParticipations.map((a,r)=>{const i=s.highlightedPlayer===a.name,l=u===a.name,n=a.isHighlightedAddition;return e.jsx(v,{fill:i?"var(--accent-primary)":n?"var(--accent-secondary)":M(a.name),stroke:i?"var(--accent-primary)":l?"var(--text-primary)":"none",strokeWidth:i?3:l?2:0,strokeDasharray:n?"5,5":"none",opacity:n?.8:1,onMouseEnter:()=>h(a.name),onMouseLeave:()=>h(null),style:{cursor:"pointer"}},`cell-${r}`)})}),e.jsx(y,{dataKey:"wins",fill:"var(--chart-color-2)",name:"Victoires",children:c.topPlayersByParticipations.map((a,r)=>{const i=s.highlightedPlayer===a.name,l=u===a.name,n=a.isHighlightedAddition;return e.jsx(v,{fill:i?"var(--accent-primary)":n?"var(--accent-secondary)":"var(--chart-color-2)",stroke:i?"var(--accent-primary)":l?"var(--text-primary)":"none",strokeWidth:i?3:l?2:0,strokeDasharray:n?"5,5":"none",opacity:n?.8:1,onMouseEnter:()=>h(a.name),onMouseLeave:()=>h(null),style:{cursor:"pointer"}},`cell-${r}`)})})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Taux de Victoire (min. 3 parties)"}),c.highlightedPlayerInWinRate&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",s.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(j,{title:"Taux de Victoire - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(R,{width:"100%",height:400,children:e.jsxs(P,{data:c.topPlayersByWins,children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:a,y:r,payload:i})=>e.jsx("text",{x:a,y:r,dy:16,textAnchor:"end",fill:s.highlightedPlayer===i.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:s.highlightedPlayer===i.value?14:12,fontWeight:s.highlightedPlayer===i.value?"bold":"normal",transform:`rotate(-45 ${a} ${r})`,children:i.value})}),e.jsx(S,{}),e.jsx(B,{content:({active:a,payload:r})=>{if(a&&r&&r.length>0){const i=r[0].payload,l=i.isHighlightedAddition,n=s.highlightedPlayer===i.name,p=i.participations>=3;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.name,n&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[i.winRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:i.wins})," / ",i.participations]})]}),l&&!p&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (< 3 parties)"}),l&&p&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(y,{dataKey:"winRate",name:"Taux de victoire (%)",children:c.topPlayersByWins.map((a,r)=>{const i=s.highlightedPlayer===a.name,l=u===a.name,n=a.isHighlightedAddition;return e.jsx(v,{fill:i?"var(--accent-primary)":n?"var(--accent-secondary)":m[r%m.length],stroke:i?"var(--accent-primary)":l?"var(--text-primary)":"none",strokeWidth:i?3:l?2:0,strokeDasharray:n?"5,5":"none",opacity:n?.8:1,onMouseEnter:()=>h(a.name),onMouseLeave:()=>h(null),style:{cursor:"pointer"}},`cell-${r}`)})})]})})})]})]}),e.jsxs("div",{className:"lycans-chart-section",children:[e.jsx("h3",{children:"RÃ©partition par Nombre de Participants"}),e.jsx(j,{title:"RÃ©partition par Nombre de Participants - Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(R,{width:"100%",height:400,children:e.jsxs(P,{data:c.participantData,margin:{bottom:15},children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"participants",label:{value:"Nombre de parties",position:"insideBottom",offset:-5}}),e.jsx(S,{}),e.jsx(B,{content:({active:a,payload:r})=>{if(a&&r&&r.length>0){const i=r[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[i.participants," ",i.participants===1?"participant":"participants"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Nombre de parties: ",e.jsx("strong",{children:i.games})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[i.percentage,"%"]})]})]})]})}return null}}),e.jsx(y,{dataKey:"games",name:"Nombre de parties",children:c.participantData.map((a,r)=>e.jsx(v,{fill:m[r%m.length]},`cell-${r}`))})]})})})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{ae as BRPlayersStatsChart};
