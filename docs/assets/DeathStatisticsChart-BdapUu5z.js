import{g as he,e as ge,u as te,a as ae,r as I,j as e,p as ne,i as ve,m as xe}from"./index-CVy_16Yl.js";import{g as oe,u as fe,a as je,b as Se,c as Pe}from"./useDeathStatisticsFromRaw-DPpoma_B.js";import{u as me}from"./baseStatsHook-C2H3neZY.js";import{g as ee,a as ie,D as F}from"./datasyncExport-BirWLS1z.js";import{M as ue,C as ye,u as re,m as le,b as pe,a as be}from"./api-CYqA0AYs.js";import{D as V,g as de}from"./deathTypes-gHH1w6_X.js";import{F as G,C as q,X as U,Y as $}from"./FullscreenChart-ChseP4GM.js";import{u as se}from"./useJoueursData-7JzxSF-R.js";import{R as O,T as _,a as X}from"./CategoricalChart-DmoZoH7R.js";import{B as J,a as Y}from"./BarChart-DN2erQNQ.js";function ce(s){if(!s||s.trim()==="")return null;const l=s.trim().slice(1),m=parseInt(l,10);return isNaN(m)||m<1?null:m}function De(s,h){if(s.length===0)return null;const l={},m={};s.forEach(y=>{let o=1;if(y.EndTiming){const g=ce(y.EndTiming);g&&(o=g)}y.PlayerStats.forEach(g=>{if(h&&h!=="Tous les camps"&&ee(g.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==h)return;const c=g.Username;l[c]||(l[c]={playerName:c,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const K=l[c];K.totalGames++;let B=null;g.DeathTiming&&(B=ce(g.DeathTiming));for(let b=1;b<=o;b++)K.gamesPlayedByDay[b]||(K.gamesPlayedByDay[b]=0,K.survivalsByDay[b]=0),m[b]||(m[b]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),K.gamesPlayedByDay[b]++,m[b].playersOnDay++,(!B||B>b)&&(K.survivalsByDay[b]++,m[b].survivorsOnDay++)});for(let g=1;g<=o;g++)m[g]||(m[g]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),m[g].gamesReachingDay++}),Object.values(l).forEach(y=>{Object.keys(y.gamesPlayedByDay).forEach(o=>{const g=parseInt(o),c=y.gamesPlayedByDay[g],K=y.survivalsByDay[g];c>0?y.survivalRatesByDay[g]=K/c*100:y.survivalRatesByDay[g]=0})});const d=Object.values(l).filter(y=>y.totalGames>0).sort((y,o)=>o.totalGames-y.totalGames),N=Object.entries(m).map(([y,o])=>({dayNumber:parseInt(y),totalGamesReachingDay:o.gamesReachingDay,totalPlayersOnDay:o.playersOnDay,averageSurvivalRate:o.playersOnDay>0?o.survivorsOnDay/o.playersOnDay*100:0})).sort((y,o)=>y.dayNumber-o.dayNumber);return{totalGames:s.length,totalPlayersAnalyzed:d.length,playerSurvivalStats:d,dayStats:N}}function Te(s,h,l=ue.MEDIUM){return s.playerSurvivalStats.filter(m=>m.totalGames>=l&&(m.gamesPlayedByDay[h]||0)>0).map(m=>({playerName:m.playerName,survivalRate:m.survivalRatesByDay[h]||0,gamesPlayed:m.totalGames,timesReachedDay:m.gamesPlayedByDay[h]||0,timesSurvivedDay:m.survivalsByDay[h]||0})).sort((m,d)=>d.survivalRate-m.survivalRate).slice(0,ye.TOP_15)}function Ae(s,h,l=ue.MEDIUM){return s.playerSurvivalStats.filter(m=>m.totalGames>=l&&(m.gamesPlayedByDay[h]||0)>0).map(m=>({playerName:m.playerName,survivalRate:m.survivalRatesByDay[h]||0,gamesPlayed:m.totalGames,timesReachedDay:m.gamesPlayedByDay[h]||0,timesSurvivedDay:m.survivalsByDay[h]||0})).sort((m,d)=>m.survivalRate-d.survivalRate).slice(0,ye.TOP_15)}function Ne(s){return me(h=>De(h,s))}function Be(s,h){if(h==="Tous les camps"){const l=s.filter(m=>m!==V.BULLET_HUMAN&&m!==V.BULLET_WOLF);return(s.includes(V.BULLET_HUMAN)||s.includes(V.BULLET_WOLF))&&!l.includes(V.BULLET)&&l.push(V.BULLET),l}return s}function Q(s,h){if(h==="Tous les camps"){const l=s.killsByDeathType[V.BULLET_HUMAN]||0,m=s.killsByDeathType[V.BULLET_WOLF]||0,d=s.killsByDeathType[V.BULLET]||0,N={...s.killsByDeathType};return N[V.BULLET]=l+m+d,delete N[V.BULLET_HUMAN],delete N[V.BULLET_WOLF],{...s,killsByDeathType:N}}return s}function ke(s,h="Tous les camps",l="Tous les camps"){const m=new Map;return s.forEach(d=>{d.PlayerStats.forEach(N=>{const y=he(N),o=ge(N),g=ie(N.MainRoleInitial,N.MainRoleChanges||[]),c=ee(g,{regroupVillagers:!0,regroupWolfSubRoles:!0},N.Power);if(h!=="Tous les camps"&&c!==h)return;let K=0;if(d.PlayerStats.forEach(B=>{if(B.KillerName===N.Username&&B.DeathTiming){const b=ie(B.MainRoleInitial,B.MainRoleChanges||[]),M=ee(b,{regroupVillagers:!0,regroupWolfSubRoles:!0},B.Power);l==="Tous les camps"?K++:l==="Roles solo"?M!=="Villageois"&&M!=="Loups"&&K++:M===l&&K++}}),K>0){const B=m.get(y);B?K>B.maxKills?(B.maxKills=K,B.timesAchieved=1,B.gameIds=[d.DisplayedId]):K===B.maxKills&&(B.timesAchieved++,B.gameIds.includes(d.DisplayedId)||B.gameIds.push(d.DisplayedId)):m.set(y,{playerName:o,maxKills:K,timesAchieved:1,gameIds:[d.DisplayedId]})}})}),Array.from(m.values()).sort((d,N)=>N.maxKills!==d.maxKills?N.maxKills-d.maxKills:N.timesAchieved-d.timesAchieved)}function Ke(s,h="Tous les camps",l="Tous les camps"){const m=new Map;return s.forEach(d=>{const N=new Map;d.PlayerStats.forEach(y=>{if(y.KillerName&&y.DeathTiming&&y.DeathTiming.match(/^[A-Z]\d+$/)){const o=y.KillerName,g=y.DeathTiming,c=d.PlayerStats.find(H=>H.Username===o);if(!c)return;const K=ie(c.MainRoleInitial,c.MainRoleChanges||[]),B=ee(K,{regroupVillagers:!0,regroupWolfSubRoles:!0},c.Power);if(h!=="Tous les camps"&&B!==h)return;const b=ie(y.MainRoleInitial,y.MainRoleChanges||[]),M=ee(b,{regroupVillagers:!0,regroupWolfSubRoles:!0},y.Power);let C=!1;if(l==="Tous les camps"?C=!0:l==="Roles solo"?C=M!=="Villageois"&&M!=="Loups":C=M===l,!C)return;N.has(o)||N.set(o,new Map);const A=N.get(o);A.set(g,(A.get(g)||0)+1)}}),N.forEach((y,o)=>{const g=Math.max(...Array.from(y.values())),c=d.PlayerStats.find(M=>M.Username===o);if(!c)return;const K=he(c),B=ge(c),b=m.get(K);b?g>b.maxKills?(b.maxKills=g,b.timesAchieved=1,b.gameIds=[d.DisplayedId]):g===b.maxKills&&(b.timesAchieved++,b.gameIds.includes(d.DisplayedId)||b.gameIds.push(d.DisplayedId)):m.set(K,{playerName:B,maxKills:g,timesAchieved:1,gameIds:[d.DisplayedId]})})}),Array.from(m.values()).sort((d,N)=>N.maxKills!==d.maxKills?N.maxKills-d.maxKills:N.timesAchieved-d.timesAchieved)}function Me(s,h="Tous les camps",l="Tous les camps"){return s.length===0?null:{maxKillsPerGame:ke(s,h,l),maxKillsPerPhase:Ke(s,h,l)}}function Re(s="Tous les camps",h="Tous les camps"){return me(l=>Me(l,s,h))}function He({deathStats:s,selectedCamp:h,victimCampFilter:l,minGamesForAverage:m,onMinGamesChange:d,availableDeathTypes:N,deathTypeColors:y,totalEligibleForAverage:o}){const{navigateToGameDetails:g}=te(),{settings:c}=ae(),{joueursData:K}=se(),B=re(K),{data:b}=Re(h,l),M=I.useMemo(()=>Be(N,l),[N,l]),C=I.useMemo(()=>{const t={...y};if(l==="Tous les camps"&&!t[V.BULLET]){const i=y[V.BULLET_HUMAN]||y[V.BULLET_WOLF];i&&(t[V.BULLET]=i)}return t},[y,l]),A=t=>{let i="Top Tueurs";return h!=="Tous les camps"&&(i+=` en ${h}`),l!=="Tous les camps"&&(l==="Roles solo"?i+=" (victimes: Roles solo)":i+=` (victimes: ${l})`),t==="total"?i+=" (Total)":i+=" (Moyenne par Partie)",i},H=t=>{let i=t==="game"?"Record de Kills en une Partie":"Record de Kills en une Phase";return h!=="Tous les camps"&&(i+=` (${h})`),l!=="Tous les camps"&&(l==="Roles solo"?i+=h!=="Tous les camps"?" - victimes: Roles solo":" (victimes: Roles solo)":i+=h!=="Tous les camps"?` - victimes: ${l}`:` (victimes: ${l})`),i},{totalKillsData:z,averageKillsData:u,highlightedPlayerAddedToTotal:x,highlightedPlayerAddedToAverage:D}=I.useMemo(()=>{if(!s)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const t=s.killerStats.sort((E,v)=>v.kills-E.kills).slice(0,15),i=c.highlightedPlayer&&t.some(E=>E.killerName===c.highlightedPlayer),a=t.map(E=>{const v=Q(E,l),L={name:v.killerName,value:v.kills,victims:v.victims.length,percentage:v.percentage,gamesPlayed:v.gamesPlayed,averageKillsPerGame:v.averageKillsPerGame,isHighlightedAddition:!1};return M.forEach(w=>{L[w]=v.killsByDeathType[w]||0}),L});let p=!1;if(c.highlightedPlayer&&!i){const E=s.killerStats.find(v=>v.killerName===c.highlightedPlayer);if(E){const v=Q(E,l),L={name:v.killerName,value:v.kills,victims:v.victims.length,percentage:v.percentage,gamesPlayed:v.gamesPlayed,averageKillsPerGame:v.averageKillsPerGame,isHighlightedAddition:!0};M.forEach(w=>{L[w]=v.killsByDeathType[w]||0}),a.push(L),p=!0}}const k=s.killerStats.filter(E=>E.gamesPlayed>=m).sort((E,v)=>v.averageKillsPerGame-E.averageKillsPerGame).slice(0,15),R=c.highlightedPlayer&&k.some(E=>E.killerName===c.highlightedPlayer),S=k.map(E=>{const v=Q(E,l),L={name:v.killerName,value:v.averageKillsPerGame,victims:v.victims.length,percentage:v.percentage,gamesPlayed:v.gamesPlayed,averageKillsPerGame:v.averageKillsPerGame,isHighlightedAddition:!1};return M.forEach(w=>{const Z=v.killsByDeathType[w]||0;L[w]=v.gamesPlayed>0?Z/v.gamesPlayed:0}),L});let W=!1;if(c.highlightedPlayer&&!R){const E=s.killerStats.find(v=>v.killerName===c.highlightedPlayer);if(E){const v=Q(E,l),L={name:v.killerName,value:v.averageKillsPerGame,victims:v.victims.length,percentage:v.percentage,gamesPlayed:v.gamesPlayed,averageKillsPerGame:v.averageKillsPerGame,isHighlightedAddition:!0};M.forEach(w=>{const Z=v.killsByDeathType[w]||0;L[w]=v.gamesPlayed>0?Z/v.gamesPlayed:0}),S.push(L),W=!0}}return{totalKillsData:a,averageKillsData:S,highlightedPlayerAddedToTotal:p,highlightedPlayerAddedToAverage:W}},[s,c.highlightedPlayer,m,M,l]),P=({active:t,payload:i,label:a})=>{if(t&&i&&i.length){const p=i[0].payload,n=p.isHighlightedAddition,k=c.highlightedPlayer===p.name,R=M.reduce((S,W)=>S+(p[W]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:k?"var(--accent-primary)":"var(--text-primary)"},children:[a,n&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",R]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",p.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),M.map(S=>({deathType:S,count:p[S]||0})).filter(S=>S.count>0).sort((S,W)=>W.count-S.count).map(({deathType:S,count:W})=>e.jsxs("p",{style:{color:C[S],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[oe(S),":"]})," ",W]},S))]}),n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),k&&!n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},r=({active:t,payload:i,label:a})=>{if(t&&i&&i.length){const p=i[0].payload,n=p.isHighlightedAddition,k=c.highlightedPlayer===p.name,R=p.gamesPlayed>=m,S=s?.killerStats.find(L=>L.killerName===p.name),W=S?Q(S,l):null,E=M.reduce((L,w)=>L+(p[w]||0),0),v=W?W.kills:Math.round(E*p.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:k?"var(--accent-primary)":"var(--text-primary)"},children:[a,n&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",E.toFixed(2)," (",v," kills /",p.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",p.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),M.map(L=>({deathType:L,avgCount:p[L]||0,totalKillsForDeathType:W?W.killsByDeathType[L]||0:Math.round((p[L]||0)*p.gamesPlayed)})).filter(L=>L.avgCount>0).sort((L,w)=>w.avgCount-L.avgCount).map(({deathType:L,avgCount:w,totalKillsForDeathType:Z})=>e.jsxs("p",{style:{color:C[L],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[oe(L),":"]})," ",w.toFixed(2)," (",Z," kills /",p.gamesPlayed," games)"]},L))]}),n&&!R&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",m," parties)"]}),n&&R&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),k&&!n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},f=I.useMemo(()=>{if(!b)return[];const t=b.maxKillsPerGame.slice(0,15),i=c.highlightedPlayer&&t.some(a=>a.playerName===c.highlightedPlayer);if(c.highlightedPlayer&&!i){const a=b.maxKillsPerGame.find(p=>p.playerName===c.highlightedPlayer);a&&t.push({...a})}return t.map((a,p)=>({name:a.playerName,value:a.maxKills,timesAchieved:a.timesAchieved,gameIds:a.gameIds,isHighlightedAddition:p>=15}))},[b,c.highlightedPlayer]),j=I.useMemo(()=>{if(!b)return[];const t=b.maxKillsPerPhase.slice(0,15),i=c.highlightedPlayer&&t.some(a=>a.playerName===c.highlightedPlayer);if(c.highlightedPlayer&&!i){const a=b.maxKillsPerPhase.find(p=>p.playerName===c.highlightedPlayer);a&&t.push({...a})}return t.map((a,p)=>({name:a.playerName,value:a.maxKills,timesAchieved:a.timesAchieved,gameIds:a.gameIds,isHighlightedAddition:p>=15}))},[b,c.highlightedPlayer]),T=({active:t,payload:i,label:a,chartType:p})=>{if(t&&i&&i.length){const n=i[0].payload,k=c.highlightedPlayer===n.name,R=n.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:k?"var(--accent-primary)":"var(--text-primary)"},children:[a,R&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsxs("strong",{children:[p==="game"?"Max kills en une partie":"Max kills en une phase",":"]})," ",n.value]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Nombre de fois:"})," ",n.timesAchieved]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"4px 0",fontSize:"0.8rem"},children:[n.gameIds.length," partie",n.gameIds.length>1?"s":""," concernÃ©e",n.gameIds.length>1?"s":""]}),R&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),k&&!R&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:A("total")}),x&&c.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',c.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:A("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:z,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:c.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:c.highlightedPlayer===a.value?14:12,fontWeight:c.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx($,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(P,{})}),M.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"kills",fill:C[t],onClick:i=>{const a={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(a.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),g(a)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,z.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:A("average")}),D&&c.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',c.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:m,onChange:t=>d(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:le.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(G,{title:A("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:u,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:c.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:c.highlightedPlayer===a.value?14:12,fontWeight:c.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx($,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(r,{})}),M.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"averageKills",fill:C[t],onClick:i=>{const a={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(a.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),g(a)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,u.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",o," ayant au moins ",m," partie",m>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:H("game")}),f.some(t=>t.isHighlightedAddition)&&c.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',c.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:H("game"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:c.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:c.highlightedPlayer===a.value?14:12,fontWeight:c.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx($,{label:{value:"Nombre max de kills en une partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(T,{...t,chartType:"game"})}),e.jsx(Y,{dataKey:"value",shape:t=>{const{x:i,y:a,width:p,height:n,payload:k}=t,R=k,S=c.highlightedPlayer===R.name,W=R.isHighlightedAddition,E=B[R.name]||(S?"var(--accent-primary)":W?"var(--accent-secondary)":"var(--chart-primary)");return e.jsx(X,{x:i,y:a,width:p,height:n,fill:E,stroke:S?"var(--accent-primary)":"none",strokeWidth:S?3:0,strokeDasharray:W?"5,5":"none",opacity:W?.8:1,onClick:()=>{if(R?.gameIds&&R.gameIds.length>0){const v={fromComponent:"Statistiques de Mort - Max Kills par Partie"};R.gameIds.length===1?v.selectedGame=R.gameIds[0]:v.selectedGameIds=R.gameIds,h!=="Tous les camps"&&(v.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),g(v)}},style:{cursor:"pointer"}})}})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:h!=="Tous les camps"||l!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule partie (avec filtres appliquÃ©s)":"Nombre maximum de kills rÃ©alisÃ©s en une seule partie"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:H("phase")}),j.some(t=>t.isHighlightedAddition)&&c.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',c.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:H("phase"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:j,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:i,payload:a})=>e.jsx("text",{x:t,y:i,dy:10,fill:c.highlightedPlayer===a.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:c.highlightedPlayer===a.value?14:12,fontWeight:c.highlightedPlayer===a.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${i})`,children:a.value})}),e.jsx($,{label:{value:"Nombre max de kills en une phase",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(T,{...t,chartType:"phase"})}),e.jsx(Y,{dataKey:"value",shape:t=>{const{x:i,y:a,width:p,height:n,payload:k}=t,R=k,S=c.highlightedPlayer===R.name,W=R.isHighlightedAddition,E=B[R.name]||(S?"var(--accent-primary)":W?"var(--accent-secondary)":"var(--chart-secondary)");return e.jsx(X,{x:i,y:a,width:p,height:n,fill:E,stroke:S?"var(--accent-primary)":"none",strokeWidth:S?3:0,strokeDasharray:W?"5,5":"none",opacity:W?.8:1,onClick:()=>{if(R?.gameIds&&R.gameIds.length>0){const v={fromComponent:"Statistiques de Mort - Max Kills par Phase"};R.gameIds.length===1?v.selectedGame=R.gameIds[0]:v.selectedGameIds=R.gameIds,h!=="Tous les camps"&&(v.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),g(v)}},style:{cursor:"pointer"}})}})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:h!=="Tous les camps"||l!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule phase avec filtres appliquÃ©s":"Nombre maximum de kills rÃ©alisÃ©s en une seule phase"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",textAlign:"center",marginTop:"0.25rem",fontStyle:"italic"},children:"Une phase est une sÃ©quence de jeu : Jour (J1), Nuit (N1), Meeting (M1), etc."})]})]})}function ze({deathStats:s,selectedCamp:h,minGamesForAverage:l,onMinGamesChange:m,availableDeathTypes:d,deathTypeColors:N}){const{navigateToGameDetails:y}=te(),{settings:o}=ae(),{joueursData:g}=se(),c=re(g),[K,B]=I.useState(null),{totalDeathsData:b,survivalRateData:M,highlightedPlayerAddedToDeaths:C,highlightedPlayerAddedToSurvival:A}=I.useMemo(()=>{if(!s)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const u=s.playerDeathStats.sort((i,a)=>a.totalDeaths-i.totalDeaths).slice(0,15),x=o.highlightedPlayer&&u.some(i=>i.playerName===o.highlightedPlayer),D=u.map(i=>{const a=i.gamesPlayed,p=a>0?(a-i.totalDeaths)/a*100:0,n={name:i.playerName,value:i.totalDeaths,totalDeaths:i.totalDeaths,gamesPlayed:a,deathRate:i.deathRate,survivalRate:p,isHighlightedAddition:!1};return d.forEach(k=>{n[k]=i.deathsByType[k]||0}),n});let P=!1;if(o.highlightedPlayer&&!x){const i=s.playerDeathStats.find(a=>a.playerName===o.highlightedPlayer);if(i){const a=i.gamesPlayed,p=a>0?(a-i.totalDeaths)/a*100:0,n={name:i.playerName,value:i.totalDeaths,totalDeaths:i.totalDeaths,gamesPlayed:a,deathRate:i.deathRate,survivalRate:p,isHighlightedAddition:!0};d.forEach(k=>{n[k]=i.deathsByType[k]||0}),D.push(n),P=!0}}const f=s.playerDeathStats.filter(i=>i.gamesPlayed>=l).map(i=>({...i,survivalRate:i.gamesPlayed>0?(i.gamesPlayed-i.totalDeaths)/i.gamesPlayed*100:0})).sort((i,a)=>a.survivalRate-i.survivalRate).slice(0,15),j=o.highlightedPlayer&&f.some(i=>i.playerName===o.highlightedPlayer),T=f.map(i=>{const a={name:i.playerName,value:i.survivalRate,totalDeaths:i.totalDeaths,gamesPlayed:i.gamesPlayed,deathRate:i.deathRate,survivalRate:i.survivalRate,isHighlightedAddition:!1};return d.forEach(p=>{a[p]=i.deathsByType[p]||0}),a});let t=!1;if(o.highlightedPlayer&&!j){const i=s.playerDeathStats.find(a=>a.playerName===o.highlightedPlayer);if(i){const a=i.gamesPlayed>0?(i.gamesPlayed-i.totalDeaths)/i.gamesPlayed*100:0,p={name:i.playerName,value:a,totalDeaths:i.totalDeaths,gamesPlayed:i.gamesPlayed,deathRate:i.deathRate,survivalRate:a,isHighlightedAddition:!0};d.forEach(n=>{p[n]=i.deathsByType[n]||0}),T.push(p),t=!0}}return{totalDeathsData:D,survivalRateData:T,highlightedPlayerAddedToDeaths:P,highlightedPlayerAddedToSurvival:t}},[s,o.highlightedPlayer,l,d]),H=({active:u,payload:x,label:D})=>{if(u&&x&&x.length){const P=x[0].payload,r=P.isHighlightedAddition,f=o.highlightedPlayer===P.name,j=d.reduce((T,t)=>T+(P[t]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:f?"var(--accent-primary)":"var(--text-primary)"},children:[D,r&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",j]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",P.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",P.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),d.map(T=>{const t=P[T]||0;return t===0?null:e.jsxs("p",{style:{color:N[T],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[de(T),":"]})," ",t]},T)})]}),r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),f&&!r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},z=({active:u,payload:x,label:D})=>{if(u&&x&&x.length){const P=x[0].payload,r=P.isHighlightedAddition,f=o.highlightedPlayer===P.name,j=P.gamesPlayed>=l;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:f?"var(--accent-primary)":"var(--text-primary)"},children:[D,r&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",P.survivalRate.toFixed(1),"% (",P.gamesPlayed-P.totalDeaths," survies / ",P.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",P.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",P.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),d.map(T=>{const t=P[T]||0;return t===0?null:e.jsxs("p",{style:{color:N[T],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[de(T),":"]})," ",t]},T)})]}),r&&!j&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties)"]}),r&&j&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),f&&!r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:h==="Tous les camps"?"Morts (Total)":`Morts en ${h} (Total)`}),C&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:h==="Tous les camps"?"Morts (Total)":`Morts en ${h} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:b,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:u,y:x,payload:D})=>e.jsx("text",{x:u,y:x,dy:10,fill:o.highlightedPlayer===D.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===D.value?14:12,fontWeight:o.highlightedPlayer===D.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${u} ${x})`,children:D.value})}),e.jsx($,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(H,{})}),d.map(u=>e.jsx(Y,{dataKey:u,name:u,stackId:"deaths",fill:N[u],onClick:x=>{const D={selectedPlayer:x?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(D.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),y(D)}},u))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,b.filter(u=>!u.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",h==="Tous les camps"?"(Total)":` en ${h}`]}),A&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:l,onChange:u=>m(Number(u.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:le.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsx(G,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:M,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:u,y:x,payload:D})=>e.jsx("text",{x:u,y:x,dy:10,fill:o.highlightedPlayer===D.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===D.value?14:12,fontWeight:o.highlightedPlayer===D.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${u} ${x})`,children:D.value})}),e.jsx($,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(z,{})}),e.jsx(Y,{dataKey:"value",style:{cursor:"pointer"},shape:u=>{const{x,y:D,width:P,height:r,payload:f}=u,j=f,T=o.highlightedPlayer===j.name,t=j.isHighlightedAddition;return e.jsx(X,{x,y:D,width:P,height:r,fill:c[j.name]||"var(--chart-primary)",stroke:T?"var(--accent-primary)":K===j.name?"var(--text-primary)":"none",strokeWidth:T?3:K===j.name?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>{const i={selectedPlayer:j?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(i.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),y(i)},onMouseEnter:()=>B(j?.name||null),onMouseLeave:()=>B(null)})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,M.filter(u=>!u.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",l," partie",l>1?"s":"",")"]})]})]})}function Le({hunterStats:s,isLoading:h,error:l}){const{navigateToGameDetails:m}=te(),{settings:d}=ae(),N=pe(),{joueursData:y}=se(),o=re(y),[g,c]=I.useState(null);if(h)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(l)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",l]});if(!s||s.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:K,highlightedPlayerAddedToBest:B,finalBadHuntersData:b,highlightedPlayerAddedToBad:M}=(()=>{const z=s.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).sort((t,i)=>i.averageNonVillageoisKillsPerGame-t.averageNonVillageoisKillsPerGame).slice(0,15),u=d.highlightedPlayer&&z.some(t=>t.hunterName===d.highlightedPlayer);let x=[...z],D=!1;if(d.highlightedPlayer&&!u){const t=s.hunterStats.find(i=>i.hunterName===d.highlightedPlayer);t&&(x.push({...t,isHighlightedAddition:!0}),D=!0)}const P=s.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).map(t=>({name:t.hunterName,averageVillageoisKills:Number((t.villageoisKills/t.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:t.villageoisKills,totalNonVillageoisKills:t.nonVillageoisKills,totalKills:t.totalKills,gamesPlayed:t.gamesPlayedAsHunter,victimsByCamp:t.victimsByCamp,goodVictimsByCamp:t.goodVictimsByCamp,badVictimsByCamp:t.badVictimsByCamp,hunterName:t.hunterName})),r=P.sort((t,i)=>i.averageVillageoisKills-t.averageVillageoisKills).slice(0,15),f=d.highlightedPlayer&&r.some(t=>t.hunterName===d.highlightedPlayer);let j=[...r],T=!1;if(d.highlightedPlayer&&!f){const t=P.find(i=>i.hunterName===d.highlightedPlayer);t&&(j.push({...t,isHighlightedAddition:!0}),T=!0)}return{finalBestHuntersData:x,highlightedPlayerAddedToBest:D,finalBadHuntersData:j,highlightedPlayerAddedToBad:T}})(),C=({active:H,payload:z,label:u})=>{if(H&&z&&z.length){const x=z[0].payload,D=x.isHighlightedAddition,P=d.highlightedPlayer===x.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:P?"var(--accent-primary)":"var(--text-primary)"},children:[u,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",x.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",x.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",x.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",x.totalKills]}),x.goodVictimsByCamp&&Object.keys(x.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(x.goodVictimsByCamp).map(([r,f])=>e.jsxs("p",{style:{color:N[r]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[r,":"]})," ",f]},r))]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),P&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},A=({active:H,payload:z,label:u})=>{if(H&&z&&z.length){const x=z[0].payload,D=x.isHighlightedAddition,P=d.highlightedPlayer===x.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:P?"var(--accent-primary)":"var(--text-primary)"},children:[u,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",x.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",x.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",x.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",x.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",x.totalKills]}),x.badVictimsByCamp&&Object.keys(x.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(x.badVictimsByCamp).map(([r,f])=>e.jsxs("p",{style:{color:N[r]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[r,":"]})," ",f]},r))]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),P&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),B&&d.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',d.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:K,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:H,y:z,payload:u})=>e.jsx("text",{x:H,y:z,dy:10,fill:d.highlightedPlayer===u.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:d.highlightedPlayer===u.value?14:12,fontWeight:d.highlightedPlayer===u.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${H} ${z})`,children:u.value})}),e.jsx($,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(C,{})}),e.jsx(Y,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",style:{cursor:"pointer"},shape:H=>{const{x:z,y:u,width:x,height:D,payload:P}=H,r=P,f=d.highlightedPlayer===r.hunterName,j=r.isHighlightedAddition;return e.jsx(X,{x:z,y:u,width:x,height:D,fill:o[r.hunterName]||N.Chasseur||"#8884d8",stroke:f?"var(--accent-primary)":g===r.hunterName?"var(--text-primary)":"none",strokeWidth:f?3:g===r.hunterName?2:0,strokeDasharray:j?"5,5":"none",opacity:j?.8:1,onClick:()=>{r?.hunterName&&m({selectedPlayer:r.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:()=>c(r.hunterName||null),onMouseLeave:()=>c(null),style:{cursor:"pointer"}})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,K.filter(H=>!H.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),M&&d.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',d.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:b,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:H,y:z,payload:u})=>e.jsx("text",{x:H,y:z,dy:10,fill:d.highlightedPlayer===u.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:d.highlightedPlayer===u.value?14:12,fontWeight:d.highlightedPlayer===u.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${H} ${z})`,children:u.value})}),e.jsx($,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(A,{})}),e.jsx(Y,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",style:{cursor:"pointer"},shape:H=>{const{x:z,y:u,width:x,height:D,payload:P}=H,r=P,f=d.highlightedPlayer===r.hunterName,j=r.isHighlightedAddition;return e.jsx(X,{x:z,y:u,width:x,height:D,fill:o[r.hunterName]||N.Chasseur||"#8884d8",stroke:f?"var(--accent-primary)":g===r.hunterName?"var(--text-primary)":"none",strokeWidth:f?3:g===r.hunterName?2:0,strokeDasharray:j?"5,5":"none",opacity:j?.8:1,onClick:()=>{r?.hunterName&&m({selectedPlayer:r.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:()=>c(r.hunterName||null),onMouseLeave:()=>c(null),style:{cursor:"pointer"}})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,b.filter(H=>!H.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function Ee({survivalStats:s,selectedCamp:h,minGamesForAverage:l,onMinGamesChange:m,isLoading:d,error:N}){const{navigateToGameDetails:y}=te(),{settings:o}=ae(),{joueursData:g}=se(),c=re(g),[K,B]=I.useState(be.DEFAULT_SELECTED_DAY),[b,M]=I.useState(null),C=I.useMemo(()=>s?s.dayStats.filter(f=>f.totalGamesReachingDay>0).map(f=>f.dayNumber).sort((f,j)=>f-j):[],[s]),A=I.useMemo(()=>C.includes(K)?K:C.length>0?C[0]:1,[K,C]),{highestSurvivalData:H,highlightedPlayerAddedToHighest:z}=I.useMemo(()=>{if(!s)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const r=Te(s,A,l),f=o.highlightedPlayer&&r.some(t=>t.playerName===o.highlightedPlayer),j=r.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let T=!1;if(o.highlightedPlayer&&!f){const t=s.playerSurvivalStats.find(i=>i.playerName===o.highlightedPlayer);if(t&&t.totalGames>=l&&(t.gamesPlayedByDay[A]||0)>0){const i=t.survivalRatesByDay[A]||0;j.push({name:o.highlightedPlayer,value:i,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[A]||0,timesSurvivedDay:t.survivalsByDay[A]||0,isHighlightedAddition:!0}),T=!0}}return{highestSurvivalData:j,highlightedPlayerAddedToHighest:T}},[s,A,l,o.highlightedPlayer]),{lowestSurvivalData:u,highlightedPlayerAddedToLowest:x}=I.useMemo(()=>{if(!s)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const r=Ae(s,A,l),f=o.highlightedPlayer&&r.some(t=>t.playerName===o.highlightedPlayer),j=r.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let T=!1;if(o.highlightedPlayer&&!f){const t=s.playerSurvivalStats.find(i=>i.playerName===o.highlightedPlayer);if(t&&t.totalGames>=l&&(t.gamesPlayedByDay[A]||0)>0){const i=t.survivalRatesByDay[A]||0;j.push({name:o.highlightedPlayer,value:i,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[A]||0,timesSurvivedDay:t.survivalsByDay[A]||0,isHighlightedAddition:!0}),T=!0}}return{lowestSurvivalData:j,highlightedPlayerAddedToLowest:T}},[s,A,l,o.highlightedPlayer]),D=r=>{y({selectedPlayer:r,fromComponent:"Statistiques de Survie"})},P=({active:r,payload:f,label:j})=>{if(r&&f&&f.length>0){const T=f[0].payload,t=T.isHighlightedAddition,i=o.highlightedPlayer===T.name,a=T.gamesPlayed>=l,p=T.timesReachedDay-T.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:j})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",A,": ",T.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",A,": ",T.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",A,": ",T.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",A,": ",p]}),e.jsxs("div",{children:["Total de parties: ",T.gamesPlayed]}),t&&!a&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties au total)"]}),t&&a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),i&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return d?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):N?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",N]}):s?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",A," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",z||x?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:A,onChange:r=>B(parseInt(r.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:C.map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:l,onChange:r=>m(parseInt(r.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:le.map(r=>e.jsx("option",{value:r,children:r},r))})]})]})}),A&&s.dayStats.find(r=>r.dayNumber===A)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:A===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${A}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:s.dayStats.find(r=>r.dayNumber===A)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",A]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(s.dayStats.find(r=>r.dayNumber===A)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",l," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:s.playerSurvivalStats.filter(r=>r.totalGames>=l&&(r.gamesPlayedByDay[A]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",A]}),z&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${A}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:H,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:r,y:f,payload:j})=>e.jsx("text",{x:r,y:f,dy:16,textAnchor:"end",transform:`rotate(-45, ${r}, ${f})`,fill:o.highlightedPlayer===j.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===j.value?14:12,fontWeight:o.highlightedPlayer===j.value?"bold":"normal",children:j.value})}),e.jsx($,{tickFormatter:r=>`${r.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(P,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",shape:r=>{const{x:f,y:j,width:T,height:t,payload:i}=r,a=i,p=o.highlightedPlayer===a.name,n=b===a.name,k=a.isHighlightedAddition;return e.jsx(X,{x:f,y:j,width:T,height:t,fill:c[a.name]||"var(--chart-primary)",stroke:p?"var(--accent-primary)":n?"var(--text-primary)":"none",strokeWidth:p?3:n?2:0,strokeDasharray:k?"5,5":"none",opacity:k?.8:1,onClick:()=>D(a.name),onMouseEnter:()=>M(a.name),onMouseLeave:()=>M(null),style:{cursor:"pointer"}})}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",A]}),x&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${A}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:u,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:r,y:f,payload:j})=>e.jsx("text",{x:r,y:f,dy:16,textAnchor:"end",transform:`rotate(-45, ${r}, ${f})`,fill:o.highlightedPlayer===j.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===j.value?14:12,fontWeight:o.highlightedPlayer===j.value?"bold":"normal",children:j.value})}),e.jsx($,{tickFormatter:r=>`${r.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(P,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",shape:r=>{const{x:f,y:j,width:T,height:t,payload:i}=r,a=i,p=o.highlightedPlayer===a.name,n=b===a.name,k=a.isHighlightedAddition;return e.jsx(X,{x:f,y:j,width:T,height:t,fill:c[a.name]||"var(--chart-color-4)",stroke:p?"var(--accent-primary)":n?"var(--text-primary)":"none",strokeWidth:p?3:n?2:0,strokeDasharray:k?"5,5":"none",opacity:k?.8:1,onClick:()=>D(a.name),onMouseEnter:()=>M(a.name),onMouseLeave:()=>M(null),style:{cursor:"pointer"}})}})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function Oe(){const{navigationState:s,updateNavigationState:h}=te(),[l,m]=I.useState(s.deathStatisticsState?.selectedCamp||s.deathStatsSelectedCamp||"Tous les camps"),[d,N]=I.useState(s.deathStatisticsState?.victimCampFilter||"Tous les camps"),[y,o]=I.useState(s.deathStatisticsState?.minGamesForAverage||25),[g,c]=I.useState(()=>{const n=ne();if(n.deathStatsView&&["killers","deaths","hunter","survival"].includes(n.deathStatsView))return n.deathStatsView;const k=s.deathStatisticsState?.selectedView;return k&&k!=="location"?k:"killers"}),{data:K}=fe(),{data:B,isLoading:b,error:M}=je(l,d),{data:C,isLoading:A,error:H}=Se(),{data:z,isLoading:u,error:x}=Ne(l),{data:D}=ve(),P=pe();I.useEffect(()=>{(!s.deathStatisticsState||s.deathStatisticsState.selectedCamp!==l||s.deathStatisticsState.victimCampFilter!==d||s.deathStatisticsState.minGamesForAverage!==y||s.deathStatisticsState.selectedView!==g)&&h({deathStatisticsState:{selectedCamp:l,victimCampFilter:d,minGamesForAverage:y,selectedView:g,focusChart:s.deathStatisticsState?.focusChart}})},[l,d,y,g,s.deathStatisticsState,h]),I.useEffect(()=>{const n=()=>{const k=ne();if(k.deathStatsView&&["killers","deaths","hunter","survival"].includes(k.deathStatsView)){const R=k.deathStatsView;R!==g&&c(R)}};return window.addEventListener("popstate",n),window.addEventListener("urlchange",n),()=>{window.removeEventListener("popstate",n),window.removeEventListener("urlchange",n)}},[g]);const r=I.useMemo(()=>D?Pe(D):[],[D]),f=I.useMemo(()=>{const n={};r.forEach(S=>{S===F.BY_WOLF?n[S]=P.Loup:S===F.VOTED?n[S]="var(--chart-color-1)":S===F.BULLET||S===F.BULLET_HUMAN||S===F.BULLET_WOLF?n[S]=P.Chasseur:S===F.BY_ZOMBIE?n[S]=P.Vaudou:S===F.ASSASSIN?n[S]=P.Alchimiste:S===F.AVENGER?n[S]="var(--chart-color-2)":S===F.LOVER_DEATH?n[S]=P.Amoureux:S===F.BY_BEAST?n[S]="var(--chart-color-3)":S===F.SHERIF_SUCCESS?n[S]="var(--chart-color-4)":S===F.SMUGGLER_HUNT_KILL&&(n[S]=P.Contrebandier)});const k=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let R=0;return r.forEach(S=>{n[S]||(n[S]=k[R%k.length],R++)}),n},[r,P]),j=n=>{m(n),h({deathStatsSelectedCamp:n,deathStatisticsState:{selectedCamp:n,victimCampFilter:d,minGamesForAverage:y,selectedView:g,focusChart:s.deathStatisticsState?.focusChart}})},T=n=>{N(n),h({deathStatisticsState:{selectedCamp:l,victimCampFilter:n,minGamesForAverage:y,selectedView:g,focusChart:s.deathStatisticsState?.focusChart}})},t=n=>{o(n),h({deathStatisticsState:{selectedCamp:l,victimCampFilter:d,minGamesForAverage:n,selectedView:g,focusChart:s.deathStatisticsState?.focusChart}})},i=n=>{c(n),h({deathStatisticsState:{selectedCamp:l,victimCampFilter:d,minGamesForAverage:y,selectedView:n,focusChart:s.deathStatisticsState?.focusChart}}),xe({deathStatsView:n},"replace")},{gamesWithKillers:a,totalEligibleForAverage:p}=I.useMemo(()=>{if(!B)return{gamesWithKillers:0,totalEligibleForAverage:0};const n=B.killerStats.filter(k=>k.gamesPlayed>=y);return{gamesWithKillers:B.totalGames,totalEligibleForAverage:n.length}},[B,y]);return b?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):M?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",M]}):B?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${g==="killers"?"active":""}`,onClick:()=>i("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${g==="deaths"?"active":""}`,onClick:()=>i("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${g==="survival"?"active":""}`,onClick:()=>i("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${g==="hunter"?"active":""}`,onClick:()=>i("hunter"),children:"Chasseur"})]}),(g==="killers"||g==="deaths"||g==="survival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:l,onChange:n=>j(n.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),K?.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),g==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:d,onChange:n=>T(n.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(g==="killers"||g==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:B.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:B.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:a})]})]}),g==="killers"&&e.jsx(He,{deathStats:B,selectedCamp:l,victimCampFilter:d,minGamesForAverage:y,onMinGamesChange:t,availableDeathTypes:r,deathTypeColors:f,totalEligibleForAverage:p}),g==="deaths"&&e.jsx(ze,{deathStats:B,selectedCamp:l,minGamesForAverage:y,onMinGamesChange:t,availableDeathTypes:r,deathTypeColors:f}),g==="hunter"&&e.jsx(Le,{hunterStats:C,isLoading:A,error:H}),g==="survival"&&e.jsx(Ee,{survivalStats:z,selectedCamp:l,minGamesForAverage:y,onMinGamesChange:t,isLoading:u,error:x})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{Oe as DeathStatisticsChart};
