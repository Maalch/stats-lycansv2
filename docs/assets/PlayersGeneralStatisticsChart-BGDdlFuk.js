import{r as o,j as r}from"./index-tQsKKbSp.js";import{u as J}from"./usePlayerStats-Cn1bF07C.js";import{p as k,l as _,g as H}from"./api-K__vudGA.js";import{u as Q,a as U,r as Z,b as ee,c as re,d as O,s as te,e as ae,f as T,g as ie,h as se,L as ne,i as le,j as B,k as K,R,T as A,C}from"./CategoricalChart-RzgsUDl_.js";import{c as oe,L as ce,r as de,B as V,C as q,X as M,Y as W,a as G}from"./BarChart-Cmbiu_tk.js";import{P as ue,a as xe}from"./PieChart-DrzWERcC.js";import{L as me}from"./Legend-HuZnAmyY.js";function $(e,a){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),s.push.apply(s,n)}return s}function z(e){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?$(Object(s),!0).forEach(function(n){L(e,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))})}return e}function L(e,a,s){return(a=ye(a))in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s,e}function ye(e){var a=he(e,"string");return typeof a=="symbol"?a:a+""}function he(e,a){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,a);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function D(){return D=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},D.apply(null,arguments)}var pe=(e,a)=>{var s;return o.isValidElement(e)?s=o.cloneElement(e,a):typeof e=="function"?s=e(a):s=o.createElement("line",D({},a,{className:"recharts-reference-line-line"})),s},fe=(e,a,s,n,u,c,w,p,d)=>{var{x:f,y:v,width:g,height:x}=u;if(s){var{y:j}=d,m=e.y.apply(j,{position:c});if(B(m)||d.ifOverflow==="discard"&&!e.y.isInRange(m))return null;var y=[{x:f+g,y:m},{x:f,y:m}];return p==="left"?y.reverse():y}if(a){var{x:t}=d,i=e.x.apply(t,{position:c});if(B(i)||d.ifOverflow==="discard"&&!e.x.isInRange(i))return null;var l=[{x:i,y:v+x},{x:i,y:v}];return w==="top"?l.reverse():l}if(n){var{segment:h}=d,S=h.map(P=>e.apply(P,{position:c}));return d.ifOverflow==="discard"&&S.some(P=>!e.isInRange(P))?null:S}return null};function ve(e){var a=Q();return o.useEffect(()=>(a(U(e)),()=>{a(Z(e))})),null}function ge(e){var{x:a,y:s,segment:n,xAxisId:u,yAxisId:c,shape:w,className:p,ifOverflow:d}=e,f=ee(),v=re(),g=O(b=>te(b,u)),x=O(b=>ae(b,c)),j=O(b=>T(b,"xAxis",u,f)),m=O(b=>T(b,"yAxis",c,f)),y=ie(),t=K(a),i=K(s);if(!v||!y||g==null||x==null||j==null||m==null)return null;var l=oe({x:j,y:m}),h=n&&n.length===2,S=fe(l,t,i,h,y,e.position,g.orientation,x.orientation,e);if(!S)return null;var[{x:P,y:E},{x:I,y:F}]=S,X=d==="hidden"?"url(#".concat(v,")"):void 0,Y=z(z({clipPath:X},se(e,!0)),{},{x1:P,y1:E,x2:I,y2:F});return o.createElement(ne,{className:le("recharts-reference-line",p)},pe(w,Y),ce.renderCallByParent(e,de({x1:P,y1:E,x2:I,y2:F})))}function je(e){return o.createElement(o.Fragment,null,o.createElement(ve,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),o.createElement(ge,e))}class N extends o.Component{render(){return o.createElement(je,this.props)}}L(N,"displayName","ReferenceLine");L(N,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Ce(){const{playerStatsData:e,dataLoading:a,fetchError:s}=J(),[n,u]=o.useState(null),[c,w]=o.useState(20),[p,d]=o.useState("best"),f=[5,10,20,30,50,100,150,200];if(a)return r.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques des joueurs..."});if(s)return r.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",s]});if(!e)return r.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de joueur disponible"});const v=e.playerStats.filter(t=>t.gamesPlayed>=c).length,g=e.playerStats.filter(t=>t.gamesPlayed>2).sort((t,i)=>i.gamesPlayed-t.gamesPlayed).slice(0,20),x=e.playerStats.filter(t=>t.gamesPlayed>=c).sort((t,i)=>p==="best"?parseFloat(i.winPercent)-parseFloat(t.winPercent):parseFloat(t.winPercent)-parseFloat(i.winPercent)).slice(0,20),j=e.playerStats.length>0?(e.playerStats.reduce((t,i)=>t+parseFloat(i.winPercent),0)/e.playerStats.length).toFixed(1):"0",y=n?(t=>{const i=e.playerStats.find(l=>l.player===t);return i?Object.entries(i.camps).filter(([l,h])=>h>0).map(([l,h])=>({name:l,value:h,percentage:(h/i.gamesPlayed*100).toFixed(1)})):[]})(n):[];return r.jsxs("div",{className:"lycans-players-stats",children:[r.jsx("h2",{children:"Statistiques des Joueurs"}),r.jsxs("p",{className:"lycans-stats-info",children:["Total de ",e.totalGames," parties analysées avec ",e.playerStats.length," joueurs"]}),r.jsxs("div",{className:"lycans-graphiques-groupe",children:[r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsx("h3",{children:"Top Participations"}),r.jsx("div",{style:{height:400},children:r.jsx(R,{width:"100%",height:"100%",children:r.jsxs(V,{data:g,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(q,{strokeDasharray:"3 3"}),r.jsx(M,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(W,{label:{value:"Nombre de parties",angle:-90,position:"insideLeft"}}),r.jsx(A,{content:({active:t,payload:i})=>{if(t&&i&&i.length>0){const l=i[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:l.player})}),r.jsxs("div",{children:["Parties jouées : ",l.gamesPlayed]}),r.jsxs("div",{children:["Pourcentage : ",l.gamesPlayedPercent,"%"]})]})}return null}}),r.jsx(G,{dataKey:"gamesPlayed",name:"Parties jouées",fill:"#00C49F",children:g.map(t=>r.jsx(C,{fill:k[t.player]||"#00C49F",onClick:()=>u(t.player),style:{cursor:"pointer"}},`cell-participation-${t.player}`))})]})})})]}),r.jsxs("div",{className:"lycans-graphique-section",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[r.jsx("h3",{children:p==="best"?"Meilleurs Taux de Victoire":"Moins Bon Taux de Victoire"}),r.jsxs("div",{className:"lycans-winrate-controls",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),r.jsx("select",{id:"min-games-select",value:c,onChange:t=>w(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:f.map(t=>r.jsx("option",{value:t,children:t},t))}),r.jsxs("select",{value:p,onChange:t=>d(t.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:[r.jsx("option",{value:"best",children:"Meilleurs Taux de Victoire"}),r.jsx("option",{value:"worst",children:"Moins Bon Taux de Victoire"})]})]})]}),r.jsx("div",{style:{height:400},children:r.jsx(R,{width:"100%",height:"100%",children:r.jsxs(V,{data:x,margin:{top:20,right:30,left:20,bottom:70},children:[r.jsx(q,{strokeDasharray:"3 3"}),r.jsx(M,{dataKey:"player",angle:-45,textAnchor:"end",height:80,interval:0}),r.jsx(W,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),r.jsx(A,{content:({active:t,payload:i})=>{if(t&&i&&i.length>0){const l=i[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:l.player})}),r.jsxs("div",{children:["Taux de victoire : ",l.winPercent,"%"]}),r.jsxs("div",{children:["Victoires : ",l.wins," / ",l.gamesPlayed]})]})}return null}}),r.jsx(G,{dataKey:"winPercent",name:"Taux de Victoire",fill:"#8884d8",children:x.map(t=>r.jsx(C,{fill:k[t.player]||"#8884d8",onClick:()=>u(t.player),style:{cursor:"pointer"}},`cell-winrate-${t.player}`))}),r.jsx(N,{y:parseFloat(j),stroke:"red",strokeDasharray:"3 3",label:{value:`Moyenne: ${j}%`,position:"insideBottomRight",fill:"red",fontSize:12,fontWeight:"bold"}})]})})}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",x.length," des joueurs (sur ",v," ayant au moins ",c," partie",c>1?"s":"",")"]})]})]}),n&&r.jsxs("div",{className:"lycans-graphique-section lycans-joueur-details",children:[r.jsxs("h3",{children:["Distribution des Camps - ",n]}),r.jsx("div",{style:{height:300},children:r.jsx(R,{width:"100%",height:"100%",children:r.jsxs(ue,{children:[r.jsx(xe,{data:y,cx:"50%",cy:"50%",labelLine:!0,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:({name:t,percentage:i})=>`${t}: ${i}%`,children:y.map((t,i)=>r.jsx(C,{fill:_[t.name]||H(t.name)},`cell-${i}`))}),r.jsx(A,{content:({active:t,payload:i})=>{if(t&&i&&i.length>0){const l=i[0].payload;return r.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[r.jsx("div",{children:r.jsx("strong",{children:l.name})}),r.jsxs("div",{children:[l.value," parties (",l.percentage,"%)"]})]})}return null}}),r.jsx(me,{})]})})})]})]})}export{Ce as PlayersGeneralStatisticsChart};
