import{r as o,j as e}from"./index-xf6cffmm.js";import{aQ as v,R as d,B as j,C as u,X as h,Y as m,T as x,o as y,aa as g}from"./statsApi-DH7aEbdp.js";import{L as f,a as D}from"./LineChart-X_dxjxU7.js";import{L as p}from"./Legend-CDtnEO_w.js";function b(){const[n,l]=o.useState(null),[t,i]=o.useState(!0),[c,r]=o.useState(null);return o.useEffect(()=>{(async()=>{i(!0),r(null);try{const a=await v();l(a)}catch(a){r(a instanceof Error?a.message:"Une erreur est survenue"),console.error("Error fetching game duration analysis:",a)}finally{i(!1)}})()},[]),{durationAnalysis:n,fetchingData:t,apiError:c}}function R(){const{durationAnalysis:n,fetchingData:l,apiError:t}=b();if(l)return e.jsx("div",{className:"statistiques-attente",children:"Analyse des durées de partie en cours..."});if(t)return e.jsxs("div",{className:"statistiques-echec",children:["Problème rencontré: ",t]});if(!n)return e.jsx("div",{className:"statistiques-indisponibles",children:"Données d'analyse non disponibles"});const i=Object.entries(n.daysByWolfRatio).map(([r,s])=>({ratio:`${parseFloat(r).toFixed(0)}%`,moyenne:parseFloat(s.average),parties:s.count})).sort((r,s)=>parseFloat(r.ratio)-parseFloat(s.ratio)),c=Object.entries(n.daysByWinnerCamp).map(([r,s])=>({camp:r,moyenne:parseFloat(s.average),parties:s.count})).sort((r,s)=>s.moyenne-r.moyenne);return e.jsxs("div",{className:"lycans-duree-analyse",children:[e.jsx("h2",{children:"Analyse des Durées de Partie"}),e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Durée Moyenne"}),e.jsxs("p",{className:"lycans-valeur-principale",children:[n.averageDays," jours"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Durée Minimum"}),e.jsxs("p",{className:"lycans-valeur-principale",children:[n.minDays," jours"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Durée Maximum"}),e.jsxs("p",{className:"lycans-valeur-principale",children:[n.maxDays," jours"]})]})]}),e.jsxs("div",{className:"lycans-graphiques-section",children:[e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Distribution des Durées de Partie"}),e.jsx("div",{style:{height:300},children:e.jsx(d,{width:"100%",height:"100%",children:e.jsxs(j,{data:n.dayDistribution,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(u,{strokeDasharray:"3 3"}),e.jsx(h,{dataKey:"days",label:{value:"Nombre de Jours",position:"insideBottom",offset:-5}}),e.jsx(m,{label:{value:"Nombre de Parties",angle:-90,position:"insideLeft"}}),e.jsx(x,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const a=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:[a.days," jours"]})}),e.jsxs("div",{children:[a.count," parties"]})]})}return null}}),e.jsx(y,{dataKey:"count",name:"Nombre de Parties",fill:"var(--chart-color-2)"})]})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Durée Moyenne par Ratio Loups/Joueurs"}),e.jsx("div",{style:{height:300},children:e.jsx(d,{width:"100%",height:"100%",children:e.jsxs(f,{data:i,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(u,{strokeDasharray:"3 3"}),e.jsx(h,{dataKey:"ratio",label:{value:"Ratio Loups/Joueurs (%)",position:"insideBottom",offset:-5}}),e.jsx(m,{label:{value:"Durée Moyenne (jours)",angle:-90,position:"insideLeft"}}),e.jsx(x,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const a=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Pourcentage de loups : ",a.ratio]})}),e.jsxs("div",{children:["Durée moyenne : ",a.moyenne," jours"]}),e.jsxs("div",{children:["Nombre de parties : ",a.parties]})]})}return null}}),e.jsx(p,{}),e.jsx(D,{type:"monotone",dataKey:"moyenne",name:"Durée Moyenne",stroke:"var(--chart-color-5)",activeDot:{r:8}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-element",children:[e.jsx("h3",{children:"Durée Moyenne par Camp Victorieux"}),e.jsx("div",{style:{height:300},children:e.jsx(d,{width:"100%",height:"100%",children:e.jsxs(j,{data:c,margin:{top:20,right:30,left:20,bottom:60},children:[e.jsx(u,{strokeDasharray:"3 3"}),e.jsx(h,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(m,{label:{value:"Durée Moyenne (jours)",angle:-90,position:"insideLeft"}}),e.jsx(x,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const a=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:a.camp})}),e.jsxs("div",{children:["Durée moyenne : ",a.moyenne," jours"]}),e.jsxs("div",{children:["Nombre de parties : ",a.parties]})]})}return null}}),e.jsx(p,{formatter:r=>r==="moyenne"?"Durée Moyenne":r}),e.jsx(y,{dataKey:"moyenne",name:"moyenne",fill:"var(--chart-color-4)",children:e.jsx(g,{dataKey:"moyenne",position:"top",formatter:r=>{const s=typeof r=="number"?r:Number(r);return isNaN(s)?"":`${s.toFixed(1)}j`},fill:"var(--text-primary)",fontSize:12})})]})})})]})]})]})}export{R as GameDurationInsights};
