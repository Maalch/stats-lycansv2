import{r as o,j as e}from"./index-BfCDFxRF.js";import{R as x,B as v,C as j,X as m,Y as g,T as y,a as f}from"./BarChart-B_McVPj_.js";function S(){const[i,P]=o.useState(null),[d,n]=o.useState(!0),[h,t]=o.useState(null);return o.useEffect(()=>{(async()=>{try{n(!0),t(null);const c=await fetch("https://script.google.com/macros/s/AKfycbxrhG1mb7N6q7Mg88ogw0mirXgSihPpNPurZwiEOy9miG24Cc3AlGZCn2uoGnygNhck/exec?action=playerPairingStats");if(!c.ok)throw new Error(`Erreur API: ${c.status}`);const u=await c.json();P(u)}catch(l){console.error("Erreur lors de la récupération des statistiques de paires:",l),t(l instanceof Error?l.message:"Erreur inconnue")}finally{n(!1)}})()},[]),{data:i,isLoading:d,error:h}}function k(){const{data:i,isLoading:P,error:d}=S(),[n,h]=o.useState("wolves");if(P)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(d)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",d]});if(!i)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const t=i.wolfPairs.pairs.filter(s=>s.appearances>=2).map(s=>({...s,winRateNum:parseFloat(s.winRate)})),p=i.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate)})),l=t.filter(s=>s.appearances>=2),c=p.filter(s=>s.appearances>=2),u=[...t].sort((s,a)=>a.appearances-s.appearances).slice(0,10),b=[...t].sort((s,a)=>a.winRateNum-s.winRateNum).slice(0,10),N=[...p].sort((s,a)=>a.appearances-s.appearances).slice(0,10),w=[...p].sort((s,a)=>a.winRateNum-s.winRateNum).slice(0,10),A=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:i.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:i.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:l.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),u.length>0?e.jsx("div",{style:{height:350},children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(v,{data:u,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(j,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(g,{label:{value:"Apparitions",angle:-90,position:"insideLeft"}}),e.jsx(y,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.pair})}),e.jsxs("div",{children:["Apparitions: ",r.appearances]}),e.jsxs("div",{children:["Victoires: ",r.wins]}),e.jsxs("div",{children:["Taux de victoire: ",r.winRate,"%"]})]})}return null}}),e.jsx(f,{dataKey:"appearances",name:"Apparitions",fill:"var(--chart-color-1)"})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"1rem"},children:"(minimum 2 apparitions)"}),b.length>0?e.jsx("div",{style:{height:320},children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(v,{data:b,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(j,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(g,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(y,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.pair})}),e.jsxs("div",{children:["Taux de victoire: ",r.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.appearances]})]})}return null}}),e.jsx(f,{dataKey:"winRateNum",name:"Taux de victoire (%)",fill:"var(--chart-color-4)"})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})})]})]})]}),R=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:i.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:i.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:c.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),N.length>0?e.jsx("div",{style:{height:350},children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(v,{data:N,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(j,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(g,{label:{value:"Apparitions",angle:-90,position:"insideLeft"}}),e.jsx(y,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.pair})}),e.jsxs("div",{children:["Apparitions: ",r.appearances]}),e.jsxs("div",{children:["Victoires: ",r.wins]}),e.jsxs("div",{children:["Taux de victoire: ",r.winRate,"%"]})]})}return null}}),e.jsx(f,{dataKey:"appearances",name:"Apparitions",fill:"var(--chart-color-5)"})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),w.length>0?e.jsx("div",{style:{height:320},children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(v,{data:w,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(j,{strokeDasharray:"3 3"}),e.jsx(m,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(g,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(y,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const r=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.pair})}),e.jsxs("div",{children:["Taux de victoire: ",r.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",r.wins," / ",r.appearances]})]})}return null}}),e.jsx(f,{dataKey:"winRateNum",name:"Taux de victoire (%)",fill:"var(--chart-color-6)"})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${n==="wolves"?" active":""}`,onClick:()=>h("wolves"),type:"button",children:["Paires de Loups (",i.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${n==="lovers"?" active":""}`,onClick:()=>h("lovers"),type:"button",children:["Paires d'Amoureux (",i.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:n==="wolves"?A():R()})]})}export{k as PlayerPairingStatsChart};
