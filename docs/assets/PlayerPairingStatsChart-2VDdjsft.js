import{r as h,j as e}from"./index-BFKR9s5X.js";import{p as D}from"./api-4z_uY0SA.js";import{R as f,B as b,C as P,X as w,Y as N,T as R,a as A,b as C}from"./BarChart-DDwYEYEi.js";function E(){const[l,k]=h.useState(null),[x,o]=h.useState(!0),[u,n]=h.useState(null);return h.useEffect(()=>{(async()=>{try{o(!0),n(null);const d=await fetch("https://script.google.com/macros/s/AKfycbxrhG1mb7N6q7Mg88ogw0mirXgSihPpNPurZwiEOy9miG24Cc3AlGZCn2uoGnygNhck/exec?action=playerPairingStats");if(!d.ok)throw new Error(`Erreur API: ${d.status}`);const p=await d.json();k(p)}catch(c){console.error("Erreur lors de la récupération des statistiques de paires:",c),n(c instanceof Error?c.message:"Erreur inconnue")}finally{o(!1)}})()},[]),{data:l,isLoading:x,error:u}}function z(){const{data:l,isLoading:k,error:x}=E(),[o,u]=h.useState("wolves");if(k)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de paires..."});if(x)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",x]});if(!l)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de paires disponible"});const n=s=>D[s]||"#8884d8",j=s=>`gradient-${s.replace(/[^a-zA-Z0-9]/g,"")}`,c=s=>s.map(r=>{const[a,t]=r.players,i=n(a),S=n(t),q=j(r.pair);return e.jsxs("linearGradient",{id:q,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:i}),e.jsx("stop",{offset:"50%",stopColor:i}),e.jsx("stop",{offset:"50%",stopColor:S}),e.jsx("stop",{offset:"100%",stopColor:S})]},q)}),d=l.wolfPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:j(s.pair)})),p=l.loverPairs.pairs.map(s=>({...s,winRateNum:parseFloat(s.winRate),gradientId:j(s.pair)})),L=d.filter(s=>s.appearances>=2),I=p.filter(s=>s.appearances>=2),m=[...d].sort((s,r)=>r.appearances-s.appearances).slice(0,10),g=[...d].sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),v=[...p].sort((s,r)=>r.appearances-s.appearances).slice(0,10),y=[...p].sort((s,r)=>r.winRateNum-s.winRateNum).slice(0,10),$=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec Plusieurs Loups"}),e.jsx("div",{className:"lycans-valeur-principale",children:l.wolfPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:l.wolfPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:L.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Fréquentes"}),m.length>0?e.jsx("div",{style:{height:350},children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(b,{data:m,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:c(m)}),e.jsx(P,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(N,{label:{value:"Apparitions",angle:-90,position:"insideLeft"}}),e.jsx(R,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[t,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(t),borderRadius:"2px"}}),e.jsx("span",{children:t}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Apparitions: ",a.appearances]}),e.jsxs("div",{children:["Victoires: ",a.wins]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]})]})}return null}}),e.jsx(A,{dataKey:"appearances",name:"Apparitions",children:m.map((s,r)=>e.jsx(C,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire récurrente trouvée"})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires de Loups les Plus Performantes"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"1rem"},children:"(minimum 2 apparitions)"}),g.length>0?e.jsx("div",{style:{height:320},children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(b,{data:g,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:c(g)}),e.jsx(P,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(N,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(R,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[t,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(t),borderRadius:"2px"}}),e.jsx("span",{children:t}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",a.wins," / ",a.appearances]})]})}return null}}),e.jsx(A,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:g.map((s,r)=>e.jsx(C,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})})]})]})]}),T=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Parties avec des Amoureux"}),e.jsx("div",{className:"lycans-valeur-principale",children:l.loverPairs.totalGames}),e.jsx("p",{children:"parties analysées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Différentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:l.loverPairs.pairs.length}),e.jsx("p",{children:"combinaisons trouvées"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Paires Récurrentes"}),e.jsx("div",{className:"lycans-valeur-principale",children:I.length}),e.jsx("p",{children:"avec 2+ apparitions"})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Fréquentes"}),v.length>0?e.jsx("div",{style:{height:350},children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(b,{data:v,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:c(v)}),e.jsx(P,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(N,{label:{value:"Apparitions",angle:-90,position:"insideLeft"}}),e.jsx(R,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[t,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(t),borderRadius:"2px"}}),e.jsx("span",{children:t}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Apparitions: ",a.appearances]}),e.jsxs("div",{children:["Victoires: ",a.wins]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]})]})}return null}}),e.jsx(A,{dataKey:"appearances",name:"Apparitions",children:v.map((s,r)=>e.jsx(C,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Aucune paire d'amoureux trouvée"})})]}),e.jsxs("div",{className:"lycans-graphique-moitie",children:[e.jsx("h3",{children:"Paires d'Amoureux les Plus Performantes"}),y.length>0?e.jsx("div",{style:{height:320},children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(b,{data:y,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx("defs",{children:c(y)}),e.jsx(P,{strokeDasharray:"3 3"}),e.jsx(w,{dataKey:"pair",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:11}),e.jsx(N,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(R,{content:({active:s,payload:r})=>{if(s&&r&&r.length>0){const a=r[0].payload,[t,i]=a.players;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.pair})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",margin:"4px 0"},children:[e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(t),borderRadius:"2px"}}),e.jsx("span",{children:t}),e.jsx("span",{children:"+"}),e.jsx("span",{style:{width:"12px",height:"12px",backgroundColor:n(i),borderRadius:"2px"}}),e.jsx("span",{children:i})]}),e.jsxs("div",{children:["Taux de victoire: ",a.winRate,"%"]}),e.jsxs("div",{children:["Victoires: ",a.wins," / ",a.appearances]})]})}return null}}),e.jsx(A,{dataKey:"winRateNum",name:"Taux de victoire (%)",children:y.map((s,r)=>e.jsx(C,{fill:`url(#${s.gradientId})`},`cell-${r}`))})]})})}):e.jsx("div",{className:"lycans-empty-section",children:e.jsx("p",{children:"Pas assez de données pour analyser la performance"})})]})]})]});return e.jsxs("div",{className:"lycans-players-pairing",children:[e.jsx("h2",{children:"Analyse des Paires de Joueurs"}),e.jsx("p",{className:"lycans-stats-info",children:"Fréquence et performance des joueurs lorsqu'ils jouent ensemble en tant que loups ou amoureux"}),e.jsxs("nav",{className:"lycans-submenu",children:[e.jsxs("button",{className:`lycans-submenu-btn${o==="wolves"?" active":""}`,onClick:()=>u("wolves"),type:"button",children:["Paires de Loups (",l.wolfPairs.pairs.length,")"]}),e.jsxs("button",{className:`lycans-submenu-btn${o==="lovers"?" active":""}`,onClick:()=>u("lovers"),type:"button",children:["Paires d'Amoureux (",l.loverPairs.pairs.length,")"]})]}),e.jsx("div",{className:"lycans-dashboard-content",children:o==="wolves"?$():T()})]})}export{z as PlayerPairingStatsChart};
