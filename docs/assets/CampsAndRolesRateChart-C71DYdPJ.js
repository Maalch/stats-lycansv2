import{r as c,j as e}from"./index-DV88Is_b.js";import{l as u}from"./api-CzvsImqf.js";import{R as p,B as m,C as x,X as g,Y as j,T as f,L as v,a as y,b as R}from"./BarChart-CQ431gI_.js";function b(){const[a,l]=c.useState(null),[i,n]=c.useState(!0),[t,s]=c.useState(null);return c.useEffect(()=>{(async()=>{try{n(!0),s(null);const d=await fetch("https://script.google.com/macros/s/AKfycbw7amBQVger2k8MpFhueGGtAMUsYioIvdU2yVcixtFuk66a2DRWEpZ_c3xf2nncKjuHPg/exec?action=campWinStats");if(!d.ok)throw new Error(`Erreur réseau: ${d.status}`);const h=await d.json();if(h.error)throw new Error(h.error);l(h)}catch(o){console.error("Erreur lors du chargement des statistiques de victoire:",o),s(o instanceof Error?o.message:"Erreur inconnue")}finally{n(!1)}})()},[]),{campWinStats:a,isLoading:i,errorInfo:t}}const w="#607D8B";function q(){const{campWinStats:a,isLoading:l,errorInfo:i}=b();if(l)return e.jsx("div",{className:"statistiques-chargement",children:"Chargement des statistiques de victoire..."});if(i)return e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",i]});if(!a||!a.campStats||a.campStats.length===0)return e.jsx("div",{className:"statistiques-vide",children:"Aucune donnée de victoire disponible"});const n=a?.soloCamps?.map(t=>({...t,pourcentage:(t.appearances/a.totalGames*100).toFixed(2)}))||[];return e.jsxs("div",{className:"lycans-stats-container",children:[e.jsx("h2",{children:"Statistiques de Victoire par Camp"}),e.jsxs("p",{children:["Total des parties: ",a.totalGames]}),e.jsx("div",{className:"lycans-chart-wrapper",style:{height:400},children:e.jsx(p,{width:"100%",height:"100%",children:e.jsxs(m,{data:a.campStats,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(x,{strokeDasharray:"3 3"}),e.jsx(g,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(j,{label:{value:"Taux de victoire (%)",angle:-90,position:"insideLeft"},domain:[0,100]}),e.jsx(f,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const r=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:r.camp}),e.jsxs("div",{children:["Victoires : ",r.wins]}),e.jsxs("div",{children:["Taux de victoire : ",r.winRate,"%"]})]})}return null}}),e.jsx(v,{formatter:t=>t==="winRate"?"Taux de victoire":t}),e.jsx(y,{dataKey:"winRate",name:"winRate",fill:"#82ca9d",children:a.campStats.map((t,s)=>e.jsx(R,{fill:u[t.camp]||w},`cellule-${s}`))})]})})}),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Statistiques de Fréquence des rôles solo"}),e.jsx("div",{className:"lycans-chart-wrapper",style:{height:400},children:e.jsx(p,{width:"100%",height:"100%",children:e.jsxs(m,{data:n,margin:{top:20,right:30,left:20,bottom:70},children:[e.jsx(x,{strokeDasharray:"3 3"}),e.jsx(g,{dataKey:"soloRole",angle:-45,textAnchor:"end",height:80,interval:0}),e.jsx(j,{label:{value:"Fréquence (%)",angle:-90,position:"insideLeft"},domain:[0,Math.max(...n.map(t=>parseFloat(t.pourcentage)))+5]}),e.jsx(f,{content:({active:t,payload:s})=>{if(t&&s&&s.length>0){const r=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:r.soloRole}),e.jsxs("div",{children:["Apparitions : ",r.appearances]}),e.jsxs("div",{children:["Fréquence : ",r.pourcentage,"%"]})]})}return null}}),e.jsx(v,{formatter:t=>t==="pourcentage"?"Fréquence d'apparition":t}),e.jsx(y,{dataKey:"pourcentage",name:"pourcentage",fill:"#8884d8",children:n.map((t,s)=>e.jsx(R,{fill:u[t.soloRole]||w},`cellule-solo-${s}`))})]})})})]})]})}export{q as CampsAndRolesRateChart};
