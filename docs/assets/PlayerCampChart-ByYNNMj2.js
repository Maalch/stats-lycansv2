import{g as ee,b as he,j as e,u as ge,a as fe,r as D}from"./index-5Ju3r3ey.js";import{u as xe}from"./baseStatsHook-T5X3bnPf.js";import{a as B,b as re,g as ye}from"./datasyncExport-CjB7UYqV.js";import{g as K}from"./roleUtils-CLjkiQQc.js";import{u as je}from"./useJoueursData-CQ5EMHu4.js";import{a as Pe,u as ve,m as Re}from"./api-BNcVDVRn.js";import{F as se,C as ae,X as ie,Y as ne,a as be}from"./FullscreenChart-CCMYHCvv.js";import{R as oe,T as te}from"./CategoricalChart-BMOLuUBJ.js";import{B as Te,a as we}from"./BarChart-CZgH6g3y.js";import{S as Ce,a as Ae}from"./ScatterChart-jMq_EKt6.js";function J(a,r){const c=B(a.MainRoleInitial,a.MainRoleChanges||[]),n=K(a);return ye(c,r,n)}function Z(a,r=!1,c=!1){const n={};return a.forEach(p=>{const m=new Set;p.PlayerStats.forEach(o=>{const l=J(o,{regroupWolfSubRoles:r,regroupVillagers:c});m.add(l)}),m.forEach(o=>{n[o]||(n[o]={totalGames:0,wins:0,winRate:0,players:{}}),n[o].totalGames++});const g=new Set;p.PlayerStats.forEach(o=>{if(o.Victorious){const l=J(o,{regroupWolfSubRoles:r,regroupVillagers:c});g.add(l)}}),g.forEach(o=>{n[o]&&n[o].wins++})}),n}function _(a,r,c=!1,n=!1){const p={};return a.forEach(m=>{m.PlayerStats.forEach(g=>{const o=ee(g),l=g.Username,s=J(g,{regroupWolfSubRoles:c,regroupVillagers:n}),t=s==="Autres"?"R√¥les sp√©ciaux":s;r[t].players[o]||(r[t].players[o]={games:0,wins:0,winRate:0,displayName:l}),r[t].players[o].games++,r[t].players[o].displayName=l,g.Victorious&&r[t].players[o].wins++,p[o]||(p[o]={totalGames:0,camps:{},displayName:l}),p[o].displayName=l,p[o].camps[t]||(p[o].camps[t]={games:0,wins:0,winRate:0,performance:0}),p[o].totalGames++,p[o].camps[t].games++,g.Victorious&&p[o].camps[t].wins++})}),p}function Fe(a){const r={};return r["R√¥les sp√©ciaux"]={totalGames:0,wins:0,winRate:0,players:{}},a.forEach(c=>{c.PlayerStats.forEach(n=>{const p=K(n),m=B(n.MainRoleInitial,n.MainRoleChanges||[]);re(m,p)==="Autres"&&(r["R√¥les sp√©ciaux"].totalGames++,n.Victorious&&r["R√¥les sp√©ciaux"].wins++)})}),r}function Ne(a,r){const c={};return a.forEach(n=>{n.PlayerStats.forEach(p=>{const m=ee(p),g=p.Username,o=K(p);if(re(B(p.MainRoleInitial,p.MainRoleChanges||[]),o)==="Autres"){const s="R√¥les sp√©ciaux";r[s].players[m]||(r[s].players[m]={games:0,wins:0,winRate:0,displayName:g}),r[s].players[m].games++,r[s].players[m].displayName=g,p.Victorious&&r[s].players[m].wins++,c[m]||(c[m]={totalGames:0,camps:{},displayName:g}),c[m].displayName=g,c[m].camps[s]||(c[m].camps[s]={games:0,wins:0,winRate:0,performance:0}),c[m].totalGames++,c[m].camps[s].games++,p.Victorious&&c[m].camps[s].wins++}})}),c}function H(a){Object.keys(a).forEach(r=>{a[r].totalGames>0&&(a[r].winRate=parseFloat((a[r].wins/a[r].totalGames*100).toFixed(2))),Object.keys(a[r].players).forEach(c=>{const n=a[r].players[c];n.games>0&&(n.winRate=parseFloat((n.wins/n.games*100).toFixed(2)))})})}function z(a,r){Object.keys(a).forEach(c=>{Object.keys(a[c].camps).forEach(n=>{const p=a[c].camps[n];p.games>0&&(p.winRate=parseFloat((p.wins/p.games*100).toFixed(2)),r[n]&&r[n].winRate!==void 0?p.performance=parseFloat((p.winRate-r[n].winRate).toFixed(2)):p.performance=0)})})}function Ve(a,r,c){const n=[];return Object.keys(a).forEach(m=>{const g=a[m],o=[];Object.keys(g.camps).forEach(l=>{const s=g.camps[l];if(s.games>=c){const t=r[l]&&r[l].winRate!==void 0?r[l].winRate.toFixed(2):"0.00";o.push({camp:l,games:s.games,wins:s.wins,winRate:s.winRate.toFixed(2),campAvgWinRate:t,performance:s.performance.toFixed(2)})}}),o.sort((l,s)=>parseFloat(s.performance)-parseFloat(l.performance)),o.length>0&&n.push({player:g.displayName,totalGames:g.totalGames,campPerformance:o})}),n.sort((m,g)=>g.totalGames-m.totalGames),{campAverages:Object.keys(r).map(m=>({camp:m,totalGames:r[m].totalGames,wins:r[m].wins,winRate:r[m].winRate.toFixed(2)})),playerPerformanceArray:n}}function Le(a){if(a.length===0)return null;const r=Z(a,!1,!1),c=Z(a,!0,!0),n=Fe(a),p=_(a,r,!1,!1),m=_(a,c,!0,!0),g=Ne(a,n);H(r),H(c),H(n),z(p,r),z(m,c),z(g,n);const o={...r},l={...p};c.Loup&&(o["Camp Loup"]=c.Loup,Object.keys(m).forEach(x=>{l[x]||(l[x]=m[x]),m[x].camps.Loup&&(l[x].camps["Camp Loup"]=m[x].camps.Loup)})),c.Villageois&&(o["Camp Villageois"]=c.Villageois,Object.keys(m).forEach(x=>{l[x]||(l[x]=m[x]),m[x].camps.Villageois&&(l[x].camps["Camp Villageois"]=m[x].camps.Villageois)})),n["R√¥les sp√©ciaux"]&&(o["R√¥les sp√©ciaux"]=n["R√¥les sp√©ciaux"],Object.keys(g).forEach(x=>{l[x]||(l[x]=g[x]),g[x].camps["R√¥les sp√©ciaux"]&&(l[x].camps["R√¥les sp√©ciaux"]=g[x].camps["R√¥les sp√©ciaux"])}));const s=3,{campAverages:t,playerPerformanceArray:b}=Ve(l,o,s);return{campAverages:t,playerPerformance:b,minGamesRequired:s}}function We(){const{data:a,isLoading:r,error:c}=xe(Le);return{playerCampPerformance:a,isLoading:r,error:c}}function le({infoId:a,title:r,children:c}){const{activeInfo:n,toggleInfo:p}=he(),m=n===a;return e.jsxs("div",{className:"info-bubble-container",children:[e.jsx("button",{className:"info-bubble-trigger",onClick:()=>p(a),"aria-label":"Afficher les informations",title:"Informations sur ce graphique",children:"‚ÑπÔ∏è"}),m&&e.jsxs("div",{className:"info-bubble-content",children:[e.jsxs("div",{className:"info-bubble-header",children:[e.jsx("h4",{children:r}),e.jsx("button",{className:"info-bubble-close",onClick:()=>p(a),"aria-label":"Fermer",children:"‚úï"})]}),e.jsx("div",{className:"info-bubble-body",children:c})]})]})}function De({viewMode:a,selectedCamp:r,minGames:c,chartData:n,highlightedPlayer:p,lycansColorScheme:m,playersColor:g,onBarClick:o}){return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("h3",{style:{margin:0},children:a==="performance"?r==="Tous les camps"?"Meilleures performances - Tous les camps":`Meilleurs joueurs en ${r}`:r==="Tous les camps"?"Plus grand % de parties - Tous les camps":`Plus grand % de parties en ${r}`}),e.jsx(le,{infoId:`bar-chart-${a}-${r}`,title:"√Ä propos de ce graphique",children:a==="performance"?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Filtres actuels :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affichage :"})," Meilleures Performances"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Camp/R√¥le :"})," ",r]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Minimum de parties :"})," ",c]})]}),(r==="Tous les camps"||r==="Camp Villageois"||r==="Camp Loup"||r==="R√¥les sp√©ciaux")&&e.jsxs("p",{style:{background:"var(--bg-primary)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.5rem"},children:[e.jsxs("strong",{children:["‚ÑπÔ∏è ",r," :"]})," ",r==="Tous les camps"&&"Affiche le meilleur r√¥le de chaque joueur (toutes cat√©gories confondues).",r==="Camp Villageois"&&"Inclut Villageois, Chasseur, Alchimiste, Protecteur et Disciple.",r==="Camp Loup"&&"Inclut Loup, Tra√Ætre et Louveteau.",r==="R√¥les sp√©ciaux"&&"Inclut les r√¥les solo comme Amoureux, Idiot du Village, Agent, etc."]}),e.jsx("p",{children:e.jsx("strong",{children:"Comment √ßa marche :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Taux personnel"})," : Le pourcentage de victoires du joueur dans ce camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Moyenne du camp"})," : Le taux de victoire moyen de tous les joueurs dans ce camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Performance"})," : La diff√©rence entre le taux personnel et la moyenne du camp"]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Interpr√©tation :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Performance positive (+)"})," : Le joueur performe mieux que la moyenne"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Performance n√©gative (-)"})," : Le joueur performe moins bien que la moyenne"]})]}),e.jsxs("p",{children:[e.jsx("em",{children:"Exemple :"})," Si un joueur a 60% de victoires en Camp Villageois et que la moyenne est 45%, sa performance est de ",e.jsx("code",{children:"+15%"}),"."]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Filtres actuels :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affichage :"})," Pourcentage de Parties Jou√©es"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Camp/R√¥le :"})," ",r]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Minimum de parties :"})," ",c]})]}),(r==="Tous les camps"||r==="Camp Villageois"||r==="Camp Loup"||r==="R√¥les sp√©ciaux")&&e.jsxs("p",{style:{background:"var(--bg-primary)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.5rem"},children:[e.jsxs("strong",{children:["‚ÑπÔ∏è ",r," :"]})," ",r==="Tous les camps"&&"Affiche le r√¥le le plus jou√© par chaque joueur (toutes cat√©gories confondues).",r==="Camp Villageois"&&"Inclut Villageois, Chasseur, Alchimiste, Protecteur et Disciple.",r==="Camp Loup"&&"Inclut Loup, Tra√Ætre et Louveteau.",r==="R√¥les sp√©ciaux"&&"Inclut les r√¥les solo comme Amoureux, Idiot du Village, Agent, etc."]}),e.jsx("p",{children:e.jsx("strong",{children:"Comment √ßa marche :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Parties dans ce r√¥le"})," : Nombre de parties jou√©es avec ce r√¥le/camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Total parties"})," : Nombre total de parties jou√©es par le joueur"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Pourcentage"})," : (Parties dans ce r√¥le / Total parties) √ó 100"]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Interpr√©tation :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Un ",e.jsx("strong",{children:"pourcentage √©lev√©"})," indique que le joueur a souvent eu ce r√¥le"]}),e.jsxs("li",{children:["Permet d'identifier les ",e.jsx("strong",{children:"r√¥les r√©currents"})," pour chaque joueur"]}),e.jsxs("li",{children:["Utile pour comprendre l'",e.jsx("strong",{children:"exp√©rience de jeu"})," de chacun"]})]})]})})]}),e.jsx(se,{title:a==="performance"?r==="Tous les camps"?"Meilleures Performances - Tous les camps":`Meilleurs Joueurs - ${r}`:r==="Tous les camps"?"Pourcentage de Parties Jou√©es - Tous les camps":`Pourcentage de Parties Jou√©es - ${r}`,children:e.jsx("div",{style:{height:500},children:e.jsx(oe,{width:"100%",height:"100%",children:e.jsxs(Te,{data:n,margin:{top:20,right:30,left:20,bottom:0},children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(ie,{dataKey:r==="Tous les camps"?"uniqueKey":"player",angle:-45,textAnchor:"end",height:110,interval:0,fontSize:15,tick:({x:l,y:s,payload:t,index:b})=>{const x=n[b],F=x?.player||t.value,k=p===(x?.player||t.value);return e.jsx("text",{x:l,y:s,dy:16,textAnchor:"end",fill:k?"var(--accent-primary)":"var(--text-secondary)",fontSize:k?14:13,fontWeight:k?"bold":"italic",transform:`rotate(-45 ${l} ${s})`,children:F})}}),e.jsx(ne,{domain:a==="playPercentage"?[0,100]:["auto","auto"],label:{value:a==="performance"?"Performance vs moyenne (%)":"Pourcentage de parties jou√©es (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(te,{content:({active:l,payload:s})=>{if(l&&s&&s.length>0){const t=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r==="Tous les camps"?`${t.player} - ${t.camp}`:t.player})}),a==="performance"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties: ",t.games]}),e.jsxs("div",{children:["Victoires: ",t.wins]}),e.jsxs("div",{children:["Taux personnel: ",t.winRate,"%"]}),r!=="Tous les camps"&&e.jsxs("div",{children:["Moyenne camp: ",t.campAvgWinRate,"%"]}),e.jsxs("div",{children:["Performance: ",t.performance>0?"+":"",t.performance]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties dans ce r√¥le: ",t.games]}),e.jsxs("div",{children:["Total parties: ",t.totalGames]}),e.jsxs("div",{children:["Pourcentage: ",t.playPercentage?.toFixed(1),"%"]}),e.jsxs("div",{children:["Victoires: ",t.wins]}),e.jsxs("div",{children:["Taux de victoire: ",t.winRate,"%"]})]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(we,{dataKey:a==="performance"?"performanceNum":"playPercentage",style:{cursor:"pointer"},onClick:o,children:n.map((l,s)=>{const t=p===l.player,b=l.isHighlightedAddition;let x;return r==="Tous les camps"?x=m[l.camp]||`var(--chart-color-${s%6+1})`:x=g[l.player]||"var(--accent-primary)",e.jsx(be,{fill:x,stroke:t?"var(--accent-primary)":"transparent",strokeWidth:t?3:0,strokeDasharray:b?"5,5":"none",opacity:b?.8:1},`cell-${s}`)})})]})})})})]})}function ke({viewMode:a,selectedCamp:r,minGames:c,chartData:n,highlightedPlayer:p,lycansColorScheme:m,playersColor:g,onScatterClick:o}){return e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("h3",{style:{margin:0},children:a==="performance"?r==="Tous les camps"?"Vue Partie/Performance - Tous les camps":`Vue Partie/Performance - ${r}`:r==="Tous les camps"?"Vue Pourcentage/Taux de victoire - Tous les camps":`Vue Pourcentage/Taux de victoire - ${r}`}),e.jsx(le,{infoId:`scatter-chart-${a}-${r}`,title:"√Ä propos de ce graphique",children:a==="performance"?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Filtres actuels :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affichage :"})," Vue Nuage de Points (Parties vs Performance)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Camp/R√¥le :"})," ",r]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Minimum de parties :"})," ",c]})]}),(r==="Tous les camps"||r==="Camp Villageois"||r==="Camp Loup"||r==="R√¥les sp√©ciaux")&&e.jsxs("p",{style:{background:"var(--bg-primary)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.5rem"},children:[e.jsxs("strong",{children:["‚ÑπÔ∏è ",r," :"]})," ",r==="Tous les camps"&&"Affiche le meilleur r√¥le de chaque joueur (toutes cat√©gories confondues).",r==="Camp Villageois"&&"Inclut Villageois, Chasseur, Alchimiste, Protecteur et Disciple.",r==="Camp Loup"&&"Inclut Loup, Tra√Ætre et Louveteau.",r==="R√¥les sp√©ciaux"&&"Inclut les r√¥les solo comme Amoureux, Idiot du Village, Agent, etc."]}),e.jsx("p",{children:e.jsx("strong",{children:"Comment lire ce graphique :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Axe horizontal (X)"})," : Nombre de parties jou√©es"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Axe vertical (Y)"})," : Performance par rapport √† la moyenne du camp"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Chaque point"})," : Repr√©sente un joueur (initiale affich√©e)"]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Interpr√©tation :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Points hauts"})," : Joueurs avec meilleure performance que la moyenne"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Points bas"})," : Joueurs avec performance inf√©rieure √† la moyenne"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Points √† droite"})," : Joueurs avec plus d'exp√©rience (plus de parties)"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Filtres actuels :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affichage :"})," Vue Nuage de Points (Pourcentage vs Taux de victoire)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Camp/R√¥le :"})," ",r]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Minimum de parties :"})," ",c]})]}),(r==="Tous les camps"||r==="Camp Villageois"||r==="Camp Loup"||r==="R√¥les sp√©ciaux")&&e.jsxs("p",{style:{background:"var(--bg-primary)",padding:"0.75rem",borderRadius:"6px",marginTop:"0.5rem"},children:[e.jsxs("strong",{children:["‚ÑπÔ∏è ",r," :"]})," ",r==="Tous les camps"&&"Affiche le r√¥le le plus jou√© par chaque joueur (toutes cat√©gories confondues).",r==="Camp Villageois"&&"Inclut Villageois, Chasseur, Alchimiste, Protecteur et Disciple.",r==="Camp Loup"&&"Inclut Loup, Tra√Ætre et Louveteau.",r==="R√¥les sp√©ciaux"&&"Inclut les r√¥les solo comme Amoureux, Idiot du Village, Agent, etc."]}),e.jsx("p",{children:e.jsx("strong",{children:"Comment lire ce graphique :"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Axe horizontal (X)"})," : ",r==="Tous les camps"?"Nombre de parties dans ce r√¥le":"Nombre de parties"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Axe vertical (Y)"})," : ",r==="Tous les camps"?"Pourcentage de parties jou√©es avec ce r√¥le":"Taux de victoire (%)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Chaque point"})," : Repr√©sente un joueur (initiale affich√©e)"]})]}),e.jsx("p",{children:e.jsx("strong",{children:"Interpr√©tation :"})}),e.jsxs("ul",{children:[r==="Tous les camps"?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Points hauts"})," : Joueurs qui ont souvent ce r√¥le"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Points bas"})," : Joueurs qui ont rarement ce r√¥le"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Points hauts"})," : Joueurs avec taux de victoire √©lev√©"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Points bas"})," : Joueurs avec taux de victoire faible"]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Points √† droite"})," : Plus d'exp√©rience avec ce camp/r√¥le"]})]})]})})]}),e.jsx(se,{title:a==="performance"?r==="Tous les camps"?"Vue Partie/Performance - Tous les camps":`Vue Partie/Performance - ${r}`:r==="Tous les camps"?"Vue Pourcentage/Taux de victoire - Tous les camps":`Vue Pourcentage/Taux de victoire - ${r}`,children:e.jsx("div",{style:{height:500},children:e.jsx(oe,{width:"100%",height:"100%",children:e.jsxs(Ce,{margin:{top:20,right:30,left:20,bottom:40},children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(ie,{type:"number",dataKey:"games",name:"Parties",label:{value:"Nombre de parties",position:"bottom"}}),e.jsx(ne,{type:"number",dataKey:a==="performance"?"performanceNum":r==="Tous les camps"?"playPercentage":"winRateNum",name:a==="performance"?"Performance":r==="Tous les camps"?"Pourcentage":"Taux de victoire",domain:a==="performance"?["auto","auto"]:[0,100],label:{value:a==="performance"?"Performance vs moyenne (%)":r==="Tous les camps"?"Pourcentage de parties jou√©es (%)":"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(te,{cursor:{strokeDasharray:"3 3"},content:({active:l,payload:s})=>{if(l&&s&&s.length>0){const t=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:r==="Tous les camps"?`${t.player} - ${t.camp}`:t.player})}),a==="performance"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties: ",t.games]}),e.jsxs("div",{children:["Victoires: ",t.wins]}),e.jsxs("div",{children:["Taux personnel: ",t.winRate,"%"]}),r!=="Tous les camps"&&e.jsxs("div",{children:["Moyenne camp: ",t.campAvgWinRate,"%"]}),e.jsxs("div",{children:["Performance: ",t.performance>0?"+":"",t.performance]})]}):e.jsx(e.Fragment,{children:r==="Tous les camps"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties dans ce r√¥le: ",t.games]}),e.jsxs("div",{children:["Total parties: ",t.totalGames]}),e.jsxs("div",{children:["Pourcentage: ",t.playPercentage?.toFixed(1),"%"]}),e.jsxs("div",{children:["Victoires: ",t.wins]}),e.jsxs("div",{children:["Taux de victoire: ",t.winRate,"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Parties: ",t.games]}),e.jsxs("div",{children:["Victoires: ",t.wins]}),e.jsxs("div",{children:["Taux de victoire: ",t.winRate,"%"]})]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"üñ±Ô∏è Cliquez pour voir les parties"})]})}return null}}),e.jsx(Ae,{data:n,onClick:o,shape:l=>{const s=p===l.payload?.player,t=l.payload?.isHighlightedAddition;return e.jsxs("g",{style:{cursor:"pointer"},children:[e.jsx("circle",{cx:l.cx,cy:l.cy,r:s?15:12,fill:r==="Tous les camps"?m[l.payload?.camp]||"var(--accent-primary)":g[l.payload?.player]||"var(--accent-primary)",stroke:s?"var(--accent-primary)":"#222",strokeWidth:s?3:1,strokeDasharray:t?"5,5":"none",opacity:t?.8:1}),e.jsx("text",{x:l.cx,y:l.cy,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",fontSize:s?"12":"10",fontWeight:"bold",pointerEvents:"none",children:l.payload?.player?.charAt(0).toUpperCase()})]})}})]})})})})]})}function Be(){const{navigateToGameDetails:a,navigationState:r,updateNavigationState:c}=ge(),{settings:n}=fe(),p=Pe(),{joueursData:m}=je(),g=ve(m),[o,l]=D.useState(r.campPerformanceState?.viewMode||"performance"),[s,t]=D.useState(r.campPerformanceState?.selectedCampPerformanceCamp||"Camp Villageois"),[b,x]=D.useState(r.campPerformanceState?.selectedCampPerformanceMinGames||50),{playerCampPerformance:F,isLoading:k,error:O}=We();D.useEffect(()=>{r.campPerformanceState||c({campPerformanceState:{viewMode:o,selectedCampPerformanceCamp:s,selectedCampPerformanceMinGames:b}})},[o,s,b,r.campPerformanceState,c]);const ce=D.useMemo(()=>{if(!F?.campAverages)return["Tous les camps"];const i=F.campAverages.map(L=>L.camp),u=["Tous les camps"];i.includes("Camp Villageois")&&u.push("Camp Villageois"),i.includes("Villageois")&&u.push("Villageois"),i.includes("Chasseur")&&u.push("Chasseur"),i.includes("Alchimiste")&&u.push("Alchimiste"),i.includes("Protecteur")&&u.push("Protecteur"),i.includes("Disciple")&&u.push("Disciple"),i.includes("Camp Loup")&&u.push("Camp Loup"),i.includes("Loup")&&u.push("Loup"),i.includes("Tra√Ætre")&&u.push("Tra√Ætre"),i.includes("Louveteau")&&u.push("Louveteau"),i.includes("R√¥les sp√©ciaux")&&u.push("R√¥les sp√©ciaux");const R=["Camp Villageois","Camp Loup","R√¥les sp√©ciaux"],N=[...["Camp Villageois","Villageois","Chasseur","Alchimiste","Protecteur","Disciple","Camp Loup","Loup","Tra√Ætre","Louveteau"],...R],$=i.filter(L=>!N.includes(L)).sort();return[...u,...$]},[F]),{campPlayPercentageData:me,topPlayPercentageData:pe,totalPlayPercentagePlayers:G}=D.useMemo(()=>{if(!F?.playerPerformance||o!=="playPercentage")return{campPlayPercentageData:[],topPlayPercentageData:[],totalPlayPercentagePlayers:0};const{playerPerformance:i}=F,u=[],R=[],w=new Map;for(const f of i){const T=f.campPerformance.reduce((h,A)=>h+A.games,0);for(const h of f.campPerformance)if(h.games>=b){const A=h.games/T*100,d=`${f.player}-${h.camp}`,j={player:f.player,camp:h.camp,games:h.games,wins:h.wins,winRate:h.winRate,performance:h.performance,winRateNum:parseFloat(h.winRate),performanceNum:parseFloat(h.performance),campAvgWinRateNum:parseFloat(h.campAvgWinRate),totalGames:T,playPercentage:A,isHighlightedAddition:!1,uniqueKey:d,playerCamp:d},V=w.get(f.player);(!V||j.playPercentage>V.playPercentage)&&w.set(f.player,j),s!=="Tous les camps"&&h.camp===s&&u.push(j)}}R.push(...w.values());const N=(f,T,h=!1)=>{if(!n.highlightedPlayer||f.some(P=>P.player===n.highlightedPlayer&&(!T||P.camp===T)))return f;const d=i.find(P=>P.player===n.highlightedPlayer);if(!d)return f;const j=d.campPerformance.reduce((P,C)=>P+C.games,0);if(h){let P=null;for(const C of d.campPerformance)if(C.games>=1){const M=C.games/j*100,Y=`${d.player}-${C.camp}`,Q={player:d.player,camp:C.camp,games:C.games,wins:C.wins,winRate:C.winRate,performance:C.performance,winRateNum:parseFloat(C.winRate),performanceNum:parseFloat(C.performance),campAvgWinRateNum:parseFloat(C.campAvgWinRate),totalGames:j,playPercentage:M,isHighlightedAddition:!0,uniqueKey:Y,playerCamp:Y};(!P||Q.playPercentage>P.playPercentage)&&(P=Q)}return P?[...f,P]:f}const V=[];for(const P of d.campPerformance)if((!T||P.camp===T)&&P.games>=1){const C=P.games/j*100,M=`${d.player}-${P.camp}`;V.push({player:d.player,camp:P.camp,games:P.games,wins:P.wins,winRate:P.winRate,performance:P.performance,winRateNum:parseFloat(P.winRate),performanceNum:parseFloat(P.performance),campAvgWinRateNum:parseFloat(P.campAvgWinRate),totalGames:j,playPercentage:C,isHighlightedAddition:!0,uniqueKey:M,playerCamp:M})}return[...f,...V]},$=s!=="Tous les camps"?N(u,s,!1):[],L=N(R,void 0,!0),S=$.sort((f,T)=>T.playPercentage-f.playPercentage),I=L.sort((f,T)=>T.playPercentage-f.playPercentage),q=(f,T)=>{const h=f.slice(0,T);if(h.some(j=>j.player===n.highlightedPlayer)||!n.highlightedPlayer)return h;const d=f.find(j=>j.player===n.highlightedPlayer);if(d){const j={...d,isHighlightedAddition:!0};return[...h,j]}return h};let W=0;s==="Tous les camps"?W=w.size:W=u.length;const v=q(S,15),y=q(I,15);return{campPlayPercentageData:v,topPlayPercentageData:y,totalPlayPercentagePlayers:W}},[F,s,b,n.highlightedPlayer,o]),{campPlayerData:ue,topPerformersData:de,totalMatchingPlayers:E}=D.useMemo(()=>{if(!F?.playerPerformance||o!=="performance")return{campPlayerData:[],topPerformersData:[],totalMatchingPlayers:0};const{playerPerformance:i}=F,u=[],R=[],w=new Map;for(const v of i)for(const y of v.campPerformance)if(y.games>=b){const f=`${v.player}-${y.camp}`,T={player:v.player,camp:y.camp,games:y.games,wins:y.wins,winRate:y.winRate,performance:y.performance,winRateNum:parseFloat(y.winRate),performanceNum:parseFloat(y.performance),campAvgWinRateNum:parseFloat(y.campAvgWinRate),isHighlightedAddition:!1,uniqueKey:f,playerCamp:f},h=w.get(v.player);(!h||T.performanceNum>h.performanceNum)&&w.set(v.player,T),s!=="Tous les camps"&&y.camp===s&&u.push({player:v.player,...y,winRateNum:parseFloat(y.winRate),performanceNum:parseFloat(y.performance),campAvgWinRateNum:parseFloat(y.campAvgWinRate),isHighlightedAddition:!1,uniqueKey:f,playerCamp:f})}R.push(...w.values());const N=(v,y,f=!1)=>{if(!n.highlightedPlayer||v.some(d=>d.player===n.highlightedPlayer&&(!y||d.camp===y)))return v;const h=i.find(d=>d.player===n.highlightedPlayer);if(!h)return v;if(f){let d=null;for(const j of h.campPerformance)if(j.games>=1){const V=`${h.player}-${j.camp}`,P={player:h.player,camp:j.camp,games:j.games,wins:j.wins,winRate:j.winRate,performance:j.performance,winRateNum:parseFloat(j.winRate),performanceNum:parseFloat(j.performance),campAvgWinRateNum:parseFloat(j.campAvgWinRate),isHighlightedAddition:!0,uniqueKey:V,playerCamp:V};(!d||P.performanceNum>d.performanceNum)&&(d=P)}return d?[...v,d]:v}const A=[];for(const d of h.campPerformance)if((!y||d.camp===y)&&d.games>=1){const j=`${h.player}-${d.camp}`;A.push({player:h.player,camp:d.camp,games:d.games,wins:d.wins,winRate:d.winRate,performance:d.performance,winRateNum:parseFloat(d.winRate),performanceNum:parseFloat(d.performance),campAvgWinRateNum:parseFloat(d.campAvgWinRate),isHighlightedAddition:!0,uniqueKey:j,playerCamp:j})}return[...v,...A]},$=s!=="Tous les camps"?N(u,s,!1):[],L=N(R,void 0,!0),S=$.sort((v,y)=>y.performanceNum-v.performanceNum),I=L.sort((v,y)=>y.performanceNum-v.performanceNum),q=(v,y)=>{const f=v.slice(0,y);if(f.some(A=>A.player===n.highlightedPlayer)||!n.highlightedPlayer)return f;const h=v.find(A=>A.player===n.highlightedPlayer);if(h){const A={...h,isHighlightedAddition:!0};return[...f,A]}return f};let W=0;return s==="Tous les camps"?W=w.size:W=u.length,{campPlayerData:q(S,15),topPerformersData:q(I,15),totalMatchingPlayers:W}},[F,s,b,n.highlightedPlayer,o]),U=i=>{i&&i.player&&(s!=="Tous les camps"?a(s==="Camp Loup"?{selectedPlayer:i.player,campFilter:{selectedCamp:"Camp Loup",campFilterMode:"wins-only",excludeWolfSubRoles:!1},fromComponent:`Performance des Joueurs - ${s}`}:s==="Camp Villageois"?{selectedPlayer:i.player,campFilter:{selectedCamp:"Villageois",campFilterMode:"wins-only",excludeVillagers:!1},fromComponent:`Performance des Joueurs - ${s}`}:s==="R√¥les sp√©ciaux"?{selectedPlayer:i.player,fromComponent:`Performance des Joueurs - ${s}`}:{selectedPlayer:i.player,campFilter:{selectedCamp:s,campFilterMode:"wins-only",excludeWolfSubRoles:s==="Tra√Ætre"||s==="Louveteau",excludeVillagers:s==="Chasseur"||s==="Alchimiste"||s==="Protecteur"||s==="Disciple"},fromComponent:`Performance des Joueurs - ${s}`}):i.camp==="Camp Loup"?a({selectedPlayer:i.player,campFilter:{selectedCamp:"Loup",campFilterMode:"wins-only",excludeWolfSubRoles:!1},fromComponent:"Performance des Joueurs - Tous les camps"}):i.camp==="Camp Villageois"?a({selectedPlayer:i.player,campFilter:{selectedCamp:"Villageois",campFilterMode:"wins-only",excludeWolfSubRoles:!0},fromComponent:"Performance des Joueurs - Tous les camps"}):i.camp==="R√¥les sp√©ciaux"?a({selectedPlayer:i.player,fromComponent:"Performance des Joueurs - Tous les camps"}):a({selectedPlayer:i.player,campFilter:{selectedCamp:i.camp,campFilterMode:"wins-only",excludeWolfSubRoles:i.camp==="Tra√Ætre"||i.camp==="Louveteau",excludeVillagers:i.camp==="Chasseur"||i.camp==="Alchimiste"||i.camp==="Protecteur"||i.camp==="Disciple"},fromComponent:"Performance des Joueurs - Tous les camps"}))};if(k)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de performance par camp..."});if(O)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",O]});if(!F)return e.jsx("div",{className:"donnees-manquantes",children:"Aucune donn√©e de performance par camp disponible"});const X=o==="performance"?s==="Tous les camps"?de:ue:s==="Tous les camps"?pe:me;return e.jsxs("div",{className:"lycans-player-camp-performance",children:[e.jsx("h2",{children:o==="performance"?"Meilleures Performances par Camp":"Pourcentage de Parties Jou√©es par R√¥le"}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"view-mode-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Affichage:"}),e.jsxs("select",{id:"view-mode-select",value:o,onChange:i=>{const u=i.target.value;l(u),c({campPerformanceState:{viewMode:u,selectedCampPerformanceCamp:s,selectedCampPerformanceMinGames:b}})},style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"200px"},children:[e.jsx("option",{value:"performance",children:"üèÜ Meilleures performances"}),e.jsx("option",{value:"playPercentage",children:"üìä % parties jou√©es"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsx("select",{id:"camp-select",value:s,onChange:i=>{const u=i.target.value;t(u),c({campPerformanceState:{viewMode:o,selectedCampPerformanceCamp:u,selectedCampPerformanceMinGames:b}})},style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"200px"},children:ce.map(i=>{let u=i,R=!1,w=!1,N=!1;return i==="Tous les camps"?(u="üìä Tous les camps",N=!0):i==="Camp Villageois"?(u="   üèòÔ∏è Camp Villageois",R=!0,w=!0):i==="Villageois"?(u="   Villageois",R=!0):i==="Chasseur"?(u="     Chasseur",R=!0):i==="Alchimiste"?(u="     Alchimiste",R=!0):i==="Protecteur"?(u="     Protecteur",R=!0):i==="Disciple"?(u="     Disciple",R=!0):i==="Camp Loup"?(u="   üê∫ Camp Loup",R=!0,w=!0):i==="Loup"?(u="     Loup",R=!0):i==="Tra√Ætre"?(u="     Tra√Ætre",R=!0):i==="Louveteau"?(u="     Louveteau",R=!0):i==="R√¥les sp√©ciaux"?(u="   ‚≠ê R√¥les sp√©ciaux",R=!0,w=!0):(u=`     ${i}`,R=!0),e.jsx("option",{value:i,style:{fontFamily:"monospace",fontSize:R?"0.85rem":"0.9rem",fontWeight:w?"bold":"normal",color:w?"var(--accent-primary)":N?"var(--accent-secondary)":"inherit"},children:u},i)})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-select",value:b,onChange:i=>{const u=Number(i.target.value);x(u),c({campPerformanceState:{viewMode:o,selectedCampPerformanceCamp:s,selectedCampPerformanceMinGames:u}})},style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",width:"90px"},children:Re.map(i=>e.jsx("option",{value:i,children:i},i))})]})]}),e.jsx("div",{style:{textAlign:"center",marginBottom:"1.5rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:e.jsxs("span",{style:{color:"var(--text-secondary)",fontSize:"0.95rem",fontWeight:"500"},children:[o==="performance"?E:G," joueur",(o==="performance"?E:G)!==1?"s":""," ",(o==="performance"?E:G)!==1?"correspondent":"correspond"," aux crit√®res"]})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsx(De,{viewMode:o,selectedCamp:s,minGames:b,chartData:X,highlightedPlayer:n.highlightedPlayer,lycansColorScheme:p,playersColor:g,onBarClick:U}),e.jsx(ke,{viewMode:o,selectedCamp:s,minGames:b,chartData:X,highlightedPlayer:n.highlightedPlayer,lycansColorScheme:p,playersColor:g,onScatterClick:U})]})]})}export{Be as PlayerCampChart};
