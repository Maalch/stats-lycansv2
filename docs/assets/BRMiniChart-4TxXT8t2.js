import{a as me,r as b,j as e}from"./index-DGFV8OXQ.js";import{F as A,C as T,X as B,Y as W}from"./FullscreenChart-CzXmwdZ1.js";import{b as xe,c as ve}from"./useRawBRData-D1j0QYaw.js";import{u as ue}from"./useJoueursData-B1Cilqb1.js";import{M as te,u as je,c as fe,g as Pe}from"./api-zvTdSM8o.js";import{R as M,T as k,a as z}from"./CategoricalChart-XlP9iajG.js";import{B as F,a as H}from"./BarChart-BXpjcvj0.js";const re=fe.BR_MINIMAL;function ke(){const{data:S,isLoading:ae,error:K}=xe(),{data:w,isLoading:se,error:D}=ve(),{settings:a}=me(),{joueursData:ne}=ue(),[N,f]=b.useState(null),[d,E]=b.useState("wins"),[g,G]=b.useState("total"),[u,oe]=b.useState(te.VERY_LOW),[j,le]=b.useState(te.VERY_LOW),de=je(ne),R=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],I=r=>de[r]||Pe(r),l=b.useMemo(()=>{if(!S||!w)return null;const r=w.length,s=S.length,t=S.filter(i=>i.Gagnant).length,o=S.reduce((i,n)=>{const v=n.Participants;return i[v]||(i[v]={name:v,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),i[v].participations++,i[v].totalScore+=n.Score,n.Gagnant&&i[v].wins++,i},{});Object.values(o).forEach(i=>{i.averageScore=i.totalScore/i.participations,i.winRate=i.wins/i.participations*100});const c=Object.values(o).sort((i,n)=>n.participations-i.participations),p=c.slice(0,15),h=a.highlightedPlayer&&p.some(i=>i.name===a.highlightedPlayer);let y=!1,x=[...p];if(a.highlightedPlayer&&!h){const i=c.find(n=>n.name===a.highlightedPlayer);i&&(x.push({...i,isHighlightedAddition:!0}),y=!0)}const m=Object.values(o).sort((i,n)=>n.wins-i.wins),P=m.slice(0,15),C=a.highlightedPlayer&&P.some(i=>i.name===a.highlightedPlayer);let V=!1,O=[...P];if(a.highlightedPlayer&&!C){const i=m.find(n=>n.name===a.highlightedPlayer);i&&(O.push({...i,isHighlightedAddition:!0}),V=!0)}const L=Object.values(o).filter(i=>i.participations>=u),q=L.sort((i,n)=>n.winRate-i.winRate).slice(0,15),ce=a.highlightedPlayer&&q.some(i=>i.name===a.highlightedPlayer);let $=!1,_=[...q];if(a.highlightedPlayer&&!ce){const i=c.find(n=>n.name===a.highlightedPlayer);i&&(_.push({...i,isHighlightedAddition:!0}),$=!0)}const Y=Object.values(o).sort((i,n)=>n.totalScore-i.totalScore),X=Y.slice(0,15),he=a.highlightedPlayer&&X.some(i=>i.name===a.highlightedPlayer);let J=!1,U=[...X];if(a.highlightedPlayer&&!he){const i=Y.find(n=>n.name===a.highlightedPlayer);i&&(U.push({...i,isHighlightedAddition:!0}),J=!0)}const Q=Object.values(o).filter(i=>i.participations>=j),Z=Q.sort((i,n)=>n.averageScore-i.averageScore).slice(0,15),ge=a.highlightedPlayer&&Z.some(i=>i.name===a.highlightedPlayer);let ee=!1,ie=[...Z];if(a.highlightedPlayer&&!ge){const i=c.find(n=>n.name===a.highlightedPlayer);i&&(ie.push({...i,isHighlightedAddition:!0}),ee=!0)}const pe=w.reduce((i,n)=>{const v=n["Nombre de participants"];return i[v]||(i[v]=0),i[v]++,i},{}),ye=Object.entries(pe).map(([i,n])=>({participants:parseInt(i),games:n,percentage:(n/r*100).toFixed(1)})).sort((i,n)=>i.participants-n.participants);return{totalGames:r,totalParticipations:s,totalWins:t,averageParticipantsPerGame:(s/r).toFixed(1),topPlayersByParticipations:x,highlightedPlayerInParticipations:y,topPlayersByWins:O,highlightedPlayerInWins:V,topPlayersByWinRate:_,highlightedPlayerInWinRate:$,totalEligiblePlayersForWinRate:L.length,topPlayersByTotalScore:U,highlightedPlayerInTotalScore:J,topPlayersByAverageScore:ie,highlightedPlayerInAverageScore:ee,totalEligiblePlayersForKills:Q.length,participantData:ye}},[S,w,a.highlightedPlayer,u,j]);return ae||se?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Mini Battle Royale..."}):K||D?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",K||D]}):!l||l.totalGames===0?e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Mini Battle Royale disponible (2-5 joueurs)"}):e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Mini Battle Royale (2-5 joueurs)"})}),e.jsxs("div",{className:"lycans-stats-grid",children:[e.jsxs("div",{className:"lycans-stat-card",children:[e.jsx("h3",{children:"Parties totales"}),e.jsx("div",{className:"lycans-stat-value",children:l.totalGames})]}),e.jsxs("div",{className:"lycans-stat-card",children:[e.jsx("h3",{children:"Participations"}),e.jsx("div",{className:"lycans-stat-value",children:l.totalParticipations})]}),e.jsxs("div",{className:"lycans-stat-card",children:[e.jsx("h3",{children:"Moy. participants/partie"}),e.jsx("div",{className:"lycans-stat-value",children:l.averageParticipantsPerGame})]})]}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Participations"}),l.highlightedPlayerInParticipations&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary-text)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]}),e.jsx(A,{title:"Participations - Mini Battle Royale",className:"lycans-chart-wrapper",children:e.jsx(M,{width:"100%",height:400,children:e.jsxs(F,{data:l.topPlayersByParticipations,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:r,y:s,payload:t})=>e.jsx("text",{x:r,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:a.highlightedPlayer===t.value?14:12,fontWeight:a.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${r} ${s})`,children:t.value})}),e.jsx(W,{}),e.jsx(k,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const t=s[0].payload,o=t.isHighlightedAddition,c=a.highlightedPlayer===t.name;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,c&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:t.wins})]})]}),o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(H,{dataKey:"participations",name:"Participations",shape:r=>{const{x:s,y:t,width:o,height:c,payload:p}=r,h=p,y=a.highlightedPlayer===h.name,x=N===h.name,m=h.isHighlightedAddition;return e.jsx(z,{x:s,y:t,width:o,height:c,fill:y?"var(--accent-primary)":m?"var(--accent-secondary)":I(h.name),stroke:y?"var(--accent-primary)":x?"var(--text-primary)":"none",strokeWidth:y?3:x?2:0,strokeDasharray:m?"5,5":"none",opacity:m?.8:1,onMouseEnter:()=>f(h.name),onMouseLeave:()=>f(null),style:{cursor:"pointer"}})}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"RÃ©partition par Nombre de Participants"}),e.jsx(A,{title:"RÃ©partition par Nombre de Participants - Mini BR",className:"lycans-chart-wrapper",children:e.jsx(M,{width:"100%",height:400,children:e.jsxs(F,{data:l.participantData,margin:{bottom:15},children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"participants",label:{value:"Nombre de participants",position:"insideBottom",offset:-5}}),e.jsx(W,{}),e.jsx(k,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const t=s[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.participants," joueur",t.participants>1?"s":""]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Parties: ",e.jsx("strong",{children:t.games})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]})]})]})}return null}}),e.jsx(H,{dataKey:"games",name:"Nombre de parties",shape:r=>{const{x:s,y:t,width:o,height:c,index:p}=r,h=R[(p??0)%R.length];return e.jsx(z,{x:s,y:t,width:o,height:c,fill:h})}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{children:d==="wins"?"Victoires":"Taux de Victoire"}),(d==="wins"&&l.highlightedPlayerInWins||d==="winRate"&&l.highlightedPlayerInWinRate)&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",minWidth:"350px",justifyContent:"flex-end"},children:[d==="winRate"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"min-games-winrate-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-winrate-select",value:u,onChange:r=>oe(Number(r.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:re.map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsx("button",{onClick:()=>E("wins"),style:{background:d==="wins"?"var(--accent-primary)":"var(--bg-tertiary)",color:d==="wins"?"var(--bg-primary)":"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem",cursor:"pointer"},children:"Victoires"}),e.jsx("button",{onClick:()=>E("winRate"),style:{background:d==="winRate"?"var(--accent-primary)":"var(--bg-tertiary)",color:d==="winRate"?"var(--bg-primary)":"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem",cursor:"pointer"},children:"Taux de victoire"})]})]}),e.jsx(A,{title:`${d==="wins"?"Victoires":"Taux de Victoire"} - Mini Battle Royale`,className:"lycans-chart-wrapper",children:e.jsx(M,{width:"100%",height:400,children:e.jsxs(F,{data:d==="wins"?l.topPlayersByWins:l.topPlayersByWinRate,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:r,y:s,payload:t})=>e.jsx("text",{x:r,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:a.highlightedPlayer===t.value?14:12,fontWeight:a.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${r} ${s})`,children:t.value})}),e.jsx(W,{}),e.jsx(k,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const t=s[0].payload,o=t.isHighlightedAddition,c=a.highlightedPlayer===t.name,p=t.participations>=u;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,c&&" ðŸŽ¯"]}),e.jsx("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:d==="wins"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:t.wins})]}),e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate.toFixed(1),"%"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:t.wins})," / ",t.participations]})]})}),o&&d==="winRate"&&!p&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",u," partie",u>1?"s":"",")"]}),o&&(d==="winRate"&&p||d==="wins")&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(H,{dataKey:d==="wins"?"wins":"winRate",name:d==="wins"?"Victoires":"Taux de victoire (%)",shape:r=>{const{x:s,y:t,width:o,height:c,payload:p,index:h}=r,y=p,x=a.highlightedPlayer===y.name,m=N===y.name,P=y.isHighlightedAddition,C=x?"var(--accent-primary)":P?"var(--accent-secondary)":d==="wins"?I(y.name):R[(h??0)%R.length];return e.jsx(z,{x:s,y:t,width:o,height:c,fill:C,stroke:x?"var(--accent-primary)":m?"var(--text-primary)":"none",strokeWidth:x?3:m?2:0,strokeDasharray:P?"5,5":"none",opacity:P?.8:1,onMouseEnter:()=>f(y.name),onMouseLeave:()=>f(null),style:{cursor:"pointer"}})}})]})})}),d==="winRate"&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",l.topPlayersByWinRate.length," des joueurs (sur ",l.totalEligiblePlayersForWinRate," ayant au moins ",u," partie",u>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{children:g==="total"?"Kills Totaux":"Kills Moyen par Partie"}),(g==="total"&&l.highlightedPlayerInTotalScore||g==="average"&&l.highlightedPlayerInAverageScore)&&a.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",a.highlightedPlayer," affichÃ© en plus du top 15"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",minWidth:"350px",justifyContent:"flex-end"},children:[g==="average"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"min-games-kills-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-kills-select",value:j,onChange:r=>le(Number(r.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:re.map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsx("button",{onClick:()=>G("total"),style:{background:g==="total"?"var(--accent-primary)":"var(--bg-tertiary)",color:g==="total"?"var(--bg-primary)":"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem",cursor:"pointer"},children:"Kills Totaux"}),e.jsx("button",{onClick:()=>G("average"),style:{background:g==="average"?"var(--accent-primary)":"var(--bg-tertiary)",color:g==="average"?"var(--bg-primary)":"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem",cursor:"pointer"},children:"Kills Moyen"})]})]}),e.jsx(A,{title:`${g==="total"?"Kills Totaux":"Kills Moyen par Partie"} - Mini Battle Royale`,className:"lycans-chart-wrapper",children:e.jsx(M,{width:"100%",height:400,children:e.jsxs(F,{data:g==="total"?l.topPlayersByTotalScore:l.topPlayersByAverageScore,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:r,y:s,payload:t})=>e.jsx("text",{x:r,y:s,dy:16,textAnchor:"end",fill:a.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:a.highlightedPlayer===t.value?14:12,fontWeight:a.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${r} ${s})`,children:t.value})}),e.jsx(W,{}),e.jsx(k,{content:({active:r,payload:s})=>{if(r&&s&&s.length>0){const t=s[0].payload,o=t.isHighlightedAddition,c=a.highlightedPlayer===t.name,p=t.participations>=j;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,c&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Kills total: ",e.jsx("strong",{children:t.totalScore})]}),e.jsxs("div",{children:["Kills moyen: ",e.jsx("strong",{children:t.averageScore.toFixed(2)})]})]}),o&&g==="average"&&!p&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",j," partie",j>1?"s":"",")"]}),o&&(g==="average"&&p||g==="total")&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(H,{dataKey:g==="total"?"totalScore":"averageScore",name:g==="total"?"Kills totaux":"Kills moyen par partie",shape:r=>{const{x:s,y:t,width:o,height:c,payload:p}=r,h=p,y=a.highlightedPlayer===h.name,x=N===h.name,m=h.isHighlightedAddition;return e.jsx(z,{x:s,y:t,width:o,height:c,fill:y?"var(--accent-primary)":m?"var(--accent-secondary)":I(h.name),stroke:y?"var(--accent-primary)":x?"var(--text-primary)":"none",strokeWidth:y?3:x?2:0,strokeDasharray:m?"5,5":"none",opacity:m?.8:1,onMouseEnter:()=>f(h.name),onMouseLeave:()=>f(null),style:{cursor:"pointer"}})}})]})})}),g==="average"&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",l.topPlayersByAverageScore.length," des joueurs (sur ",l.totalEligiblePlayersForKills," ayant au moins ",j," partie",j>1?"s":"",")"]})]})]})]})}export{ke as BRMiniChart};
