import{g as se,e as me,u as Z,a as te,r as w,j as e,p as ce,i as xe,m as fe}from"./index-IJBMYy_y.js";import{g as de,u as je,a as Pe,b as Se,c as be}from"./useDeathStatisticsFromRaw-D5vqlDmY.js";import{u as ne}from"./baseStatsHook-Cc6ZV3F_.js";import{g as ie,a as le,D as F}from"./datasyncExport-BirWLS1z.js";import{M as ue,C as ye,u as ae,m as oe,b as pe,a as Ae,c as De}from"./api-2x3jNjc4.js";import{D as V,g as he}from"./deathTypes-gHH1w6_X.js";import{F as G,C as q,X as U,Y as $}from"./FullscreenChart-RQqCRGfp.js";import{u as re}from"./useJoueursData-CsKek6WX.js";import{R as O,T as _,a as X}from"./CategoricalChart-Cqxd7nSg.js";import{B as J,a as Y}from"./BarChart-BAeVaoGQ.js";function ge(r){if(!r||r.trim()==="")return null;const l=r.trim().slice(1),v=parseInt(l,10);return isNaN(v)||v<1?null:v}function Te(r,g){if(r.length===0)return null;const l={},v={};r.forEach(d=>{let s=1;if(d.EndTiming){const m=ge(d.EndTiming);m&&(s=m)}d.PlayerStats.forEach(m=>{if(g&&g!=="Tous les camps"&&ie(m.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==g)return;const n=m.Username;l[n]||(l[n]={playerName:n,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const R=l[n];R.totalGames++;let D=null;m.DeathTiming&&(D=ge(m.DeathTiming));for(let f=1;f<=s;f++)R.gamesPlayedByDay[f]||(R.gamesPlayedByDay[f]=0,R.survivalsByDay[f]=0),v[f]||(v[f]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),R.gamesPlayedByDay[f]++,v[f].playersOnDay++,(!D||D>f)&&(R.survivalsByDay[f]++,v[f].survivorsOnDay++)});for(let m=1;m<=s;m++)v[m]||(v[m]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),v[m].gamesReachingDay++}),Object.values(l).forEach(d=>{Object.keys(d.gamesPlayedByDay).forEach(s=>{const m=parseInt(s),n=d.gamesPlayedByDay[m],R=d.survivalsByDay[m];n>0?d.survivalRatesByDay[m]=R/n*100:d.survivalRatesByDay[m]=0})});const u=Object.values(l).filter(d=>d.totalGames>0).sort((d,s)=>s.totalGames-d.totalGames),b=Object.entries(v).map(([d,s])=>({dayNumber:parseInt(d),totalGamesReachingDay:s.gamesReachingDay,totalPlayersOnDay:s.playersOnDay,averageSurvivalRate:s.playersOnDay>0?s.survivorsOnDay/s.playersOnDay*100:0})).sort((d,s)=>d.dayNumber-s.dayNumber);return{totalGames:r.length,totalPlayersAnalyzed:u.length,playerSurvivalStats:u,dayStats:b}}function Me(r,g,l=ue.MEDIUM){return r.playerSurvivalStats.filter(v=>v.totalGames>=l&&(v.gamesPlayedByDay[g]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[g]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[g]||0,timesSurvivedDay:v.survivalsByDay[g]||0})).sort((v,u)=>u.survivalRate-v.survivalRate).slice(0,ye.TOP_15)}function Ne(r,g,l=ue.MEDIUM){return r.playerSurvivalStats.filter(v=>v.totalGames>=l&&(v.gamesPlayedByDay[g]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[g]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[g]||0,timesSurvivedDay:v.survivalsByDay[g]||0})).sort((v,u)=>v.survivalRate-u.survivalRate).slice(0,ye.TOP_15)}function Re(r){return ne(g=>Te(g,r))}function ke(r,g){if(!r.DeathTiming)return!0;const l=r.DeathTiming.toUpperCase();if(l.startsWith("M")){const v=parseInt(l.substring(1));return g<=v}if(l.startsWith("N")||l.startsWith("J")){const v=parseInt(l.substring(1));return g<v}return!0}function Be(r,g){if(r.length===0)return null;const l=new Map;let v=0;r.forEach(b=>{if(!b.PlayerStats)return;b.PlayerStats.forEach(s=>{const m=se(s),n=s.Username;l.has(m)||l.set(m,{playerName:n,villageois:{meetingsParticipated:0,deathsAtMeetings:0},loups:{meetingsParticipated:0,deathsAtMeetings:0},solo:{meetingsParticipated:0,deathsAtMeetings:0}})});const d=Math.max(...b.PlayerStats.flatMap(s=>(s.Votes||[]).map(m=>m.Day||0)),0);v+=d;for(let s=1;s<=d;s++)b.PlayerStats.filter(n=>ke(n,s)).forEach(n=>{const R=se(n),D=l.get(R);if(!D)return;const f=le(n.MainRoleInitial,n.MainRoleChanges||[]),k=ie(f,{regroupWolfSubRoles:!0});g&&g!=="Tous les camps"&&k!==g||(k==="Villageois"?D.villageois.meetingsParticipated++:k==="Loup"?D.loups.meetingsParticipated++:D.solo.meetingsParticipated++,n.DeathType==="VOTED"&&n.DeathTiming===`M${s}`&&(k==="Villageois"?D.villageois.deathsAtMeetings++:k==="Loup"?D.loups.deathsAtMeetings++:D.solo.deathsAtMeetings++))})});const u=Array.from(l.entries()).map(([b,d])=>{const s=d.villageois.meetingsParticipated+d.loups.meetingsParticipated+d.solo.meetingsParticipated,m=d.villageois.deathsAtMeetings+d.loups.deathsAtMeetings+d.solo.deathsAtMeetings,n=s>0?(s-m)/s*100:0,R=d.villageois.meetingsParticipated>0?(d.villageois.meetingsParticipated-d.villageois.deathsAtMeetings)/d.villageois.meetingsParticipated*100:null,D=d.loups.meetingsParticipated>0?(d.loups.meetingsParticipated-d.loups.deathsAtMeetings)/d.loups.meetingsParticipated*100:null,f=d.solo.meetingsParticipated>0?(d.solo.meetingsParticipated-d.solo.deathsAtMeetings)/d.solo.meetingsParticipated*100:null;return{playerId:b,playerName:d.playerName,totalMeetingsParticipated:s,totalDeathsAtMeetings:m,survivalRate:n,campBreakdown:{villageois:{meetingsParticipated:d.villageois.meetingsParticipated,deathsAtMeetings:d.villageois.deathsAtMeetings,survivalRate:R},loups:{meetingsParticipated:d.loups.meetingsParticipated,deathsAtMeetings:d.loups.deathsAtMeetings,survivalRate:D},solo:{meetingsParticipated:d.solo.meetingsParticipated,deathsAtMeetings:d.solo.deathsAtMeetings,survivalRate:f}}}}).filter(b=>b.totalMeetingsParticipated>0).sort((b,d)=>d.survivalRate-b.survivalRate);return{totalGames:r.length,totalMeetings:v,playerStats:u}}function He(r){return ne(g=>Be(g,r))}const Ke=["Chasseur","Alchimiste","Protecteur","Disciple","Inquisiteur"],ze=["Chasseur","Alchimiste"];function Le(r){return r.MainRoleInitial==="Villageois Ã‰lite"?r.Power||null:ze.includes(r.MainRoleInitial)?r.MainRoleInitial:null}function ve(r,g){if(g==="Tous les camps")return!0;if(Ke.includes(g))return Le(r)===g;const l=le(r.MainRoleInitial,r.MainRoleChanges||[]);return ie(l,{regroupVillagers:!0,regroupWolfSubRoles:!0},r.Power)===g}function Ie(r,g){if(g==="Tous les camps"){const l=r.filter(v=>v!==V.BULLET_HUMAN&&v!==V.BULLET_WOLF);return(r.includes(V.BULLET_HUMAN)||r.includes(V.BULLET_WOLF))&&!l.includes(V.BULLET)&&l.push(V.BULLET),l}return r}function ee(r,g){if(g==="Tous les camps"){const l=r.killsByDeathType[V.BULLET_HUMAN]||0,v=r.killsByDeathType[V.BULLET_WOLF]||0,u=r.killsByDeathType[V.BULLET]||0,b={...r.killsByDeathType};return b[V.BULLET]=l+v+u,delete b[V.BULLET_HUMAN],delete b[V.BULLET_WOLF],{...r,killsByDeathType:b}}return r}function Ee(r,g="Tous les camps",l="Tous les camps"){const v=new Map;return r.forEach(u=>{u.PlayerStats.forEach(b=>{const d=se(b),s=me(b);if(!ve(b,g))return;let m=0;if(u.PlayerStats.forEach(n=>{if(n.KillerName===b.Username&&n.DeathTiming){const R=le(n.MainRoleInitial,n.MainRoleChanges||[]),D=ie(R,{regroupVillagers:!0,regroupWolfSubRoles:!0},n.Power);l==="Tous les camps"?m++:l==="Roles solo"?D!=="Villageois"&&D!=="Loups"&&m++:D===l&&m++}}),m>0){const n=v.get(d);n?m>n.maxKills?(n.maxKills=m,n.timesAchieved=1,n.gameIds=[u.DisplayedId]):m===n.maxKills&&(n.timesAchieved++,n.gameIds.includes(u.DisplayedId)||n.gameIds.push(u.DisplayedId)):v.set(d,{playerName:s,maxKills:m,timesAchieved:1,gameIds:[u.DisplayedId]})}})}),Array.from(v.values()).sort((u,b)=>b.maxKills!==u.maxKills?b.maxKills-u.maxKills:b.timesAchieved-u.timesAchieved)}function we(r,g="Tous les camps",l="Tous les camps"){const v=new Map;return r.forEach(u=>{const b=new Map;u.PlayerStats.forEach(d=>{if(d.KillerName&&d.DeathTiming&&d.DeathTiming.match(/^[A-Z]\d+$/)){const s=d.KillerName,m=d.DeathTiming,n=u.PlayerStats.find(C=>C.Username===s);if(!n||!ve(n,g))return;const R=le(d.MainRoleInitial,d.MainRoleChanges||[]),D=ie(R,{regroupVillagers:!0,regroupWolfSubRoles:!0},d.Power);let f=!1;if(l==="Tous les camps"?f=!0:l==="Roles solo"?f=D!=="Villageois"&&D!=="Loups":f=D===l,!f)return;b.has(s)||b.set(s,new Map);const k=b.get(s);k.set(m,(k.get(m)||0)+1)}}),b.forEach((d,s)=>{const m=Math.max(...Array.from(d.values())),n=u.PlayerStats.find(k=>k.Username===s);if(!n)return;const R=se(n),D=me(n),f=v.get(R);f?m>f.maxKills?(f.maxKills=m,f.timesAchieved=1,f.gameIds=[u.DisplayedId]):m===f.maxKills&&(f.timesAchieved++,f.gameIds.includes(u.DisplayedId)||f.gameIds.push(u.DisplayedId)):v.set(R,{playerName:D,maxKills:m,timesAchieved:1,gameIds:[u.DisplayedId]})})}),Array.from(v.values()).sort((u,b)=>b.maxKills!==u.maxKills?b.maxKills-u.maxKills:b.timesAchieved-u.timesAchieved)}function Ce(r,g="Tous les camps",l="Tous les camps"){return r.length===0?null:{maxKillsPerGame:Ee(r,g,l),maxKillsPerPhase:we(r,g,l)}}function We(r="Tous les camps",g="Tous les camps"){return ne(l=>Ce(l,r,g))}function Ve({deathStats:r,selectedCamp:g,victimCampFilter:l,minGamesForAverage:v,onMinGamesChange:u,availableDeathTypes:b,deathTypeColors:d,totalEligibleForAverage:s}){const{navigateToGameDetails:m}=Z(),{settings:n}=te(),{joueursData:R}=re(),D=ae(R),{data:f}=We(g,l),k=w.useMemo(()=>Ie(b,l),[b,l]),C=w.useMemo(()=>{const t={...d};if(l==="Tous les camps"&&!t[V.BULLET]){const a=d[V.BULLET_HUMAN]||d[V.BULLET_WOLF];a&&(t[V.BULLET]=a)}return t},[d,l]),N=t=>{let a="Top Tueurs";return g!=="Tous les camps"&&(a+=` en ${g}`),l!=="Tous les camps"&&(l==="Roles solo"?a+=" (victimes: Roles solo)":a+=` (victimes: ${l})`),t==="total"?a+=" (Total)":a+=" (Moyenne par Partie)",a},I=t=>{let a=t==="game"?"Record de Kills en une Partie":"Record de Kills en une Phase";return g!=="Tous les camps"&&(a+=` (${g})`),l!=="Tous les camps"&&(l==="Roles solo"?a+=g!=="Tous les camps"?" - victimes: Roles solo":" (victimes: Roles solo)":a+=g!=="Tous les camps"?` - victimes: ${l}`:` (victimes: ${l})`),a},{totalKillsData:L,averageKillsData:j,highlightedPlayerAddedToTotal:S,highlightedPlayerAddedToAverage:T}=w.useMemo(()=>{if(!r)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const t=r.killerStats.sort((z,h)=>h.kills-z.kills).slice(0,15),a=n.highlightedPlayer&&t.some(z=>z.killerName===n.highlightedPlayer),i=t.map(z=>{const h=ee(z,l),E={name:h.killerName,value:h.kills,victims:h.victims.length,percentage:h.percentage,gamesPlayed:h.gamesPlayed,averageKillsPerGame:h.averageKillsPerGame,isHighlightedAddition:!1};return k.forEach(W=>{E[W]=h.killsByDeathType[W]||0}),E});let p=!1;if(n.highlightedPlayer&&!a){const z=r.killerStats.find(h=>h.killerName===n.highlightedPlayer);if(z){const h=ee(z,l),E={name:h.killerName,value:h.kills,victims:h.victims.length,percentage:h.percentage,gamesPlayed:h.gamesPlayed,averageKillsPerGame:h.averageKillsPerGame,isHighlightedAddition:!0};k.forEach(W=>{E[W]=h.killsByDeathType[W]||0}),i.push(E),p=!0}}const H=r.killerStats.filter(z=>z.gamesPlayed>=v).sort((z,h)=>h.averageKillsPerGame-z.averageKillsPerGame).slice(0,15),B=n.highlightedPlayer&&H.some(z=>z.killerName===n.highlightedPlayer),y=H.map(z=>{const h=ee(z,l),E={name:h.killerName,value:h.averageKillsPerGame,victims:h.victims.length,percentage:h.percentage,gamesPlayed:h.gamesPlayed,averageKillsPerGame:h.averageKillsPerGame,isHighlightedAddition:!1};return k.forEach(W=>{const Q=h.killsByDeathType[W]||0;E[W]=h.gamesPlayed>0?Q/h.gamesPlayed:0}),E});let K=!1;if(n.highlightedPlayer&&!B){const z=r.killerStats.find(h=>h.killerName===n.highlightedPlayer);if(z){const h=ee(z,l),E={name:h.killerName,value:h.averageKillsPerGame,victims:h.victims.length,percentage:h.percentage,gamesPlayed:h.gamesPlayed,averageKillsPerGame:h.averageKillsPerGame,isHighlightedAddition:!0};k.forEach(W=>{const Q=h.killsByDeathType[W]||0;E[W]=h.gamesPlayed>0?Q/h.gamesPlayed:0}),y.push(E),K=!0}}return{totalKillsData:i,averageKillsData:y,highlightedPlayerAddedToTotal:p,highlightedPlayerAddedToAverage:K}},[r,n.highlightedPlayer,v,k,l]),M=({active:t,payload:a,label:i})=>{if(t&&a&&a.length){const p=a[0].payload,P=p.isHighlightedAddition,H=n.highlightedPlayer===p.name,B=k.reduce((y,K)=>y+(p[K]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:H?"var(--accent-primary)":"var(--text-primary)"},children:[i,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",B]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",p.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),k.map(y=>({deathType:y,count:p[y]||0})).filter(y=>y.count>0).sort((y,K)=>K.count-y.count).map(({deathType:y,count:K})=>e.jsxs("p",{style:{color:C[y],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[de(y),":"]})," ",K]},y))]}),P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),H&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},o=({active:t,payload:a,label:i})=>{if(t&&a&&a.length){const p=a[0].payload,P=p.isHighlightedAddition,H=n.highlightedPlayer===p.name,B=p.gamesPlayed>=v,y=r?.killerStats.find(E=>E.killerName===p.name),K=y?ee(y,l):null,z=k.reduce((E,W)=>E+(p[W]||0),0),h=K?K.kills:Math.round(z*p.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:H?"var(--accent-primary)":"var(--text-primary)"},children:[i,P&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",z.toFixed(2)," (",h," kills /",p.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",p.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),k.map(E=>({deathType:E,avgCount:p[E]||0,totalKillsForDeathType:K?K.killsByDeathType[E]||0:Math.round((p[E]||0)*p.gamesPlayed)})).filter(E=>E.avgCount>0).sort((E,W)=>W.avgCount-E.avgCount).map(({deathType:E,avgCount:W,totalKillsForDeathType:Q})=>e.jsxs("p",{style:{color:C[E],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[de(E),":"]})," ",W.toFixed(2)," (",Q," kills /",p.gamesPlayed," games)"]},E))]}),P&&!B&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",v," parties)"]}),P&&B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),H&&!P&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},A=w.useMemo(()=>{if(!f)return[];const t=f.maxKillsPerGame.slice(0,15),a=n.highlightedPlayer&&t.some(i=>i.playerName===n.highlightedPlayer);if(n.highlightedPlayer&&!a){const i=f.maxKillsPerGame.find(p=>p.playerName===n.highlightedPlayer);i&&t.push({...i})}return t.map((i,p)=>({name:i.playerName,value:i.maxKills,timesAchieved:i.timesAchieved,gameIds:i.gameIds,isHighlightedAddition:p>=15}))},[f,n.highlightedPlayer]),c=w.useMemo(()=>{if(!f)return[];const t=f.maxKillsPerPhase.slice(0,15),a=n.highlightedPlayer&&t.some(i=>i.playerName===n.highlightedPlayer);if(n.highlightedPlayer&&!a){const i=f.maxKillsPerPhase.find(p=>p.playerName===n.highlightedPlayer);i&&t.push({...i})}return t.map((i,p)=>({name:i.playerName,value:i.maxKills,timesAchieved:i.timesAchieved,gameIds:i.gameIds,isHighlightedAddition:p>=15}))},[f,n.highlightedPlayer]),x=({active:t,payload:a,label:i,chartType:p})=>{if(t&&a&&a.length){const P=a[0].payload,H=n.highlightedPlayer===P.name,B=P.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:H?"var(--accent-primary)":"var(--text-primary)"},children:[i,B&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsxs("strong",{children:[p==="game"?"Max kills en une partie":"Max kills en une phase",":"]})," ",P.value]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Nombre de fois:"})," ",P.timesAchieved]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"4px 0",fontSize:"0.8rem"},children:[P.gameIds.length," partie",P.gameIds.length>1?"s":""," concernÃ©e",P.gameIds.length>1?"s":""]}),B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),H&&!B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:N("total")}),S&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:N("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:L,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:n.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===i.value?14:12,fontWeight:n.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(M,{})}),k.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"kills",fill:C[t],onClick:a=>{const i={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(i.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),m(i)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,L.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:N("average")}),T&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:v,onChange:t=>u(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:oe.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(G,{title:N("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:j,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:n.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===i.value?14:12,fontWeight:n.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(o,{})}),k.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"averageKills",fill:C[t],onClick:a=>{const i={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(i.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),m(i)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,j.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",s," ayant au moins ",v," partie",v>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:I("game")}),A.some(t=>t.isHighlightedAddition)&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:I("game"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:A,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:n.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===i.value?14:12,fontWeight:n.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Nombre max de kills en une partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(x,{...t,chartType:"game"})}),e.jsx(Y,{dataKey:"value",shape:t=>{const{x:a,y:i,width:p,height:P,payload:H}=t,B=H,y=n.highlightedPlayer===B.name,K=B.isHighlightedAddition,z=D[B.name]||(y?"var(--accent-primary)":K?"var(--accent-secondary)":"var(--chart-primary)");return e.jsx(X,{x:a,y:i,width:p,height:P,fill:z,stroke:y?"var(--accent-primary)":"none",strokeWidth:y?3:0,strokeDasharray:K?"5,5":"none",opacity:K?.8:1,onClick:()=>{if(B?.gameIds&&B.gameIds.length>0){const h={fromComponent:"Statistiques de Mort - Max Kills par Partie"};B.gameIds.length===1?h.selectedGame=B.gameIds[0]:h.selectedGameIds=B.gameIds,g!=="Tous les camps"&&(h.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),m(h)}},style:{cursor:"pointer"}})}})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:g!=="Tous les camps"||l!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule partie (avec filtres appliquÃ©s)":"Nombre maximum de kills rÃ©alisÃ©s en une seule partie"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:I("phase")}),c.some(t=>t.isHighlightedAddition)&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:I("phase"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:c,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:n.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===i.value?14:12,fontWeight:n.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Nombre max de kills en une phase",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(x,{...t,chartType:"phase"})}),e.jsx(Y,{dataKey:"value",shape:t=>{const{x:a,y:i,width:p,height:P,payload:H}=t,B=H,y=n.highlightedPlayer===B.name,K=B.isHighlightedAddition,z=D[B.name]||(y?"var(--accent-primary)":K?"var(--accent-secondary)":"var(--chart-secondary)");return e.jsx(X,{x:a,y:i,width:p,height:P,fill:z,stroke:y?"var(--accent-primary)":"none",strokeWidth:y?3:0,strokeDasharray:K?"5,5":"none",opacity:K?.8:1,onClick:()=>{if(B?.gameIds&&B.gameIds.length>0){const h={fromComponent:"Statistiques de Mort - Max Kills par Phase"};B.gameIds.length===1?h.selectedGame=B.gameIds[0]:h.selectedGameIds=B.gameIds,g!=="Tous les camps"&&(h.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),m(h)}},style:{cursor:"pointer"}})}})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:g!=="Tous les camps"||l!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule phase avec filtres appliquÃ©s":"Nombre maximum de kills rÃ©alisÃ©s en une seule phase"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",textAlign:"center",marginTop:"0.25rem",fontStyle:"italic"},children:"Une phase est une sÃ©quence de jeu : Jour (J1), Nuit (N1), Meeting (M1), etc."})]})]})}function Fe({deathStats:r,selectedCamp:g,minGamesForAverage:l,onMinGamesChange:v,availableDeathTypes:u,deathTypeColors:b}){const{navigateToGameDetails:d}=Z(),{settings:s}=te(),{joueursData:m}=re(),n=ae(m),[R,D]=w.useState(null),{totalDeathsData:f,survivalRateData:k,highlightedPlayerAddedToDeaths:C,highlightedPlayerAddedToSurvival:N}=w.useMemo(()=>{if(!r)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const j=r.playerDeathStats.sort((a,i)=>i.totalDeaths-a.totalDeaths).slice(0,15),S=s.highlightedPlayer&&j.some(a=>a.playerName===s.highlightedPlayer),T=j.map(a=>{const i=a.gamesPlayed,p=i>0?(i-a.totalDeaths)/i*100:0,P={name:a.playerName,value:a.totalDeaths,totalDeaths:a.totalDeaths,gamesPlayed:i,deathRate:a.deathRate,survivalRate:p,isHighlightedAddition:!1};return u.forEach(H=>{P[H]=a.deathsByType[H]||0}),P});let M=!1;if(s.highlightedPlayer&&!S){const a=r.playerDeathStats.find(i=>i.playerName===s.highlightedPlayer);if(a){const i=a.gamesPlayed,p=i>0?(i-a.totalDeaths)/i*100:0,P={name:a.playerName,value:a.totalDeaths,totalDeaths:a.totalDeaths,gamesPlayed:i,deathRate:a.deathRate,survivalRate:p,isHighlightedAddition:!0};u.forEach(H=>{P[H]=a.deathsByType[H]||0}),T.push(P),M=!0}}const A=r.playerDeathStats.filter(a=>a.gamesPlayed>=l).map(a=>({...a,survivalRate:a.gamesPlayed>0?(a.gamesPlayed-a.totalDeaths)/a.gamesPlayed*100:0})).sort((a,i)=>i.survivalRate-a.survivalRate).slice(0,15),c=s.highlightedPlayer&&A.some(a=>a.playerName===s.highlightedPlayer),x=A.map(a=>{const i={name:a.playerName,value:a.survivalRate,totalDeaths:a.totalDeaths,gamesPlayed:a.gamesPlayed,deathRate:a.deathRate,survivalRate:a.survivalRate,isHighlightedAddition:!1};return u.forEach(p=>{i[p]=a.deathsByType[p]||0}),i});let t=!1;if(s.highlightedPlayer&&!c){const a=r.playerDeathStats.find(i=>i.playerName===s.highlightedPlayer);if(a){const i=a.gamesPlayed>0?(a.gamesPlayed-a.totalDeaths)/a.gamesPlayed*100:0,p={name:a.playerName,value:i,totalDeaths:a.totalDeaths,gamesPlayed:a.gamesPlayed,deathRate:a.deathRate,survivalRate:i,isHighlightedAddition:!0};u.forEach(P=>{p[P]=a.deathsByType[P]||0}),x.push(p),t=!0}}return{totalDeathsData:T,survivalRateData:x,highlightedPlayerAddedToDeaths:M,highlightedPlayerAddedToSurvival:t}},[r,s.highlightedPlayer,l,u]),I=({active:j,payload:S,label:T})=>{if(j&&S&&S.length){const M=S[0].payload,o=M.isHighlightedAddition,A=s.highlightedPlayer===M.name,c=u.reduce((x,t)=>x+(M[t]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:A?"var(--accent-primary)":"var(--text-primary)"},children:[T,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",c]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",M.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",M.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),u.map(x=>{const t=M[x]||0;return t===0?null:e.jsxs("p",{style:{color:b[x],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[he(x),":"]})," ",t]},x)})]}),o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),A&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},L=({active:j,payload:S,label:T})=>{if(j&&S&&S.length){const M=S[0].payload,o=M.isHighlightedAddition,A=s.highlightedPlayer===M.name,c=M.gamesPlayed>=l;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:A?"var(--accent-primary)":"var(--text-primary)"},children:[T,o&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",M.survivalRate.toFixed(1),"% (",M.gamesPlayed-M.totalDeaths," survies / ",M.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",M.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",M.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),u.map(x=>{const t=M[x]||0;return t===0?null:e.jsxs("p",{style:{color:b[x],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[he(x),":"]})," ",t]},x)})]}),o&&!c&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties)"]}),o&&c&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),A&&!o&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:g==="Tous les camps"?"Morts (Total)":`Morts en ${g} (Total)`}),C&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:g==="Tous les camps"?"Morts (Total)":`Morts en ${g} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:j,y:S,payload:T})=>e.jsx("text",{x:j,y:S,dy:10,fill:s.highlightedPlayer===T.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:s.highlightedPlayer===T.value?14:12,fontWeight:s.highlightedPlayer===T.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${j} ${S})`,children:T.value})}),e.jsx($,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(I,{})}),u.map(j=>e.jsx(Y,{dataKey:j,name:j,stackId:"deaths",fill:b[j],onClick:S=>{const T={selectedPlayer:S?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(T.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),d(T)}},j))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(j=>!j.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",g==="Tous les camps"?"(Total)":` en ${g}`]}),N&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:l,onChange:j=>v(Number(j.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:oe.map(j=>e.jsx("option",{value:j,children:j},j))})]}),e.jsx(G,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:k,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:j,y:S,payload:T})=>e.jsx("text",{x:j,y:S,dy:10,fill:s.highlightedPlayer===T.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:s.highlightedPlayer===T.value?14:12,fontWeight:s.highlightedPlayer===T.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${j} ${S})`,children:T.value})}),e.jsx($,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(L,{})}),e.jsx(Y,{dataKey:"value",style:{cursor:"pointer"},shape:j=>{const{x:S,y:T,width:M,height:o,payload:A}=j,c=A,x=s.highlightedPlayer===c.name,t=c.isHighlightedAddition;return e.jsx(X,{x:S,y:T,width:M,height:o,fill:n[c.name]||"var(--chart-primary)",stroke:x?"var(--accent-primary)":R===c.name?"var(--text-primary)":"none",strokeWidth:x?3:R===c.name?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>{const a={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};g!=="Tous les camps"&&(a.campFilter={selectedCamp:g,campFilterMode:"all-assignments"}),d(a)},onMouseEnter:()=>D(c?.name||null),onMouseLeave:()=>D(null)})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,k.filter(j=>!j.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",l," partie",l>1?"s":"",")"]})]})]})}function Ge({hunterStats:r,isLoading:g,error:l}){const{navigateToGameDetails:v}=Z(),{settings:u}=te(),b=pe(),{joueursData:d}=re(),s=ae(d),[m,n]=w.useState(null);if(g)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(l)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",l]});if(!r||r.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:R,highlightedPlayerAddedToBest:D,finalBadHuntersData:f,highlightedPlayerAddedToBad:k}=(()=>{const L=r.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).sort((t,a)=>a.averageNonVillageoisKillsPerGame-t.averageNonVillageoisKillsPerGame).slice(0,15),j=u.highlightedPlayer&&L.some(t=>t.hunterName===u.highlightedPlayer);let S=[...L],T=!1;if(u.highlightedPlayer&&!j){const t=r.hunterStats.find(a=>a.hunterName===u.highlightedPlayer);t&&(S.push({...t,isHighlightedAddition:!0}),T=!0)}const M=r.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).map(t=>({name:t.hunterName,averageVillageoisKills:Number((t.villageoisKills/t.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:t.villageoisKills,totalNonVillageoisKills:t.nonVillageoisKills,totalKills:t.totalKills,gamesPlayed:t.gamesPlayedAsHunter,victimsByCamp:t.victimsByCamp,goodVictimsByCamp:t.goodVictimsByCamp,badVictimsByCamp:t.badVictimsByCamp,hunterName:t.hunterName})),o=M.sort((t,a)=>a.averageVillageoisKills-t.averageVillageoisKills).slice(0,15),A=u.highlightedPlayer&&o.some(t=>t.hunterName===u.highlightedPlayer);let c=[...o],x=!1;if(u.highlightedPlayer&&!A){const t=M.find(a=>a.hunterName===u.highlightedPlayer);t&&(c.push({...t,isHighlightedAddition:!0}),x=!0)}return{finalBestHuntersData:S,highlightedPlayerAddedToBest:T,finalBadHuntersData:c,highlightedPlayerAddedToBad:x}})(),C=({active:I,payload:L,label:j})=>{if(I&&L&&L.length){const S=L[0].payload,T=S.isHighlightedAddition,M=u.highlightedPlayer===S.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:M?"var(--accent-primary)":"var(--text-primary)"},children:[j,T&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",S.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",S.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",S.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",S.totalKills]}),S.goodVictimsByCamp&&Object.keys(S.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(S.goodVictimsByCamp).map(([o,A])=>e.jsxs("p",{style:{color:b[o]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[o,":"]})," ",A]},o))]}),T&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),M&&!T&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},N=({active:I,payload:L,label:j})=>{if(I&&L&&L.length){const S=L[0].payload,T=S.isHighlightedAddition,M=u.highlightedPlayer===S.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:M?"var(--accent-primary)":"var(--text-primary)"},children:[j,T&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",S.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",S.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",S.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",S.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",S.totalKills]}),S.badVictimsByCamp&&Object.keys(S.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(S.badVictimsByCamp).map(([o,A])=>e.jsxs("p",{style:{color:b[o]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[o,":"]})," ",A]},o))]}),T&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),M&&!T&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),D&&u.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',u.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:I,y:L,payload:j})=>e.jsx("text",{x:I,y:L,dy:10,fill:u.highlightedPlayer===j.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:u.highlightedPlayer===j.value?14:12,fontWeight:u.highlightedPlayer===j.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${I} ${L})`,children:j.value})}),e.jsx($,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(C,{})}),e.jsx(Y,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",style:{cursor:"pointer"},shape:I=>{const{x:L,y:j,width:S,height:T,payload:M}=I,o=M,A=u.highlightedPlayer===o.hunterName,c=o.isHighlightedAddition;return e.jsx(X,{x:L,y:j,width:S,height:T,fill:s[o.hunterName]||b.Chasseur||"#8884d8",stroke:A?"var(--accent-primary)":m===o.hunterName?"var(--text-primary)":"none",strokeWidth:A?3:m===o.hunterName?2:0,strokeDasharray:c?"5,5":"none",opacity:c?.8:1,onClick:()=>{o?.hunterName&&v({selectedPlayer:o.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:()=>n(o.hunterName||null),onMouseLeave:()=>n(null),style:{cursor:"pointer"}})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(I=>!I.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),k&&u.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',u.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:I,y:L,payload:j})=>e.jsx("text",{x:I,y:L,dy:10,fill:u.highlightedPlayer===j.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:u.highlightedPlayer===j.value?14:12,fontWeight:u.highlightedPlayer===j.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${I} ${L})`,children:j.value})}),e.jsx($,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(N,{})}),e.jsx(Y,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",style:{cursor:"pointer"},shape:I=>{const{x:L,y:j,width:S,height:T,payload:M}=I,o=M,A=u.highlightedPlayer===o.hunterName,c=o.isHighlightedAddition;return e.jsx(X,{x:L,y:j,width:S,height:T,fill:s[o.hunterName]||b.Chasseur||"#8884d8",stroke:A?"var(--accent-primary)":m===o.hunterName?"var(--text-primary)":"none",strokeWidth:A?3:m===o.hunterName?2:0,strokeDasharray:c?"5,5":"none",opacity:c?.8:1,onClick:()=>{o?.hunterName&&v({selectedPlayer:o.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:()=>n(o.hunterName||null),onMouseLeave:()=>n(null),style:{cursor:"pointer"}})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(I=>!I.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function qe({survivalStats:r,selectedCamp:g,minGamesForAverage:l,onMinGamesChange:v,isLoading:u,error:b}){const{navigateToGameDetails:d}=Z(),{settings:s}=te(),{joueursData:m}=re(),n=ae(m),[R,D]=w.useState(Ae.DEFAULT_SELECTED_DAY),[f,k]=w.useState(null),C=w.useMemo(()=>r?r.dayStats.filter(A=>A.totalGamesReachingDay>0).map(A=>A.dayNumber).sort((A,c)=>A-c):[],[r]),N=w.useMemo(()=>C.includes(R)?R:C.length>0?C[0]:1,[R,C]),{highestSurvivalData:I,highlightedPlayerAddedToHighest:L}=w.useMemo(()=>{if(!r)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const o=Me(r,N,l),A=s.highlightedPlayer&&o.some(t=>t.playerName===s.highlightedPlayer),c=o.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let x=!1;if(s.highlightedPlayer&&!A){const t=r.playerSurvivalStats.find(a=>a.playerName===s.highlightedPlayer);if(t&&t.totalGames>=l&&(t.gamesPlayedByDay[N]||0)>0){const a=t.survivalRatesByDay[N]||0;c.push({name:s.highlightedPlayer,value:a,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[N]||0,timesSurvivedDay:t.survivalsByDay[N]||0,isHighlightedAddition:!0}),x=!0}}return{highestSurvivalData:c,highlightedPlayerAddedToHighest:x}},[r,N,l,s.highlightedPlayer]),{lowestSurvivalData:j,highlightedPlayerAddedToLowest:S}=w.useMemo(()=>{if(!r)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const o=Ne(r,N,l),A=s.highlightedPlayer&&o.some(t=>t.playerName===s.highlightedPlayer),c=o.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let x=!1;if(s.highlightedPlayer&&!A){const t=r.playerSurvivalStats.find(a=>a.playerName===s.highlightedPlayer);if(t&&t.totalGames>=l&&(t.gamesPlayedByDay[N]||0)>0){const a=t.survivalRatesByDay[N]||0;c.push({name:s.highlightedPlayer,value:a,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[N]||0,timesSurvivedDay:t.survivalsByDay[N]||0,isHighlightedAddition:!0}),x=!0}}return{lowestSurvivalData:c,highlightedPlayerAddedToLowest:x}},[r,N,l,s.highlightedPlayer]),T=o=>{d({selectedPlayer:o,fromComponent:"Statistiques de Survie"})},M=({active:o,payload:A,label:c})=>{if(o&&A&&A.length>0){const x=A[0].payload,t=x.isHighlightedAddition,a=s.highlightedPlayer===x.name,i=x.gamesPlayed>=l,p=x.timesReachedDay-x.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:c})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",N,": ",x.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",N,": ",x.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",N,": ",x.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",N,": ",p]}),e.jsxs("div",{children:["Total de parties: ",x.gamesPlayed]}),t&&!i&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties au total)"]}),t&&i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),a&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return u?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):b?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",b]}):r?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",N," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",L||S?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:N,onChange:o=>D(parseInt(o.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:C.map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:l,onChange:o=>v(parseInt(o.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:oe.map(o=>e.jsx("option",{value:o,children:o},o))})]})]})}),N&&r.dayStats.find(o=>o.dayNumber===N)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:N===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${N}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:r.dayStats.find(o=>o.dayNumber===N)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",N]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(r.dayStats.find(o=>o.dayNumber===N)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",l," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:r.playerSurvivalStats.filter(o=>o.totalGames>=l&&(o.gamesPlayedByDay[N]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",N]}),L&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${N}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:I,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:o,y:A,payload:c})=>e.jsx("text",{x:o,y:A,dy:16,textAnchor:"end",transform:`rotate(-45, ${o}, ${A})`,fill:s.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:s.highlightedPlayer===c.value?14:12,fontWeight:s.highlightedPlayer===c.value?"bold":"normal",children:c.value})}),e.jsx($,{tickFormatter:o=>`${o.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(M,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",shape:o=>{const{x:A,y:c,width:x,height:t,payload:a}=o,i=a,p=s.highlightedPlayer===i.name,P=f===i.name,H=i.isHighlightedAddition;return e.jsx(X,{x:A,y:c,width:x,height:t,fill:n[i.name]||"var(--chart-primary)",stroke:p?"var(--accent-primary)":P?"var(--text-primary)":"none",strokeWidth:p?3:P?2:0,strokeDasharray:H?"5,5":"none",opacity:H?.8:1,onClick:()=>T(i.name),onMouseEnter:()=>k(i.name),onMouseLeave:()=>k(null),style:{cursor:"pointer"}})}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",N]}),S&&s.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',s.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${N}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:j,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:o,y:A,payload:c})=>e.jsx("text",{x:o,y:A,dy:16,textAnchor:"end",transform:`rotate(-45, ${o}, ${A})`,fill:s.highlightedPlayer===c.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:s.highlightedPlayer===c.value?14:12,fontWeight:s.highlightedPlayer===c.value?"bold":"normal",children:c.value})}),e.jsx($,{tickFormatter:o=>`${o.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(M,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",shape:o=>{const{x:A,y:c,width:x,height:t,payload:a}=o,i=a,p=s.highlightedPlayer===i.name,P=f===i.name,H=i.isHighlightedAddition;return e.jsx(X,{x:A,y:c,width:x,height:t,fill:n[i.name]||"var(--chart-color-4)",stroke:p?"var(--accent-primary)":P?"var(--text-primary)":"none",strokeWidth:p?3:P?2:0,strokeDasharray:H?"5,5":"none",opacity:H?.8:1,onClick:()=>T(i.name),onMouseEnter:()=>k(i.name),onMouseLeave:()=>k(null),style:{cursor:"pointer"}})}})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function Ue({meetingSurvivalStats:r,selectedCamp:g,minGamesForAverage:l,onMinGamesChange:v,isLoading:u,error:b}){const{navigateToGameDetails:d}=Z(),{settings:s}=te(),{joueursData:m}=re(),n=ae(m),[R,D]=w.useState(null),[f,k]=w.useState(50),[C,N]=w.useState("highest"),I=De.MEETINGS,{survivalData:L,highlightedPlayerAdded:j}=w.useMemo(()=>{if(!r)return{survivalData:[],highlightedPlayerAdded:!1};const c=r.playerStats.filter(i=>i.totalMeetingsParticipated>=f).sort((i,p)=>C==="highest"?p.survivalRate-i.survivalRate:i.survivalRate-p.survivalRate).slice(0,20),x=s.highlightedPlayer&&c.some(i=>i.playerName===s.highlightedPlayer),t=c.map(i=>({name:i.playerName,value:i.survivalRate,totalMeetings:i.totalMeetingsParticipated,totalDeaths:i.totalDeathsAtMeetings,villageoisRate:i.campBreakdown.villageois.survivalRate,loupRate:i.campBreakdown.loups.survivalRate,soloRate:i.campBreakdown.solo.survivalRate,isHighlightedAddition:!1}));let a=!1;if(s.highlightedPlayer&&!x){const i=r.playerStats.find(p=>p.playerName===s.highlightedPlayer);i&&i.totalMeetingsParticipated>=f&&(t.push({name:s.highlightedPlayer,value:i.survivalRate,totalMeetings:i.totalMeetingsParticipated,totalDeaths:i.totalDeathsAtMeetings,villageoisRate:i.campBreakdown.villageois.survivalRate,loupRate:i.campBreakdown.loups.survivalRate,soloRate:i.campBreakdown.solo.survivalRate,isHighlightedAddition:!0}),a=!0)}return{survivalData:t,highlightedPlayerAdded:a}},[r,s.highlightedPlayer,g,f,C]),{rawDeathsData:S,rawDeathsHighlightedAdded:T}=w.useMemo(()=>{if(!r)return{rawDeathsData:[],rawDeathsHighlightedAdded:!1};const c=[...r.playerStats].filter(i=>i.totalDeathsAtMeetings>0).sort((i,p)=>p.totalDeathsAtMeetings-i.totalDeathsAtMeetings).slice(0,20),x=s.highlightedPlayer&&c.some(i=>i.playerName===s.highlightedPlayer),t=c.map(i=>({name:i.playerName,value:i.totalDeathsAtMeetings,totalMeetings:i.totalMeetingsParticipated,survivalRate:i.survivalRate,isHighlightedAddition:!1}));let a=!1;if(s.highlightedPlayer&&!x){const i=r.playerStats.find(p=>p.playerName===s.highlightedPlayer);i&&i.totalDeathsAtMeetings>0&&(t.push({name:i.playerName,value:i.totalDeathsAtMeetings,totalMeetings:i.totalMeetingsParticipated,survivalRate:i.survivalRate,isHighlightedAddition:!0}),a=!0)}return{rawDeathsData:t,rawDeathsHighlightedAdded:a}},[r,s.highlightedPlayer]),M=c=>{c&&c.name&&d({selectedPlayer:c.name,fromComponent:"Survie aux meetings"})},o=({active:c,payload:x})=>{if(c&&x&&x.length>0){const t=x[0].payload,a=s.highlightedPlayer===t.name,i=t.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"1rem",boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",color:a?"var(--accent-primary)":"var(--text-primary)",fontSize:a?"1.1rem":"1rem"},children:t.name}),e.jsxs("div",{style:{fontSize:"1.3rem",fontWeight:"bold",color:"var(--danger, #e05252)",marginBottom:"0.5rem"},children:["ðŸ’€ ",t.value," mort",t.value>1?"s":""," en meeting"]}),e.jsxs("div",{style:{color:"var(--text-secondary)"},children:["Meetings participÃ©s : ",t.totalMeetings]}),e.jsxs("div",{style:{color:"var(--text-secondary)"},children:["Taux de survie global : ",t.survivalRate.toFixed(1),"%"]}),i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 20)"}),a&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},A=({active:c,payload:x})=>{if(c&&x&&x.length>0){const t=x[0].payload,a=s.highlightedPlayer===t.name,i=t.isHighlightedAddition,p=t.totalMeetings>=f,P=t.totalMeetings-t.totalDeaths;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"1rem",boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",color:a?"var(--accent-primary)":"var(--text-primary)",fontSize:a?"1.1rem":"1rem"},children:t.name}),e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"var(--accent-secondary)",marginBottom:"0.5rem"},children:["Taux de survie aux meetings: ",t.value.toFixed(1),"%"]}),e.jsxs("div",{children:["Meetings participants: ",t.totalMeetings]}),e.jsxs("div",{children:["A survÃ©cu: ",P]}),e.jsxs("div",{children:["Mort en meeting: ",t.totalDeaths]}),g==="Tous les camps"&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:{marginTop:"0.5rem",borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.25rem"},children:"Par camp:"}),t.villageoisRate!==null&&e.jsxs("div",{children:["Villageois: ",t.villageoisRate.toFixed(1),"%"]}),t.loupRate!==null&&e.jsxs("div",{children:["Loup: ",t.loupRate.toFixed(1),"%"]}),t.soloRate!==null&&e.jsxs("div",{children:["Solo: ",t.soloRate.toFixed(1),"%"]})]})}),i&&!p&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",f," meetings)"]}),i&&p&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 20)"}),a&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return u?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie aux meetings..."}):b?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",b]}):r?e.jsxs("div",{className:"lycans-meeting-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Les statistiques de survie aux meetings montrent le pourcentage de fois qu'un joueur survit aprÃ¨s la rÃ©union parmi tous les meetings auxquels il a participÃ©. Un joueur "participe" Ã  un meeting s'il Ã©tait vivant au dÃ©but de celui-ci. Seules les morts par vote comptent ici.`}),e.jsx("p",{children:j&&"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 20."})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem",marginTop:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"sort-order-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Tri :"}),e.jsxs("select",{id:"sort-order-select",value:C,onChange:c=>N(c.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"200px"},children:[e.jsx("option",{value:"highest",children:"Plus haut taux de survie"}),e.jsx("option",{value:"lowest",children:"Plus bas taux de survie"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-meetings-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. meetings :"}),e.jsx("select",{id:"min-meetings-select",value:f,onChange:c=>k(parseInt(c.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:I.map(c=>e.jsx("option",{value:c,children:c},c))})]})]})}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem",marginTop:"1.5rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des parties analysÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:r.totalGames})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des meetings"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:r.totalMeetings})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",f," meetings)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:r.playerStats.filter(c=>c.totalMeetingsParticipated>=f).length})]})]}),e.jsx(G,{title:C==="highest"?"ðŸ›¡ï¸ Taux de Survie aux Meetings (Plus Haut)":"ðŸ’€ Taux de Survie aux Meetings (Plus Bas)",children:e.jsx(O,{width:"100%",height:500,children:e.jsxs(J,{data:L,margin:{top:20,right:30,left:20,bottom:120},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,stroke:"var(--text-secondary)",tick:c=>{const{x,y:t,payload:a}=c,i=s.highlightedPlayer===a.value;return e.jsx("text",{x,y:t,dy:10,textAnchor:"end",fill:i?"var(--accent-primary)":"var(--text-secondary)",fontSize:i?14:12,fontWeight:i?"bold":"normal",transform:`rotate(-45 ${x} ${t})`,children:a.value})}}),e.jsx($,{domain:[0,100],label:{value:"Taux de survie (%)",angle:-90,position:"insideLeft",fill:"var(--text-primary)"},stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"}}),e.jsx(_,{content:e.jsx(A,{}),cursor:{fill:"var(--bg-tertiary)",opacity:.3}}),e.jsx(Y,{dataKey:"value",fill:"var(--chart-primary)",shape:c=>{const{x,y:t,width:a,height:i,payload:p}=c,P=p,H=s.highlightedPlayer===P.name,B=P.isHighlightedAddition,y=R===P.name;return e.jsx(X,{x,y:t,width:a,height:i,fill:H?"var(--accent-primary)":B?"var(--accent-secondary)":y?"var(--accent-primary-text)":n[P.name]||"var(--chart-primary)",stroke:H?"var(--accent-primary)":"none",strokeWidth:H?3:0,strokeDasharray:B?"5,5":"none",opacity:B?.8:1,onClick:()=>M(P),onMouseEnter:()=>D(P.name),onMouseLeave:()=>D(null),style:{cursor:"pointer"}})}})]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-section-description",style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"var(--text-primary)",marginBottom:"0.5rem"},children:"ðŸ† Record de morts en meeting"}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",margin:0},children:["Nombre total de fois oÃ¹ chaque joueur a Ã©tÃ© Ã©liminÃ© par un vote de meeting.",g!=="Tous les camps"&&` FiltrÃ© sur le camp : ${g}.`," ","Aucun filtre de meetings minimum appliquÃ© â€” tous les joueurs apparaissent.",T&&" Le joueur sÃ©lectionnÃ© est affichÃ© mÃªme s'il n'est pas dans le top 20."]})]}),e.jsx(G,{title:"ðŸ† Record de Morts en Meeting (Votes)",children:e.jsx(O,{width:"100%",height:500,children:e.jsxs(J,{data:S,margin:{top:20,right:30,left:20,bottom:120},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,stroke:"var(--text-secondary)",tick:c=>{const{x,y:t,payload:a}=c,i=s.highlightedPlayer===a.value;return e.jsx("text",{x,y:t,dy:10,textAnchor:"end",fill:i?"var(--accent-primary)":"var(--text-secondary)",fontSize:i?14:12,fontWeight:i?"bold":"normal",transform:`rotate(-45 ${x} ${t})`,children:a.value})}}),e.jsx($,{allowDecimals:!1,label:{value:"Morts en meeting",angle:-90,position:"insideLeft",fill:"var(--text-primary)"},stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"}}),e.jsx(_,{content:e.jsx(o,{}),cursor:{fill:"var(--bg-tertiary)",opacity:.3}}),e.jsx(Y,{dataKey:"value",fill:"var(--danger, #e05252)",label:{position:"top",fill:"var(--text-secondary)",fontSize:11},shape:c=>{const{x,y:t,width:a,height:i,payload:p}=c,P=p,H=s.highlightedPlayer===P.name,B=P.isHighlightedAddition,y=R===P.name;return e.jsx(X,{x,y:t,width:a,height:i,fill:H?"var(--accent-primary)":B?"var(--accent-secondary)":y?"var(--accent-primary-text)":n[P.name]||"var(--danger, #e05252)",stroke:H?"var(--accent-primary)":"none",strokeWidth:H?3:0,strokeDasharray:B?"5,5":"none",opacity:B?.8:1,onClick:()=>M(P),onMouseEnter:()=>D(P.name),onMouseLeave:()=>D(null),style:{cursor:"pointer"}})}})]})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie aux meetings disponible"})}function it(){const{navigationState:r,updateNavigationState:g}=Z(),[l,v]=w.useState(r.deathStatisticsState?.selectedCamp||r.deathStatsSelectedCamp||"Tous les camps"),[u,b]=w.useState(r.deathStatisticsState?.victimCampFilter||"Tous les camps"),[d,s]=w.useState(r.deathStatisticsState?.minGamesForAverage||25),[m,n]=w.useState(()=>{const y=ce();if(y.deathStatsView&&["killers","deaths","hunter","survival","meetingSurvival"].includes(y.deathStatsView))return y.deathStatsView;const K=r.deathStatisticsState?.selectedView;return K&&K!=="location"?K:"killers"}),{data:R}=je(),{data:D,isLoading:f,error:k}=Pe(l,u),{data:C,isLoading:N,error:I}=Se(),{data:L,isLoading:j,error:S}=Re(l),{data:T,isLoading:M,error:o}=He(l),{data:A}=xe(),c=pe();w.useEffect(()=>{(!r.deathStatisticsState||r.deathStatisticsState.selectedCamp!==l||r.deathStatisticsState.victimCampFilter!==u||r.deathStatisticsState.minGamesForAverage!==d||r.deathStatisticsState.selectedView!==m)&&g({deathStatisticsState:{selectedCamp:l,victimCampFilter:u,minGamesForAverage:d,selectedView:m,focusChart:r.deathStatisticsState?.focusChart}})},[l,u,d,m,r.deathStatisticsState,g]),w.useEffect(()=>{const y=()=>{const K=ce();if(K.deathStatsView&&["killers","deaths","hunter","survival","meetingSurvival"].includes(K.deathStatsView)){const z=K.deathStatsView;z!==m&&n(z)}};return window.addEventListener("popstate",y),window.addEventListener("urlchange",y),()=>{window.removeEventListener("popstate",y),window.removeEventListener("urlchange",y)}},[m]);const x=w.useMemo(()=>A?be(A):[],[A]),t=w.useMemo(()=>{const y={};x.forEach(h=>{h===F.BY_WOLF?y[h]=c.Loup:h===F.VOTED?y[h]="var(--chart-color-1)":h===F.BULLET||h===F.BULLET_HUMAN||h===F.BULLET_WOLF?y[h]=c.Chasseur:h===F.BY_ZOMBIE?y[h]=c.Vaudou:h===F.ASSASSIN?y[h]=c.Alchimiste:h===F.AVENGER?y[h]="var(--chart-color-2)":h===F.LOVER_DEATH?y[h]=c.Amoureux:h===F.BY_BEAST?y[h]="var(--chart-color-3)":h===F.SHERIF_SUCCESS?y[h]="var(--chart-color-4)":h===F.SMUGGLER_HUNT_KILL&&(y[h]=c.Contrebandier)});const K=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let z=0;return x.forEach(h=>{y[h]||(y[h]=K[z%K.length],z++)}),y},[x,c]),a=y=>{v(y),g({deathStatsSelectedCamp:y,deathStatisticsState:{selectedCamp:y,victimCampFilter:u,minGamesForAverage:d,selectedView:m,focusChart:r.deathStatisticsState?.focusChart}})},i=y=>{b(y),g({deathStatisticsState:{selectedCamp:l,victimCampFilter:y,minGamesForAverage:d,selectedView:m,focusChart:r.deathStatisticsState?.focusChart}})},p=y=>{s(y),g({deathStatisticsState:{selectedCamp:l,victimCampFilter:u,minGamesForAverage:y,selectedView:m,focusChart:r.deathStatisticsState?.focusChart}})},P=y=>{n(y),g({deathStatisticsState:{selectedCamp:l,victimCampFilter:u,minGamesForAverage:d,selectedView:y,focusChart:r.deathStatisticsState?.focusChart}}),fe({deathStatsView:y},"replace")},{gamesWithKillers:H,totalEligibleForAverage:B}=w.useMemo(()=>{if(!D)return{gamesWithKillers:0,totalEligibleForAverage:0};const y=D.killerStats.filter(K=>K.gamesPlayed>=d);return{gamesWithKillers:D.totalGames,totalEligibleForAverage:y.length}},[D,d]);return f?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):D?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${m==="killers"?"active":""}`,onClick:()=>P("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${m==="deaths"?"active":""}`,onClick:()=>P("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${m==="survival"?"active":""}`,onClick:()=>P("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${m==="meetingSurvival"?"active":""}`,onClick:()=>P("meetingSurvival"),children:"Survie aux meetings"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${m==="hunter"?"active":""}`,onClick:()=>P("hunter"),children:"Chasseur"})]}),(m==="killers"||m==="deaths"||m==="survival"||m==="meetingSurvival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:l,onChange:y=>a(y.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),R?.includes("Villageois")&&e.jsxs("optgroup",{label:"Villageois",children:[e.jsx("option",{value:"Villageois",children:"Tous les Villageois"}),e.jsx("option",{value:"Chasseur",children:"â†³ Chasseur"}),e.jsx("option",{value:"Alchimiste",children:"â†³ Alchimiste"}),e.jsx("option",{value:"Protecteur",children:"â†³ Protecteur"}),e.jsx("option",{value:"Disciple",children:"â†³ Disciple"}),e.jsx("option",{value:"Inquisiteur",children:"â†³ Inquisiteur"})]}),R?.includes("Loup")&&e.jsxs("optgroup",{label:"Loup",children:[e.jsx("option",{value:"Loup",children:"Tous les Loups"}),R?.includes("TraÃ®tre")&&e.jsx("option",{value:"TraÃ®tre",children:"â†³ TraÃ®tre"}),R?.includes("Louveteau")&&e.jsx("option",{value:"Louveteau",children:"â†³ Louveteau"})]}),(()=>{const y=["TraÃ®tre","Louveteau"],K=["Villageois","Loup"],z=R?.filter(h=>!K.includes(h)&&!y.includes(h))??[];return z.length>0?e.jsx("optgroup",{label:"RÃ´les Solo",children:z.map(h=>e.jsx("option",{value:h,children:h},h))}):null})()]})]}),m==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:u,onChange:y=>i(y.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(m==="killers"||m==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:D.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:D.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:H})]})]}),m==="killers"&&e.jsx(Ve,{deathStats:D,selectedCamp:l,victimCampFilter:u,minGamesForAverage:d,onMinGamesChange:p,availableDeathTypes:x,deathTypeColors:t,totalEligibleForAverage:B}),m==="deaths"&&e.jsx(Fe,{deathStats:D,selectedCamp:l,minGamesForAverage:d,onMinGamesChange:p,availableDeathTypes:x,deathTypeColors:t}),m==="hunter"&&e.jsx(Ge,{hunterStats:C,isLoading:N,error:I}),m==="survival"&&e.jsx(qe,{survivalStats:L,selectedCamp:l,minGamesForAverage:d,onMinGamesChange:p,isLoading:j,error:S}),m==="meetingSurvival"&&e.jsx(Ue,{meetingSurvivalStats:T,selectedCamp:l,minGamesForAverage:d,onMinGamesChange:p,isLoading:M,error:o})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{it as DeathStatisticsChart};
