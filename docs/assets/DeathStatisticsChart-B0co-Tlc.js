import{g as le,e as me,u as Q,a as ae,r as w,j as e,p as de,i as ve,m as xe}from"./index-DGFV8OXQ.js";import{g as ce,u as fe,a as je,b as Pe,c as Se}from"./useDeathStatisticsFromRaw-DvP3NtFH.js";import{u as ne}from"./baseStatsHook-D3rI5qPx.js";import{g as Z,a as ie,D as F}from"./datasyncExport-BirWLS1z.js";import{M as ue,C as ye,u as re,m as oe,b as pe,a as be,c as Ae}from"./api-zvTdSM8o.js";import{D as V,g as he}from"./deathTypes-gHH1w6_X.js";import{F as G,C as q,X as U,Y as $}from"./FullscreenChart-CzXmwdZ1.js";import{u as se}from"./useJoueursData-B1Cilqb1.js";import{R as O,T as _,a as X}from"./CategoricalChart-XlP9iajG.js";import{B as J,a as Y}from"./BarChart-BXpjcvj0.js";function ge(s){if(!s||s.trim()==="")return null;const l=s.trim().slice(1),v=parseInt(l,10);return isNaN(v)||v<1?null:v}function De(s,h){if(s.length===0)return null;const l={},v={};s.forEach(c=>{let r=1;if(c.EndTiming){const u=ge(c.EndTiming);u&&(r=u)}c.PlayerStats.forEach(u=>{if(h&&h!=="Tous les camps"&&Z(u.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==h)return;const o=u.Username;l[o]||(l[o]={playerName:o,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const R=l[o];R.totalGames++;let j=null;u.DeathTiming&&(j=ge(u.DeathTiming));for(let f=1;f<=r;f++)R.gamesPlayedByDay[f]||(R.gamesPlayedByDay[f]=0,R.survivalsByDay[f]=0),v[f]||(v[f]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),R.gamesPlayedByDay[f]++,v[f].playersOnDay++,(!j||j>f)&&(R.survivalsByDay[f]++,v[f].survivorsOnDay++)});for(let u=1;u<=r;u++)v[u]||(v[u]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),v[u].gamesReachingDay++}),Object.values(l).forEach(c=>{Object.keys(c.gamesPlayedByDay).forEach(r=>{const u=parseInt(r),o=c.gamesPlayedByDay[u],R=c.survivalsByDay[u];o>0?c.survivalRatesByDay[u]=R/o*100:c.survivalRatesByDay[u]=0})});const g=Object.values(l).filter(c=>c.totalGames>0).sort((c,r)=>r.totalGames-c.totalGames),b=Object.entries(v).map(([c,r])=>({dayNumber:parseInt(c),totalGamesReachingDay:r.gamesReachingDay,totalPlayersOnDay:r.playersOnDay,averageSurvivalRate:r.playersOnDay>0?r.survivorsOnDay/r.playersOnDay*100:0})).sort((c,r)=>c.dayNumber-r.dayNumber);return{totalGames:s.length,totalPlayersAnalyzed:g.length,playerSurvivalStats:g,dayStats:b}}function Te(s,h,l=ue.MEDIUM){return s.playerSurvivalStats.filter(v=>v.totalGames>=l&&(v.gamesPlayedByDay[h]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[h]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[h]||0,timesSurvivedDay:v.survivalsByDay[h]||0})).sort((v,g)=>g.survivalRate-v.survivalRate).slice(0,ye.TOP_15)}function Me(s,h,l=ue.MEDIUM){return s.playerSurvivalStats.filter(v=>v.totalGames>=l&&(v.gamesPlayedByDay[h]||0)>0).map(v=>({playerName:v.playerName,survivalRate:v.survivalRatesByDay[h]||0,gamesPlayed:v.totalGames,timesReachedDay:v.gamesPlayedByDay[h]||0,timesSurvivedDay:v.survivalsByDay[h]||0})).sort((v,g)=>v.survivalRate-g.survivalRate).slice(0,ye.TOP_15)}function Ne(s){return ne(h=>De(h,s))}function Re(s,h){if(!s.DeathTiming)return!0;const l=s.DeathTiming.toUpperCase();if(l.startsWith("M")){const v=parseInt(l.substring(1));return h<=v}if(l.startsWith("N")||l.startsWith("J")){const v=parseInt(l.substring(1));return h<v}return!0}function ke(s,h){if(s.length===0)return null;const l=new Map;let v=0;s.forEach(b=>{if(!b.PlayerStats)return;b.PlayerStats.forEach(r=>{const u=le(r),o=r.Username;l.has(u)||l.set(u,{playerName:o,villageois:{meetingsParticipated:0,deathsAtMeetings:0},loups:{meetingsParticipated:0,deathsAtMeetings:0},solo:{meetingsParticipated:0,deathsAtMeetings:0}})});const c=Math.max(...b.PlayerStats.flatMap(r=>(r.Votes||[]).map(u=>u.Day||0)),0);v+=c;for(let r=1;r<=c;r++)b.PlayerStats.filter(o=>Re(o,r)).forEach(o=>{const R=le(o),j=l.get(R);if(!j)return;const f=ie(o.MainRoleInitial,o.MainRoleChanges||[]),k=Z(f,{regroupWolfSubRoles:!0});h&&h!=="Tous les camps"&&k!==h||(k==="Villageois"?j.villageois.meetingsParticipated++:k==="Loup"?j.loups.meetingsParticipated++:j.solo.meetingsParticipated++,o.DeathType==="VOTED"&&o.DeathTiming===`M${r}`&&(k==="Villageois"?j.villageois.deathsAtMeetings++:k==="Loup"?j.loups.deathsAtMeetings++:j.solo.deathsAtMeetings++))})});const g=Array.from(l.entries()).map(([b,c])=>{const r=c.villageois.meetingsParticipated+c.loups.meetingsParticipated+c.solo.meetingsParticipated,u=c.villageois.deathsAtMeetings+c.loups.deathsAtMeetings+c.solo.deathsAtMeetings,o=r>0?(r-u)/r*100:0,R=c.villageois.meetingsParticipated>0?(c.villageois.meetingsParticipated-c.villageois.deathsAtMeetings)/c.villageois.meetingsParticipated*100:null,j=c.loups.meetingsParticipated>0?(c.loups.meetingsParticipated-c.loups.deathsAtMeetings)/c.loups.meetingsParticipated*100:null,f=c.solo.meetingsParticipated>0?(c.solo.meetingsParticipated-c.solo.deathsAtMeetings)/c.solo.meetingsParticipated*100:null;return{playerId:b,playerName:c.playerName,totalMeetingsParticipated:r,totalDeathsAtMeetings:u,survivalRate:o,campBreakdown:{villageois:{meetingsParticipated:c.villageois.meetingsParticipated,deathsAtMeetings:c.villageois.deathsAtMeetings,survivalRate:R},loups:{meetingsParticipated:c.loups.meetingsParticipated,deathsAtMeetings:c.loups.deathsAtMeetings,survivalRate:j},solo:{meetingsParticipated:c.solo.meetingsParticipated,deathsAtMeetings:c.solo.deathsAtMeetings,survivalRate:f}}}}).filter(b=>b.totalMeetingsParticipated>0).sort((b,c)=>c.survivalRate-b.survivalRate);return{totalGames:s.length,totalMeetings:v,playerStats:g}}function Be(s){return ne(h=>ke(h,s))}function He(s,h){if(h==="Tous les camps"){const l=s.filter(v=>v!==V.BULLET_HUMAN&&v!==V.BULLET_WOLF);return(s.includes(V.BULLET_HUMAN)||s.includes(V.BULLET_WOLF))&&!l.includes(V.BULLET)&&l.push(V.BULLET),l}return s}function te(s,h){if(h==="Tous les camps"){const l=s.killsByDeathType[V.BULLET_HUMAN]||0,v=s.killsByDeathType[V.BULLET_WOLF]||0,g=s.killsByDeathType[V.BULLET]||0,b={...s.killsByDeathType};return b[V.BULLET]=l+v+g,delete b[V.BULLET_HUMAN],delete b[V.BULLET_WOLF],{...s,killsByDeathType:b}}return s}function Ke(s,h="Tous les camps",l="Tous les camps"){const v=new Map;return s.forEach(g=>{g.PlayerStats.forEach(b=>{const c=le(b),r=me(b),u=ie(b.MainRoleInitial,b.MainRoleChanges||[]),o=Z(u,{regroupVillagers:!0,regroupWolfSubRoles:!0},b.Power);if(h!=="Tous les camps"&&o!==h)return;let R=0;if(g.PlayerStats.forEach(j=>{if(j.KillerName===b.Username&&j.DeathTiming){const f=ie(j.MainRoleInitial,j.MainRoleChanges||[]),k=Z(f,{regroupVillagers:!0,regroupWolfSubRoles:!0},j.Power);l==="Tous les camps"?R++:l==="Roles solo"?k!=="Villageois"&&k!=="Loups"&&R++:k===l&&R++}}),R>0){const j=v.get(c);j?R>j.maxKills?(j.maxKills=R,j.timesAchieved=1,j.gameIds=[g.DisplayedId]):R===j.maxKills&&(j.timesAchieved++,j.gameIds.includes(g.DisplayedId)||j.gameIds.push(g.DisplayedId)):v.set(c,{playerName:r,maxKills:R,timesAchieved:1,gameIds:[g.DisplayedId]})}})}),Array.from(v.values()).sort((g,b)=>b.maxKills!==g.maxKills?b.maxKills-g.maxKills:b.timesAchieved-g.timesAchieved)}function ze(s,h="Tous les camps",l="Tous les camps"){const v=new Map;return s.forEach(g=>{const b=new Map;g.PlayerStats.forEach(c=>{if(c.KillerName&&c.DeathTiming&&c.DeathTiming.match(/^[A-Z]\d+$/)){const r=c.KillerName,u=c.DeathTiming,o=g.PlayerStats.find(z=>z.Username===r);if(!o)return;const R=ie(o.MainRoleInitial,o.MainRoleChanges||[]),j=Z(R,{regroupVillagers:!0,regroupWolfSubRoles:!0},o.Power);if(h!=="Tous les camps"&&j!==h)return;const f=ie(c.MainRoleInitial,c.MainRoleChanges||[]),k=Z(f,{regroupVillagers:!0,regroupWolfSubRoles:!0},c.Power);let W=!1;if(l==="Tous les camps"?W=!0:l==="Roles solo"?W=k!=="Villageois"&&k!=="Loups":W=k===l,!W)return;b.has(r)||b.set(r,new Map);const T=b.get(r);T.set(u,(T.get(u)||0)+1)}}),b.forEach((c,r)=>{const u=Math.max(...Array.from(c.values())),o=g.PlayerStats.find(k=>k.Username===r);if(!o)return;const R=le(o),j=me(o),f=v.get(R);f?u>f.maxKills?(f.maxKills=u,f.timesAchieved=1,f.gameIds=[g.DisplayedId]):u===f.maxKills&&(f.timesAchieved++,f.gameIds.includes(g.DisplayedId)||f.gameIds.push(g.DisplayedId)):v.set(R,{playerName:j,maxKills:u,timesAchieved:1,gameIds:[g.DisplayedId]})})}),Array.from(v.values()).sort((g,b)=>b.maxKills!==g.maxKills?b.maxKills-g.maxKills:b.timesAchieved-g.timesAchieved)}function Le(s,h="Tous les camps",l="Tous les camps"){return s.length===0?null:{maxKillsPerGame:Ke(s,h,l),maxKillsPerPhase:ze(s,h,l)}}function Ee(s="Tous les camps",h="Tous les camps"){return ne(l=>Le(l,s,h))}function Ie({deathStats:s,selectedCamp:h,victimCampFilter:l,minGamesForAverage:v,onMinGamesChange:g,availableDeathTypes:b,deathTypeColors:c,totalEligibleForAverage:r}){const{navigateToGameDetails:u}=Q(),{settings:o}=ae(),{joueursData:R}=se(),j=re(R),{data:f}=Ee(h,l),k=w.useMemo(()=>He(b,l),[b,l]),W=w.useMemo(()=>{const t={...c};if(l==="Tous les camps"&&!t[V.BULLET]){const a=c[V.BULLET_HUMAN]||c[V.BULLET_WOLF];a&&(t[V.BULLET]=a)}return t},[c,l]),T=t=>{let a="Top Tueurs";return h!=="Tous les camps"&&(a+=` en ${h}`),l!=="Tous les camps"&&(l==="Roles solo"?a+=" (victimes: Roles solo)":a+=` (victimes: ${l})`),t==="total"?a+=" (Total)":a+=" (Moyenne par Partie)",a},z=t=>{let a=t==="game"?"Record de Kills en une Partie":"Record de Kills en une Phase";return h!=="Tous les camps"&&(a+=` (${h})`),l!=="Tous les camps"&&(l==="Roles solo"?a+=h!=="Tous les camps"?" - victimes: Roles solo":" (victimes: Roles solo)":a+=h!=="Tous les camps"?` - victimes: ${l}`:` (victimes: ${l})`),a},{totalKillsData:L,averageKillsData:P,highlightedPlayerAddedToTotal:A,highlightedPlayerAddedToAverage:M}=w.useMemo(()=>{if(!s)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const t=s.killerStats.sort((E,m)=>m.kills-E.kills).slice(0,15),a=o.highlightedPlayer&&t.some(E=>E.killerName===o.highlightedPlayer),i=t.map(E=>{const m=te(E,l),I={name:m.killerName,value:m.kills,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!1};return k.forEach(C=>{I[C]=m.killsByDeathType[C]||0}),I});let p=!1;if(o.highlightedPlayer&&!a){const E=s.killerStats.find(m=>m.killerName===o.highlightedPlayer);if(E){const m=te(E,l),I={name:m.killerName,value:m.kills,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!0};k.forEach(C=>{I[C]=m.killsByDeathType[C]||0}),i.push(I),p=!0}}const H=s.killerStats.filter(E=>E.gamesPlayed>=v).sort((E,m)=>m.averageKillsPerGame-E.averageKillsPerGame).slice(0,15),B=o.highlightedPlayer&&H.some(E=>E.killerName===o.highlightedPlayer),y=H.map(E=>{const m=te(E,l),I={name:m.killerName,value:m.averageKillsPerGame,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!1};return k.forEach(C=>{const ee=m.killsByDeathType[C]||0;I[C]=m.gamesPlayed>0?ee/m.gamesPlayed:0}),I});let K=!1;if(o.highlightedPlayer&&!B){const E=s.killerStats.find(m=>m.killerName===o.highlightedPlayer);if(E){const m=te(E,l),I={name:m.killerName,value:m.averageKillsPerGame,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!0};k.forEach(C=>{const ee=m.killsByDeathType[C]||0;I[C]=m.gamesPlayed>0?ee/m.gamesPlayed:0}),y.push(I),K=!0}}return{totalKillsData:i,averageKillsData:y,highlightedPlayerAddedToTotal:p,highlightedPlayerAddedToAverage:K}},[s,o.highlightedPlayer,v,k,l]),N=({active:t,payload:a,label:i})=>{if(t&&a&&a.length){const p=a[0].payload,S=p.isHighlightedAddition,H=o.highlightedPlayer===p.name,B=k.reduce((y,K)=>y+(p[K]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:H?"var(--accent-primary)":"var(--text-primary)"},children:[i,S&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",B]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",p.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),k.map(y=>({deathType:y,count:p[y]||0})).filter(y=>y.count>0).sort((y,K)=>K.count-y.count).map(({deathType:y,count:K})=>e.jsxs("p",{style:{color:W[y],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ce(y),":"]})," ",K]},y))]}),S&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),H&&!S&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},n=({active:t,payload:a,label:i})=>{if(t&&a&&a.length){const p=a[0].payload,S=p.isHighlightedAddition,H=o.highlightedPlayer===p.name,B=p.gamesPlayed>=v,y=s?.killerStats.find(I=>I.killerName===p.name),K=y?te(y,l):null,E=k.reduce((I,C)=>I+(p[C]||0),0),m=K?K.kills:Math.round(E*p.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:H?"var(--accent-primary)":"var(--text-primary)"},children:[i,S&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",E.toFixed(2)," (",m," kills /",p.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",p.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),k.map(I=>({deathType:I,avgCount:p[I]||0,totalKillsForDeathType:K?K.killsByDeathType[I]||0:Math.round((p[I]||0)*p.gamesPlayed)})).filter(I=>I.avgCount>0).sort((I,C)=>C.avgCount-I.avgCount).map(({deathType:I,avgCount:C,totalKillsForDeathType:ee})=>e.jsxs("p",{style:{color:W[I],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ce(I),":"]})," ",C.toFixed(2)," (",ee," kills /",p.gamesPlayed," games)"]},I))]}),S&&!B&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",v," parties)"]}),S&&B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),H&&!S&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},D=w.useMemo(()=>{if(!f)return[];const t=f.maxKillsPerGame.slice(0,15),a=o.highlightedPlayer&&t.some(i=>i.playerName===o.highlightedPlayer);if(o.highlightedPlayer&&!a){const i=f.maxKillsPerGame.find(p=>p.playerName===o.highlightedPlayer);i&&t.push({...i})}return t.map((i,p)=>({name:i.playerName,value:i.maxKills,timesAchieved:i.timesAchieved,gameIds:i.gameIds,isHighlightedAddition:p>=15}))},[f,o.highlightedPlayer]),d=w.useMemo(()=>{if(!f)return[];const t=f.maxKillsPerPhase.slice(0,15),a=o.highlightedPlayer&&t.some(i=>i.playerName===o.highlightedPlayer);if(o.highlightedPlayer&&!a){const i=f.maxKillsPerPhase.find(p=>p.playerName===o.highlightedPlayer);i&&t.push({...i})}return t.map((i,p)=>({name:i.playerName,value:i.maxKills,timesAchieved:i.timesAchieved,gameIds:i.gameIds,isHighlightedAddition:p>=15}))},[f,o.highlightedPlayer]),x=({active:t,payload:a,label:i,chartType:p})=>{if(t&&a&&a.length){const S=a[0].payload,H=o.highlightedPlayer===S.name,B=S.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:H?"var(--accent-primary)":"var(--text-primary)"},children:[i,B&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsxs("strong",{children:[p==="game"?"Max kills en une partie":"Max kills en une phase",":"]})," ",S.value]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Nombre de fois:"})," ",S.timesAchieved]}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"4px 0",fontSize:"0.8rem"},children:[S.gameIds.length," partie",S.gameIds.length>1?"s":""," concernÃ©e",S.gameIds.length>1?"s":""]}),B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),H&&!B&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:T("total")}),A&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:T("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:L,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:o.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===i.value?14:12,fontWeight:o.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(N,{})}),k.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"kills",fill:W[t],onClick:a=>{const i={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(i.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(i)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,L.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:T("average")}),M&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:v,onChange:t=>g(Number(t.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:oe.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(G,{title:T("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:P,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:o.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===i.value?14:12,fontWeight:o.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(n,{})}),k.map(t=>e.jsx(Y,{dataKey:t,name:t,stackId:"averageKills",fill:W[t],onClick:a=>{const i={selectedPlayer:a?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(i.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(i)}},t))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,P.filter(t=>!t.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",r," ayant au moins ",v," partie",v>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:z("game")}),D.some(t=>t.isHighlightedAddition)&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:z("game"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:D,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:o.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===i.value?14:12,fontWeight:o.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Nombre max de kills en une partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(x,{...t,chartType:"game"})}),e.jsx(Y,{dataKey:"value",shape:t=>{const{x:a,y:i,width:p,height:S,payload:H}=t,B=H,y=o.highlightedPlayer===B.name,K=B.isHighlightedAddition,E=j[B.name]||(y?"var(--accent-primary)":K?"var(--accent-secondary)":"var(--chart-primary)");return e.jsx(X,{x:a,y:i,width:p,height:S,fill:E,stroke:y?"var(--accent-primary)":"none",strokeWidth:y?3:0,strokeDasharray:K?"5,5":"none",opacity:K?.8:1,onClick:()=>{if(B?.gameIds&&B.gameIds.length>0){const m={fromComponent:"Statistiques de Mort - Max Kills par Partie"};B.gameIds.length===1?m.selectedGame=B.gameIds[0]:m.selectedGameIds=B.gameIds,h!=="Tous les camps"&&(m.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(m)}},style:{cursor:"pointer"}})}})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:h!=="Tous les camps"||l!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule partie (avec filtres appliquÃ©s)":"Nombre maximum de kills rÃ©alisÃ©s en une seule partie"})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:z("phase")}),d.some(t=>t.isHighlightedAddition)&&o.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',o.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:z("phase"),children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:d,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:t,y:a,payload:i})=>e.jsx("text",{x:t,y:a,dy:10,fill:o.highlightedPlayer===i.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:o.highlightedPlayer===i.value?14:12,fontWeight:o.highlightedPlayer===i.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${t} ${a})`,children:i.value})}),e.jsx($,{label:{value:"Nombre max de kills en une phase",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:t=>e.jsx(x,{...t,chartType:"phase"})}),e.jsx(Y,{dataKey:"value",shape:t=>{const{x:a,y:i,width:p,height:S,payload:H}=t,B=H,y=o.highlightedPlayer===B.name,K=B.isHighlightedAddition,E=j[B.name]||(y?"var(--accent-primary)":K?"var(--accent-secondary)":"var(--chart-secondary)");return e.jsx(X,{x:a,y:i,width:p,height:S,fill:E,stroke:y?"var(--accent-primary)":"none",strokeWidth:y?3:0,strokeDasharray:K?"5,5":"none",opacity:K?.8:1,onClick:()=>{if(B?.gameIds&&B.gameIds.length>0){const m={fromComponent:"Statistiques de Mort - Max Kills par Phase"};B.gameIds.length===1?m.selectedGame=B.gameIds[0]:m.selectedGameIds=B.gameIds,h!=="Tous les camps"&&(m.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),u(m)}},style:{cursor:"pointer"}})}})]})})})}),e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:h!=="Tous les camps"||l!=="Tous les camps"?"Nombre maximum de kills rÃ©alisÃ©s en une seule phase avec filtres appliquÃ©s":"Nombre maximum de kills rÃ©alisÃ©s en une seule phase"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",textAlign:"center",marginTop:"0.25rem",fontStyle:"italic"},children:"Une phase est une sÃ©quence de jeu : Jour (J1), Nuit (N1), Meeting (M1), etc."})]})]})}function we({deathStats:s,selectedCamp:h,minGamesForAverage:l,onMinGamesChange:v,availableDeathTypes:g,deathTypeColors:b}){const{navigateToGameDetails:c}=Q(),{settings:r}=ae(),{joueursData:u}=se(),o=re(u),[R,j]=w.useState(null),{totalDeathsData:f,survivalRateData:k,highlightedPlayerAddedToDeaths:W,highlightedPlayerAddedToSurvival:T}=w.useMemo(()=>{if(!s)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const P=s.playerDeathStats.sort((a,i)=>i.totalDeaths-a.totalDeaths).slice(0,15),A=r.highlightedPlayer&&P.some(a=>a.playerName===r.highlightedPlayer),M=P.map(a=>{const i=a.gamesPlayed,p=i>0?(i-a.totalDeaths)/i*100:0,S={name:a.playerName,value:a.totalDeaths,totalDeaths:a.totalDeaths,gamesPlayed:i,deathRate:a.deathRate,survivalRate:p,isHighlightedAddition:!1};return g.forEach(H=>{S[H]=a.deathsByType[H]||0}),S});let N=!1;if(r.highlightedPlayer&&!A){const a=s.playerDeathStats.find(i=>i.playerName===r.highlightedPlayer);if(a){const i=a.gamesPlayed,p=i>0?(i-a.totalDeaths)/i*100:0,S={name:a.playerName,value:a.totalDeaths,totalDeaths:a.totalDeaths,gamesPlayed:i,deathRate:a.deathRate,survivalRate:p,isHighlightedAddition:!0};g.forEach(H=>{S[H]=a.deathsByType[H]||0}),M.push(S),N=!0}}const D=s.playerDeathStats.filter(a=>a.gamesPlayed>=l).map(a=>({...a,survivalRate:a.gamesPlayed>0?(a.gamesPlayed-a.totalDeaths)/a.gamesPlayed*100:0})).sort((a,i)=>i.survivalRate-a.survivalRate).slice(0,15),d=r.highlightedPlayer&&D.some(a=>a.playerName===r.highlightedPlayer),x=D.map(a=>{const i={name:a.playerName,value:a.survivalRate,totalDeaths:a.totalDeaths,gamesPlayed:a.gamesPlayed,deathRate:a.deathRate,survivalRate:a.survivalRate,isHighlightedAddition:!1};return g.forEach(p=>{i[p]=a.deathsByType[p]||0}),i});let t=!1;if(r.highlightedPlayer&&!d){const a=s.playerDeathStats.find(i=>i.playerName===r.highlightedPlayer);if(a){const i=a.gamesPlayed>0?(a.gamesPlayed-a.totalDeaths)/a.gamesPlayed*100:0,p={name:a.playerName,value:i,totalDeaths:a.totalDeaths,gamesPlayed:a.gamesPlayed,deathRate:a.deathRate,survivalRate:i,isHighlightedAddition:!0};g.forEach(S=>{p[S]=a.deathsByType[S]||0}),x.push(p),t=!0}}return{totalDeathsData:M,survivalRateData:x,highlightedPlayerAddedToDeaths:N,highlightedPlayerAddedToSurvival:t}},[s,r.highlightedPlayer,l,g]),z=({active:P,payload:A,label:M})=>{if(P&&A&&A.length){const N=A[0].payload,n=N.isHighlightedAddition,D=r.highlightedPlayer===N.name,d=g.reduce((x,t)=>x+(N[t]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:D?"var(--accent-primary)":"var(--text-primary)"},children:[M,n&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",d]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",N.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",N.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),g.map(x=>{const t=N[x]||0;return t===0?null:e.jsxs("p",{style:{color:b[x],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[he(x),":"]})," ",t]},x)})]}),n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),D&&!n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},L=({active:P,payload:A,label:M})=>{if(P&&A&&A.length){const N=A[0].payload,n=N.isHighlightedAddition,D=r.highlightedPlayer===N.name,d=N.gamesPlayed>=l;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:D?"var(--accent-primary)":"var(--text-primary)"},children:[M,n&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",N.survivalRate.toFixed(1),"% (",N.gamesPlayed-N.totalDeaths," survies / ",N.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",N.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",N.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),g.map(x=>{const t=N[x]||0;return t===0?null:e.jsxs("p",{style:{color:b[x],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[he(x),":"]})," ",t]},x)})]}),n&&!d&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties)"]}),n&&d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),D&&!n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:h==="Tous les camps"?"Morts (Total)":`Morts en ${h} (Total)`}),W&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:h==="Tous les camps"?"Morts (Total)":`Morts en ${h} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:P,y:A,payload:M})=>e.jsx("text",{x:P,y:A,dy:10,fill:r.highlightedPlayer===M.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===M.value?14:12,fontWeight:r.highlightedPlayer===M.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${P} ${A})`,children:M.value})}),e.jsx($,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(z,{})}),g.map(P=>e.jsx(Y,{dataKey:P,name:P,stackId:"deaths",fill:b[P],onClick:A=>{const M={selectedPlayer:A?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(M.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),c(M)}},P))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(P=>!P.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",h==="Tous les camps"?"(Total)":` en ${h}`]}),T&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:l,onChange:P=>v(Number(P.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:oe.map(P=>e.jsx("option",{value:P,children:P},P))})]}),e.jsx(G,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:k,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:P,y:A,payload:M})=>e.jsx("text",{x:P,y:A,dy:10,fill:r.highlightedPlayer===M.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===M.value?14:12,fontWeight:r.highlightedPlayer===M.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${P} ${A})`,children:M.value})}),e.jsx($,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(L,{})}),e.jsx(Y,{dataKey:"value",style:{cursor:"pointer"},shape:P=>{const{x:A,y:M,width:N,height:n,payload:D}=P,d=D,x=r.highlightedPlayer===d.name,t=d.isHighlightedAddition;return e.jsx(X,{x:A,y:M,width:N,height:n,fill:o[d.name]||"var(--chart-primary)",stroke:x?"var(--accent-primary)":R===d.name?"var(--text-primary)":"none",strokeWidth:x?3:R===d.name?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>{const a={selectedPlayer:d?.name,fromComponent:"Statistiques de Mort"};h!=="Tous les camps"&&(a.campFilter={selectedCamp:h,campFilterMode:"all-assignments"}),c(a)},onMouseEnter:()=>j(d?.name||null),onMouseLeave:()=>j(null)})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,k.filter(P=>!P.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",l," partie",l>1?"s":"",")"]})]})]})}function We({hunterStats:s,isLoading:h,error:l}){const{navigateToGameDetails:v}=Q(),{settings:g}=ae(),b=pe(),{joueursData:c}=se(),r=re(c),[u,o]=w.useState(null);if(h)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(l)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",l]});if(!s||s.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:R,highlightedPlayerAddedToBest:j,finalBadHuntersData:f,highlightedPlayerAddedToBad:k}=(()=>{const L=s.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).sort((t,a)=>a.averageNonVillageoisKillsPerGame-t.averageNonVillageoisKillsPerGame).slice(0,15),P=g.highlightedPlayer&&L.some(t=>t.hunterName===g.highlightedPlayer);let A=[...L],M=!1;if(g.highlightedPlayer&&!P){const t=s.hunterStats.find(a=>a.hunterName===g.highlightedPlayer);t&&(A.push({...t,isHighlightedAddition:!0}),M=!0)}const N=s.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).map(t=>({name:t.hunterName,averageVillageoisKills:Number((t.villageoisKills/t.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:t.villageoisKills,totalNonVillageoisKills:t.nonVillageoisKills,totalKills:t.totalKills,gamesPlayed:t.gamesPlayedAsHunter,victimsByCamp:t.victimsByCamp,goodVictimsByCamp:t.goodVictimsByCamp,badVictimsByCamp:t.badVictimsByCamp,hunterName:t.hunterName})),n=N.sort((t,a)=>a.averageVillageoisKills-t.averageVillageoisKills).slice(0,15),D=g.highlightedPlayer&&n.some(t=>t.hunterName===g.highlightedPlayer);let d=[...n],x=!1;if(g.highlightedPlayer&&!D){const t=N.find(a=>a.hunterName===g.highlightedPlayer);t&&(d.push({...t,isHighlightedAddition:!0}),x=!0)}return{finalBestHuntersData:A,highlightedPlayerAddedToBest:M,finalBadHuntersData:d,highlightedPlayerAddedToBad:x}})(),W=({active:z,payload:L,label:P})=>{if(z&&L&&L.length){const A=L[0].payload,M=A.isHighlightedAddition,N=g.highlightedPlayer===A.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[P,M&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",A.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",A.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",A.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",A.totalKills]}),A.goodVictimsByCamp&&Object.keys(A.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(A.goodVictimsByCamp).map(([n,D])=>e.jsxs("p",{style:{color:b[n]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[n,":"]})," ",D]},n))]}),M&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),N&&!M&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},T=({active:z,payload:L,label:P})=>{if(z&&L&&L.length){const A=L[0].payload,M=A.isHighlightedAddition,N=g.highlightedPlayer===A.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:N?"var(--accent-primary)":"var(--text-primary)"},children:[P,M&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",A.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",A.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",A.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",A.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",A.totalKills]}),A.badVictimsByCamp&&Object.keys(A.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(A.badVictimsByCamp).map(([n,D])=>e.jsxs("p",{style:{color:b[n]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[n,":"]})," ",D]},n))]}),M&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),N&&!M&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),j&&g.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',g.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:z,y:L,payload:P})=>e.jsx("text",{x:z,y:L,dy:10,fill:g.highlightedPlayer===P.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:g.highlightedPlayer===P.value?14:12,fontWeight:g.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${z} ${L})`,children:P.value})}),e.jsx($,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(W,{})}),e.jsx(Y,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",style:{cursor:"pointer"},shape:z=>{const{x:L,y:P,width:A,height:M,payload:N}=z,n=N,D=g.highlightedPlayer===n.hunterName,d=n.isHighlightedAddition;return e.jsx(X,{x:L,y:P,width:A,height:M,fill:r[n.hunterName]||b.Chasseur||"#8884d8",stroke:D?"var(--accent-primary)":u===n.hunterName?"var(--text-primary)":"none",strokeWidth:D?3:u===n.hunterName?2:0,strokeDasharray:d?"5,5":"none",opacity:d?.8:1,onClick:()=>{n?.hunterName&&v({selectedPlayer:n.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:()=>o(n.hunterName||null),onMouseLeave:()=>o(null),style:{cursor:"pointer"}})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(z=>!z.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),k&&g.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',g.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:f,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(q,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:z,y:L,payload:P})=>e.jsx("text",{x:z,y:L,dy:10,fill:g.highlightedPlayer===P.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:g.highlightedPlayer===P.value?14:12,fontWeight:g.highlightedPlayer===P.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${z} ${L})`,children:P.value})}),e.jsx($,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(T,{})}),e.jsx(Y,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",style:{cursor:"pointer"},shape:z=>{const{x:L,y:P,width:A,height:M,payload:N}=z,n=N,D=g.highlightedPlayer===n.hunterName,d=n.isHighlightedAddition;return e.jsx(X,{x:L,y:P,width:A,height:M,fill:r[n.hunterName]||b.Chasseur||"#8884d8",stroke:D?"var(--accent-primary)":u===n.hunterName?"var(--text-primary)":"none",strokeWidth:D?3:u===n.hunterName?2:0,strokeDasharray:d?"5,5":"none",opacity:d?.8:1,onClick:()=>{n?.hunterName&&v({selectedPlayer:n.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:()=>o(n.hunterName||null),onMouseLeave:()=>o(null),style:{cursor:"pointer"}})}})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(z=>!z.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function Ce({survivalStats:s,selectedCamp:h,minGamesForAverage:l,onMinGamesChange:v,isLoading:g,error:b}){const{navigateToGameDetails:c}=Q(),{settings:r}=ae(),{joueursData:u}=se(),o=re(u),[R,j]=w.useState(be.DEFAULT_SELECTED_DAY),[f,k]=w.useState(null),W=w.useMemo(()=>s?s.dayStats.filter(D=>D.totalGamesReachingDay>0).map(D=>D.dayNumber).sort((D,d)=>D-d):[],[s]),T=w.useMemo(()=>W.includes(R)?R:W.length>0?W[0]:1,[R,W]),{highestSurvivalData:z,highlightedPlayerAddedToHighest:L}=w.useMemo(()=>{if(!s)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const n=Te(s,T,l),D=r.highlightedPlayer&&n.some(t=>t.playerName===r.highlightedPlayer),d=n.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let x=!1;if(r.highlightedPlayer&&!D){const t=s.playerSurvivalStats.find(a=>a.playerName===r.highlightedPlayer);if(t&&t.totalGames>=l&&(t.gamesPlayedByDay[T]||0)>0){const a=t.survivalRatesByDay[T]||0;d.push({name:r.highlightedPlayer,value:a,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[T]||0,timesSurvivedDay:t.survivalsByDay[T]||0,isHighlightedAddition:!0}),x=!0}}return{highestSurvivalData:d,highlightedPlayerAddedToHighest:x}},[s,T,l,r.highlightedPlayer]),{lowestSurvivalData:P,highlightedPlayerAddedToLowest:A}=w.useMemo(()=>{if(!s)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const n=Me(s,T,l),D=r.highlightedPlayer&&n.some(t=>t.playerName===r.highlightedPlayer),d=n.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let x=!1;if(r.highlightedPlayer&&!D){const t=s.playerSurvivalStats.find(a=>a.playerName===r.highlightedPlayer);if(t&&t.totalGames>=l&&(t.gamesPlayedByDay[T]||0)>0){const a=t.survivalRatesByDay[T]||0;d.push({name:r.highlightedPlayer,value:a,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[T]||0,timesSurvivedDay:t.survivalsByDay[T]||0,isHighlightedAddition:!0}),x=!0}}return{lowestSurvivalData:d,highlightedPlayerAddedToLowest:x}},[s,T,l,r.highlightedPlayer]),M=n=>{c({selectedPlayer:n,fromComponent:"Statistiques de Survie"})},N=({active:n,payload:D,label:d})=>{if(n&&D&&D.length>0){const x=D[0].payload,t=x.isHighlightedAddition,a=r.highlightedPlayer===x.name,i=x.gamesPlayed>=l,p=x.timesReachedDay-x.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:d})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",T,": ",x.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",T,": ",x.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",T,": ",x.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",T,": ",p]}),e.jsxs("div",{children:["Total de parties: ",x.gamesPlayed]}),t&&!i&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",l," parties au total)"]}),t&&i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),a&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return g?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):b?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",b]}):s?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",T," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",L||A?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:T,onChange:n=>j(parseInt(n.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:W.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:l,onChange:n=>v(parseInt(n.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:oe.map(n=>e.jsx("option",{value:n,children:n},n))})]})]})}),T&&s.dayStats.find(n=>n.dayNumber===T)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:T===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${T}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:s.dayStats.find(n=>n.dayNumber===T)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",T]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(s.dayStats.find(n=>n.dayNumber===T)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",l," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:s.playerSurvivalStats.filter(n=>n.totalGames>=l&&(n.gamesPlayedByDay[T]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",T]}),L&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary-text)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:z,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:n,y:D,payload:d})=>e.jsx("text",{x:n,y:D,dy:16,textAnchor:"end",transform:`rotate(-45, ${n}, ${D})`,fill:r.highlightedPlayer===d.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===d.value?14:12,fontWeight:r.highlightedPlayer===d.value?"bold":"normal",children:d.value})}),e.jsx($,{tickFormatter:n=>`${n.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(N,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",shape:n=>{const{x:D,y:d,width:x,height:t,payload:a}=n,i=a,p=r.highlightedPlayer===i.name,S=f===i.name,H=i.isHighlightedAddition;return e.jsx(X,{x:D,y:d,width:x,height:t,fill:o[i.name]||"var(--chart-primary)",stroke:p?"var(--accent-primary)":S?"var(--text-primary)":"none",strokeWidth:p?3:S?2:0,strokeDasharray:H?"5,5":"none",opacity:H?.8:1,onClick:()=>M(i.name),onMouseEnter:()=>k(i.name),onMouseLeave:()=>k(null),style:{cursor:"pointer"}})}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",T]}),A&&r.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',r.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(G,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(J,{data:P,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:n,y:D,payload:d})=>e.jsx("text",{x:n,y:D,dy:16,textAnchor:"end",transform:`rotate(-45, ${n}, ${D})`,fill:r.highlightedPlayer===d.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:r.highlightedPlayer===d.value?14:12,fontWeight:r.highlightedPlayer===d.value?"bold":"normal",children:d.value})}),e.jsx($,{tickFormatter:n=>`${n.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(_,{content:e.jsx(N,{})}),e.jsx(Y,{dataKey:"value",name:"Taux de survie",cursor:"pointer",shape:n=>{const{x:D,y:d,width:x,height:t,payload:a}=n,i=a,p=r.highlightedPlayer===i.name,S=f===i.name,H=i.isHighlightedAddition;return e.jsx(X,{x:D,y:d,width:x,height:t,fill:o[i.name]||"var(--chart-color-4)",stroke:p?"var(--accent-primary)":S?"var(--text-primary)":"none",strokeWidth:p?3:S?2:0,strokeDasharray:H?"5,5":"none",opacity:H?.8:1,onClick:()=>M(i.name),onMouseEnter:()=>k(i.name),onMouseLeave:()=>k(null),style:{cursor:"pointer"}})}})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function Ve({meetingSurvivalStats:s,selectedCamp:h,minGamesForAverage:l,onMinGamesChange:v,isLoading:g,error:b}){const{navigateToGameDetails:c}=Q(),{settings:r}=ae(),{joueursData:u}=se(),o=re(u),[R,j]=w.useState(null),[f,k]=w.useState(50),[W,T]=w.useState("highest"),z=Ae.MEETINGS,{survivalData:L,highlightedPlayerAdded:P}=w.useMemo(()=>{if(!s)return{survivalData:[],highlightedPlayerAdded:!1};const d=s.playerStats.filter(i=>i.totalMeetingsParticipated>=f).sort((i,p)=>W==="highest"?p.survivalRate-i.survivalRate:i.survivalRate-p.survivalRate).slice(0,20),x=r.highlightedPlayer&&d.some(i=>i.playerName===r.highlightedPlayer),t=d.map(i=>({name:i.playerName,value:i.survivalRate,totalMeetings:i.totalMeetingsParticipated,totalDeaths:i.totalDeathsAtMeetings,villageoisRate:i.campBreakdown.villageois.survivalRate,loupRate:i.campBreakdown.loups.survivalRate,soloRate:i.campBreakdown.solo.survivalRate,isHighlightedAddition:!1}));let a=!1;if(r.highlightedPlayer&&!x){const i=s.playerStats.find(p=>p.playerName===r.highlightedPlayer);i&&i.totalMeetingsParticipated>=f&&(t.push({name:r.highlightedPlayer,value:i.survivalRate,totalMeetings:i.totalMeetingsParticipated,totalDeaths:i.totalDeathsAtMeetings,villageoisRate:i.campBreakdown.villageois.survivalRate,loupRate:i.campBreakdown.loups.survivalRate,soloRate:i.campBreakdown.solo.survivalRate,isHighlightedAddition:!0}),a=!0)}return{survivalData:t,highlightedPlayerAdded:a}},[s,r.highlightedPlayer,h,f,W]),{rawDeathsData:A,rawDeathsHighlightedAdded:M}=w.useMemo(()=>{if(!s)return{rawDeathsData:[],rawDeathsHighlightedAdded:!1};const d=[...s.playerStats].filter(i=>i.totalDeathsAtMeetings>0).sort((i,p)=>p.totalDeathsAtMeetings-i.totalDeathsAtMeetings).slice(0,20),x=r.highlightedPlayer&&d.some(i=>i.playerName===r.highlightedPlayer),t=d.map(i=>({name:i.playerName,value:i.totalDeathsAtMeetings,totalMeetings:i.totalMeetingsParticipated,survivalRate:i.survivalRate,isHighlightedAddition:!1}));let a=!1;if(r.highlightedPlayer&&!x){const i=s.playerStats.find(p=>p.playerName===r.highlightedPlayer);i&&i.totalDeathsAtMeetings>0&&(t.push({name:i.playerName,value:i.totalDeathsAtMeetings,totalMeetings:i.totalMeetingsParticipated,survivalRate:i.survivalRate,isHighlightedAddition:!0}),a=!0)}return{rawDeathsData:t,rawDeathsHighlightedAdded:a}},[s,r.highlightedPlayer]),N=d=>{d&&d.name&&c({selectedPlayer:d.name,fromComponent:"Survie aux meetings"})},n=({active:d,payload:x})=>{if(d&&x&&x.length>0){const t=x[0].payload,a=r.highlightedPlayer===t.name,i=t.isHighlightedAddition;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"1rem",boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",color:a?"var(--accent-primary)":"var(--text-primary)",fontSize:a?"1.1rem":"1rem"},children:t.name}),e.jsxs("div",{style:{fontSize:"1.3rem",fontWeight:"bold",color:"var(--danger, #e05252)",marginBottom:"0.5rem"},children:["ðŸ’€ ",t.value," mort",t.value>1?"s":""," en meeting"]}),e.jsxs("div",{style:{color:"var(--text-secondary)"},children:["Meetings participÃ©s : ",t.totalMeetings]}),e.jsxs("div",{style:{color:"var(--text-secondary)"},children:["Taux de survie global : ",t.survivalRate.toFixed(1),"%"]}),i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 20)"}),a&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},D=({active:d,payload:x})=>{if(d&&x&&x.length>0){const t=x[0].payload,a=r.highlightedPlayer===t.name,i=t.isHighlightedAddition,p=t.totalMeetings>=f,S=t.totalMeetings-t.totalDeaths;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"1rem",boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",color:a?"var(--accent-primary)":"var(--text-primary)",fontSize:a?"1.1rem":"1rem"},children:t.name}),e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"var(--accent-secondary)",marginBottom:"0.5rem"},children:["Taux de survie aux meetings: ",t.value.toFixed(1),"%"]}),e.jsxs("div",{children:["Meetings participants: ",t.totalMeetings]}),e.jsxs("div",{children:["A survÃ©cu: ",S]}),e.jsxs("div",{children:["Mort en meeting: ",t.totalDeaths]}),h==="Tous les camps"&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:{marginTop:"0.5rem",borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.25rem"},children:"Par camp:"}),t.villageoisRate!==null&&e.jsxs("div",{children:["Villageois: ",t.villageoisRate.toFixed(1),"%"]}),t.loupRate!==null&&e.jsxs("div",{children:["Loup: ",t.loupRate.toFixed(1),"%"]}),t.soloRate!==null&&e.jsxs("div",{children:["Solo: ",t.soloRate.toFixed(1),"%"]})]})}),i&&!p&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",f," meetings)"]}),i&&p&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 20)"}),a&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return g?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie aux meetings..."}):b?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",b]}):s?e.jsxs("div",{className:"lycans-meeting-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Les statistiques de survie aux meetings montrent le pourcentage de fois qu'un joueur survit aprÃ¨s la rÃ©union parmi tous les meetings auxquels il a participÃ©. Un joueur "participe" Ã  un meeting s'il Ã©tait vivant au dÃ©but de celui-ci. Seules les morts par vote comptent ici.`}),e.jsx("p",{children:P&&"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 20."})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem",marginTop:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"sort-order-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Tri :"}),e.jsxs("select",{id:"sort-order-select",value:W,onChange:d=>T(d.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"200px"},children:[e.jsx("option",{value:"highest",children:"Plus haut taux de survie"}),e.jsx("option",{value:"lowest",children:"Plus bas taux de survie"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-meetings-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. meetings :"}),e.jsx("select",{id:"min-meetings-select",value:f,onChange:d=>k(parseInt(d.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:z.map(d=>e.jsx("option",{value:d,children:d},d))})]})]})}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem",marginTop:"1.5rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des parties analysÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:s.totalGames})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des meetings"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:s.totalMeetings})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",f," meetings)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:s.playerStats.filter(d=>d.totalMeetingsParticipated>=f).length})]})]}),e.jsx(G,{title:W==="highest"?"ðŸ›¡ï¸ Taux de Survie aux Meetings (Plus Haut)":"ðŸ’€ Taux de Survie aux Meetings (Plus Bas)",children:e.jsx(O,{width:"100%",height:500,children:e.jsxs(J,{data:L,margin:{top:20,right:30,left:20,bottom:120},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,stroke:"var(--text-secondary)",tick:d=>{const{x,y:t,payload:a}=d,i=r.highlightedPlayer===a.value;return e.jsx("text",{x,y:t,dy:10,textAnchor:"end",fill:i?"var(--accent-primary)":"var(--text-secondary)",fontSize:i?14:12,fontWeight:i?"bold":"normal",transform:`rotate(-45 ${x} ${t})`,children:a.value})}}),e.jsx($,{domain:[0,100],label:{value:"Taux de survie (%)",angle:-90,position:"insideLeft",fill:"var(--text-primary)"},stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"}}),e.jsx(_,{content:e.jsx(D,{}),cursor:{fill:"var(--bg-tertiary)",opacity:.3}}),e.jsx(Y,{dataKey:"value",fill:"var(--chart-primary)",shape:d=>{const{x,y:t,width:a,height:i,payload:p}=d,S=p,H=r.highlightedPlayer===S.name,B=S.isHighlightedAddition,y=R===S.name;return e.jsx(X,{x,y:t,width:a,height:i,fill:H?"var(--accent-primary)":B?"var(--accent-secondary)":y?"var(--accent-primary-text)":o[S.name]||"var(--chart-primary)",stroke:H?"var(--accent-primary)":"none",strokeWidth:H?3:0,strokeDasharray:B?"5,5":"none",opacity:B?.8:1,onClick:()=>N(S),onMouseEnter:()=>j(S.name),onMouseLeave:()=>j(null),style:{cursor:"pointer"}})}})]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"lycans-section-description",style:{marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"var(--text-primary)",marginBottom:"0.5rem"},children:"ðŸ† Record de morts en meeting"}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",margin:0},children:["Nombre total de fois oÃ¹ chaque joueur a Ã©tÃ© Ã©liminÃ© par un vote de meeting.",h!=="Tous les camps"&&` FiltrÃ© sur le camp : ${h}.`," ","Aucun filtre de meetings minimum appliquÃ© â€” tous les joueurs apparaissent.",M&&" Le joueur sÃ©lectionnÃ© est affichÃ© mÃªme s'il n'est pas dans le top 20."]})]}),e.jsx(G,{title:"ðŸ† Record de Morts en Meeting (Votes)",children:e.jsx(O,{width:"100%",height:500,children:e.jsxs(J,{data:A,margin:{top:20,right:30,left:20,bottom:120},children:[e.jsx(q,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(U,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,stroke:"var(--text-secondary)",tick:d=>{const{x,y:t,payload:a}=d,i=r.highlightedPlayer===a.value;return e.jsx("text",{x,y:t,dy:10,textAnchor:"end",fill:i?"var(--accent-primary)":"var(--text-secondary)",fontSize:i?14:12,fontWeight:i?"bold":"normal",transform:`rotate(-45 ${x} ${t})`,children:a.value})}}),e.jsx($,{allowDecimals:!1,label:{value:"Morts en meeting",angle:-90,position:"insideLeft",fill:"var(--text-primary)"},stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"}}),e.jsx(_,{content:e.jsx(n,{}),cursor:{fill:"var(--bg-tertiary)",opacity:.3}}),e.jsx(Y,{dataKey:"value",fill:"var(--danger, #e05252)",label:{position:"top",fill:"var(--text-secondary)",fontSize:11},shape:d=>{const{x,y:t,width:a,height:i,payload:p}=d,S=p,H=r.highlightedPlayer===S.name,B=S.isHighlightedAddition,y=R===S.name;return e.jsx(X,{x,y:t,width:a,height:i,fill:H?"var(--accent-primary)":B?"var(--accent-secondary)":y?"var(--accent-primary-text)":o[S.name]||"var(--danger, #e05252)",stroke:H?"var(--accent-primary)":"none",strokeWidth:H?3:0,strokeDasharray:B?"5,5":"none",opacity:B?.8:1,onClick:()=>N(S),onMouseEnter:()=>j(S.name),onMouseLeave:()=>j(null),style:{cursor:"pointer"}})}})]})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie aux meetings disponible"})}function Ze(){const{navigationState:s,updateNavigationState:h}=Q(),[l,v]=w.useState(s.deathStatisticsState?.selectedCamp||s.deathStatsSelectedCamp||"Tous les camps"),[g,b]=w.useState(s.deathStatisticsState?.victimCampFilter||"Tous les camps"),[c,r]=w.useState(s.deathStatisticsState?.minGamesForAverage||25),[u,o]=w.useState(()=>{const y=de();if(y.deathStatsView&&["killers","deaths","hunter","survival","meetingSurvival"].includes(y.deathStatsView))return y.deathStatsView;const K=s.deathStatisticsState?.selectedView;return K&&K!=="location"?K:"killers"}),{data:R}=fe(),{data:j,isLoading:f,error:k}=je(l,g),{data:W,isLoading:T,error:z}=Pe(),{data:L,isLoading:P,error:A}=Ne(l),{data:M,isLoading:N,error:n}=Be(l),{data:D}=ve(),d=pe();w.useEffect(()=>{(!s.deathStatisticsState||s.deathStatisticsState.selectedCamp!==l||s.deathStatisticsState.victimCampFilter!==g||s.deathStatisticsState.minGamesForAverage!==c||s.deathStatisticsState.selectedView!==u)&&h({deathStatisticsState:{selectedCamp:l,victimCampFilter:g,minGamesForAverage:c,selectedView:u,focusChart:s.deathStatisticsState?.focusChart}})},[l,g,c,u,s.deathStatisticsState,h]),w.useEffect(()=>{const y=()=>{const K=de();if(K.deathStatsView&&["killers","deaths","hunter","survival","meetingSurvival"].includes(K.deathStatsView)){const E=K.deathStatsView;E!==u&&o(E)}};return window.addEventListener("popstate",y),window.addEventListener("urlchange",y),()=>{window.removeEventListener("popstate",y),window.removeEventListener("urlchange",y)}},[u]);const x=w.useMemo(()=>D?Se(D):[],[D]),t=w.useMemo(()=>{const y={};x.forEach(m=>{m===F.BY_WOLF?y[m]=d.Loup:m===F.VOTED?y[m]="var(--chart-color-1)":m===F.BULLET||m===F.BULLET_HUMAN||m===F.BULLET_WOLF?y[m]=d.Chasseur:m===F.BY_ZOMBIE?y[m]=d.Vaudou:m===F.ASSASSIN?y[m]=d.Alchimiste:m===F.AVENGER?y[m]="var(--chart-color-2)":m===F.LOVER_DEATH?y[m]=d.Amoureux:m===F.BY_BEAST?y[m]="var(--chart-color-3)":m===F.SHERIF_SUCCESS?y[m]="var(--chart-color-4)":m===F.SMUGGLER_HUNT_KILL&&(y[m]=d.Contrebandier)});const K=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let E=0;return x.forEach(m=>{y[m]||(y[m]=K[E%K.length],E++)}),y},[x,d]),a=y=>{v(y),h({deathStatsSelectedCamp:y,deathStatisticsState:{selectedCamp:y,victimCampFilter:g,minGamesForAverage:c,selectedView:u,focusChart:s.deathStatisticsState?.focusChart}})},i=y=>{b(y),h({deathStatisticsState:{selectedCamp:l,victimCampFilter:y,minGamesForAverage:c,selectedView:u,focusChart:s.deathStatisticsState?.focusChart}})},p=y=>{r(y),h({deathStatisticsState:{selectedCamp:l,victimCampFilter:g,minGamesForAverage:y,selectedView:u,focusChart:s.deathStatisticsState?.focusChart}})},S=y=>{o(y),h({deathStatisticsState:{selectedCamp:l,victimCampFilter:g,minGamesForAverage:c,selectedView:y,focusChart:s.deathStatisticsState?.focusChart}}),xe({deathStatsView:y},"replace")},{gamesWithKillers:H,totalEligibleForAverage:B}=w.useMemo(()=>{if(!j)return{gamesWithKillers:0,totalEligibleForAverage:0};const y=j.killerStats.filter(K=>K.gamesPlayed>=c);return{gamesWithKillers:j.totalGames,totalEligibleForAverage:y.length}},[j,c]);return f?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):k?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",k]}):j?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="killers"?"active":""}`,onClick:()=>S("killers"),children:"Tueurs"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="deaths"?"active":""}`,onClick:()=>S("deaths"),children:"Morts"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="survival"?"active":""}`,onClick:()=>S("survival"),children:"Survie par Jour"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="meetingSurvival"?"active":""}`,onClick:()=>S("meetingSurvival"),children:"Survie aux meetings"}),e.jsx("button",{type:"button",className:`lycans-categorie-btn ${u==="hunter"?"active":""}`,onClick:()=>S("hunter"),children:"Chasseur"})]}),(u==="killers"||u==="deaths"||u==="survival"||u==="meetingSurvival")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:l,onChange:y=>a(y.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),R?.map(y=>e.jsx("option",{value:y,children:y},y))]})]}),u==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:g,onChange:y=>i(y.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(u==="killers"||u==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:j.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:j.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary-text)"},children:H})]})]}),u==="killers"&&e.jsx(Ie,{deathStats:j,selectedCamp:l,victimCampFilter:g,minGamesForAverage:c,onMinGamesChange:p,availableDeathTypes:x,deathTypeColors:t,totalEligibleForAverage:B}),u==="deaths"&&e.jsx(we,{deathStats:j,selectedCamp:l,minGamesForAverage:c,onMinGamesChange:p,availableDeathTypes:x,deathTypeColors:t}),u==="hunter"&&e.jsx(We,{hunterStats:W,isLoading:T,error:z}),u==="survival"&&e.jsx(Ce,{survivalStats:L,selectedCamp:l,minGamesForAverage:c,onMinGamesChange:p,isLoading:P,error:A}),u==="meetingSurvival"&&e.jsx(Ve,{meetingSurvivalStats:M,selectedCamp:l,minGamesForAverage:c,onMinGamesChange:p,isLoading:N,error:n})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{Ze as DeathStatisticsChart};
