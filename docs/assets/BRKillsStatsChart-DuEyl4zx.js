import{b as X,r as P,j as e}from"./index-MtJ8cbMy.js";import{F as w,C,X as z,Y as M}from"./FullscreenChart-BJ2cN-2x.js";import{u as Y}from"./useRawBRData-Bpxmu5Me.js";import{u as J}from"./useJoueursData-j60E84F-.js";import{M as U,u as Q,c as Z,g as ee}from"./api-C62hZ3wT.js";import{R as T,T as R,a as F}from"./CategoricalChart-DXaK5Xzl.js";import{B as I,a as H}from"./BarChart-DCkBQjRx.js";import{P as re,a as te}from"./PieChart-CNeygPr8.js";import"./PolarChart-Dyi8U5lc.js";const ie=Z.BR_STANDARD;function xe(){const{data:y,isLoading:O,error:B}=Y(),{settings:n}=X(),{joueursData:E}=J(),[G,D]=P.useState(null),[l,K]=P.useState("average"),[m,q]=P.useState(U.LOW),L=Q(E),b=["var(--chart-color-1)","var(--chart-color-2)","var(--chart-color-3)","var(--chart-color-4)","var(--chart-color-5)","var(--chart-color-6)"],W=s=>L[s]||ee(s),x=P.useMemo(()=>{if(!y)return null;const s=y.length,a=y.reduce((r,i)=>{const o=i.Participants;return r[o]||(r[o]={name:o,participations:0,wins:0,totalScore:0,averageScore:0,winRate:0}),r[o].participations++,r[o].totalScore+=i.Score,i.Gagnant&&r[o].wins++,r},{});Object.values(a).forEach(r=>{r.averageScore=r.totalScore/r.participations,r.winRate=r.wins/r.participations*100});const t=Object.values(a).filter(r=>r.participations>=m),g=t.sort((r,i)=>i.averageScore-r.averageScore).slice(0,15),d=Object.values(a).sort((r,i)=>i.participations-r.participations),c=Object.values(a).sort((r,i)=>i.totalScore-r.totalScore),u=c.slice(0,15),v=n.highlightedPlayer&&u.some(r=>r.name===n.highlightedPlayer);let p=!1,f=[...u];if(n.highlightedPlayer&&!v){const r=c.find(i=>i.name===n.highlightedPlayer);r&&(f.push({...r,isHighlightedAddition:!0}),p=!0)}const A=n.highlightedPlayer&&g.some(r=>r.name===n.highlightedPlayer);let S=!1,k=[...g];if(n.highlightedPlayer&&!A){const r=d.find(i=>i.name===n.highlightedPlayer);r&&(k.push({...r,isHighlightedAddition:!0}),S=!0)}const _=y.reduce((r,i)=>{const o=i.Score,j=o===0?"0":o===1?"1":o===2?"2":o===3?"3":o===4?"4":o<=6?"5-6":"7+";return r[j]||(r[j]={count:0,wins:0}),r[j].count++,i.Gagnant&&r[j].wins++,r},{}),$=Object.entries(_).map(([r,i])=>({range:r,count:i.count,wins:i.wins,percentage:(i.count/s*100).toFixed(1),winRate:i.count>0?(i.wins/i.count*100).toFixed(1):"0.0"})),N=y.filter(r=>r.Gagnant).reduce((r,i)=>{const o=i.Score;return r[o]||(r[o]=0),r[o]++,r},{}),V=Object.entries(N).map(([r,i])=>({score:parseInt(r),count:i,percentage:(i/Object.values(N).reduce((o,j)=>o+j,0)*100).toFixed(1)})).sort((r,i)=>r.score-i.score);return{topPlayersByAverageScore:k,topPlayersByTotalScore:f,scoreData:$,winnerScoreData:V,highlightedPlayerInAverageScore:S,highlightedPlayerInTotalScore:p,totalEligiblePlayers:t.length}},[y,n.highlightedPlayer,m]);return O?e.jsx("div",{className:"statistiques-chargement",children:"Chargement des donnÃ©es Battle Royale..."}):B?e.jsxs("div",{className:"statistiques-erreur",children:["Erreur: ",B]}):x?e.jsxs("div",{className:"lycans-chart-container",children:[e.jsx("div",{className:"lycans-chart-header",children:e.jsx("h2",{children:"Statistiques Kills - Battle Royale"})}),e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{children:l==="average"?"Kill Moyen par Partie":"Kills Totaux"}),(l==="average"&&x.highlightedPlayerInAverageScore||l==="total"&&x.highlightedPlayerInTotalScore)&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.9rem",color:"var(--accent-primary-text)",margin:"0.5rem 0"},children:["ðŸŽ¯ ",n.highlightedPlayer," affichÃ© en plus du top 15"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",minWidth:"350px",justifyContent:"flex-end"},children:[l==="average"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"min-games-avg-score-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-avg-score-select",value:m,onChange:s=>q(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:ie.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("button",{onClick:()=>K("total"),style:{background:l==="total"?"var(--accent-primary)":"var(--bg-tertiary)",color:l==="total"?"var(--bg-primary)":"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem",cursor:"pointer"},children:"Kills Totaux"}),e.jsx("button",{onClick:()=>K("average"),style:{background:l==="average"?"var(--accent-primary)":"var(--bg-tertiary)",color:l==="average"?"var(--bg-primary)":"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem",cursor:"pointer"},children:"Kill Moyen"})]})]}),e.jsx(w,{title:`${l==="average"?"Kill Moyen par Partie":"Kills Totaux"} - Battle Royale`,className:"lycans-chart-wrapper",children:e.jsx(T,{width:"100%",height:400,children:e.jsxs(I,{data:l==="average"?x.topPlayersByAverageScore:x.topPlayersByTotalScore,children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0,tick:({x:s,y:a,payload:t})=>e.jsx("text",{x:s,y:a,dy:16,textAnchor:"end",fill:n.highlightedPlayer===t.value?"var(--accent-primary-text)":"var(--text-secondary)",fontSize:n.highlightedPlayer===t.value?14:12,fontWeight:n.highlightedPlayer===t.value?"bold":"normal",transform:`rotate(-45 ${s} ${a})`,children:t.value})}),e.jsx(M,{}),e.jsx(R,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const t=a[0].payload,h=t.isHighlightedAddition,g=n.highlightedPlayer===t.name,d=t.participations>=m;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.name,g&&" ðŸŽ¯"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Participations: ",e.jsx("strong",{children:t.participations})]}),e.jsxs("div",{children:["Kill total: ",e.jsx("strong",{children:t.totalScore})]}),e.jsxs("div",{children:["Kill moyen: ",e.jsx("strong",{children:t.averageScore.toFixed(2)})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate.toFixed(1),"%"]})]})]}),h&&!d&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",m," partie",m>1?"s":"",")"]}),h&&d&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"8px",fontStyle:"italic",paddingTop:"8px",borderTop:"1px solid var(--border-color)"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"})]})}return null}}),e.jsx(H,{dataKey:l==="average"?"averageScore":"totalScore",name:l==="average"?"Kill moyen par partie":"Kills totaux",shape:s=>{const{x:a,y:t,width:h,height:g,payload:d}=s,c=d,u=n.highlightedPlayer===c.name,v=G===c.name,p=c.isHighlightedAddition;return e.jsx(F,{x:a,y:t,width:h,height:g,fill:u?"var(--accent-primary)":p?"var(--accent-secondary)":W(c.name),stroke:u?"var(--accent-primary)":v?"var(--text-primary)":"none",strokeWidth:u?3:v?2:0,strokeDasharray:p?"5,5":"none",opacity:p?.8:1,onMouseEnter:()=>D(c.name),onMouseLeave:()=>D(null),style:{cursor:"pointer"}})}})]})})}),l==="average"&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",x.topPlayersByAverageScore.length," des joueurs (sur ",x.totalEligiblePlayers," ayant au moins ",m," partie",m>1?"s":"",")"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills"}),e.jsx(w,{title:"Distribution des Kills",className:"lycans-chart-wrapper",children:e.jsx(T,{width:"100%",height:400,children:e.jsxs(re,{children:[e.jsx(te,{data:x.scoreData.map((s,a)=>({...s,fill:b[a%b.length]})),cx:"50%",cy:"50%",labelLine:!1,label:s=>{const{cx:a,cy:t,midAngle:h,outerRadius:g,range:d,percentage:c,fill:u}=s,v=Math.PI/180,p=g+30,f=a+p*Math.cos(-h*v),A=t+p*Math.sin(-h*v),S=d==="7+"?-12:0;return e.jsx("text",{x:f,y:A+S,fill:u,textAnchor:f>a?"start":"end",dominantBaseline:"central",children:`${d}: ${c}%`})},outerRadius:140,fill:"#8884d8",dataKey:"count"}),e.jsx(R,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const t=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.range," ",t.range==="1"?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Nombre de parties: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]}),e.jsxs("div",{children:["Taux de victoire: ",e.jsxs("strong",{children:[t.winRate,"%"]})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"4px"},children:["(",t.wins," victoire",t.wins!==1?"s":"",")"]})]})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution des Kills des Gagnants"}),e.jsx(w,{title:"Distribution des Kills des Gagnants",className:"lycans-chart-wrapper",children:e.jsx(T,{width:"100%",height:400,children:e.jsxs(I,{data:x.winnerScoreData,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(C,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"score",label:{value:"Nombre de kills",position:"insideBottom",offset:-5}}),e.jsx(M,{label:{value:"Nombre de victoires",angle:-90,position:"insideLeft"}}),e.jsx(R,{content:({active:s,payload:a})=>{if(s&&a&&a.length>0){const t=a[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"12px",borderRadius:"8px",border:"1px solid var(--border-color)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem"},children:[t.score," ",t.score===1?"kill":"kills"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.5"},children:[e.jsxs("div",{children:["Victoires: ",e.jsx("strong",{children:t.count})]}),e.jsxs("div",{children:["Pourcentage: ",e.jsxs("strong",{children:[t.percentage,"%"]})]})]})]})}return null}}),e.jsx(H,{dataKey:"count",name:"Victoires",shape:s=>{const{x:a,y:t,width:h,height:g,index:d}=s,c=b[(d??0)%b.length];return e.jsx(F,{x:a,y:t,width:h,height:g,fill:c})}})]})})})]})]})]}):e.jsx("div",{className:"statistiques-vide",children:"Aucune donnÃ©e Battle Royale disponible"})}export{xe as BRKillsStatsChart};
