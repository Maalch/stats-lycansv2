import{r as s,j as c}from"./index-DxMDmK9J.js";import{ae as I,a5 as ie,af as ne,ag as se,a1 as B,ah as oe,c as Y,ai as le,aj as J,ak as X,al as ce,am as ue,an as de,ao as pe,v as H,D as ve,ap as me,y as ye,aq as fe,z as Q,E as he,G as xe,b as ge,a4 as Ae,F as be,ar as P,L as w,as as Se,at as Ee,k as z,au as F,N as Ie,O as Pe,Q as C,x as L,U as je,V as _e,W as Te,Z as Oe,_ as we,$ as De,a0 as Ke,av as Ce,aw as ze,a2 as Re,ax as Le,ad as Me,R as $,B as ke,C as W,X as V,Y as Z,T as q,a as Ne}from"./BarChart-1OtdnxJ6.js";import{L as G}from"./Legend-IPTwhYyO.js";function ee(e,t,a){return(t=Be(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Be(e){var t=Fe(e,"string");return typeof t=="symbol"?t:t+""}function Fe(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $e(e){var t=ie();return s.useEffect(()=>(t(ne(e)),()=>{t(se(e))}),[e,t]),null}class R extends s.Component{render(){return s.createElement($e,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:I.allowDuplicatedCategory,allowDataOverflow:I.allowDataOverflow,reversed:I.reversed,includeHidden:I.includeHidden})}}ee(R,"displayName","ZAxis");ee(R,"defaultProps",{zAxisId:0,range:I.range,scale:I.scale,type:I.type});var We=["option","isActive"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},O.apply(null,arguments)}function Ve(e,t){if(e==null)return{};var a,r,n=Ze(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Ze(e,t){if(e==null)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;a[r]=e[r]}return a}function qe(e){var{option:t,isActive:a}=e,r=Ve(e,We);return typeof t=="string"?s.createElement(B,O({option:s.createElement(oe,O({type:t},r)),isActive:a,shapeType:"symbols"},r)):s.createElement(B,O({option:t,isActive:a,shapeType:"symbols"},r))}var Ge=(e,t,a,r,n,i,o)=>J(e,"xAxis",t,o),Ue=(e,t,a,r,n,i,o)=>X(e,"xAxis",t,o),Ye=(e,t,a,r,n,i,o)=>J(e,"yAxis",a,o),Je=(e,t,a,r,n,i,o)=>X(e,"yAxis",a,o),Xe=(e,t,a,r)=>ce(e,"zAxis",r,!1),He=(e,t,a,r,n)=>n,Qe=(e,t,a,r,n,i)=>i,et=(e,t,a,r,n,i,o)=>le(e,t,a,o),tt=Y([ue,He],(e,t)=>{if(e.some(a=>a.type==="scatter"&&t.dataKey===a.dataKey&&t.data===a.data))return t}),at=Y([et,Ge,Ue,Ye,Je,Xe,tt,Qe],(e,t,a,r,n,i,o,m)=>{var{chartData:u,dataStartIndex:d,dataEndIndex:f}=e;if(o!=null){var p;if(o?.data!=null&&o.data.length>0?p=o.data:p=u?.slice(d,f+1),!(p==null||t==null||r==null||a==null||n==null||a?.length===0||n?.length===0))return vt({displayedData:p,xAxis:t,yAxis:r,zAxis:i,scatterSettings:o,xAxisTicks:a,yAxisTicks:n,cells:m})}}),rt=["onMouseEnter","onClick","onMouseLeave"],it=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function te(e,t){if(e==null)return{};var a,r,n=nt(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function nt(e,t){if(e==null)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;a[r]=e[r]}return a}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},j.apply(null,arguments)}function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?U(Object(a),!0).forEach(function(r){M(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function M(e,t,a){return(t=st(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function st(e){var t=ot(e,"string");return typeof t=="symbol"?t:t+""}function ot(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lt=e=>{var{dataKey:t,name:a,fill:r,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:r,value:H(a,t),payload:e}]};function ct(e){var{points:t,props:a}=e,{line:r,lineType:n,lineJointType:i}=a;if(!r)return null;var o=L(a,!1),m=L(r,!1),u,d;if(n==="joint")u=t.map(l=>({x:l.cx,y:l.cy}));else if(n==="fitting"){var{xmin:f,xmax:p,a:x,b}=ze(t),S=l=>x*l+b;u=[{x:f,y:S(f)},{x:p,y:S(p)}]}var y=h(h(h({},o),{},{fill:"none",stroke:o&&o.fill},m),{},{points:u});return s.isValidElement(r)?d=s.cloneElement(r,y):typeof r=="function"?d=r(y):d=s.createElement(Re,j({},y,{type:i})),s.createElement(w,{className:"recharts-scatter-line",key:"recharts-scatter-line"},d)}function ae(e){var{points:t,showLabels:a,allOtherScatterProps:r}=e,{shape:n,activeShape:i,dataKey:o}=r,m=L(r,!1),u=Q(je),{onMouseEnter:d,onClick:f,onMouseLeave:p}=r,x=te(r,rt),b=_e(d,r.dataKey),S=Te(p),y=Oe(f,r.dataKey);return t==null?null:s.createElement(s.Fragment,null,s.createElement(ct,{points:t,props:r}),t.map((l,v)=>{var E=i&&u===String(v),g=E?i:n,A=h(h(h({key:"symbol-".concat(v)},m),l),{},{[De]:v,[we]:String(o)});return s.createElement(w,j({className:"recharts-scatter-symbol"},Ke(x,l,v),{onMouseEnter:b(l,v),onMouseLeave:S(l,v),onClick:y(l,v),key:"symbol-".concat(l?.cx,"-").concat(l?.cy,"-").concat(l?.size,"-").concat(v)}),s.createElement(qe,j({option:g,isActive:E},A)))}),a&&Ce.renderCallByParent(r,t))}function ut(e){var{previousPointsRef:t,props:a}=e,{points:r,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:m}=a,u=t.current,d=Ie(a,"recharts-scatter-"),[f,p]=s.useState(!1),x=s.useCallback(()=>{p(!1)},[]),b=s.useCallback(()=>{p(!0)},[]);return s.createElement(Pe,{begin:i,duration:o,isActive:n,easing:m,from:{t:0},to:{t:1},onAnimationEnd:x,onAnimationStart:b,key:d},S=>{var{t:y}=S,l=y===1?r:r.map((v,E)=>{var g=u&&u[E];if(g){var A=C(g.cx,v.cx),D=C(g.cy,v.cy),_=C(g.size,v.size);return h(h({},v),{},{cx:A(y),cy:D(y),size:_(y)})}var T=C(0,v.size);return h(h({},v),{},{size:T(y)})});return y>0&&(t.current=l),s.createElement(w,null,s.createElement(ae,{points:l,allOtherScatterProps:a,showLabels:!f}))})}function dt(e){var{points:t,isAnimationActive:a}=e,r=s.useRef(null),n=r.current;return a&&t&&t.length&&(!n||n!==t)?s.createElement(ut,{props:e,previousPointsRef:r}):s.createElement(ae,{points:t,allOtherScatterProps:e,showLabels:!0})}function pt(e){var{dataKey:t,points:a,stroke:r,strokeWidth:n,fill:i,name:o,hide:m,tooltipType:u}=e;return{dataDefinedOnItem:a?.map(d=>d.tooltipPayload),positions:a?.map(d=>d.tooltipPosition),settings:{stroke:r,strokeWidth:n,fill:i,nameKey:void 0,dataKey:t,name:H(o,t),hide:m,type:u,color:i,unit:""}}}function vt(e){var{displayedData:t,xAxis:a,yAxis:r,zAxis:n,scatterSettings:i,xAxisTicks:o,yAxisTicks:m,cells:u}=e,d=P(a.dataKey)?i.dataKey:a.dataKey,f=P(r.dataKey)?i.dataKey:r.dataKey,p=n&&n.dataKey,x=n?n.range:R.defaultProps.range,b=x&&x[0],S=a.scale.bandwidth?a.scale.bandwidth():0,y=r.scale.bandwidth?r.scale.bandwidth():0;return t.map((l,v)=>{var E=z(l,d),g=z(l,f),A=!P(p)&&z(l,p)||"-",D=[{name:P(a.dataKey)?i.name:a.name||a.dataKey,unit:a.unit||"",value:E,payload:l,dataKey:d,type:i.tooltipType},{name:P(r.dataKey)?i.name:r.name||r.dataKey,unit:r.unit||"",value:g,payload:l,dataKey:f,type:i.tooltipType}];A!=="-"&&D.push({name:n.name||n.dataKey,unit:n.unit||"",value:A,payload:l,dataKey:p,type:i.tooltipType});var _=F({axis:a,ticks:o,bandSize:S,entry:l,index:v,dataKey:d}),T=F({axis:r,ticks:m,bandSize:y,entry:l,index:v,dataKey:f}),N=A!=="-"?n.scale(A):b,K=Math.sqrt(Math.max(N,0)/Math.PI);return h(h({},l),{},{cx:_,cy:T,x:_-K,y:T-K,width:2*K,height:2*K,size:N,node:{x:E,y:g,z:A},tooltipPayload:D,tooltipPosition:{x:_,y:T},payload:l},u&&u[v]&&u[v].props)})}var mt=(e,t,a)=>({x:e.cx,y:e.cy,value:a==="x"?+e.node.x:+e.node.y,errorVal:z(e,t)});function yt(e){var t=s.useRef(Ae("recharts-scatter-")),{hide:a,points:r,className:n,needClip:i,xAxisId:o,yAxisId:m,id:u,children:d}=e;if(a)return null;var f=be("recharts-scatter",n),p=P(u)?t.current:u;return s.createElement(w,{className:f,clipPath:i?"url(#clipPath-".concat(p,")"):null},i&&s.createElement("defs",null,s.createElement(Se,{clipPathId:p,xAxisId:o,yAxisId:m})),s.createElement(Ee,{xAxisId:o,yAxisId:m,data:r,dataPointFormatter:mt,errorBarOffset:0},d),s.createElement(w,{key:"recharts-scatter-symbols"},s.createElement(dt,e)))}var re={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!xe.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function ft(e){var t=ve(e,re),{animationBegin:a,animationDuration:r,animationEasing:n,hide:i,isAnimationActive:o,legendType:m,lineJointType:u,lineType:d,shape:f,xAxisId:p,yAxisId:x,zAxisId:b}=t,S=te(t,it),{needClip:y}=me(p,x),l=s.useMemo(()=>ye(e.children,ge),[e.children]),v=s.useMemo(()=>({name:e.name,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey}),[e.data,e.dataKey,e.name,e.tooltipType]),E=fe(),g=Q(A=>at(A,p,x,b,v,l,E));return y==null?null:s.createElement(s.Fragment,null,s.createElement(he,{fn:pt,args:h(h({},e),{},{points:g})}),s.createElement(yt,j({},S,{xAxisId:p,yAxisId:x,zAxisId:b,lineType:d,lineJointType:u,legendType:m,shape:f,hide:i,isAnimationActive:o,animationBegin:a,animationDuration:r,animationEasing:n,points:g,needClip:y})))}class k extends s.Component{render(){return s.createElement(de,{type:"scatter",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:this.props.zAxisId,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},s.createElement(pe,{legendPayload:lt(this.props)}),s.createElement(ft,this.props))}}M(k,"displayName","Scatter");M(k,"defaultProps",re);var ht=["item"],xt=s.forwardRef((e,t)=>s.createElement(Le,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:ht,tooltipPayloadSearcher:Me,categoricalChartProps:e,ref:t}));function gt(){const[e,t]=s.useState(null),[a,r]=s.useState(!0),[n,i]=s.useState(null);return s.useEffect(()=>{(async()=>{try{r(!0),i(null);const u=await fetch("https://script.google.com/macros/s/AKfycbw7amBQVger2k8MpFhueGGtAMUsYioIvdU2yVcixtFuk66a2DRWEpZ_c3xf2nncKjuHPg/exec?action=roleSurvivalStats");if(!u.ok)throw new Error(`Erreur de requête: ${u.status}`);const d=await u.json();if(d.error)throw new Error(d.error);t(d)}catch(m){console.error("Problème lors de la récupération des stats de survie des rôles:",m),i(m instanceof Error?m.message:"Erreur lors du chargement")}finally{r(!1)}})()},[]),{roleSurvivalStats:e,dataLoading:a,fetchError:n}}function Et(){const{roleSurvivalStats:e,dataLoading:t,fetchError:a}=gt();if(t)return c.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques de survie des rôles..."});if(a)return c.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",a]});if(!e||!e.roleStats||e.roleStats.length===0)return c.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de survie disponible"});const r=e.roleStats.filter(i=>i.appearances>=3),n=r.map(i=>({nom:i.role,tauxSurvie:parseFloat(i.survivalRate),dureeVie:parseFloat(i.avgLifespan),apparitions:i.appearances}));return c.jsxs("div",{className:"lycans-roles-survie",children:[c.jsx("h2",{children:"Statistiques de Survie des Rôles"}),c.jsxs("div",{className:"lycans-graphiques-groupe",children:[c.jsxs("div",{className:"lycans-graphique-section",children:[c.jsx("h3",{children:"Taux de Survie par Rôle"}),c.jsx("div",{style:{height:400},children:c.jsx($,{width:"100%",height:"100%",children:c.jsxs(ke,{data:r,margin:{top:20,right:30,left:20,bottom:70},layout:"vertical",children:[c.jsx(W,{strokeDasharray:"3 3"}),c.jsx(V,{type:"number",domain:[0,100]}),c.jsx(Z,{dataKey:"role",type:"category",width:150}),c.jsx(q,{formatter:(i,o)=>o==="survivalRate"?[`${i}%`,"Taux de Survie"]:[i,o],labelFormatter:i=>`Rôle: ${i}`}),c.jsx(G,{}),c.jsx(Ne,{dataKey:"survivalRate",name:"Taux de Survie",fill:"#82ca9d",background:{fill:"#eee"}})]})})})]}),c.jsxs("div",{className:"lycans-graphique-section",children:[c.jsx("h3",{children:"Durée de Vie Moyenne vs Taux de Survie"}),c.jsx("div",{style:{height:400},children:c.jsx($,{width:"100%",height:"100%",children:c.jsxs(xt,{margin:{top:20,right:30,left:20,bottom:10},children:[c.jsx(W,{}),c.jsx(V,{type:"number",dataKey:"dureeVie",name:"Durée de Vie Moyenne (jours)",label:{value:"Durée de Vie Moyenne (jours)",position:"insideBottom",offset:-10}}),c.jsx(Z,{type:"number",dataKey:"tauxSurvie",name:"Taux de Survie (%)",label:{value:"Taux de Survie (%)",angle:-90,position:"insideLeft"}}),c.jsx(R,{type:"number",dataKey:"apparitions",range:[50,400],name:"Nombre d'Apparitions"}),c.jsx(q,{cursor:{strokeDasharray:"3 3"},formatter:(i,o)=>o==="dureeVie"?[`${i} jours`,"Durée de Vie Moyenne"]:o==="tauxSurvie"?[`${i}%`,"Taux de Survie"]:o==="apparitions"?[`${i} fois`,"Nombre d'Apparitions"]:[i,o],labelFormatter:i=>n[i].nom}),c.jsx(G,{}),c.jsx(k,{name:"Rôles",data:n,fill:"#8884d8"})]})})})]})]})]})}export{Et as RoleSurvivalRateChart};
