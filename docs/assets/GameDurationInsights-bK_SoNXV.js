import{r as c,j as n}from"./index-4tou-POj.js";import{x as $,a0 as se,J as I,t as oe,K as Ce,a1 as Le,y as k,L as z,e as J,a2 as le,f as ce,g as ue,s as ke,j as Ke,a3 as Re,a4 as H,k as Te,l as _e,v as Be,m as de,n as Me,o as We,a5 as Fe,a6 as Ge,q as qe,G as Ve,a7 as pe,z as $e,a8 as ze,A as Je,D as he,E as Q,F as Xe,H as Ue,I as S,Z as Ye,V as me,w as Ze,_ as He,$ as Qe,R as B,B as ee,C as M,X as W,Y as F,T as G,a as te}from"./BarChart-6QfMPLFR.js";import{L as ae}from"./Legend-Bffo_Voq.js";function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},q.apply(null,arguments)}var ve=e=>{var{cx:t,cy:a,r,className:s}=e,i=$("recharts-dot",s);return t===+t&&a===+a&&r===+r?c.createElement("circle",q({},I(e,!1),se(e),{className:i,cx:t,cy:a,r})):null};function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?re(Object(a),!0).forEach(function(r){et(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function et(e,t,a){return(t=tt(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tt(e){var t=at(e,"string");return typeof t=="symbol"?t:t+""}function at(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rt=e=>{var{point:t,childIndex:a,mainColor:r,activeDot:s,dataKey:i}=e;if(s===!1||t.x==null||t.y==null)return null;var o=ne(ne({index:a,dataKey:i,cx:t.x,cy:t.y,r:4,fill:r??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},I(s,!1)),se(s)),l;return c.isValidElement(s)?l=c.cloneElement(s,o):typeof s=="function"?l=s(o):l=c.createElement(ve,o),c.createElement(z,{className:"recharts-active-dot"},l)};function nt(e){var{points:t,mainColor:a,activeDot:r,itemDataKey:s}=e,i=oe(Ce),o=Le();if(t==null||o==null)return null;var l=t.find(u=>o.includes(u.payload));return k(l)?null:rt({point:l,childIndex:Number(i),mainColor:a,dataKey:s,activeDot:r})}var ye=(e,t,a,r)=>ce(e,"xAxis",t,r),fe=(e,t,a,r)=>ue(e,"xAxis",t,r),xe=(e,t,a,r)=>ce(e,"yAxis",a,r),ge=(e,t,a,r)=>ue(e,"yAxis",a,r),it=J([le,ye,xe,fe,ge],(e,t,a,r,s)=>Re(e,"xAxis")?H(t,r,!1):H(a,s,!1)),st=(e,t,a,r,s)=>s,ot=J([Ke,st],(e,t)=>{if(e.some(a=>a.type==="line"&&t.dataKey===a.dataKey&&t.data===a.data))return t}),lt=J([le,ye,xe,fe,ge,ot,it,ke],(e,t,a,r,s,i,o,l)=>{var{chartData:u,dataStartIndex:d,dataEndIndex:m}=l;if(!(i==null||t==null||a==null||r==null||s==null||r.length===0||s.length===0||o==null)){var{dataKey:p,data:h}=i,v;if(h!=null&&h.length>0?v=h:v=u?.slice(d,m+1),v!=null)return Ot({layout:e,xAxis:t,yAxis:a,xAxisTicks:r,yAxisTicks:s,dataKey:p,bandSize:o,displayedData:v})}}),ct=["type","layout","connectNulls","needClip"],ut=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function je(e,t){if(e==null)return{};var a,r,s=dt(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function dt(e,t){if(e==null)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;a[r]=e[r]}return a}function ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ie(Object(a),!0).forEach(function(r){K(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ie(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function K(e,t,a){return(t=pt(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pt(e){var t=ht(e,"string");return typeof t=="symbol"?t:t+""}function ht(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},O.apply(null,arguments)}var mt=e=>{var{dataKey:t,name:a,stroke:r,legendType:s,hide:i}=e;return[{inactive:i,dataKey:t,type:s,color:r,value:de(a,t),payload:e}]};function vt(e){var{dataKey:t,data:a,stroke:r,strokeWidth:s,fill:i,name:o,hide:l,unit:u}=e;return{dataDefinedOnItem:a,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:i,dataKey:t,nameKey:void 0,name:de(o,t),hide:l,type:e.tooltipType,color:e.stroke,unit:u}}}var be=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function yt(e,t){for(var a=e.length%2!==0?[...e,0]:e,r=[],s=0;s<t;++s)r=[...r,...a];return r}var ft=(e,t,a)=>{var r=a.reduce((p,h)=>p+h);if(!r)return be(t,e);for(var s=Math.floor(e/r),i=e%r,o=t-e,l=[],u=0,d=0;u<a.length;d+=a[u],++u)if(d+a[u]>i){l=[...a.slice(0,u),i-d];break}var m=l.length%2===0?[0,o]:[o];return[...yt(a,s),...l,...m].map(p=>"".concat(p,"px")).join(", ")};function xt(e,t){var a;if(c.isValidElement(e))a=c.cloneElement(e,t);else if(typeof e=="function")a=e(t);else{var r=$("recharts-line-dot",typeof e!="boolean"?e.className:"");a=c.createElement(ve,O({},t,{className:r}))}return a}function gt(e,t){return e==null?!1:t?!0:e.length===1}function jt(e){var{clipPathId:t,points:a,props:r}=e,{dot:s,dataKey:i,needClip:o}=r;if(!gt(a,s))return null;var l=pe(s),u=I(r,!1),d=I(s,!0),m=a.map((h,v)=>{var x=f(f(f({key:"dot-".concat(v),r:3},u),d),{},{index:v,cx:h.x,cy:h.y,dataKey:i,value:h.value,payload:h.payload,points:a});return xt(s,x)}),p={clipPath:o?"url(#clipPath-".concat(l?"":"dots-").concat(t,")"):null};return c.createElement(z,O({className:"recharts-line-dots",key:"dots"},p),m)}function V(e){var{clipPathId:t,pathRef:a,points:r,strokeDasharray:s,props:i,showLabels:o}=e,{type:l,layout:u,connectNulls:d,needClip:m}=i,p=je(i,ct),h=f(f({},I(p,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:m?"url(#clipPath-".concat(t,")"):null,points:r,type:l,layout:u,connectNulls:d,strokeDasharray:s??i.strokeDasharray});return c.createElement(c.Fragment,null,r?.length>1&&c.createElement(Ye,O({},h,{pathRef:a})),c.createElement(jt,{points:r,clipPathId:t,props:i}),o&&me.renderCallByParent(i,r))}function bt(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Pt(e){var{clipPathId:t,props:a,pathRef:r,previousPointsRef:s,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:l,isAnimationActive:u,animationBegin:d,animationDuration:m,animationEasing:p,animateNewValues:h,width:v,height:x,onAnimationEnd:P,onAnimationStart:g}=a,b=s.current,N=Xe(a,"recharts-line-"),[E,j]=c.useState(!1),w=c.useCallback(()=>{typeof P=="function"&&P(),j(!1)},[P]),R=c.useCallback(()=>{typeof g=="function"&&g(),j(!0)},[g]),D=bt(r.current),C=i.current;return c.createElement(Ue,{begin:d,duration:m,isActive:u,easing:p,from:{t:0},to:{t:1},onAnimationEnd:w,onAnimationStart:R,key:N},T=>{var{t:A}=T,De=S(C,D+C),_=Math.min(De(A),D),L;if(l){var Ae="".concat(l).split(/[,\s]+/gim).map(y=>parseFloat(y));L=ft(_,D,Ae)}else L=be(D,_);if(b){var Ee=b.length/o.length,U=A===1?o:o.map((y,Ie)=>{var Y=Math.floor(Ie*Ee);if(b[Y]){var Z=b[Y],Oe=S(Z.x,y.x),Ne=S(Z.y,y.y);return f(f({},y),{},{x:Oe(A),y:Ne(A)})}if(h){var we=S(v*2,y.x),Se=S(x/2,y.y);return f(f({},y),{},{x:we(A),y:Se(A)})}return f(f({},y),{},{x:y.x,y:y.y})});return s.current=U,c.createElement(V,{props:a,points:U,clipPathId:t,pathRef:r,showLabels:!E,strokeDasharray:L})}return A>0&&D>0&&(s.current=o,i.current=_),c.createElement(V,{props:a,points:o,clipPathId:t,pathRef:r,showLabels:!E,strokeDasharray:L})})}function Dt(e){var{clipPathId:t,props:a}=e,{points:r,isAnimationActive:s}=a,i=c.useRef(null),o=c.useRef(0),l=c.useRef(null),u=i.current;return s&&r&&r.length&&u!==r?c.createElement(Pt,{props:a,clipPathId:t,previousPointsRef:i,longestAnimatedLengthRef:o,pathRef:l}):c.createElement(V,{props:a,points:r,clipPathId:t,pathRef:l,showLabels:!0})}var At=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:he(e.payload,t)});class Et extends c.Component{constructor(){super(...arguments),K(this,"id",Ze("recharts-line-"))}render(){var t,{hide:a,dot:r,points:s,className:i,xAxisId:o,yAxisId:l,top:u,left:d,width:m,height:p,id:h,needClip:v,layout:x}=this.props;if(a)return null;var P=$("recharts-line",i),g=k(h)?this.id:h,{r:b=3,strokeWidth:N=2}=(t=I(r,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},E=pe(r),j=b*2+N;return c.createElement(c.Fragment,null,c.createElement(z,{className:P},v&&c.createElement("defs",null,c.createElement($e,{clipPathId:g,xAxisId:o,yAxisId:l}),!E&&c.createElement("clipPath",{id:"clipPath-dots-".concat(g)},c.createElement("rect",{x:d-j/2,y:u-j/2,width:m+j,height:p+j}))),c.createElement(Dt,{props:this.props,clipPathId:g}),c.createElement(ze,{direction:x==="horizontal"?"y":"x"},c.createElement(Je,{xAxisId:o,yAxisId:l,data:s,dataPointFormatter:At,errorBarOffset:0},this.props.children))),c.createElement(nt,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var Pe={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Ve.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function It(e){var t=Me(e,Pe),{activeDot:a,animateNewValues:r,animationBegin:s,animationDuration:i,animationEasing:o,connectNulls:l,dot:u,hide:d,isAnimationActive:m,label:p,legendType:h,xAxisId:v,yAxisId:x}=t,P=je(t,ut),{needClip:g}=We(v,x),{height:b,width:N,x:E,y:j}=Fe(),w=Ge(),R=qe(),D=c.useMemo(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),C=oe(T=>lt(T,v,x,R,D));return w!=="horizontal"&&w!=="vertical"?null:c.createElement(Et,O({},P,{connectNulls:l,dot:u,activeDot:a,animateNewValues:r,animationBegin:s,animationDuration:i,animationEasing:o,isAnimationActive:m,hide:d,label:p,legendType:h,xAxisId:v,yAxisId:x,points:C,layout:w,height:b,width:N,left:E,top:j,needClip:g}))}function Ot(e){var{layout:t,xAxis:a,yAxis:r,xAxisTicks:s,yAxisTicks:i,dataKey:o,bandSize:l,displayedData:u}=e;return u.map((d,m)=>{var p=he(d,o);return t==="horizontal"?{x:Q({axis:a,ticks:s,bandSize:l,entry:d,index:m}),y:k(p)?null:r.scale(p),value:p,payload:d}:{x:k(p)?null:a.scale(p),y:Q({axis:r,ticks:i,bandSize:l,entry:d,index:m}),value:p,payload:d}})}class X extends c.PureComponent{render(){return c.createElement(Te,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},c.createElement(_e,{legendPayload:mt(this.props)}),c.createElement(Be,{fn:vt,args:this.props}),c.createElement(It,this.props))}}K(X,"displayName","Line");K(X,"defaultProps",Pe);var Nt=["axis"],wt=c.forwardRef((e,t)=>c.createElement(He,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Nt,tooltipPayloadSearcher:Qe,categoricalChartProps:e,ref:t}));function St(){const[e,t]=c.useState(null),[a,r]=c.useState(!0),[s,i]=c.useState(null);return c.useEffect(()=>{(async()=>{try{r(!0),i(null);const u=await fetch("https://script.google.com/macros/s/AKfycbxrhG1mb7N6q7Mg88ogw0mirXgSihPpNPurZwiEOy9miG24Cc3AlGZCn2uoGnygNhck/exec?action=gameDurationAnalysis");if(!u.ok)throw new Error(`Échec de la requête: ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(d.error);t(d)}catch(l){console.error("Impossible de charger les données de durée de partie:",l),i(l instanceof Error?l.message:"Erreur inconnue")}finally{r(!1)}})()},[]),{durationAnalysis:e,fetchingData:a,apiError:s}}function Kt(){const{durationAnalysis:e,fetchingData:t,apiError:a}=St();if(t)return n.jsx("div",{className:"statistiques-attente",children:"Analyse des durées de partie en cours..."});if(a)return n.jsxs("div",{className:"statistiques-echec",children:["Problème rencontré: ",a]});if(!e)return n.jsx("div",{className:"statistiques-indisponibles",children:"Données d'analyse non disponibles"});const r=Object.entries(e.daysByWolfRatio).map(([i,o])=>({ratio:`${parseFloat(i).toFixed(0)}%`,moyenne:parseFloat(o.average),parties:o.count})).sort((i,o)=>parseFloat(i.ratio)-parseFloat(o.ratio)),s=Object.entries(e.daysByWinnerCamp).map(([i,o])=>({camp:i,moyenne:parseFloat(o.average),parties:o.count})).sort((i,o)=>o.moyenne-i.moyenne);return n.jsxs("div",{className:"lycans-duree-analyse",children:[n.jsx("h2",{children:"Analyse des Durées de Partie"}),n.jsxs("div",{className:"lycans-resume-conteneur",children:[n.jsxs("div",{className:"lycans-stat-carte",children:[n.jsx("h3",{children:"Durée Moyenne"}),n.jsxs("p",{className:"lycans-valeur-principale",children:[e.averageDays," jours"]})]}),n.jsxs("div",{className:"lycans-stat-carte",children:[n.jsx("h3",{children:"Durée Minimum"}),n.jsxs("p",{className:"lycans-valeur-principale",children:[e.minDays," jours"]})]}),n.jsxs("div",{className:"lycans-stat-carte",children:[n.jsx("h3",{children:"Durée Maximum"}),n.jsxs("p",{className:"lycans-valeur-principale",children:[e.maxDays," jours"]})]})]}),n.jsxs("div",{className:"lycans-graphiques-section",children:[n.jsxs("div",{className:"lycans-graphique-element",children:[n.jsx("h3",{children:"Distribution des Durées de Partie"}),n.jsx("div",{style:{height:300},children:n.jsx(B,{width:"100%",height:"100%",children:n.jsxs(ee,{data:e.dayDistribution,margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(M,{strokeDasharray:"3 3"}),n.jsx(W,{dataKey:"days",label:{value:"Nombre de Jours",position:"insideBottom",offset:-5}}),n.jsx(F,{label:{value:"Nombre de Parties",angle:-90,position:"insideLeft"}}),n.jsx(G,{content:({active:i,payload:o})=>{if(i&&o&&o.length>0){const l=o[0].payload;return n.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[n.jsx("div",{children:n.jsxs("strong",{children:[l.days," jours"]})}),n.jsxs("div",{children:[l.count," parties"]})]})}return null}}),n.jsx(te,{dataKey:"count",name:"Nombre de Parties",fill:"var(--chart-color-2)"})]})})})]}),n.jsxs("div",{className:"lycans-graphique-element",children:[n.jsx("h3",{children:"Durée Moyenne par Ratio Loups/Joueurs"}),n.jsx("div",{style:{height:300},children:n.jsx(B,{width:"100%",height:"100%",children:n.jsxs(wt,{data:r,margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(M,{strokeDasharray:"3 3"}),n.jsx(W,{dataKey:"ratio",label:{value:"Ratio Loups/Joueurs (%)",position:"insideBottom",offset:-5}}),n.jsx(F,{label:{value:"Durée Moyenne (jours)",angle:-90,position:"insideLeft"}}),n.jsx(G,{content:({active:i,payload:o})=>{if(i&&o&&o.length>0){const l=o[0].payload;return n.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[n.jsx("div",{children:n.jsxs("strong",{children:["Pourcentage de loups : ",l.ratio]})}),n.jsxs("div",{children:["Durée moyenne : ",l.moyenne," jours"]}),n.jsxs("div",{children:["Nombre de parties : ",l.parties]})]})}return null}}),n.jsx(ae,{}),n.jsx(X,{type:"monotone",dataKey:"moyenne",name:"Durée Moyenne",stroke:"var(--chart-color-5)",activeDot:{r:8}})]})})})]}),n.jsxs("div",{className:"lycans-graphique-element",children:[n.jsx("h3",{children:"Durée Moyenne par Camp Victorieux"}),n.jsx("div",{style:{height:300},children:n.jsx(B,{width:"100%",height:"100%",children:n.jsxs(ee,{data:s,margin:{top:20,right:30,left:20,bottom:60},children:[n.jsx(M,{strokeDasharray:"3 3"}),n.jsx(W,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),n.jsx(F,{label:{value:"Durée Moyenne (jours)",angle:-90,position:"insideLeft"}}),n.jsx(G,{content:({active:i,payload:o})=>{if(i&&o&&o.length>0){const l=o[0].payload;return n.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[n.jsx("div",{children:n.jsx("strong",{children:l.camp})}),n.jsxs("div",{children:["Durée moyenne : ",l.moyenne," jours"]}),n.jsxs("div",{children:["Nombre de parties : ",l.parties]})]})}return null}}),n.jsx(ae,{formatter:i=>i==="moyenne"?"Durée Moyenne":i}),n.jsx(te,{dataKey:"moyenne",name:"moyenne",fill:"var(--chart-color-4)",children:n.jsx(me,{dataKey:"moyenne",position:"top",formatter:i=>{const o=typeof i=="number"?i:Number(i);return isNaN(o)?"":`${o.toFixed(1)}j`},fill:"var(--text-primary)",fontSize:12})})]})})})]})]})]})}export{Kt as GameDurationInsights};
