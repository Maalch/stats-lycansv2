import{r as l,j as s}from"./index-55qKkggj.js";import{F as U,ay as se,x as I,z as oe,U as Le,az as Ce,ar as k,L as Y,c as J,n as le,aj as ce,ak as ue,ai as ke,am as Ke,aA as Re,aB as Z,an as Te,ao as _e,E as Be,v as de,D as Me,ap as Fe,aC as We,aD as $e,aq as qe,G as Ve,aE as pe,as as ze,aF as Ge,at as Ue,k as me,au as ee,N as Ye,O as Je,Q as S,a2 as Xe,av as he,a4 as He,ax as Qe,ad as Ze,R as M,B as te,C as F,X as W,Y as $,T as q,a as ae}from"./BarChart-C6C8AQSr.js";import{L as V}from"./Legend-mar0S_6n.js";function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},z.apply(null,arguments)}var fe=e=>{var{cx:t,cy:a,r,className:i}=e,n=U("recharts-dot",i);return t===+t&&a===+a&&r===+r?l.createElement("circle",z({},I(e,!1),se(e),{className:n,cx:t,cy:a,r})):null};function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?re(Object(a),!0).forEach(function(r){et(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function et(e,t,a){return(t=tt(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tt(e){var t=at(e,"string");return typeof t=="symbol"?t:t+""}function at(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rt=e=>{var{point:t,childIndex:a,mainColor:r,activeDot:i,dataKey:n}=e;if(i===!1||t.x==null||t.y==null)return null;var o=ne(ne({index:a,dataKey:n,cx:t.x,cy:t.y,r:4,fill:r??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},I(i,!1)),se(i)),c;return l.isValidElement(i)?c=l.cloneElement(i,o):typeof i=="function"?c=i(o):c=l.createElement(fe,o),l.createElement(Y,{className:"recharts-active-dot"},c)};function nt(e){var{points:t,mainColor:a,activeDot:r,itemDataKey:i}=e,n=oe(Le),o=Ce();if(t==null||o==null)return null;var c=t.find(u=>o.includes(u.payload));return k(c)?null:rt({point:c,childIndex:Number(n),mainColor:a,dataKey:i,activeDot:r})}var ye=(e,t,a,r)=>ce(e,"xAxis",t,r),ve=(e,t,a,r)=>ue(e,"xAxis",t,r),xe=(e,t,a,r)=>ce(e,"yAxis",a,r),ge=(e,t,a,r)=>ue(e,"yAxis",a,r),it=J([le,ye,xe,ve,ge],(e,t,a,r,i)=>Re(e,"xAxis")?Z(t,r,!1):Z(a,i,!1)),st=(e,t,a,r,i)=>i,ot=J([Ke,st],(e,t)=>{if(e.some(a=>a.type==="line"&&t.dataKey===a.dataKey&&t.data===a.data))return t}),lt=J([le,ye,xe,ve,ge,ot,it,ke],(e,t,a,r,i,n,o,c)=>{var{chartData:u,dataStartIndex:d,dataEndIndex:h}=c;if(!(n==null||t==null||a==null||r==null||i==null||r.length===0||i.length===0||o==null)){var{dataKey:p,data:m}=n,f;if(m!=null&&m.length>0?f=m:f=u?.slice(d,h+1),f!=null)return Ot({layout:e,xAxis:t,yAxis:a,xAxisTicks:r,yAxisTicks:i,dataKey:p,bandSize:o,displayedData:f})}}),ct=["type","layout","connectNulls","needClip"],ut=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function je(e,t){if(e==null)return{};var a,r,i=dt(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function dt(e,t){if(e==null)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;a[r]=e[r]}return a}function ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ie(Object(a),!0).forEach(function(r){R(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ie(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function R(e,t,a){return(t=pt(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function pt(e){var t=mt(e,"string");return typeof t=="symbol"?t:t+""}function mt(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},O.apply(null,arguments)}var ht=e=>{var{dataKey:t,name:a,stroke:r,legendType:i,hide:n}=e;return[{inactive:n,dataKey:t,type:i,color:r,value:de(a,t),payload:e}]};function ft(e){var{dataKey:t,data:a,stroke:r,strokeWidth:i,fill:n,name:o,hide:c,unit:u}=e;return{dataDefinedOnItem:a,positions:void 0,settings:{stroke:r,strokeWidth:i,fill:n,dataKey:t,nameKey:void 0,name:de(o,t),hide:c,type:e.tooltipType,color:e.stroke,unit:u}}}var be=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function yt(e,t){for(var a=e.length%2!==0?[...e,0]:e,r=[],i=0;i<t;++i)r=[...r,...a];return r}var vt=(e,t,a)=>{var r=a.reduce((p,m)=>p+m);if(!r)return be(t,e);for(var i=Math.floor(e/r),n=e%r,o=t-e,c=[],u=0,d=0;u<a.length;d+=a[u],++u)if(d+a[u]>n){c=[...a.slice(0,u),n-d];break}var h=c.length%2===0?[0,o]:[o];return[...yt(a,i),...c,...h].map(p=>"".concat(p,"px")).join(", ")};function xt(e,t){var a;if(l.isValidElement(e))a=l.cloneElement(e,t);else if(typeof e=="function")a=e(t);else{var r=U("recharts-line-dot",typeof e!="boolean"?e.className:"");a=l.createElement(fe,O({},t,{className:r}))}return a}function gt(e,t){return e==null?!1:t?!0:e.length===1}function jt(e){var{clipPathId:t,points:a,props:r}=e,{dot:i,dataKey:n,needClip:o}=r;if(!gt(a,i))return null;var c=pe(i),u=I(r,!1),d=I(i,!0),h=a.map((m,f)=>{var x=v(v(v({key:"dot-".concat(f),r:3},u),d),{},{index:f,cx:m.x,cy:m.y,dataKey:n,value:m.value,payload:m.payload,points:a});return xt(i,x)}),p={clipPath:o?"url(#clipPath-".concat(c?"":"dots-").concat(t,")"):null};return l.createElement(Y,O({className:"recharts-line-dots",key:"dots"},p),h)}function G(e){var{clipPathId:t,pathRef:a,points:r,strokeDasharray:i,props:n,showLabels:o}=e,{type:c,layout:u,connectNulls:d,needClip:h}=n,p=je(n,ct),m=v(v({},I(p,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(t,")"):null,points:r,type:c,layout:u,connectNulls:d,strokeDasharray:i??n.strokeDasharray});return l.createElement(l.Fragment,null,r?.length>1&&l.createElement(Xe,O({},m,{pathRef:a})),l.createElement(jt,{points:r,clipPathId:t,props:n}),o&&he.renderCallByParent(n,r))}function bt(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Pt(e){var{clipPathId:t,props:a,pathRef:r,previousPointsRef:i,longestAnimatedLengthRef:n}=e,{points:o,strokeDasharray:c,isAnimationActive:u,animationBegin:d,animationDuration:h,animationEasing:p,animateNewValues:m,width:f,height:x,onAnimationEnd:P,onAnimationStart:g}=a,b=i.current,N=Ye(a,"recharts-line-"),[E,j]=l.useState(!1),w=l.useCallback(()=>{typeof P=="function"&&P(),j(!1)},[P]),T=l.useCallback(()=>{typeof g=="function"&&g(),j(!0)},[g]),D=bt(r.current),L=n.current;return l.createElement(Je,{begin:d,duration:h,isActive:u,easing:p,from:{t:0},to:{t:1},onAnimationEnd:w,onAnimationStart:T,key:N},_=>{var{t:A}=_,De=S(L,D+L),B=Math.min(De(A),D),C;if(c){var Ae="".concat(c).split(/[,\s]+/gim).map(y=>parseFloat(y));C=vt(B,D,Ae)}else C=be(D,B);if(b){var Ee=b.length/o.length,X=A===1?o:o.map((y,Ie)=>{var H=Math.floor(Ie*Ee);if(b[H]){var Q=b[H],Oe=S(Q.x,y.x),Ne=S(Q.y,y.y);return v(v({},y),{},{x:Oe(A),y:Ne(A)})}if(m){var we=S(f*2,y.x),Se=S(x/2,y.y);return v(v({},y),{},{x:we(A),y:Se(A)})}return v(v({},y),{},{x:y.x,y:y.y})});return i.current=X,l.createElement(G,{props:a,points:X,clipPathId:t,pathRef:r,showLabels:!E,strokeDasharray:C})}return A>0&&D>0&&(i.current=o,n.current=B),l.createElement(G,{props:a,points:o,clipPathId:t,pathRef:r,showLabels:!E,strokeDasharray:C})})}function Dt(e){var{clipPathId:t,props:a}=e,{points:r,isAnimationActive:i}=a,n=l.useRef(null),o=l.useRef(0),c=l.useRef(null),u=n.current;return i&&r&&r.length&&u!==r?l.createElement(Pt,{props:a,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:o,pathRef:c}):l.createElement(G,{props:a,points:r,clipPathId:t,pathRef:c,showLabels:!0})}var At=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:me(e.payload,t)});class Et extends l.Component{constructor(){super(...arguments),R(this,"id",He("recharts-line-"))}render(){var t,{hide:a,dot:r,points:i,className:n,xAxisId:o,yAxisId:c,top:u,left:d,width:h,height:p,id:m,needClip:f,layout:x}=this.props;if(a)return null;var P=U("recharts-line",n),g=k(m)?this.id:m,{r:b=3,strokeWidth:N=2}=(t=I(r,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},E=pe(r),j=b*2+N;return l.createElement(l.Fragment,null,l.createElement(Y,{className:P},f&&l.createElement("defs",null,l.createElement(ze,{clipPathId:g,xAxisId:o,yAxisId:c}),!E&&l.createElement("clipPath",{id:"clipPath-dots-".concat(g)},l.createElement("rect",{x:d-j/2,y:u-j/2,width:h+j,height:p+j}))),l.createElement(Dt,{props:this.props,clipPathId:g}),l.createElement(Ge,{direction:x==="horizontal"?"y":"x"},l.createElement(Ue,{xAxisId:o,yAxisId:c,data:i,dataPointFormatter:At,errorBarOffset:0},this.props.children))),l.createElement(nt,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var Pe={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Ve.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function It(e){var t=Me(e,Pe),{activeDot:a,animateNewValues:r,animationBegin:i,animationDuration:n,animationEasing:o,connectNulls:c,dot:u,hide:d,isAnimationActive:h,label:p,legendType:m,xAxisId:f,yAxisId:x}=t,P=je(t,ut),{needClip:g}=Fe(f,x),{height:b,width:N,x:E,y:j}=We(),w=$e(),T=qe(),D=l.useMemo(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),L=oe(_=>lt(_,f,x,T,D));return w!=="horizontal"&&w!=="vertical"?null:l.createElement(Et,O({},P,{connectNulls:c,dot:u,activeDot:a,animateNewValues:r,animationBegin:i,animationDuration:n,animationEasing:o,isAnimationActive:h,hide:d,label:p,legendType:m,xAxisId:f,yAxisId:x,points:L,layout:w,height:b,width:N,left:E,top:j,needClip:g}))}function Ot(e){var{layout:t,xAxis:a,yAxis:r,xAxisTicks:i,yAxisTicks:n,dataKey:o,bandSize:c,displayedData:u}=e;return u.map((d,h)=>{var p=me(d,o);return t==="horizontal"?{x:ee({axis:a,ticks:i,bandSize:c,entry:d,index:h}),y:k(p)?null:r.scale(p),value:p,payload:d}:{x:k(p)?null:a.scale(p),y:ee({axis:r,ticks:n,bandSize:c,entry:d,index:h}),value:p,payload:d}})}class K extends l.PureComponent{render(){return l.createElement(Te,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},l.createElement(_e,{legendPayload:ht(this.props)}),l.createElement(Be,{fn:ft,args:this.props}),l.createElement(It,this.props))}}R(K,"displayName","Line");R(K,"defaultProps",Pe);var Nt=["axis"],wt=l.forwardRef((e,t)=>l.createElement(Qe,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Nt,tooltipPayloadSearcher:Ze,categoricalChartProps:e,ref:t}));function St(){const[e,t]=l.useState(null),[a,r]=l.useState(!0),[i,n]=l.useState(null);return l.useEffect(()=>{(async()=>{try{r(!0),n(null);const u=await fetch("https://script.google.com/macros/s/AKfycbw7amBQVger2k8MpFhueGGtAMUsYioIvdU2yVcixtFuk66a2DRWEpZ_c3xf2nncKjuHPg/exec?action=gameDurationAnalysis");if(!u.ok)throw new Error(`Échec de la requête: ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(d.error);t(d)}catch(c){console.error("Impossible de charger les données de durée de partie:",c),n(c instanceof Error?c.message:"Erreur inconnue")}finally{r(!1)}})()},[]),{durationAnalysis:e,fetchingData:a,apiError:i}}function Kt(){const{durationAnalysis:e,fetchingData:t,apiError:a}=St();if(t)return s.jsx("div",{className:"statistiques-attente",children:"Analyse des durées de partie en cours..."});if(a)return s.jsxs("div",{className:"statistiques-echec",children:["Problème rencontré: ",a]});if(!e)return s.jsx("div",{className:"statistiques-indisponibles",children:"Données d'analyse non disponibles"});const r=Object.entries(e.daysByWolfRatio).map(([n,o])=>({ratio:n,moyenne:parseFloat(o.average),parties:o.count})).sort((n,o)=>parseFloat(n.ratio)-parseFloat(o.ratio)),i=Object.entries(e.daysByWinnerCamp).map(([n,o])=>({camp:n,moyenne:parseFloat(o.average),parties:o.count})).sort((n,o)=>o.moyenne-n.moyenne);return s.jsxs("div",{className:"lycans-duree-analyse",children:[s.jsx("h2",{children:"Analyse des Durées de Partie"}),s.jsxs("div",{className:"lycans-resume-conteneur",children:[s.jsxs("div",{className:"lycans-stat-carte",children:[s.jsx("h3",{children:"Durée Moyenne"}),s.jsxs("p",{className:"lycans-valeur-principale",children:[e.averageDays," jours"]})]}),s.jsxs("div",{className:"lycans-stat-carte",children:[s.jsx("h3",{children:"Durée Minimum"}),s.jsxs("p",{className:"lycans-valeur-principale",children:[e.minDays," jours"]})]}),s.jsxs("div",{className:"lycans-stat-carte",children:[s.jsx("h3",{children:"Durée Maximum"}),s.jsxs("p",{className:"lycans-valeur-principale",children:[e.maxDays," jours"]})]})]}),s.jsxs("div",{className:"lycans-graphiques-section",children:[s.jsxs("div",{className:"lycans-graphique-element",children:[s.jsx("h3",{children:"Distribution des Durées de Partie"}),s.jsx("div",{style:{height:300},children:s.jsx(M,{width:"100%",height:"100%",children:s.jsxs(te,{data:e.dayDistribution,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(F,{strokeDasharray:"3 3"}),s.jsx(W,{dataKey:"days",label:{value:"Nombre de Jours",position:"insideBottom",offset:-5}}),s.jsx($,{label:{value:"Nombre de Parties",angle:-90,position:"insideLeft"}}),s.jsx(q,{formatter:n=>[`${n} parties`,"Fréquence"],labelFormatter:n=>`${n} jours`}),s.jsx(V,{}),s.jsx(ae,{dataKey:"count",name:"Nombre de Parties",fill:"#8884d8"})]})})})]}),s.jsxs("div",{className:"lycans-graphique-element",children:[s.jsx("h3",{children:"Durée Moyenne par Ratio Loups/Joueurs"}),s.jsx("div",{style:{height:300},children:s.jsx(M,{width:"100%",height:"100%",children:s.jsxs(wt,{data:r,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(F,{strokeDasharray:"3 3"}),s.jsx(W,{dataKey:"ratio",label:{value:"Ratio Loups/Joueurs",position:"insideBottom",offset:-5}}),s.jsx($,{label:{value:"Durée Moyenne (jours)",angle:-90,position:"insideLeft"}}),s.jsx(q,{formatter:(n,o)=>o==="moyenne"?[`${n} jours`,"Durée Moyenne"]:o==="parties"?[`${n} parties`,"Nombre de Parties"]:[n,o],labelFormatter:n=>`Ratio: ${n}`}),s.jsx(V,{}),s.jsx(K,{type:"monotone",dataKey:"moyenne",name:"Durée Moyenne",stroke:"#8884d8",activeDot:{r:8}}),s.jsx(K,{type:"monotone",dataKey:"parties",name:"Nombre de Parties",stroke:"#82ca9d"})]})})})]}),s.jsxs("div",{className:"lycans-graphique-element",children:[s.jsx("h3",{children:"Durée Moyenne par Camp Victorieux"}),s.jsx("div",{style:{height:300},children:s.jsx(M,{width:"100%",height:"100%",children:s.jsxs(te,{data:i,margin:{top:20,right:30,left:20,bottom:60},children:[s.jsx(F,{strokeDasharray:"3 3"}),s.jsx(W,{dataKey:"camp",angle:-45,textAnchor:"end",height:80,interval:0}),s.jsx($,{label:{value:"Durée Moyenne (jours)",angle:-90,position:"insideLeft"}}),s.jsx(q,{formatter:(n,o,{payload:c})=>o==="moyenne"?[s.jsxs(s.Fragment,{children:[s.jsx("div",{children:s.jsxs("strong",{children:[n," jours"]})}),s.jsxs("div",{children:["(",c.parties," parties)"]})]}),"Durée Moyenne"]:[n,o]}),s.jsx(V,{formatter:n=>n==="moyenne"?"Durée Moyenne":n}),s.jsx(ae,{dataKey:"moyenne",name:"moyenne",fill:"var(--chart-color-5)",children:s.jsx(he,{dataKey:"moyenne",position:"top",formatter:n=>{const o=typeof n=="number"?n:Number(n);return isNaN(o)?"":`${o.toFixed(1)}j`},fill:"var(--text-primary)",fontSize:12})})]})})})]})]})]})}export{Kt as GameDurationInsights};
