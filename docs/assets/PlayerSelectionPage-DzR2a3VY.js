import{a as V,r as N,u as W,j as e,g as J,b as Y,m as Q,d as Z,n as ee}from"./index-DoX1ga1E.js";import{u as B}from"./useJoueursData-DywDt9wf.js";import{u as O,g as se,a as ae,l as U}from"./api-CPeFxT3b.js";import{g as te,a as re,u as ie}from"./datasyncExport-CQYuBoIM.js";import{g as le}from"./gameUtils-ClFW7kjB.js";import{F as q,C as L,X as z,Y as M,B as I,a as E,b as D}from"./FullscreenChart-BRqIMGD_.js";import{R as A,T as G}from"./CategoricalChart-CsDvM-fJ.js";import{L as ne,a as oe}from"./LineChart-Dys8Mh6M.js";import{P as ce,a as de}from"./PieChart-DXMDAD_j.js";import{R as _}from"./ReferenceLine-CkzRupDv.js";import"./ActivePoints-CZq6r4R5.js";import"./PolarChart-BNmsnlrh.js";function me(d){const{settings:f}=V(),[g,x]=N.useState(null),[y,m]=N.useState(!1),[u,p]=N.useState(null);N.useEffect(()=>{let t=!0;return(async()=>{try{m(!0),p(null);const l=f.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",c=await fetch(l);if(!c.ok)throw new Error(`Failed to load achievements: ${c.status} ${c.statusText}`);const v=await c.json();t&&x(v)}catch(l){t&&p(l instanceof Error?l.message:"Failed to load achievements")}finally{t&&m(!1)}})(),()=>{t=!1}},[f.dataSource]);const i=d&&g?.achievements[d]||null;return N.useEffect(()=>{if(d&&g){const t=g.achievements[d];t?console.log(`ðŸ† Achievements for ${d} (${f.dataSource}):`,{allGames:t.allGamesAchievements.length,moddedOnly:t.moddedOnlyAchievements.length,categories:[...new Set([...t.allGamesAchievements.map(a=>a.category),...t.moddedOnlyAchievements.map(a=>a.category)])]}):console.log(`âŒ No achievements found for ${d} in ${f.dataSource} data source`)}},[d,g,f.dataSource]),{data:i,isLoading:y,error:u,metadata:{generatedAt:g?.generatedAt||null,totalPlayers:g?.totalPlayers||0,totalGames:g?.totalGames||0,totalModdedGames:g?.totalModdedGames||0}}}function ue({achievements:d,title:f,emptyMessage:g,achievementType:x="all"}){const{navigateToTab:y,updateNavigationState:m,clearNavigation:u}=W(),{settings:p,updateSettings:i}=V(),{joueursData:t}=B(),a=O(t),l=(s,n)=>{if(n.stopPropagation(),!s.redirectTo)return;u();const j=p.highlightedPlayer;if(i(x==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:j,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:j,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),s.category==="comparison"&&s.redirectTo.subTab==="comparison"){const r=p.highlightedPlayer||"",o=c(s.description,r);o&&m({playerComparisonState:{selectedPlayer1:r,selectedPlayer2:o,showDetailedStats:!0}})}if(s.category==="comparison"&&s.redirectTo.subTab==="pairing"){const r=s.description.toLowerCase().includes("loup");m({selectedPairingTab:r?"wolves":"lovers"})}if(s.category==="kills"&&s.redirectTo.subTab==="deathStats"){const r=s.description.match(/(Villageois|Loups|Autres)/i);r&&m({deathStatsSelectedCamp:r[1]});let o=10;const h=s.description.match(/min\.\s*(\d+)/);h&&(o=parseInt(h[1],10));let b="totalKills";const C=s.redirectTo.chartSection;C&&(C==="killers-total"?b="totalKills":C==="killers-average"?b="averageKills":C==="deaths-total"?b="totalDeaths":C==="survivors-average"&&(b="survivalRate")),m({deathStatisticsState:{selectedCamp:r?.[1]||"Tous les camps",minGamesForAverage:o,focusChart:b}})}if(s.category==="map"&&s.redirectTo.subTab==="playersGeneral"){const r=s.redirectTo.mapFilter||"all";let o=10;const h=s.description.match(/min\.\s*(\d+)/);h&&(o=parseInt(h[1])),i(x==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:r,playerFilter:{mode:"none",players:[]},highlightedPlayer:j,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:r,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:r,playerFilter:{mode:"none",players:[]},highlightedPlayer:j,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:r,playerFilter:{mode:"none",players:[]}}}),m({playersGeneralState:{minGamesForWinRate:o,winRateOrder:"best",focusChart:"winRate"}}),y("players","playersGeneral");return}if(s.category==="history"&&s.redirectTo.subTab==="history"&&m({selectedPlayerName:p.highlightedPlayer||"",groupingMethod:"session"}),s.category==="series"&&s.redirectTo.subTab==="series"){let r="wins";const o=s.title.toLowerCase(),h=s.description.toLowerCase();o.includes("dÃ©faite")||h.includes("dÃ©faite")?r="losses":o.includes("loup")||h.includes("loup")?r="loup":o.includes("villageois")||h.includes("villageois")?r="villageois":(o.includes("victoire")||h.includes("victoire"))&&(r="wins"),m({selectedSeriesType:r})}if(s.category==="general"&&s.redirectTo.subTab==="playersGeneral"){let r=10;const o=s.description.match(/min\.\s*(\d+)/);o&&(r=parseInt(o[1],10));let h="winRate",b="best";const C=s.title.toLowerCase(),k=s.description.toLowerCase();C.includes("participation")||k.includes("participation")?h="participation":(C.includes("taux de victoire")||k.includes("taux de victoire"))&&(h="winRate",(C.includes("moins bon")||C.includes("mauvais")||k.includes("moins bon")||k.includes("mauvais"))&&(b="worst")),m({playersGeneralState:{minGamesForWinRate:r,winRateOrder:b,focusChart:h}})}if(s.category==="performance"&&s.redirectTo.subTab==="campPerformance"){const r=s.redirectTo.chartSection;let o="Villageois",h=1;r&&(r==="camp-loup"?o="Loup":r==="camp-villageois"?o="Villageois":r==="camp-idiot"?o="Idiot du Village":r==="camp-amoureux"?o="Amoureux":(r==="solo-roles"||r==="hall-of-fame")&&(o="Villageois"));const b=s.description.match(/min\.\s*(\d+)/);b&&(h=parseInt(b[1],10)),r==="solo-roles"?o="RÃ´les spÃ©ciaux":r==="hall-of-fame"&&(o="Tous les camps"),m({campPerformanceState:{selectedCampPerformanceCamp:o,selectedCampPerformanceMinGames:h}})}if(s.category==="voting"&&s.redirectTo.subTab==="votingStats"){const r=s.title.toLowerCase();let o="overview",h="behavior";r.includes("agressivitÃ©")?(o="overview",h="behavior"):r.includes("taux de vote")?(o="behavior",h="voteRate"):r.includes("prÃ©cision")&&(o="overview",h="accuracy"),m({votingStatsState:{selectedCategory:o,selectedView:h}})}y(s.redirectTo.tab,s.redirectTo.subTab)},c=(s,n)=>{const j=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const r of j){const o=s.match(r);if(o&&o[1]){const h=o[1].trim();if(h!==n)return h}}return null},v=s=>{if(!s.redirectTo)return"Aucune navigation disponible";switch(s.category){case"general":if(s.redirectTo.subTab==="playersGeneral"){const r=s.description.match(/min\.\s*(\d+)/),o=r?parseInt(r[1],10):10,h=s.title.toLowerCase(),b=x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return h.includes("taux de victoire")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${o} parties)${b}`:h.includes("participation")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les participations${b}`:`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${b}`}break;case"map":if(s.redirectTo.subTab==="playersGeneral"){const r=s.redirectTo.mapFilter,o=r==="village"?"Village":r==="chateau"?"ChÃ¢teau":"map",h=x==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${o}${h}`}break;case"history":if(s.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(s.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${c(s.description,p.highlightedPlayer||"")||"ce joueur"}`;if(s.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(s.redirectTo.subTab==="deathStats"){const r=s.description.match(/(Villageois|Loups|Autres)/i),o=s.description.match(/min\.\s*(\d+)/),h=o?parseInt(o[1],10):10,b=r?.[1]||"Tous les camps",C=s.redirectTo.chartSection;let k="kills et morts";return C==="killers-total"?k="total des kills":C==="killers-average"?k=`moyenne des kills (min. ${h} parties)`:C==="deaths-total"?k="total des morts":C==="survivors-average"&&(k=`taux de survie (min. ${h} parties)`),`Cliquez pour voir les statistiques de ${k} ${b!=="Tous les camps"?`en ${b}`:""}`}break;case"series":if(s.redirectTo.subTab==="series"){const r=s.title.toLowerCase(),o=s.description.toLowerCase();return r.includes("dÃ©faite")||o.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":r.includes("loup")||o.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":r.includes("villageois")||o.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":r.includes("victoire")||o.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(s.redirectTo.subTab==="campPerformance"){const r=s.redirectTo.chartSection,o=x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return r==="camp-loup"?`Cliquez pour voir les performances camp Loup${o}`:r==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${o}`:r==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${o}`:r==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${o}`:r==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${o}`:r==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${o}`:`Cliquez pour voir les performances par camp${o}`}break;case"voting":if(s.redirectTo.subTab==="votingStats"){const r=s.description.match(/min\.\s*(\d+)/),o=r?parseInt(r[1],10):25,h=x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",b=s.title.toLowerCase();return b.includes("agressivitÃ©")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${o} meetings)${h}`:b.includes("taux de vote")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${o} meetings)${h}`:b.includes("prÃ©cision")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${h}`:`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${h}`}break}return`Cliquez pour voir ${s.redirectTo.subTab}`+(x==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},w=s=>a[s]||se(s),R=s=>{const n=[/avec ([^:]+?):/,/contre ([^:]+?):/];let j=s;return n.forEach(r=>{const o=s.match(r);if(o&&o[1]){const h=o[1].trim(),C=`<span class="player-name-highlight" style="color: ${w(h)};">${h}</span>`;j=j.replace(h,C)}}),j};if(d.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:f}),e.jsx("p",{children:g||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const S=s=>s===1?"ðŸ¥‡":s===2?"ðŸ¥ˆ":s===3?"ðŸ¥‰":"",P=s=>s===1?"rank-1":s===2?"rank-2":s===3?"rank-3":s&&s<=10?"rank-top-10":"",F=d.filter(s=>s.category!=="comparison"&&(s.type==="good"||s.type==="neutral")).sort((s,n)=>(s.rank??999)-(n.rank??999)),T=d.filter(s=>s.category!=="comparison"&&s.type==="bad").sort((s,n)=>(s.rank??999)-(n.rank??999)),$=d.filter(s=>s.category==="comparison"),K=F.filter(s=>s.rank&&s.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:f}),K>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:F.filter(s=>s.rank&&s.rank<=3).map((s,n)=>e.jsxs("div",{className:`top3-card ${P(s.rank)} animate-slide-in`,style:{animationDelay:`${n*.15}s`},onClick:j=>l(s,j),title:v(s),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:S(s.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:s.title}),e.jsx("p",{className:"top3-achievement-description",children:s.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},s.id))})]}),F.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:F.filter(s=>!s.rank||s.rank>3).map((s,n)=>e.jsxs("div",{className:`achievement-card good ${P(s.rank)}`,onClick:j=>l(s,j),title:v(s),style:{animationDelay:`${n*.05}s`},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:s.title}),e.jsxs("span",{className:"achievement-rank",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:s.description})]},s.id))})]}),T.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:T.map(s=>e.jsxs("div",{className:`achievement-card bad rank-${s.rank}`,onClick:n=>l(s,n),title:v(s),children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:s.title}),e.jsxs("span",{className:"achievement-rank",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:s.description})]},s.id))})]}),$.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:$.map(s=>e.jsxs("div",{className:"achievement-card comparison",onClick:n=>l(s,n),title:v(s),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:s.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:R(s.description)}})]},s.id))})]})]})}function pe(d,f){if(!d||d.trim()===""||f.length===0)return null;const g=[];let x=d;f.forEach(t=>{const a=t.PlayerStats.find(l=>J(l)===d||l.Username.toLowerCase()===d.toLowerCase());if(a){x=Y(a);const l=te(re(a.MainRoleInitial,a.MainRoleChanges||[])),c=le(t),v=a.Victorious,w=Q(new Date(t.StartDate));g.push({gameId:t.Id,date:w,camp:l,won:v,winnerCamp:c,playersInGame:t.PlayerStats.length,mapName:t.MapName})}}),g.sort((t,a)=>{const l=c=>{const v=c.split("/");return v.length===3?new Date(parseInt(v[2]),parseInt(v[1])-1,parseInt(v[0])):new Date(c)};return l(a.date).getTime()-l(t.date).getTime()});const y=g.length,m=g.filter(t=>t.won).length,u=y>0?(m/y*100).toFixed(2):"0.00",p={};g.forEach(t=>{p[t.camp]||(p[t.camp]={appearances:0,wins:0,winRate:"0.00"}),p[t.camp].appearances++,t.won&&p[t.camp].wins++}),Object.keys(p).forEach(t=>{const a=p[t];a.winRate=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00"});const i={};return g.forEach(t=>{i[t.mapName]||(i[t.mapName]={appearances:0,wins:0,winRate:"0.00"}),i[t.mapName].appearances++,t.won&&i[t.mapName].wins++}),Object.keys(i).forEach(t=>{const a=i[t];a.winRate=a.appearances>0?(a.wins/a.appearances*100).toFixed(2):"0.00"}),{playerName:x,totalGames:y,totalWins:m,winRate:u,games:g,campStats:p,mapStats:i}}function he(d){const f={};let g=0,x=0;return Object.entries(d).forEach(([y,m])=>{y==="Village"||y==="ChÃ¢teau"?f[y]={...m}:(g+=m.appearances,x+=m.wins)}),g>=10&&(f.Autres={appearances:g,wins:x,winRate:g>0?(x/g*100).toFixed(2):"0.00"}),f}function H(d){const{data:f,isLoading:g,error:x}=ie(y=>d?pe(d,y):null);return{data:f,isLoading:g,error:x}}function ge({selectedPlayerName:d,groupingMethod:f}){const{navigateToGameDetails:g}=W(),{data:x,isLoading:y,error:m}=H(d),u=N.useMemo(()=>{if(!x?.games)return new Map;const a=new Map;return x.games.forEach(l=>{if(!a.has(l.date)){const c=l.date.split("/");c.length===3?a.set(l.date,new Date(parseInt(c[2]),parseInt(c[1])-1,parseInt(c[0])).getTime()):a.set(l.date,new Date(l.date).getTime())}}),a},[x?.games]),p=N.useMemo(()=>{if(!x?.games)return[];const a={};return x.games.forEach(l=>{let c;if(f==="month"){const v=l.date.split("/");v.length===3?c=`${v[1]}/${v[2]}`:c=l.date}else c=l.date;a[c]||(a[c]={games:[],wins:0,total:0}),a[c].games.push(l),a[c].total++,l.won&&a[c].wins++}),Object.entries(a).map(([l,c])=>({period:l,totalGames:c.total,victories:c.wins,defeats:c.total-c.wins,winRate:c.total>0?(c.wins/c.total*100).toFixed(1):"0.0",winRateNum:c.total>0?c.wins/c.total*100:0})).sort((l,c)=>{if(f==="month"){const[v,w]=l.period.split("/"),[R,S]=c.period.split("/"),P=new Date(parseInt(w),parseInt(v)-1,1),F=new Date(parseInt(S),parseInt(R)-1,1);return P.getTime()-F.getTime()}else{const v=u.get(l.period)||0,w=u.get(c.period)||0;return v-w}})},[x,f,u]),t=(a=>a<=15?{fontSize:12,angle:-45,height:80,interval:0}:a<=30?{fontSize:12,angle:-45,height:85,interval:1}:a<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(a/12)})(p.length);return y?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):m?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",m]}):x?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",f==="month"?"par Mois":"par Session"]}),e.jsx(q,{title:`Ã‰volution des Performances ${f==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(ne,{data:p,margin:{top:20,right:30,left:20,bottom:20},onClick:a=>{if(a&&a.activeLabel){const l=p.find(c=>c.period===a.activeLabel);l&&g({selectedPlayer:d,selectedDate:l.period,fromComponent:`Ã‰volution des Performances ${f==="month"?"par Mois":"par Session"}`})}},style:{cursor:"pointer"},children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"period",angle:t.angle,textAnchor:"end",height:t.height,interval:t.interval,fontSize:t.fontSize}),e.jsx(M,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:a,payload:l})=>{if(a&&l&&l.length>0){const c=l[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:c.period})}),e.jsxs("div",{children:["Parties: ",c.totalGames]}),e.jsxs("div",{children:["Victoires: ",c.victories]}),e.jsxs("div",{children:["Taux: ",c.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(oe,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",f==="month"?"par Mois":"par Session"]}),e.jsx(q,{title:`RÃ©partition Victoires/DÃ©faites ${f==="month"?"par Mois":"par Session"}`,children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(I,{data:p,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"period",angle:t.angle,textAnchor:"end",height:t.height,interval:t.interval,fontSize:t.fontSize}),e.jsx(M,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:a,payload:l})=>{if(a&&l&&l.length>0){const c=l[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:c.period})}),e.jsxs("div",{children:["Total: ",c.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",c.victories]}),e.jsxs("div",{children:["DÃ©faites: ",c.defeats]}),e.jsxs("div",{children:["Taux: ",c.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(E,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:p.map((a,l)=>e.jsx(D,{fill:"var(--accent-tertiary)",onClick:()=>{g({selectedPlayer:d,selectedDate:a.period,fromComponent:`Historique Joueur - Victoires ${f==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-victories-${l}`))}),e.jsx(E,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:p.map((a,l)=>e.jsx(D,{fill:"var(--chart-color-4)",onClick:()=>{g({selectedPlayer:d,selectedDate:a.period,fromComponent:`Historique Joueur - DÃ©faites ${f==="month"?"par Mois":"par Session"}`})},style:{cursor:"pointer"}},`cell-defeats-${l}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function fe({selectedPlayerName:d}){const{navigateToGameDetails:f}=W(),{data:g,isLoading:x,error:y}=H(d),m=ae(),u=N.useMemo(()=>g?.campStats?Object.entries(g.campStats).map(([i,t])=>({name:i,value:t.appearances,winRate:t.winRate,winRateDisplay:Math.max(parseFloat(t.winRate),1),wins:t.wins,percentage:(t.appearances/g.totalGames*100).toFixed(1)})):[],[g]),p=N.useMemo(()=>{if(!u.length)return[];const i=5;let t=0;const a=[],l=[];if(u.forEach(c=>{parseFloat(c.percentage)<i?(t+=Number(c.value),a.push(c)):l.push(c)}),t>0){const c=u.reduce((v,w)=>v+Number(w.value),0);l.push({name:"Autres",value:t,winRate:"0.0",winRateDisplay:1,wins:a.reduce((v,w)=>v+w.wins,0),percentage:(t/c*100).toFixed(1),_details:a})}return l},[u]);return x?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):y?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",y]}):g?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(ce,{children:[e.jsx(de,{data:p,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:i=>{const t=i.percent!==void 0?i.percent:0;return i.name==="Autres"?`Autres : ${i.value} (${(t*100).toFixed(1)}%)`:`${i.name}: ${i.value} (${(t*100).toFixed(1)}%)`},children:p.map((i,t)=>e.jsx(D,{fill:i.name==="Autres"?U:m[i.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{if(i.name==="Autres"){const a=i._details?.map(l=>l.name)||[];f({selectedPlayer:d,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:a},fromComponent:"Distribution par Camps"})}else i.name==="TraÃ®tre"||i.name==="Louveteau"?f({selectedPlayer:d,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):i.name==="Loup"?f({selectedPlayer:d,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):f({selectedPlayer:d,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${t}`))}),e.jsx(G,{content:({active:i,payload:t})=>{if(i&&t&&t.length>0){const a=t[0].payload;if(a.name==="Autres"&&a._details){const l=[...a._details].sort((c,v)=>v.value-c.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",a.value," parties (",a.percentage,"%)"]})}),e.jsx("div",{children:l.map((c,v)=>e.jsxs("div",{children:[c.name,": ",c.value," parties (",c.percentage,"%)"]},v))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[a.name," (",a.percentage,"%)"]})}),e.jsxs("div",{children:["Apparitions: ",a.value]}),e.jsxs("div",{children:["Victoires: ",a.wins," (",a.winRate,"%)"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(q,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(I,{data:u,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(M,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:i,payload:t})=>{if(i&&t&&t.length>0){const a=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:a.name})}),e.jsxs("div",{children:["Victoires: ",a.wins," / ",a.value]}),e.jsxs("div",{children:["Taux: ",a.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(E,{dataKey:"winRateDisplay",children:u.map((i,t)=>e.jsx(D,{fill:parseFloat(i.winRate)===0?`${m[i.name]||`var(--chart-color-${t%6+1})`}50`:m[i.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{i.name==="TraÃ®tre"||i.name==="Louveteau"?f({selectedPlayer:d,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):i.name==="Loup"?f({selectedPlayer:d,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):f({selectedPlayer:d,campFilter:{selectedCamp:i.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${t}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function xe({selectedPlayerName:d}){const{navigateToGameDetails:f}=W(),{data:g,isLoading:x,error:y}=H(d),m=N.useMemo(()=>{if(!g?.mapStats)return[];const u=he(g.mapStats);return Object.entries(u).map(([p,i])=>({name:p,value:i.appearances,winRate:i.winRate,winRateDisplay:Math.max(parseFloat(i.winRate),.1),wins:i.wins,percentage:(i.appearances/g.totalGames*100).toFixed(1)}))},[g]);return x?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):y?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",y]}):g?m.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Carte"}),e.jsx(q,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(I,{data:m,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(M,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(_,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(m.length>0){const u=m.reduce((t,a)=>t+a.value,0),p=m.reduce((t,a)=>t+a.wins,0),i=u>0?p/u*100:0;if(i!==50)return e.jsx(_,{y:i,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${i.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(G,{content:({active:u,payload:p})=>{if(u&&p&&p.length>0){const i=p[0].payload,t=[];return m.forEach(a=>{if(a.name!==i.name&&a.value>=5){const l=parseFloat(i.winRate)-parseFloat(a.winRate);Math.abs(l)>=2&&t.push({map:a.name,diff:l,better:l>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Parties: ",i.value]}),e.jsxs("div",{children:["Victoires: ",i.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",i.winRate,"%"]})}),t.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),t.map((a,l)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:a.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[a.better?"â†—":"â†˜"," ",Math.abs(a.diff).toFixed(1),"% vs ",a.map]},l))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(E,{dataKey:"winRateDisplay",label:u=>{const{x:p,y:i,width:t,payload:a}=u;if(p===void 0||i===void 0||t===void 0||!a)return null;const l=a.winRate||"0";return e.jsxs("text",{x:p+t/2,y:i-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[l,"%"]})},onClick:u=>{u&&u.name&&f({selectedPlayer:d,selectedMapName:u.name,fromComponent:"Performance par Carte"})},children:m.map((u,p)=>{let i;u.name==="Village"?i="var(--accent-secondary)":u.name==="ChÃ¢teau"?i="var(--accent-tertiary)":u.name==="Autres"?i=U:i=`var(--chart-color-${p%6+1})`;const t=Math.max(...m.map(l=>parseFloat(l.winRate))),a=parseFloat(u.winRate)===t&&t>0;return e.jsx(D,{fill:parseFloat(u.winRate)===0?`${i}30`:i,stroke:"transparent",strokeWidth:a?3:1,style:{cursor:"pointer"}},`cell-map-${p}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ve({selectedPlayerName:d}){const{gameData:f}=Z(),{joueursData:g}=B(),x=O(g),y=N.useMemo(()=>{if(!f||!d)return{playersKilled:[],killedBy:[]};const m={},u={};f.forEach(t=>{const a=t.PlayerStats.find(l=>l.Username.toLowerCase()===d.toLowerCase());a&&(t.PlayerStats.forEach(l=>{l.KillerName?.toLowerCase()===d.toLowerCase()&&(m[l.Username]=(m[l.Username]||0)+1)}),a.KillerName&&(u[a.KillerName]=(u[a.KillerName]||0)+1))});const p=Object.entries(m).map(([t,a])=>({player:t,kills:a})).sort((t,a)=>a.kills-t.kills).slice(0,10),i=Object.entries(u).map(([t,a])=>({player:t,kills:a})).sort((t,a)=>a.kills-t.kills).slice(0,10);return{playersKilled:p,killedBy:i}},[f,d]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[y.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Joueurs les plus souvent tuÃ©s"}),e.jsx(q,{title:"Joueurs les plus souvent tuÃ©s",children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(I,{data:y.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(M,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:m,payload:u})=>{if(m&&u&&u.length>0){const p=u[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:p.player})}),e.jsxs("div",{children:["TuÃ© ",p.kills," fois par ",d]})]})}return null}}),e.jsx(E,{dataKey:"kills",children:y.playersKilled.map((m,u)=>e.jsx(D,{fill:x[m.player]||"var(--chart-color-3)"},`cell-killed-${u}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[d," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),y.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Le plus souvent tuÃ© par"}),e.jsx(q,{title:"Le plus souvent tuÃ© par",children:e.jsx("div",{style:{height:400},children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(I,{data:y.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(z,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(M,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:m,payload:u})=>{if(m&&u&&u.length>0){const p=u[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:p.player})}),e.jsxs("div",{children:["A tuÃ© ",d," ",p.kills," fois"]})]})}return null}}),e.jsx(E,{dataKey:"kills",children:y.killedBy.map((m,u)=>e.jsx(D,{fill:x[m.player]||"var(--chart-color-4)"},`cell-killer-${u}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[d," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]})]})}function Pe(){const{settings:d,updateSettings:f}=V(),{data:g,isLoading:x,error:y}=ee(),{joueursData:m,isLoading:u}=B(),{data:p,isLoading:i,error:t}=me(d.highlightedPlayer),a=O(m),[l,c]=N.useState(""),[v,w]=N.useState("all"),[R,S]=N.useState("achievements"),[P,F]=N.useState("session"),T=N.useMemo(()=>{if(!g||!g.GameStats)return[];const n=new Map;return g.GameStats.forEach(j=>{const r=new Date(j.StartDate);j.PlayerStats.forEach(o=>{const h=J(o),C=m?.Players?.find(X=>X.ID===h)?.Joueur||Y(o);n.has(h)||n.set(h,{games:0,wins:0,firstDate:r,lastDate:r,displayName:C});const k=n.get(h);k.games++,o.Victorious&&k.wins++,r<k.firstDate&&(k.firstDate=r),r>k.lastDate&&(k.lastDate=r)})}),Array.from(n.entries()).map(([j,r])=>{let o=m?.Players?.find(h=>h.ID===j);return o||(o=m?.Players?.find(h=>h.Joueur===r.displayName)),{name:r.displayName,totalGames:r.games,totalWins:r.wins,winRate:r.games>0?r.wins/r.games*100:0,firstGameDate:r.firstDate.toLocaleDateString("fr-FR"),lastGameDate:r.lastDate.toLocaleDateString("fr-FR"),isHighlighted:r.displayName===d.highlightedPlayer,image:o?.Image||null,twitch:o?.Twitch||null,youtube:o?.Youtube||null}})},[g,d.highlightedPlayer,m]),$=N.useMemo(()=>{if(!l.trim())return T;const n=l.toLowerCase();return T.filter(j=>j.name.toLowerCase().includes(n))},[T,l]),K=N.useMemo(()=>[...$].sort((n,j)=>j.totalGames-n.totalGames),[$]),s=n=>{f({highlightedPlayer:n}),c("")};return x||u?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):y?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",y]})]}):!g||T.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!d.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:l,onChange:n=>c(n.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[$.length," joueur",$.length!==1?"s":"",l&&` (filtrÃ©${$.length!==1?"s":""} de ${T.length})`]})]})]}),e.jsx("div",{className:"player-display",children:l?$.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{className:"clear-search-btn",onClick:()=>c(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:K.map(n=>e.jsxs("button",{className:`suggestion-btn ${n.isHighlighted?"highlighted":""}`,onClick:()=>s(n.name),children:[n.image?e.jsx("img",{src:n.image,alt:n.name,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":a[n.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[n.name,n.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[n.totalGames," parties â€¢ ",n.winRate.toFixed(1),"% victoires"]})]})]},n.name))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',l,'"']}),e.jsx("button",{className:"clear-search-btn",onClick:()=>c(""),children:"Effacer la recherche"})]}):d.highlightedPlayer?(()=>{const n=T.find(j=>j.name===d.highlightedPlayer);return n?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:n.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[n.image?e.jsx("img",{src:n.image,alt:n.name,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":a[n.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[n.totalGames," parties â€¢ ",n.totalWins," victoires â€¢ ",n.winRate.toFixed(1),"% taux de victoire"]}),(n.twitch||n.youtube)&&e.jsxs("div",{className:"social-links",children:[n.twitch&&e.jsx("a",{href:n.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),n.youtube&&e.jsx("a",{href:n.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{className:`lycans-categorie-btn ${R==="achievements"?"active":""}`,onClick:()=>S("achievements"),children:"Classement"}),e.jsx("button",{className:`lycans-categorie-btn ${R==="evolution"?"active":""}`,onClick:()=>S("evolution"),children:"Ã‰volution"}),e.jsx("button",{className:`lycans-categorie-btn ${R==="camps"?"active":""}`,onClick:()=>S("camps"),children:"Camps"}),e.jsx("button",{className:`lycans-categorie-btn ${R==="maps"?"active":""}`,onClick:()=>S("maps"),children:"Maps"}),e.jsx("button",{className:`lycans-categorie-btn ${R==="kills"?"active":""}`,onClick:()=>S("kills"),children:"Kills"})]}),R==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[i?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):t?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",t]})}):p?e.jsx(ue,{achievements:v==="all"?p.allGamesAchievements:p.moddedOnlyAchievements,title:v==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:v}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[e.jsx("button",{className:`filter-btn ${v==="all"?"active":""}`,onClick:j=>{j.stopPropagation(),w("all")},children:"Toutes les parties"}),e.jsx("button",{className:`filter-btn ${v==="modded"?"active":""}`,onClick:j=>{j.stopPropagation(),w("modded")},children:"Parties moddÃ©es"})]})]}),R==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[e.jsx("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:P,onChange:j=>F(j.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"120px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"})]})]})}),e.jsx(ge,{selectedPlayerName:n.name,groupingMethod:P})]}),R==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(fe,{selectedPlayerName:n.name})}),R==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(xe,{selectedPlayerName:n.name})}),R==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ve,{selectedPlayerName:n.name})}),e.jsx("button",{className:"highlight-btn active",onClick:j=>{j.stopPropagation(),f({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[n.firstGameDate," - ",n.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',d.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{className:"clear-selection-btn",onClick:()=>f({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:K.map(n=>e.jsxs("div",{className:`character-card ${n.isHighlighted?"highlighted":""}`,onClick:()=>s(n.name),title:`${n.name} - ${n.totalGames} parties, ${n.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:n.image?e.jsx("img",{src:n.image,alt:n.name,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":a[n.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:n.name}),(n.twitch||n.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[n.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),n.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},n.name))})})})]})}export{Pe as PlayerSelectionPage};
