import{u as J,a as Y,r as C,j as e,e as ae}from"./index-BsBhJe0W.js";import{g as ee,a as se,c as te,u as le,b as ne,d as oe,e as de}from"./useDeathStatisticsFromRaw-6-WpxUAP.js";import{u as ce}from"./baseStatsHook-DCgrV9tD.js";import{g as he,D as W}from"./datasyncExport-D6_8Fmuy.js";import{m as X,u as Z,a as re}from"./api-BzGAbf3x.js";import{D as K,g as O}from"./deathTypes-CGUOTngO.js";import{F as E,B as $,C as F,X as V,Y as q,a as G,b as U}from"./FullscreenChart-qTbhVP9C.js";import{R as I,T as w}from"./CategoricalChart-Bg5IC_7w.js";import{u as Q}from"./useJoueursData-D--XmU2e.js";import{S as me,a as ge}from"./ScatterChart-DOmbdwst.js";function ie(d){if(!d||d.trim()==="")return null;const p=d.trim().slice(1),j=parseInt(p,10);return isNaN(j)||j<1?null:j}function ue(d,S){if(d.length===0)return null;const p=d.filter(n=>!n.LegacyData||n.LegacyData.deathInformationFilled===!0);if(p.length===0)return null;const j={},g={};p.forEach(n=>{let v=1;if(n.EndTiming){const x=ie(n.EndTiming);x&&(v=x)}n.PlayerStats.forEach(x=>{if(S&&S!=="Tous les camps"&&he(x.MainRoleInitial,{regroupLovers:!0,regroupVillagers:!0,regroupWolfSubRoles:!1})!==S)return;const z=x.Username;j[z]||(j[z]={playerName:z,totalGames:0,survivalsByDay:{},survivalRatesByDay:{},gamesPlayedByDay:{}});const A=j[z];A.totalGames++;let R=null;x.DeathTiming&&(R=ie(x.DeathTiming));for(let B=1;B<=v;B++)A.gamesPlayedByDay[B]||(A.gamesPlayedByDay[B]=0,A.survivalsByDay[B]=0),g[B]||(g[B]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),A.gamesPlayedByDay[B]++,g[B].playersOnDay++,(!R||R>B)&&(A.survivalsByDay[B]++,g[B].survivorsOnDay++)});for(let x=1;x<=v;x++)g[x]||(g[x]={gamesReachingDay:0,playersOnDay:0,survivorsOnDay:0}),g[x].gamesReachingDay++}),Object.values(j).forEach(n=>{Object.keys(n.gamesPlayedByDay).forEach(v=>{const x=parseInt(v),z=n.gamesPlayedByDay[x],A=n.survivalsByDay[x];z>0?n.survivalRatesByDay[x]=A/z*100:n.survivalRatesByDay[x]=0})});const M=Object.values(j).filter(n=>n.totalGames>0).sort((n,v)=>v.totalGames-n.totalGames),H=Object.entries(g).map(([n,v])=>({dayNumber:parseInt(n),totalGamesReachingDay:v.gamesReachingDay,totalPlayersOnDay:v.playersOnDay,averageSurvivalRate:v.playersOnDay>0?v.survivorsOnDay/v.playersOnDay*100:0})).sort((n,v)=>n.dayNumber-v.dayNumber);return{totalGames:p.length,totalPlayersAnalyzed:M.length,playerSurvivalStats:M,dayStats:H}}function ye(d,S,p=10){return d.playerSurvivalStats.filter(j=>j.totalGames>=p&&(j.gamesPlayedByDay[S]||0)>0).map(j=>({playerName:j.playerName,survivalRate:j.survivalRatesByDay[S]||0,gamesPlayed:j.totalGames,timesReachedDay:j.gamesPlayedByDay[S]||0,timesSurvivedDay:j.survivalsByDay[S]||0})).sort((j,g)=>g.survivalRate-j.survivalRate).slice(0,15)}function pe(d,S,p=10){return d.playerSurvivalStats.filter(j=>j.totalGames>=p&&(j.gamesPlayedByDay[S]||0)>0).map(j=>({playerName:j.playerName,survivalRate:j.survivalRatesByDay[S]||0,gamesPlayed:j.totalGames,timesReachedDay:j.gamesPlayedByDay[S]||0,timesSurvivedDay:j.survivalsByDay[S]||0})).sort((j,g)=>j.survivalRate-g.survivalRate).slice(0,15)}function ve(d){return ce(S=>ue(S,d))}function xe({deathStats:d,selectedCamp:S,victimCampFilter:p,minGamesForAverage:j,onMinGamesChange:g,availableDeathTypes:M,deathTypeColors:H,totalEligibleForAverage:n}){const{navigateToGameDetails:v}=J(),{settings:x}=Y(),z=s=>{if(p==="Tous les camps"){const i=s.filter(h=>h!==K.BULLET_HUMAN&&h!==K.BULLET_WOLF);return(s.includes(K.BULLET_HUMAN)||s.includes(K.BULLET_WOLF))&&!i.includes(K.BULLET)&&i.push(K.BULLET),i}return s},A=C.useMemo(()=>z(M),[M,p]),R=C.useMemo(()=>{const s={...H};if(p==="Tous les camps"&&!s[K.BULLET]){const i=H[K.BULLET_HUMAN]||H[K.BULLET_WOLF];i&&(s[K.BULLET]=i)}return s},[H,p]),B=s=>{if(p==="Tous les camps"){const i=s.killsByDeathType[K.BULLET_HUMAN]||0,h=s.killsByDeathType[K.BULLET_WOLF]||0,a=s.killsByDeathType[K.BULLET]||0,l={...s.killsByDeathType};return l[K.BULLET]=i+h+a,delete l[K.BULLET_HUMAN],delete l[K.BULLET_WOLF],{...s,killsByDeathType:l}}return s},L=s=>{let i="Top Tueurs";return S!=="Tous les camps"&&(i+=` en ${S}`),p!=="Tous les camps"&&(p==="Roles solo"?i+=" (victimes: Roles solo)":i+=` (victimes: ${p})`),s==="total"?i+=" (Total)":i+=" (Moyenne par Partie)",i},{totalKillsData:T,averageKillsData:f,highlightedPlayerAddedToTotal:k,highlightedPlayerAddedToAverage:c}=C.useMemo(()=>{if(!d)return{totalKillsData:[],averageKillsData:[],highlightedPlayerAddedToTotal:!1,highlightedPlayerAddedToAverage:!1};const s=d.killerStats.sort((o,m)=>m.kills-o.kills).slice(0,15),i=x.highlightedPlayer&&s.some(o=>o.killerName===x.highlightedPlayer),h=s.map(o=>{const m=B(o),P={name:m.killerName,value:m.kills,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!1};return A.forEach(b=>{P[b]=m.killsByDeathType[b]||0}),P});let a=!1;if(x.highlightedPlayer&&!i){const o=d.killerStats.find(m=>m.killerName===x.highlightedPlayer);if(o){const m=B(o),P={name:m.killerName,value:m.kills,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!0};A.forEach(b=>{P[b]=m.killsByDeathType[b]||0}),h.push(P),a=!0}}const t=d.killerStats.filter(o=>o.gamesPlayed>=j).sort((o,m)=>m.averageKillsPerGame-o.averageKillsPerGame).slice(0,15),r=x.highlightedPlayer&&t.some(o=>o.killerName===x.highlightedPlayer),y=t.map(o=>{const m=B(o),P={name:m.killerName,value:m.averageKillsPerGame,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!1};return A.forEach(b=>{const _=m.killsByDeathType[b]||0;P[b]=m.gamesPlayed>0?_/m.gamesPlayed:0}),P});let N=!1;if(x.highlightedPlayer&&!r){const o=d.killerStats.find(m=>m.killerName===x.highlightedPlayer);if(o){const m=B(o),P={name:m.killerName,value:m.averageKillsPerGame,victims:m.victims.length,percentage:m.percentage,gamesPlayed:m.gamesPlayed,averageKillsPerGame:m.averageKillsPerGame,isHighlightedAddition:!0};A.forEach(b=>{const _=m.killsByDeathType[b]||0;P[b]=m.gamesPlayed>0?_/m.gamesPlayed:0}),y.push(P),N=!0}}return{totalKillsData:h,averageKillsData:y,highlightedPlayerAddedToTotal:a,highlightedPlayerAddedToAverage:N}},[d,x.highlightedPlayer,j,A,p]),u=({active:s,payload:i,label:h})=>{if(s&&i&&i.length){const a=i[0].payload,l=a.isHighlightedAddition,t=x.highlightedPlayer===a.name,r=A.reduce((y,N)=>y+(a[N]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:t?"var(--accent-primary)":"var(--text-primary)"},children:[h,l&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Victimes totales:"})," ",r]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",a.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill:"}),A.map(y=>({deathType:y,count:a[y]||0})).filter(y=>y.count>0).sort((y,N)=>N.count-y.count).map(({deathType:y,count:N})=>e.jsxs("p",{style:{color:R[y],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ee(y),":"]})," ",N]},y))]}),l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),t&&!l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},D=({active:s,payload:i,label:h})=>{if(s&&i&&i.length){const a=i[0].payload,l=a.isHighlightedAddition,t=x.highlightedPlayer===a.name,r=a.gamesPlayed>=j,y=d?.killerStats.find(P=>P.killerName===a.name),N=y?B(y):null,o=A.reduce((P,b)=>P+(a[b]||0),0),m=N?N.kills:Math.round(o*a.gamesPlayed);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:t?"var(--accent-primary)":"var(--text-primary)"},children:[h,l&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Moyenne par partie:"})," ",o.toFixed(2)," (",m," kills /",a.gamesPlayed," games)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",a.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de kill (moyenne):"}),A.map(P=>({deathType:P,avgCount:a[P]||0,totalKillsForDeathType:N?N.killsByDeathType[P]||0:Math.round((a[P]||0)*a.gamesPlayed)})).filter(P=>P.avgCount>0).sort((P,b)=>b.avgCount-P.avgCount).map(({deathType:P,avgCount:b,totalKillsForDeathType:_})=>e.jsxs("p",{style:{color:R[P],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[ee(P),":"]})," ",b.toFixed(2)," (",_," kills /",a.gamesPlayed," games)"]},P))]}),l&&!r&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",j," parties)"]}),l&&r&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),t&&!l&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:L("total")}),k&&x.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',x.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(E,{title:L("total"),children:e.jsx("div",{style:{height:440},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:T,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:s,y:i,payload:h})=>e.jsx("text",{x:s,y:i,dy:10,fill:x.highlightedPlayer===h.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:x.highlightedPlayer===h.value?14:12,fontWeight:x.highlightedPlayer===h.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${s} ${i})`,children:h.value})}),e.jsx(q,{label:{value:"Nombre total de victimes",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(u,{})}),A.map(s=>e.jsx(G,{dataKey:s,name:s,stackId:"kills",fill:R[s],onClick:i=>{const h={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(h.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),v(h)}},s))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,T.filter(s=>!s.isHighlightedAddition).length)," des tueurs les plus actifs (total)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:L("average")}),c&&x.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',x.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-average-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-average-select",value:j,onChange:s=>g(Number(s.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:X.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx(E,{title:L("average"),children:e.jsx("div",{style:{height:400},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:f,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:s,y:i,payload:h})=>e.jsx("text",{x:s,y:i,dy:10,fill:x.highlightedPlayer===h.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:x.highlightedPlayer===h.value?14:12,fontWeight:x.highlightedPlayer===h.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${s} ${i})`,children:h.value})}),e.jsx(q,{label:{value:"Moyenne de victimes par partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(D,{})}),A.map(s=>e.jsx(G,{dataKey:s,name:s,stackId:"averageKills",fill:R[s],onClick:i=>{const h={selectedPlayer:i?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(h.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),v(h)}},s))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,f.filter(s=>!s.isHighlightedAddition).length)," des tueurs les plus efficaces (sur ",n," ayant au moins ",j," partie",j>1?"s":"",")"]})]})]})}function fe({deathStats:d,selectedCamp:S,minGamesForAverage:p,onMinGamesChange:j,availableDeathTypes:g,deathTypeColors:M}){const{navigateToGameDetails:H}=J(),{settings:n}=Y(),{joueursData:v}=Q(),x=Z(v),[z,A]=C.useState(null),{totalDeathsData:R,survivalRateData:B,highlightedPlayerAddedToDeaths:L,highlightedPlayerAddedToSurvival:T}=C.useMemo(()=>{if(!d)return{totalDeathsData:[],survivalRateData:[],highlightedPlayerAddedToDeaths:!1,highlightedPlayerAddedToSurvival:!1};const c=d.playerDeathStats.sort((r,y)=>y.totalDeaths-r.totalDeaths).slice(0,15),u=n.highlightedPlayer&&c.some(r=>r.playerName===n.highlightedPlayer),D=c.map(r=>{const y=r.gamesPlayed,N=y>0?(y-r.totalDeaths)/y*100:0,o={name:r.playerName,value:r.totalDeaths,totalDeaths:r.totalDeaths,gamesPlayed:y,deathRate:r.deathRate,survivalRate:N,isHighlightedAddition:!1};return g.forEach(m=>{o[m]=r.deathsByType[m]||0}),o});let s=!1;if(n.highlightedPlayer&&!u){const r=d.playerDeathStats.find(y=>y.playerName===n.highlightedPlayer);if(r){const y=r.gamesPlayed,N=y>0?(y-r.totalDeaths)/y*100:0,o={name:r.playerName,value:r.totalDeaths,totalDeaths:r.totalDeaths,gamesPlayed:y,deathRate:r.deathRate,survivalRate:N,isHighlightedAddition:!0};g.forEach(m=>{o[m]=r.deathsByType[m]||0}),D.push(o),s=!0}}const h=d.playerDeathStats.filter(r=>r.gamesPlayed>=p).map(r=>({...r,survivalRate:r.gamesPlayed>0?(r.gamesPlayed-r.totalDeaths)/r.gamesPlayed*100:0})).sort((r,y)=>y.survivalRate-r.survivalRate).slice(0,15),a=n.highlightedPlayer&&h.some(r=>r.playerName===n.highlightedPlayer),l=h.map(r=>{const y={name:r.playerName,value:r.survivalRate,totalDeaths:r.totalDeaths,gamesPlayed:r.gamesPlayed,deathRate:r.deathRate,survivalRate:r.survivalRate,isHighlightedAddition:!1};return g.forEach(N=>{y[N]=r.deathsByType[N]||0}),y});let t=!1;if(n.highlightedPlayer&&!a){const r=d.playerDeathStats.find(y=>y.playerName===n.highlightedPlayer);if(r){const y=r.gamesPlayed>0?(r.gamesPlayed-r.totalDeaths)/r.gamesPlayed*100:0,N={name:r.playerName,value:y,totalDeaths:r.totalDeaths,gamesPlayed:r.gamesPlayed,deathRate:r.deathRate,survivalRate:y,isHighlightedAddition:!0};g.forEach(o=>{N[o]=r.deathsByType[o]||0}),l.push(N),t=!0}}return{totalDeathsData:D,survivalRateData:l,highlightedPlayerAddedToDeaths:s,highlightedPlayerAddedToSurvival:t}},[d,n.highlightedPlayer,p,g]),f=({active:c,payload:u,label:D})=>{if(c&&u&&u.length){const s=u[0].payload,i=s.isHighlightedAddition,h=n.highlightedPlayer===s.name,a=g.reduce((l,t)=>l+(s[t]||0),0);return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:h?"var(--accent-primary)":"var(--text-primary)"},children:[D,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",a]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",s.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",s.survivalRate.toFixed(1),"%"]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),g.map(l=>{const t=s[l]||0;return t===0?null:e.jsxs("p",{style:{color:M[l],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[O(l),":"]})," ",t]},l)})]}),i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),h&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},k=({active:c,payload:u,label:D})=>{if(c&&u&&u.length){const s=u[0].payload,i=s.isHighlightedAddition,h=n.highlightedPlayer===s.name,a=s.gamesPlayed>=p;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:h?"var(--accent-primary)":"var(--text-primary)"},children:[D,i&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Taux de survie:"})," ",s.survivalRate.toFixed(1),"% (",s.gamesPlayed-s.totalDeaths," survies / ",s.gamesPlayed," parties)"]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Morts totales:"})," ",s.totalDeaths]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties jouÃ©es:"})," ",s.gamesPlayed]}),e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"RÃ©partition par type de mort:"}),g.map(l=>{const t=s[l]||0;return t===0?null:e.jsxs("p",{style:{color:M[l],margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[O(l),":"]})," ",t]},l)})]}),i&&!a&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",p," parties)"]}),i&&a&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),h&&!i&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:S==="Tous les camps"?"Morts (Total)":`Morts en ${S} (Total)`}),L&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(E,{title:S==="Tous les camps"?"Morts (Total)":`Morts en ${S} (Total)`,children:e.jsx("div",{style:{height:440},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:u,payload:D})=>e.jsx("text",{x:c,y:u,dy:10,fill:n.highlightedPlayer===D.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===D.value?14:12,fontWeight:n.highlightedPlayer===D.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${u})`,children:D.value})}),e.jsx(q,{label:{value:"Nombre total de morts",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(f,{})}),g.map(c=>e.jsx(G,{dataKey:c,name:c,stackId:"deaths",fill:M[c],onClick:u=>{const D={selectedPlayer:u?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(D.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),H(D)}},c))]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(c=>!c.isHighlightedAddition).length)," des joueurs les plus souvent morts"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["Meilleurs Survivants ",S==="Tous les camps"?"(Total)":` en ${S}`]}),T&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("label",{htmlFor:"min-games-survival-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Min. parties:"}),e.jsx("select",{id:"min-games-survival-select",value:p,onChange:c=>j(Number(c.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.9rem"},children:X.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsx(E,{title:"Meilleurs Survivants",children:e.jsx("div",{style:{height:400},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:B,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:c,y:u,payload:D})=>e.jsx("text",{x:c,y:u,dy:10,fill:n.highlightedPlayer===D.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===D.value?14:12,fontWeight:n.highlightedPlayer===D.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${c} ${u})`,children:D.value})}),e.jsx(q,{label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(k,{})}),e.jsx(G,{dataKey:"value",onClick:c=>{const u={selectedPlayer:c?.name,fromComponent:"Statistiques de Mort"};S!=="Tous les camps"&&(u.campFilter={selectedCamp:S,campFilterMode:"all-assignments"}),H(u)},onMouseEnter:c=>A(c?.name||null),onMouseLeave:()=>A(null),style:{cursor:"pointer"},children:B.map((c,u)=>{const D=n.highlightedPlayer===c.name,s=c.isHighlightedAddition;return e.jsx(U,{fill:x[c.name]||"var(--chart-primary)",stroke:D?"var(--accent-primary)":z===c.name?"var(--text-primary)":"none",strokeWidth:D?3:z===c.name?2:0,strokeDasharray:s?"5,5":"none",opacity:s?.8:1},`cell-${u}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,B.filter(c=>!c.isHighlightedAddition).length)," des joueurs avec le plus haut taux de survie (ayant au moins ",p," partie",p>1?"s":"",")"]})]})]})}function je({hunterStats:d,isLoading:S,error:p}){const{navigateToGameDetails:j}=J(),{settings:g}=Y(),M=re(),{joueursData:H}=Q(),n=Z(H),[v,x]=C.useState(null);if(S)return e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques chasseurs..."});if(p)return e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",p]});if(!d||d.hunterStats.length===0)return e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e Chasseur"}),e.jsx("p",{children:"Aucune statistique de chasseur disponible avec les filtres actuels."})]});const{finalBestHuntersData:z,highlightedPlayerAddedToBest:A,finalBadHuntersData:R,highlightedPlayerAddedToBad:B}=(()=>{const k=d.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).sort((t,r)=>r.averageNonVillageoisKillsPerGame-t.averageNonVillageoisKillsPerGame).slice(0,15),c=g.highlightedPlayer&&k.some(t=>t.hunterName===g.highlightedPlayer);let u=[...k],D=!1;if(g.highlightedPlayer&&!c){const t=d.hunterStats.find(r=>r.hunterName===g.highlightedPlayer);t&&(u.push({...t,isHighlightedAddition:!0}),D=!0)}const s=d.hunterStats.filter(t=>t.gamesPlayedAsHunter>=5).map(t=>({name:t.hunterName,averageVillageoisKills:Number((t.villageoisKills/t.gamesPlayedAsHunter).toFixed(2)),totalVillageoisKills:t.villageoisKills,totalNonVillageoisKills:t.nonVillageoisKills,totalKills:t.totalKills,gamesPlayed:t.gamesPlayedAsHunter,victimsByCamp:t.victimsByCamp,goodVictimsByCamp:t.goodVictimsByCamp,badVictimsByCamp:t.badVictimsByCamp,hunterName:t.hunterName})),i=s.sort((t,r)=>r.averageVillageoisKills-t.averageVillageoisKills).slice(0,15),h=g.highlightedPlayer&&i.some(t=>t.hunterName===g.highlightedPlayer);let a=[...i],l=!1;if(g.highlightedPlayer&&!h){const t=s.find(r=>r.hunterName===g.highlightedPlayer);t&&(a.push({...t,isHighlightedAddition:!0}),l=!0)}return{finalBestHuntersData:u,highlightedPlayerAddedToBest:D,finalBadHuntersData:a,highlightedPlayerAddedToBad:l}})(),L=({active:f,payload:k,label:c})=>{if(f&&k&&k.length){const u=k[0].payload,D=u.isHighlightedAddition,s=g.highlightedPlayer===u.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:s?"var(--accent-primary)":"var(--text-primary)"},children:[c,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Kills non-Villageois/partie:"})," ",u.averageNonVillageoisKillsPerGame.toFixed(2)]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",u.nonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",u.gamesPlayedAsHunter]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",u.totalKills]}),u.goodVictimsByCamp&&Object.keys(u.goodVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Bonnes victimes:"}),Object.entries(u.goodVictimsByCamp).map(([i,h])=>e.jsxs("p",{style:{color:M[i]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[i,":"]})," ",h]},i))]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),s&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null},T=({active:f,payload:k,label:c})=>{if(f&&k&&k.length){const u=k[0].payload,D=u.isHighlightedAddition,s=g.highlightedPlayer===u.hunterName;return e.jsxs("div",{style:{background:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",color:"var(--text-primary)",fontSize:"0.9rem"},children:[e.jsxs("p",{style:{fontWeight:"bold",marginBottom:"8px",color:s?"var(--accent-primary)":"var(--text-primary)"},children:[c,D&&e.jsx("span",{style:{color:"var(--accent-primary)",fontSize:"0.8rem",fontStyle:"italic",marginLeft:"4px"},children:" (ðŸŽ¯)"})]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Villageois tuÃ©s/partie:"})," ",u.averageVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total Villageois tuÃ©s:"})," ",u.totalVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total non-Villageois tuÃ©s:"})," ",u.totalNonVillageoisKills]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Parties en Chasseur:"})," ",u.gamesPlayed]}),e.jsxs("p",{style:{color:"var(--text-primary)",margin:"4px 0"},children:[e.jsx("strong",{children:"Total kills:"})," ",u.totalKills]}),u.badVictimsByCamp&&Object.keys(u.badVictimsByCamp).length>0&&e.jsxs("div",{style:{margin:"8px 0",borderTop:"1px solid var(--border-color)",paddingTop:"8px"},children:[e.jsx("p",{style:{fontWeight:"bold",fontSize:"0.85rem",marginBottom:"4px"},children:"Mauvaises victimes:"}),Object.entries(u.badVictimsByCamp).map(([i,h])=>e.jsxs("p",{style:{color:M[i]||"var(--text-secondary)",margin:"2px 0",fontSize:"0.8rem"},children:[e.jsxs("strong",{children:[i,":"]})," ",h]},i))]}),D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection personnelle"}),s&&!D&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Bons Chasseurs"}),A&&g.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',g.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(E,{title:"Bons Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:z,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:f,y:k,payload:c})=>e.jsx("text",{x:f,y:k,dy:10,fill:g.highlightedPlayer===c.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:g.highlightedPlayer===c.value?14:12,fontWeight:g.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${f} ${k})`,children:c.value})}),e.jsx(q,{label:{value:"Moyenne kills non-Villageois/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(L,{})}),e.jsx(G,{dataKey:"averageNonVillageoisKillsPerGame",fill:"var(--chart-primary)",onClick:f=>{f?.hunterName&&j({selectedPlayer:f.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Bons Chasseurs"})},onMouseEnter:f=>x(f?.hunterName||null),onMouseLeave:()=>x(null),style:{cursor:"pointer"},children:z.map((f,k)=>{const c=g.highlightedPlayer===f.hunterName,u=f.isHighlightedAddition;return e.jsx(U,{fill:n[f.hunterName]||M.Chasseur||"#8884d8",stroke:c?"var(--accent-primary)":v===f.hunterName?"var(--text-primary)":"none",strokeWidth:c?3:v===f.hunterName?2:0,strokeDasharray:u?"5,5":"none",opacity:u?.8:1},`cell-${k}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,z.filter(f=>!f.isHighlightedAddition).length)," des chasseurs les plus efficaces contre les non-Villageois (minimum 5 parties en Chasseur)"]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Mauvais Chasseurs"}),B&&g.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',g.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(E,{title:"Mauvais Chasseurs",children:e.jsx("div",{style:{height:440},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:R,margin:{top:60,right:30,left:20,bottom:10},children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(V,{dataKey:"hunterName",angle:-45,textAnchor:"end",height:80,interval:0,tick:({x:f,y:k,payload:c})=>e.jsx("text",{x:f,y:k,dy:10,fill:g.highlightedPlayer===c.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:g.highlightedPlayer===c.value?14:12,fontWeight:g.highlightedPlayer===c.value?"bold":"normal",textAnchor:"end",transform:`rotate(-45 ${f} ${k})`,children:c.value})}),e.jsx(q,{label:{value:"Moyenne Villageois tuÃ©s/partie",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(T,{})}),e.jsx(G,{dataKey:"averageVillageoisKills",fill:"var(--chart-primary)",onClick:f=>{f?.hunterName&&j({selectedPlayer:f.hunterName,campFilter:{selectedCamp:"Chasseur",campFilterMode:"all-assignments"},fromComponent:"Statistiques de Mort - Mauvais Chasseurs"})},onMouseEnter:f=>x(f?.hunterName||null),onMouseLeave:()=>x(null),style:{cursor:"pointer"},children:R.map((f,k)=>{const c=g.highlightedPlayer===f.hunterName,u=f.isHighlightedAddition;return e.jsx(U,{fill:n[f.hunterName]||M.Chasseur||"#8884d8",stroke:c?"var(--accent-primary)":v===f.hunterName?"var(--text-primary)":"none",strokeWidth:c?3:v===f.hunterName?2:0,strokeDasharray:u?"5,5":"none",opacity:u?.8:1},`cell-${k}`)})})]})})})}),e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"0.5rem"},children:["Top ",Math.min(15,R.filter(f=>!f.isHighlightedAddition).length)," des chasseurs ayant le plus tuÃ© de Villageois (minimum 5 parties en Chasseur)"]})]})]})}function Se({survivalStats:d,selectedCamp:S,minGamesForAverage:p,onMinGamesChange:j,isLoading:g,error:M}){const{navigateToGameDetails:H}=J(),{settings:n}=Y(),{joueursData:v}=Q(),x=Z(v),[z,A]=C.useState(1),[R,B]=C.useState(null),L=C.useMemo(()=>d?d.dayStats.filter(h=>h.totalGamesReachingDay>0).map(h=>h.dayNumber).sort((h,a)=>h-a):[],[d]),T=C.useMemo(()=>L.includes(z)?z:L.length>0?L[0]:1,[z,L]),{highestSurvivalData:f,highlightedPlayerAddedToHighest:k}=C.useMemo(()=>{if(!d)return{highestSurvivalData:[],highlightedPlayerAddedToHighest:!1};const i=ye(d,T,p),h=n.highlightedPlayer&&i.some(t=>t.playerName===n.highlightedPlayer),a=i.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let l=!1;if(n.highlightedPlayer&&!h){const t=d.playerSurvivalStats.find(r=>r.playerName===n.highlightedPlayer);if(t&&t.totalGames>=p&&(t.gamesPlayedByDay[T]||0)>0){const r=t.survivalRatesByDay[T]||0;a.push({name:n.highlightedPlayer,value:r,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[T]||0,timesSurvivedDay:t.survivalsByDay[T]||0,isHighlightedAddition:!0}),l=!0}}return{highestSurvivalData:a,highlightedPlayerAddedToHighest:l}},[d,T,p,n.highlightedPlayer]),{lowestSurvivalData:c,highlightedPlayerAddedToLowest:u}=C.useMemo(()=>{if(!d)return{lowestSurvivalData:[],highlightedPlayerAddedToLowest:!1};const i=pe(d,T,p),h=n.highlightedPlayer&&i.some(t=>t.playerName===n.highlightedPlayer),a=i.map(t=>({name:t.playerName,value:t.survivalRate,gamesPlayed:t.gamesPlayed,timesReachedDay:t.timesReachedDay,timesSurvivedDay:t.timesSurvivedDay,isHighlightedAddition:!1}));let l=!1;if(n.highlightedPlayer&&!h){const t=d.playerSurvivalStats.find(r=>r.playerName===n.highlightedPlayer);if(t&&t.totalGames>=p&&(t.gamesPlayedByDay[T]||0)>0){const r=t.survivalRatesByDay[T]||0;a.push({name:n.highlightedPlayer,value:r,gamesPlayed:t.totalGames,timesReachedDay:t.gamesPlayedByDay[T]||0,timesSurvivedDay:t.survivalsByDay[T]||0,isHighlightedAddition:!0}),l=!0}}return{lowestSurvivalData:a,highlightedPlayerAddedToLowest:l}},[d,T,p,n.highlightedPlayer]),D=i=>{H({selectedPlayer:i,fromComponent:"Statistiques de Survie"})},s=({active:i,payload:h,label:a})=>{if(i&&h&&h.length>0){const l=h[0].payload,t=l.isHighlightedAddition,r=n.highlightedPlayer===l.name,y=l.gamesPlayed>=p,N=l.timesReachedDay-l.timesSurvivedDay;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[e.jsx("div",{children:e.jsx("strong",{children:a})}),e.jsx("div",{children:e.jsxs("span",{style:{color:"var(--accent-primary)"},children:["Taux de survie Jour ",T,": ",l.value.toFixed(1),"%"]})}),e.jsxs("div",{children:["Parties atteignant le Jour ",T,": ",l.timesReachedDay]}),e.jsxs("div",{children:["A survÃ©cu au Jour ",T,": ",l.timesSurvivedDay]}),e.jsxs("div",{children:["N'a pas survÃ©cu au Jour ",T,": ",N]}),e.jsxs("div",{children:["Total de parties: ",l.gamesPlayed]}),t&&!y&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:["ðŸŽ¯ AffichÃ© via sÃ©lection (< ",p," parties au total)"]}),t&&y&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ AffichÃ© via sÃ©lection (hors top 15)"}),r&&!t&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--accent-primary)",marginTop:"0.25rem",fontStyle:"italic"},children:"ðŸŽ¯ Joueur sÃ©lectionnÃ©"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null};return g?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de survie..."}):M?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",M]}):d?e.jsxs("div",{className:"lycans-survival-stats",children:[e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:`Un "Jour" reprÃ©sente un cycle complet composÃ© d'une phase de jour, d'une phase de nuit, et d'une rÃ©union. Par exemple, le Jour 2 signifie que le joueur a survÃ©cu au deuxiÃ¨me cycle jour/nuit/rÃ©union.`}),e.jsxs("p",{children:["Les statistiques de survie montrent le pourcentage de fois qu'un joueur survit au Jour ",T," parmi toutes les parties qu'il a jouÃ©es et qui ont atteint ce jour. ",k||u?"Les joueurs mis en Ã©vidence apparaissent mÃªme s'ils ne sont pas dans le top 15.":""]})]}),e.jsx("div",{className:"lycans-graphique-controles",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"day-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Jour :"}),e.jsx("select",{id:"day-select",value:T,onChange:i=>A(parseInt(i.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:L.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"min-games-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Min. parties :"}),e.jsx("select",{id:"min-games-select",value:p,onChange:i=>j(parseInt(i.target.value)),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"80px"},children:X.map(i=>e.jsx("option",{value:i,children:i},i))})]})]})}),T&&d.dayStats.find(i=>i.dayNumber===T)&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:T===1?"Total des parties enregistrÃ©es":`Parties atteignant le Jour ${T}`}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:d.dayStats.find(i=>i.dayNumber===T)?.totalGamesReachingDay||0})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Taux de survie moyen Jour ",T]}),e.jsxs("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:[(d.dayStats.find(i=>i.dayNumber===T)?.averageSurvivalRate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsxs("h3",{children:["Joueurs Ã©ligibles (min. ",p," parties)"]}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:d.playerSurvivalStats.filter(i=>i.totalGames>=p&&(i.gamesPlayedByDay[T]||0)>0).length})]})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ",T]}),k&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(E,{title:`ðŸ›¡ï¸ Meilleurs Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:f,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(F,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:i,y:h,payload:a})=>e.jsx("text",{x:i,y:h,dy:16,textAnchor:"end",transform:`rotate(-45, ${i}, ${h})`,fill:n.highlightedPlayer===a.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===a.value?14:12,fontWeight:n.highlightedPlayer===a.value?"bold":"normal",children:a.value})}),e.jsx(q,{tickFormatter:i=>`${i.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(s,{})}),e.jsx(G,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:f.map((i,h)=>{const a=n.highlightedPlayer===i.name,l=R===i.name,t=i.isHighlightedAddition;return e.jsx(U,{fill:x[i.name]||"var(--chart-primary)",stroke:a?"var(--accent-primary)":l?"var(--text-primary)":"none",strokeWidth:a?3:l?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>D(i.name),onMouseEnter:()=>B(i.name),onMouseLeave:()=>B(null),style:{cursor:"pointer"}},`cell-highest-${h}`)})})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:["âš°ï¸ Plus Faibles Taux de Survie - Jour ",T]}),u&&n.highlightedPlayer&&e.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",fontStyle:"italic",marginTop:"0.25rem",marginBottom:"0.5rem"},children:['ðŸŽ¯ "',n.highlightedPlayer,'" affichÃ© en plus du top 15']})]}),e.jsx(E,{title:`âš°ï¸ Plus Faibles Taux de Survie - Jour ${T}`,children:e.jsx("div",{style:{height:400},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs($,{data:c,margin:{top:20,right:30,left:20,bottom:80},children:[e.jsx(F,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(V,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:({x:i,y:h,payload:a})=>e.jsx("text",{x:i,y:h,dy:16,textAnchor:"end",transform:`rotate(-45, ${i}, ${h})`,fill:n.highlightedPlayer===a.value?"var(--accent-primary)":"var(--text-secondary)",fontSize:n.highlightedPlayer===a.value?14:12,fontWeight:n.highlightedPlayer===a.value?"bold":"normal",children:a.value})}),e.jsx(q,{tickFormatter:i=>`${i.toFixed(0)}%`,tick:{fill:"var(--text-secondary)"},label:{value:"Taux de survie (%)",angle:270,position:"left",style:{textAnchor:"middle"}}}),e.jsx(w,{content:e.jsx(s,{})}),e.jsx(G,{dataKey:"value",name:"Taux de survie",cursor:"pointer",children:c.map((i,h)=>{const a=n.highlightedPlayer===i.name,l=R===i.name,t=i.isHighlightedAddition;return e.jsx(U,{fill:x[i.name]||"var(--chart-color-4)",stroke:a?"var(--accent-primary)":l?"var(--text-primary)":"none",strokeWidth:a?3:l?2:0,strokeDasharray:t?"5,5":"none",opacity:t?.8:1,onClick:()=>D(i.name),onMouseEnter:()=>B(i.name),onMouseLeave:()=>B(null),style:{cursor:"pointer"}},`cell-lowest-${h}`)})})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de survie disponible"})}function Pe({selectedCamp:d,availableDeathTypes:S,deathTypeColors:p}){const{navigateToGameDetails:j}=J(),{settings:g}=Y(),{data:M,isLoading:H,error:n}=ae(),[v,x]=C.useState(""),[z,A]=C.useState("all"),[R,B]=C.useState(null),L=C.useMemo(()=>{if(!M)return[];const a=se(M),l=te(M,d),t=new Map;return l.forEach(r=>{t.set(r.mapName,(t.get(r.mapName)||0)+1)}),a.sort((r,y)=>{const N=t.get(r)||0;return(t.get(y)||0)-N})},[M,d]),T=L.length>0?L[0]:"";v===""&&T!==""&&x(T);const f=C.useMemo(()=>{if(!M)return[];let a=te(M,d);return v&&(a=a.filter(l=>l.mapName===v)),z!=="all"&&(a=a.filter(l=>l.deathType===z)),a},[M,d,v,z]),k=C.useMemo(()=>{const a=new Map;return f.forEach(l=>{const t=`${Math.round(l.x)}_${Math.round(l.z)}`;a.has(t)||a.set(t,[]),a.get(t).push(l)}),a},[f]),c=C.useMemo(()=>Array.from(k.entries()).map(([a,l])=>({...l[0],deathCount:l.length,allDeaths:l,locationKey:a})),[k]),u=({active:a,payload:l})=>{if(!a||!l||l.length===0)return null;const t=l[0].payload,r=`${Math.round(t.x)}_${Math.round(t.z)}`,y=k.get(r)||[t];if(y.length>1){const o=new Map,m=new Set;return y.forEach(P=>{const b=P.deathType?O(P.deathType):"Inconnu";o.set(b,(o.get(b)||0)+1),m.add(P.gameId)}),e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:[y.length," morts Ã  cet endroit"]}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Position:"})," (",Math.round(t.x),", ",Math.round(t.z),")"]}),e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:"Types de mort:"}),e.jsx("ul",{style:{margin:"4px 0 0 0",paddingLeft:"20px"},children:Array.from(o.entries()).map(([P,b])=>e.jsxs("li",{children:[P," (",b,")"]},P))})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Parties:"})," ",Array.from(m).filter(P=>P).map(P=>`#${P}`).join(", ")]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir une des parties"})]})}return e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",maxWidth:"300px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"1rem",color:"var(--accent-primary)"},children:t.playerName}),e.jsxs("div",{style:{fontSize:"0.9rem",lineHeight:"1.6"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Camp:"})," ",t.camp]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type de mort:"})," ",t.deathType?O(t.deathType):"Inconnu"]}),t.killerName&&e.jsxs("div",{children:[e.jsx("strong",{children:"TuÃ© par:"})," ",t.killerName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Carte:"})," ",t.mapName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Partie:"})," #",t.gameId]}),e.jsxs("div",{style:{marginTop:"4px",fontSize:"0.85rem",color:"var(--text-secondary)"},children:["Position: (",Math.round(t.x),", ",Math.round(t.z),")"]})]}),e.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--border-color)",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Cliquez pour voir les dÃ©tails de la partie"})]})},D=a=>{if(!a)return;const l=a.allDeaths||[a];if(l.length===1)j({selectedGame:l[0].gameId,fromComponent:"Death Location View"});else{const t=l.map(r=>r.gameId).filter(r=>r);j({selectedGameIds:t,fromComponent:"Death Location View"})}},s=a=>a&&p[a]||"var(--text-secondary)",{xDomain:i,zDomain:h}=C.useMemo(()=>{if(c.length===0)return{xDomain:[0,100],zDomain:[0,100]};const a=c.map(P=>P.x),l=c.map(P=>P.z),t=Math.min(...a),r=Math.max(...a),y=Math.min(...l),N=Math.max(...l),o=(r-t)*.1||10,m=(N-y)*.1||10;return{xDomain:[t-o,r+o],zDomain:[y-m,N+m]}},[c]);return H?e.jsx("div",{className:"donnees-attente",children:"Chargement des localisations de mort..."}):n?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",n]}):M?e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"map-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Carte :"}),e.jsx("select",{id:"map-select",value:v,onChange:a=>x(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:L.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"death-type-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Type de mort :"}),e.jsxs("select",{id:"death-type-select",value:z,onChange:a=>A(a.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"180px"},children:[e.jsx("option",{value:"all",children:"Tous les types"}),S.map(a=>e.jsx("option",{value:a,children:O(a)},a))]})]})]}),e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Morts localisÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:f.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Camp filtrÃ©"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)",fontSize:"1.2rem"},children:d})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Type de mort"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-2)",fontSize:"1.2rem"},children:z==="all"?"Tous":O(z)})]})]}),f.length>0?e.jsx(E,{title:"Carte des Morts",children:e.jsx("div",{style:{height:600},children:e.jsx(I,{width:"100%",height:"100%",children:e.jsxs(me,{margin:{top:20,right:30,left:60,bottom:60},children:[e.jsx(F,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(V,{dataKey:"x",type:"number",name:"Position X",label:{value:"Position X",position:"bottom",offset:10,style:{fill:"var(--text-secondary)"}},domain:i,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:a=>Math.round(a).toString()}),e.jsx(q,{dataKey:"z",type:"number",name:"Position Z",label:{value:"Position Z",angle:-90,position:"left",offset:20,style:{fill:"var(--text-secondary)"}},domain:h,stroke:"var(--text-secondary)",tick:{fill:"var(--text-secondary)"},tickFormatter:a=>Math.round(a).toString()}),e.jsx(w,{content:e.jsx(u,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(ge,{data:c,onClick:a=>D(a),onMouseEnter:a=>B(a),onMouseLeave:()=>B(null),style:{cursor:"pointer"},children:c.map((a,l)=>{const t=g.highlightedPlayer===a.playerName,r=R?.playerName===a.playerName&&R?.gameId===a.gameId,y=a.deathCount>1?7:5,N=y+2;return e.jsx(U,{fill:t?"var(--accent-primary)":s(a.deathType),stroke:t||r?"white":a.deathCount>1?"var(--accent-secondary)":"none",strokeWidth:t?3:r?2:a.deathCount>1?1:0,opacity:t?1:.7,r:t?N:r?y+1:y},`cell-${l}`)})})]})})})}):e.jsxs("div",{className:"donnees-manquantes",style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"1rem"},children:"Aucune localisation de mort disponible pour les filtres sÃ©lectionnÃ©s"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"Les donnÃ©es de position ne sont disponibles que pour les parties rÃ©centes (non-legacy)."})]}),f.length>0&&e.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--text-primary)"},children:"LÃ©gende des types de mort"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.5rem"},children:S.map(a=>{const l=f.filter(t=>t.deathType===a).length;return l===0?null:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:p[a],flexShrink:0}}),e.jsxs("span",{style:{color:"var(--text-primary)"},children:[O(a)," (",l,")"]})]},a)})})]}),e.jsxs("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:[e.jsx("p",{children:e.jsx("strong",{children:"Ã€ propos de cette visualisation :"})}),e.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[e.jsx("li",{children:"Les positions sont basÃ©es sur les coordonnÃ©es X et Z (vue 2D de la carte)"}),e.jsx("li",{children:"Chaque point reprÃ©sente la mort d'un joueur Ã  un endroit prÃ©cis"}),e.jsx("li",{children:"La couleur indique le type de mort (voir lÃ©gende ci-dessus)"}),e.jsxs("li",{children:["Les joueurs en surbrillance sont affichÃ©s en "," ",e.jsx("span",{style:{color:"var(--accent-primary)",fontWeight:"bold"},children:"couleur primaire"})]}),e.jsx("li",{children:"Cliquez sur un point pour voir les dÃ©tails de la partie"}),e.jsx("li",{children:"Survolez un point pour voir les informations dÃ©taillÃ©es"})]}),e.jsx("p",{style:{marginTop:"0.5rem",fontStyle:"italic",color:"var(--text-secondary)"},children:"Note : Seules les parties rÃ©centes contiennent des donnÃ©es de position. Les parties legacy sont exclues."})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e disponible"})}function He(){const{navigationState:d,updateNavigationState:S}=J(),[p,j]=C.useState(d.deathStatisticsState?.selectedCamp||d.deathStatsSelectedCamp||"Tous les camps"),[g,M]=C.useState(d.deathStatisticsState?.victimCampFilter||"Tous les camps"),[H,n]=C.useState(d.deathStatisticsState?.minGamesForAverage||25),[v,x]=C.useState(d.deathStatisticsState?.selectedView||"killers"),{data:z}=le(),{data:A,isLoading:R,error:B}=ne(p,g),{data:L,isLoading:T,error:f}=oe(),{data:k,isLoading:c,error:u}=ve(p),{data:D}=ae(),s=re();C.useEffect(()=>{(!d.deathStatisticsState||d.deathStatisticsState.selectedCamp!==p||d.deathStatisticsState.victimCampFilter!==g||d.deathStatisticsState.minGamesForAverage!==H||d.deathStatisticsState.selectedView!==v)&&S({deathStatisticsState:{selectedCamp:p,victimCampFilter:g,minGamesForAverage:H,selectedView:v,focusChart:d.deathStatisticsState?.focusChart}})},[p,g,H,v,d.deathStatisticsState,S]);const i=C.useMemo(()=>D?de(D):[],[D]),h=C.useMemo(()=>{const o={};i.forEach(b=>{b===W.BY_WOLF?o[b]=s.Loup:b===W.VOTED?o[b]="var(--chart-color-1)":b===W.BULLET||b===W.BULLET_HUMAN||b===W.BULLET_WOLF?o[b]=s.Chasseur:b===W.BY_ZOMBIE?o[b]=s.Vaudou:b===W.ASSASSIN?o[b]=s.Alchimiste:b===W.AVENGER?o[b]="var(--chart-color-2)":b===W.LOVER_DEATH?o[b]=s.Amoureux:b===W.BY_BEAST?o[b]="var(--chart-color-3)":b===W.SHERIF_SUCCESS&&(o[b]="var(--chart-color-4)")});const m=["var(--accent-primary)","var(--accent-secondary)","var(--accent-tertiary)","#8884d8","#82ca9d","#ffc658","#ff7300","#00c49f","#ffbb28"];let P=0;return i.forEach(b=>{o[b]||(o[b]=m[P%m.length],P++)}),o},[i,s]),a=o=>{j(o),S({deathStatsSelectedCamp:o,deathStatisticsState:{selectedCamp:o,victimCampFilter:g,minGamesForAverage:H,selectedView:v,focusChart:d.deathStatisticsState?.focusChart}})},l=o=>{M(o),S({deathStatisticsState:{selectedCamp:p,victimCampFilter:o,minGamesForAverage:H,selectedView:v,focusChart:d.deathStatisticsState?.focusChart}})},t=o=>{n(o),S({deathStatisticsState:{selectedCamp:p,victimCampFilter:g,minGamesForAverage:o,selectedView:v,focusChart:d.deathStatisticsState?.focusChart}})},r=o=>{x(o),S({deathStatisticsState:{selectedCamp:p,victimCampFilter:g,minGamesForAverage:H,selectedView:o,focusChart:d.deathStatisticsState?.focusChart}})},{gamesWithKillers:y,totalEligibleForAverage:N}=C.useMemo(()=>{if(!A)return{gamesWithKillers:0,totalEligibleForAverage:0};const o=A.killerStats.filter(m=>m.gamesPlayed>=H);return{gamesWithKillers:A.totalGames,totalEligibleForAverage:o.length}},[A,H]);return R?e.jsx("div",{className:"donnees-attente",children:"Chargement des statistiques de mort..."}):B?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",B]}):A?e.jsxs("div",{className:"lycans-players-stats",children:[e.jsx("h2",{children:"ðŸ’€ Statistiques de Morts & Kills"}),e.jsxs("div",{className:"lycans-categories-selection",children:[e.jsx("button",{className:`lycans-categorie-btn ${v==="killers"?"active":""}`,onClick:()=>r("killers"),children:"Tueurs"}),e.jsx("button",{className:`lycans-categorie-btn ${v==="deaths"?"active":""}`,onClick:()=>r("deaths"),children:"Morts"}),e.jsx("button",{className:`lycans-categorie-btn ${v==="survival"?"active":""}`,onClick:()=>r("survival"),children:"Survie par Jour"}),e.jsx("button",{className:`lycans-categorie-btn ${v==="hunter"?"active":""}`,onClick:()=>r("hunter"),children:"Chasseur"})]}),(v==="killers"||v==="deaths"||v==="survival"||v==="location")&&e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp :"}),e.jsxs("select",{id:"camp-select",value:p,onChange:o=>a(o.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),z?.map(o=>e.jsx("option",{value:o,children:o},o))]})]}),v==="killers"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"victim-camp-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem",fontWeight:"bold"},children:"Camp de la victime :"}),e.jsxs("select",{id:"victim-camp-select",value:g,onChange:o=>l(o.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"150px"},children:[e.jsx("option",{value:"Tous les camps",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loup"}),e.jsx("option",{value:"Roles solo",children:"Roles solo"})]})]})]}),(v==="killers"||v==="deaths")&&e.jsxs("div",{className:"lycans-resume-conteneur",style:{marginBottom:"2rem"},children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total des morts"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-secondary)"},children:A.totalDeaths})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Tueurs identifiÃ©s"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--chart-color-1)"},children:A.killerStats.length})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Nombre de parties enregistrÃ©es"}),e.jsx("div",{className:"lycans-valeur-principale",style:{color:"var(--accent-primary)"},children:y})]})]}),v==="killers"&&e.jsx(xe,{deathStats:A,selectedCamp:p,victimCampFilter:g,minGamesForAverage:H,onMinGamesChange:t,availableDeathTypes:i,deathTypeColors:h,totalEligibleForAverage:N}),v==="deaths"&&e.jsx(fe,{deathStats:A,selectedCamp:p,minGamesForAverage:H,onMinGamesChange:t,availableDeathTypes:i,deathTypeColors:h}),v==="hunter"&&e.jsx(je,{hunterStats:L,isLoading:T,error:f}),v==="survival"&&e.jsx(Se,{survivalStats:k,selectedCamp:p,minGamesForAverage:H,onMinGamesChange:t,isLoading:c,error:u}),v==="location"&&e.jsx(Pe,{selectedCamp:p,availableDeathTypes:i,deathTypeColors:h}),e.jsx("div",{className:"lycans-section-description",style:{marginTop:"1.5rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note : "}),"DonnÃ©es en cours de rÃ©cupÃ©ration (donnÃ©es partielles)."]})})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e de mort disponible"})}export{He as DeathStatisticsChart};
