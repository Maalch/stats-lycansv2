import{r as n,j as o}from"./index-55qKkggj.js";import{ae as I,a5 as re,af as ie,ag as ne,a1 as F,ah as se,c as U,ai as oe,aj as Y,ak as J,al as le,am as ce,an as de,ao as ue,v as X,D as pe,ap as ve,y as me,aq as ye,z as H,E as he,G as fe,b as xe,a4 as ge,F as be,ar as j,L as C,as as Ae,at as Se,k as R,au as B,N as Ee,O as Ie,Q as K,x as z,U as je,V as Pe,W as _e,Z as Te,_ as Oe,$ as Ce,a0 as we,av as De,aw as Ke,a2 as Re,ax as ke,ad as ze,R as $,B as Ne,C as W,X as q,Y as V,T as Z,a as Le}from"./BarChart-C6C8AQSr.js";import{L as Me}from"./Legend-mar0S_6n.js";function Q(e,a,t){return(a=Fe(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function Fe(e){var a=Be(e,"string");return typeof a=="symbol"?a:a+""}function Be(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function $e(e){var a=re();return n.useEffect(()=>(a(ie(e)),()=>{a(ne(e))}),[e,a]),null}class k extends n.Component{render(){return n.createElement($e,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:I.allowDuplicatedCategory,allowDataOverflow:I.allowDataOverflow,reversed:I.reversed,includeHidden:I.includeHidden})}}Q(k,"displayName","ZAxis");Q(k,"defaultProps",{zAxisId:0,range:I.range,scale:I.scale,type:I.type});var We=["option","isActive"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},O.apply(null,arguments)}function qe(e,a){if(e==null)return{};var t,r,i=Ve(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function Ve(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Ze(e){var{option:a,isActive:t}=e,r=qe(e,We);return typeof a=="string"?n.createElement(F,O({option:n.createElement(se,O({type:a},r)),isActive:t,shapeType:"symbols"},r)):n.createElement(F,O({option:a,isActive:t,shapeType:"symbols"},r))}var Ge=(e,a,t,r,i,s,l)=>Y(e,"xAxis",a,l),Ue=(e,a,t,r,i,s,l)=>J(e,"xAxis",a,l),Ye=(e,a,t,r,i,s,l)=>Y(e,"yAxis",t,l),Je=(e,a,t,r,i,s,l)=>J(e,"yAxis",t,l),Xe=(e,a,t,r)=>le(e,"zAxis",r,!1),He=(e,a,t,r,i)=>i,Qe=(e,a,t,r,i,s)=>s,ea=(e,a,t,r,i,s,l)=>oe(e,a,t,l),aa=U([ce,He],(e,a)=>{if(e.some(t=>t.type==="scatter"&&a.dataKey===t.dataKey&&a.data===t.data))return a}),ta=U([ea,Ge,Ue,Ye,Je,Xe,aa,Qe],(e,a,t,r,i,s,l,m)=>{var{chartData:d,dataStartIndex:p,dataEndIndex:h}=e;if(l!=null){var v;if(l?.data!=null&&l.data.length>0?v=l.data:v=d?.slice(p,h+1),!(v==null||a==null||r==null||t==null||i==null||t?.length===0||i?.length===0))return va({displayedData:v,xAxis:a,yAxis:r,zAxis:s,scatterSettings:l,xAxisTicks:t,yAxisTicks:i,cells:m})}}),ra=["onMouseEnter","onClick","onMouseLeave"],ia=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function ee(e,a){if(e==null)return{};var t,r,i=na(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function na(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function P(){return P=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},P.apply(null,arguments)}function G(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function b(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?G(Object(t),!0).forEach(function(r){N(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function N(e,a,t){return(a=sa(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function sa(e){var a=oa(e,"string");return typeof a=="symbol"?a:a+""}function oa(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var la=e=>{var{dataKey:a,name:t,fill:r,legendType:i,hide:s}=e;return[{inactive:s,dataKey:a,type:i,color:r,value:X(t,a),payload:e}]};function ca(e){var{points:a,props:t}=e,{line:r,lineType:i,lineJointType:s}=t;if(!r)return null;var l=z(t,!1),m=z(r,!1),d,p;if(i==="joint")d=a.map(c=>({x:c.cx,y:c.cy}));else if(i==="fitting"){var{xmin:h,xmax:v,a:u,b:f}=Ke(a),g=c=>u*c+f;d=[{x:h,y:g(h)},{x:v,y:g(v)}]}var x=b(b(b({},l),{},{fill:"none",stroke:l&&l.fill},m),{},{points:d});return n.isValidElement(r)?p=n.cloneElement(r,x):typeof r=="function"?p=r(x):p=n.createElement(Re,P({},x,{type:s})),n.createElement(C,{className:"recharts-scatter-line",key:"recharts-scatter-line"},p)}function ae(e){var{points:a,showLabels:t,allOtherScatterProps:r}=e,{shape:i,activeShape:s,dataKey:l}=r,m=z(r,!1),d=H(je),{onMouseEnter:p,onClick:h,onMouseLeave:v}=r,u=ee(r,ra),f=Pe(p,r.dataKey),g=_e(v),x=Te(h,r.dataKey);return a==null?null:n.createElement(n.Fragment,null,n.createElement(ca,{points:a,props:r}),a.map((c,y)=>{var E=s&&d===String(y),A=E?s:i,S=b(b(b({key:"symbol-".concat(y)},m),c),{},{[Ce]:y,[Oe]:String(l)});return n.createElement(C,P({className:"recharts-scatter-symbol"},we(u,c,y),{onMouseEnter:f(c,y),onMouseLeave:g(c,y),onClick:x(c,y),key:"symbol-".concat(c?.cx,"-").concat(c?.cy,"-").concat(c?.size,"-").concat(y)}),n.createElement(Ze,P({option:A,isActive:E},S)))}),t&&De.renderCallByParent(r,a))}function da(e){var{previousPointsRef:a,props:t}=e,{points:r,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:m}=t,d=a.current,p=Ee(t,"recharts-scatter-"),[h,v]=n.useState(!1),u=n.useCallback(()=>{v(!1)},[]),f=n.useCallback(()=>{v(!0)},[]);return n.createElement(Ie,{begin:s,duration:l,isActive:i,easing:m,from:{t:0},to:{t:1},onAnimationEnd:u,onAnimationStart:f,key:p},g=>{var{t:x}=g,c=x===1?r:r.map((y,E)=>{var A=d&&d[E];if(A){var S=K(A.cx,y.cx),w=K(A.cy,y.cy),_=K(A.size,y.size);return b(b({},y),{},{cx:S(x),cy:w(x),size:_(x)})}var T=K(0,y.size);return b(b({},y),{},{size:T(x)})});return x>0&&(a.current=c),n.createElement(C,null,n.createElement(ae,{points:c,allOtherScatterProps:t,showLabels:!h}))})}function ua(e){var{points:a,isAnimationActive:t}=e,r=n.useRef(null),i=r.current;return t&&a&&a.length&&(!i||i!==a)?n.createElement(da,{props:e,previousPointsRef:r}):n.createElement(ae,{points:a,allOtherScatterProps:e,showLabels:!0})}function pa(e){var{dataKey:a,points:t,stroke:r,strokeWidth:i,fill:s,name:l,hide:m,tooltipType:d}=e;return{dataDefinedOnItem:t?.map(p=>p.tooltipPayload),positions:t?.map(p=>p.tooltipPosition),settings:{stroke:r,strokeWidth:i,fill:s,nameKey:void 0,dataKey:a,name:X(l,a),hide:m,type:d,color:s,unit:""}}}function va(e){var{displayedData:a,xAxis:t,yAxis:r,zAxis:i,scatterSettings:s,xAxisTicks:l,yAxisTicks:m,cells:d}=e,p=j(t.dataKey)?s.dataKey:t.dataKey,h=j(r.dataKey)?s.dataKey:r.dataKey,v=i&&i.dataKey,u=i?i.range:k.defaultProps.range,f=u&&u[0],g=t.scale.bandwidth?t.scale.bandwidth():0,x=r.scale.bandwidth?r.scale.bandwidth():0;return a.map((c,y)=>{var E=R(c,p),A=R(c,h),S=!j(v)&&R(c,v)||"-",w=[{name:j(t.dataKey)?s.name:t.name||t.dataKey,unit:t.unit||"",value:E,payload:c,dataKey:p,type:s.tooltipType},{name:j(r.dataKey)?s.name:r.name||r.dataKey,unit:r.unit||"",value:A,payload:c,dataKey:h,type:s.tooltipType}];S!=="-"&&w.push({name:i.name||i.dataKey,unit:i.unit||"",value:S,payload:c,dataKey:v,type:s.tooltipType});var _=B({axis:t,ticks:l,bandSize:g,entry:c,index:y,dataKey:p}),T=B({axis:r,ticks:m,bandSize:x,entry:c,index:y,dataKey:h}),M=S!=="-"?i.scale(S):f,D=Math.sqrt(Math.max(M,0)/Math.PI);return b(b({},c),{},{cx:_,cy:T,x:_-D,y:T-D,width:2*D,height:2*D,size:M,node:{x:E,y:A,z:S},tooltipPayload:w,tooltipPosition:{x:_,y:T},payload:c},d&&d[y]&&d[y].props)})}var ma=(e,a,t)=>({x:e.cx,y:e.cy,value:t==="x"?+e.node.x:+e.node.y,errorVal:R(e,a)});function ya(e){var a=n.useRef(ge("recharts-scatter-")),{hide:t,points:r,className:i,needClip:s,xAxisId:l,yAxisId:m,id:d,children:p}=e;if(t)return null;var h=be("recharts-scatter",i),v=j(d)?a.current:d;return n.createElement(C,{className:h,clipPath:s?"url(#clipPath-".concat(v,")"):null},s&&n.createElement("defs",null,n.createElement(Ae,{clipPathId:v,xAxisId:l,yAxisId:m})),n.createElement(Se,{xAxisId:l,yAxisId:m,data:r,dataPointFormatter:ma,errorBarOffset:0},p),n.createElement(C,{key:"recharts-scatter-symbols"},n.createElement(ua,e)))}var te={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!fe.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function ha(e){var a=pe(e,te),{animationBegin:t,animationDuration:r,animationEasing:i,hide:s,isAnimationActive:l,legendType:m,lineJointType:d,lineType:p,shape:h,xAxisId:v,yAxisId:u,zAxisId:f}=a,g=ee(a,ia),{needClip:x}=ve(v,u),c=n.useMemo(()=>me(e.children,xe),[e.children]),y=n.useMemo(()=>({name:e.name,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey}),[e.data,e.dataKey,e.name,e.tooltipType]),E=ye(),A=H(S=>ta(S,v,u,f,y,c,E));return x==null?null:n.createElement(n.Fragment,null,n.createElement(he,{fn:pa,args:b(b({},e),{},{points:A})}),n.createElement(ya,P({},g,{xAxisId:v,yAxisId:u,zAxisId:f,lineType:p,lineJointType:d,legendType:m,shape:h,hide:s,isAnimationActive:l,animationBegin:t,animationDuration:r,animationEasing:i,points:A,needClip:x})))}class L extends n.Component{render(){return n.createElement(de,{type:"scatter",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:this.props.zAxisId,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},n.createElement(ue,{legendPayload:la(this.props)}),n.createElement(ha,this.props))}}N(L,"displayName","Scatter");N(L,"defaultProps",te);var fa=["item"],xa=n.forwardRef((e,a)=>n.createElement(ke,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:fa,tooltipPayloadSearcher:ze,categoricalChartProps:e,ref:a}));function ga(){const[e,a]=n.useState(null),[t,r]=n.useState(!0),[i,s]=n.useState(null);return n.useEffect(()=>{(async()=>{try{r(!0),s(null);const d=await fetch("https://script.google.com/macros/s/AKfycbw7amBQVger2k8MpFhueGGtAMUsYioIvdU2yVcixtFuk66a2DRWEpZ_c3xf2nncKjuHPg/exec?action=roleSurvivalStats");if(!d.ok)throw new Error(`Erreur de requête: ${d.status}`);const p=await d.json();if(p.error)throw new Error(p.error);a(p)}catch(m){console.error("Problème lors de la récupération des stats de survie des rôles:",m),s(m instanceof Error?m.message:"Erreur lors du chargement")}finally{r(!1)}})()},[]),{roleSurvivalStats:e,dataLoading:t,fetchError:i}}function Ea(){const{roleSurvivalStats:e,dataLoading:a,fetchError:t}=ga(),[r,i]=n.useState("roles");if(a)return o.jsx("div",{className:"donnees-attente",children:"Récupération des statistiques de survie des rôles..."});if(t)return o.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",t]});if(!e)return o.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée de survie disponible"});const s=()=>{switch(r){case"roles":return{data:e.roleStats||[],keyField:"role",label:"Rôle",minAppearances:3};case"camps":return{data:e.campStats||[],keyField:"camp",label:"Camp",minAppearances:1};case"secondaryRoles":return{data:e.secondaryRoleStats||[],keyField:"secondaryRole",label:"Rôle Secondaire",minAppearances:3};case"thirdRoles":return{data:e.thirdRoleStats||[],keyField:"thirdRole",label:"Rôle Spécifique",minAppearances:3}}},{data:l,keyField:m,label:d,minAppearances:p}=s(),h=l.filter(u=>u.appearances>=p),v=h.map(u=>({nom:u[m],tauxSurvie:parseFloat(u.survivalRate),dureeVie:parseFloat(u.avgLifespan),apparitions:u.appearances}));return h.length===0?o.jsx("div",{className:"donnees-manquantes",children:"Aucune donnée disponible pour cette catégorie"}):o.jsxs("div",{className:"lycans-roles-survie",children:[o.jsx("h2",{children:"Statistiques de Survie des Rôles"}),o.jsxs("div",{className:"lycans-categories-selection",children:[o.jsx("button",{className:`lycans-categorie-btn ${r==="roles"?"active":""}`,onClick:()=>i("roles"),children:"Rôles principaux"}),o.jsx("button",{className:`lycans-categorie-btn ${r==="camps"?"active":""}`,onClick:()=>i("camps"),children:"Camps"}),o.jsx("button",{className:`lycans-categorie-btn ${r==="secondaryRoles"?"active":""}`,onClick:()=>i("secondaryRoles"),children:"Rôles secondaires"}),o.jsx("button",{className:`lycans-categorie-btn ${r==="thirdRoles"?"active":""}`,onClick:()=>i("thirdRoles"),children:"Rôles spécifiques"})]}),o.jsxs("div",{className:"lycans-graphiques-groupe",children:[o.jsxs("div",{className:"lycans-graphique-section",children:[o.jsxs("h3",{children:["Taux de Survie par ",d]}),o.jsx("div",{style:{height:400},children:o.jsx($,{width:"100%",height:"100%",children:o.jsxs(Ne,{data:h,margin:{top:20,right:30,left:20,bottom:70},layout:"vertical",children:[o.jsx(W,{strokeDasharray:"3 3"}),o.jsx(q,{type:"number",domain:[0,100]}),o.jsx(V,{dataKey:m,type:"category",width:150}),o.jsx(Z,{formatter:(u,f)=>f==="survivalRate"?[`${u}%`,"Taux de Survie"]:[u,f],labelFormatter:u=>`${d}: ${u}`}),o.jsx(Me,{formatter:u=>u==="survivalRate"?"Taux de Survie":u}),o.jsx(Le,{dataKey:"survivalRate",name:"survivalRate",fill:"var(--chart-color-2)",background:{fill:"var(--bg-tertiary)"}})]})})})]}),o.jsxs("div",{className:"lycans-graphique-section",children:[o.jsx("h3",{children:"Durée de Vie Moyenne vs Taux de Survie"}),o.jsx("div",{style:{height:400},children:o.jsx($,{width:"100%",height:"100%",children:o.jsxs(xa,{margin:{top:20,right:30,left:20,bottom:10},children:[o.jsx(W,{}),o.jsx(q,{type:"number",dataKey:"dureeVie",name:"Durée de Vie Moyenne (jours)",label:{value:"Durée de Vie Moyenne (jours)",position:"insideBottom",offset:-10}}),o.jsx(V,{type:"number",dataKey:"tauxSurvie",name:"Taux de Survie (%)",label:{value:"Taux de Survie (%)",angle:-90,position:"insideLeft"}}),o.jsx(k,{type:"number",dataKey:"apparitions",range:[50,400],name:"Nombre d'Apparitions"}),o.jsx(Z,{cursor:{strokeDasharray:"3 3"},content:({active:u,payload:f})=>{if(u&&f&&f.length>0){const g=f[0].payload;return o.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:8,borderRadius:6},children:[o.jsxs("div",{style:{fontWeight:"bold",marginBottom:4},children:[d,": ",g.nom]}),o.jsxs("div",{children:["Durée de Vie Moyenne : ",g.dureeVie," jours"]}),o.jsxs("div",{children:["Taux de Survie : ",g.tauxSurvie,"%"]}),o.jsxs("div",{children:["Apparitions : ",g.apparitions]})]})}return null}}),o.jsx(L,{name:d,data:v,fill:"var(--chart-color-5)"})]})})})]})]})]})}export{Ea as RoleSurvivalRateChart};
