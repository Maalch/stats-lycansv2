import{a as O,r as T,g as U,b as X,m as se,u as H,j as e,d as ae,n as te}from"./index-KuW3z-vq.js";import{g as re,a as ie,u as le}from"./datasyncExport-DpU4dbpb.js";import{g as ne}from"./gameUtils-BYF3qXc6.js";import{u as _}from"./useJoueursData-B982AzQk.js";import{u as Y,g as oe,a as ce,l as Q}from"./api-DzfEsHty.js";import{F as z,C as M,X as I,Y as E,B as K,a as V,b as A}from"./FullscreenChart-DByPeG30.js";import{R as q,T as G}from"./CategoricalChart-cwlby5hZ.js";import{L as de,a as ue}from"./LineChart-D_uRBzMU.js";import{P as me,a as pe}from"./PieChart-OXAKx5au.js";import{R as J}from"./ReferenceLine-UfoM2fc9.js";import"./ActivePoints-ByyuesHz.js";import"./PolarChart-B8KT41Nz.js";function he(u){const{settings:x}=O(),[f,y]=T.useState(null),[j,h]=T.useState(!1),[m,g]=T.useState(null);T.useEffect(()=>{let t=!0;return(async()=>{try{h(!0),g(null);const p=x.dataSource==="discord"?"/data/discord/playerAchievements.json":"/data/playerAchievements.json",c=await fetch(p);if(!c.ok)throw new Error(`Failed to load achievements: ${c.status} ${c.statusText}`);const n=await c.json();t&&y(n)}catch(p){t&&g(p instanceof Error?p.message:"Failed to load achievements")}finally{t&&h(!1)}})(),()=>{t=!1}},[x.dataSource]);const r=u&&f?.achievements[u]||null;return T.useEffect(()=>{if(u&&f){const t=f.achievements[u];t?console.log(`ðŸ† Achievements for ${u} (${x.dataSource}):`,{allGames:t.allGamesAchievements.length,moddedOnly:t.moddedOnlyAchievements.length,categories:[...new Set([...t.allGamesAchievements.map(i=>i.category),...t.moddedOnlyAchievements.map(i=>i.category)])]}):console.log(`âŒ No achievements found for ${u} in ${x.dataSource} data source`)}},[u,f,x.dataSource]),{data:r,isLoading:j,error:m,metadata:{generatedAt:f?.generatedAt||null,totalPlayers:f?.totalPlayers||0,totalGames:f?.totalGames||0,totalModdedGames:f?.totalModdedGames||0}}}function ge(u,x){if(!u||u.trim()===""||x.length===0)return null;const f=[];let y=u;x.forEach(t=>{const i=t.PlayerStats.find(p=>U(p)===u||p.Username.toLowerCase()===u.toLowerCase());if(i){y=X(i);const p=re(ie(i.MainRoleInitial,i.MainRoleChanges||[])),c=ne(t),n=i.Victorious,d=se(new Date(t.StartDate));f.push({gameId:t.Id,date:d,camp:p,won:n,winnerCamp:c,playersInGame:t.PlayerStats.length,mapName:t.MapName})}}),f.sort((t,i)=>{const p=c=>{const n=c.split("/");return n.length===3?new Date(parseInt(n[2]),parseInt(n[1])-1,parseInt(n[0])):new Date(c)};return p(i.date).getTime()-p(t.date).getTime()});const j=f.length,h=f.filter(t=>t.won).length,m=j>0?(h/j*100).toFixed(2):"0.00",g={};f.forEach(t=>{g[t.camp]||(g[t.camp]={appearances:0,wins:0,winRate:"0.00"}),g[t.camp].appearances++,t.won&&g[t.camp].wins++}),Object.keys(g).forEach(t=>{const i=g[t];i.winRate=i.appearances>0?(i.wins/i.appearances*100).toFixed(2):"0.00"});const r={};return f.forEach(t=>{r[t.mapName]||(r[t.mapName]={appearances:0,wins:0,winRate:"0.00"}),r[t.mapName].appearances++,t.won&&r[t.mapName].wins++}),Object.keys(r).forEach(t=>{const i=r[t];i.winRate=i.appearances>0?(i.wins/i.appearances*100).toFixed(2):"0.00"}),{playerName:y,totalGames:j,totalWins:h,winRate:m,games:f,campStats:g,mapStats:r}}function fe(u){const x={};let f=0,y=0;return Object.entries(u).forEach(([j,h])=>{j==="Village"||j==="ChÃ¢teau"?x[j]={...h}:(f+=h.appearances,y+=h.wins)}),f>=10&&(x.Autres={appearances:f,wins:y,winRate:f>0?(y/f*100).toFixed(2):"0.00"}),x}function B(u){const{data:x,isLoading:f,error:y}=le(j=>u?ge(u,j):null);return{data:x,isLoading:f,error:y}}function xe({achievements:u,title:x,emptyMessage:f,achievementType:y="all"}){const{navigateToTab:j,updateNavigationState:h,clearNavigation:m}=H(),{settings:g,updateSettings:r}=O(),{joueursData:t}=_(),i=Y(t),p=(s,N)=>{if(N.stopPropagation(),!s.redirectTo)return;m();const k=g.highlightedPlayer;if(r(y==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:k,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:"all",playerFilter:{mode:"none",players:[]},highlightedPlayer:k,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!1,mapNameFilter:"all",playerFilter:{mode:"none",players:[]}}}),s.category==="comparison"&&s.redirectTo.subTab==="comparison"){const l=g.highlightedPlayer||"",o=c(s.description,l);o&&h({playerComparisonState:{selectedPlayer1:l,selectedPlayer2:o,showDetailedStats:!0}})}if(s.category==="comparison"&&s.redirectTo.subTab==="pairing"){const l=s.description.toLowerCase().includes("loup");h({selectedPairingTab:l?"wolves":"lovers"})}if(s.category==="kills"&&s.redirectTo.subTab==="deathStats"){const l=s.description.match(/(Villageois|Loups|Autres)/i);l&&h({deathStatsSelectedCamp:l[1]});let o=10;const a=s.description.match(/min\.\s*(\d+)/);a&&(o=parseInt(a[1],10));let v="totalKills";const b=s.redirectTo.chartSection;b&&(b==="killers-total"?v="totalKills":b==="killers-average"?v="averageKills":b==="deaths-total"?v="totalDeaths":b==="survivors-average"&&(v="survivalRate")),h({deathStatisticsState:{selectedCamp:l?.[1]||"Tous les camps",minGamesForAverage:o,focusChart:v}})}if(s.category==="map"&&s.redirectTo.subTab==="playersGeneral"){const l=s.redirectTo.mapFilter||"all";let o=10;const a=s.description.match(/min\.\s*(\d+)/);a&&(o=parseInt(a[1])),r(y==="modded"?{gameFilter:"modded",dateRange:{start:null,end:null},mapNameFilter:l,playerFilter:{mode:"none",players:[]},highlightedPlayer:k,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!0,gameFilter:"modded",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:l,playerFilter:{mode:"none",players:[]}}}:{gameFilter:"all",dateRange:{start:null,end:null},mapNameFilter:l,playerFilter:{mode:"none",players:[]},highlightedPlayer:k,useIndependentFilters:!0,independentFilters:{gameTypeEnabled:!1,gameFilter:"all",dateRangeEnabled:!1,dateRange:{start:null,end:null},mapNameEnabled:!0,mapNameFilter:l,playerFilter:{mode:"none",players:[]}}}),h({playersGeneralState:{minGamesForWinRate:o,winRateOrder:"best",focusChart:"winRate"}}),j("players","playersGeneral");return}if(s.category==="history"&&s.redirectTo.subTab==="history"&&h({selectedPlayerName:g.highlightedPlayer||"",groupingMethod:"session"}),s.category==="series"&&s.redirectTo.subTab==="series"){let l="wins";const o=s.title.toLowerCase(),a=s.description.toLowerCase();o.includes("dÃ©faite")||a.includes("dÃ©faite")?l="losses":o.includes("loup")||a.includes("loup")?l="loup":o.includes("villageois")||a.includes("villageois")?l="villageois":(o.includes("victoire")||a.includes("victoire"))&&(l="wins"),h({selectedSeriesType:l})}if(s.category==="general"&&s.redirectTo.subTab==="playersGeneral"){let l=10;const o=s.description.match(/min\.\s*(\d+)/);o&&(l=parseInt(o[1],10));let a="winRate",v="best";const b=s.title.toLowerCase(),R=s.description.toLowerCase();b.includes("participation")||R.includes("participation")?a="participation":(b.includes("taux de victoire")||R.includes("taux de victoire"))&&(a="winRate",(b.includes("moins bon")||b.includes("mauvais")||R.includes("moins bon")||R.includes("mauvais"))&&(v="worst")),h({playersGeneralState:{minGamesForWinRate:l,winRateOrder:v,focusChart:a}})}if(s.category==="performance"&&s.redirectTo.subTab==="campPerformance"){const l=s.redirectTo.chartSection;let o="Villageois",a=1;l&&(l==="camp-loup"?o="Loup":l==="camp-villageois"?o="Villageois":l==="camp-idiot"?o="Idiot du Village":l==="camp-amoureux"?o="Amoureux":(l==="solo-roles"||l==="hall-of-fame")&&(o="Villageois"));const v=s.description.match(/min\.\s*(\d+)/);v&&(a=parseInt(v[1],10)),l==="solo-roles"?o="RÃ´les spÃ©ciaux":l==="hall-of-fame"&&(o="Tous les camps"),h({campPerformanceState:{selectedCampPerformanceCamp:o,selectedCampPerformanceMinGames:a}})}if(s.category==="voting"&&s.redirectTo.subTab==="votingStats"){const l=s.title.toLowerCase();let o="overview",a="behavior";l.includes("agressivitÃ©")?(o="overview",a="behavior"):l.includes("taux de vote")?(o="behavior",a="voteRate"):l.includes("prÃ©cision")&&(o="overview",a="accuracy"),h({votingStatsState:{selectedCategory:o,selectedView:a}})}j(s.redirectTo.tab,s.redirectTo.subTab)},c=(s,N)=>{const k=[/avec ([^:]+?):/,/contre ([^:]+?):/];for(const l of k){const o=s.match(l);if(o&&o[1]){const a=o[1].trim();if(a!==N)return a}}return null},n=s=>{if(!s.redirectTo)return"Aucune navigation disponible";switch(s.category){case"general":if(s.redirectTo.subTab==="playersGeneral"){const l=s.description.match(/min\.\s*(\d+)/),o=l?parseInt(l[1],10):10,a=s.title.toLowerCase(),v=y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return a.includes("taux de victoire")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les taux de victoire (min. ${o} parties)${v}`:a.includes("participation")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les participations${v}`:`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le classement gÃ©nÃ©ral des joueurs${v}`}break;case"map":if(s.redirectTo.subTab==="playersGeneral"){const l=s.redirectTo.mapFilter,o=l==="village"?"Village":l==="chateau"?"ChÃ¢teau":"map",a=y==="modded"?" (Filtres parties moddÃ©es + map activÃ©s)":" (Filtre map activÃ©)";return`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques gÃ©nÃ©rales filtrÃ©es sur ${o}${a}`}break;case"history":if(s.redirectTo.subTab==="history")return"Cliquez pour voir l'historique dÃ©taillÃ© du joueur par map";break;case"comparison":if(s.redirectTo.subTab==="comparison")return`Cliquez pour comparer avec ${c(s.description,g.highlightedPlayer||"")||"ce joueur"}`;if(s.redirectTo.subTab==="pairing")return"Cliquez pour voir les statistiques de paires";break;case"kills":if(s.redirectTo.subTab==="deathStats"){const l=s.description.match(/(Villageois|Loups|Autres)/i),o=s.description.match(/min\.\s*(\d+)/),a=o?parseInt(o[1],10):10,v=l?.[1]||"Tous les camps",b=s.redirectTo.chartSection;let R="kills et morts";return b==="killers-total"?R="total des kills":b==="killers-average"?R=`moyenne des kills (min. ${a} parties)`:b==="deaths-total"?R="total des morts":b==="survivors-average"&&(R=`taux de survie (min. ${a} parties)`),`Cliquez pour voir les statistiques de ${R} ${v!=="Tous les camps"?`en ${v}`:""}`}break;case"series":if(s.redirectTo.subTab==="series"){const l=s.title.toLowerCase(),o=s.description.toLowerCase();return l.includes("dÃ©faite")||o.includes("dÃ©faite")?"Cliquez pour voir les sÃ©ries de dÃ©faites":l.includes("loup")||o.includes("loup")?"Cliquez pour voir les sÃ©ries Loups":l.includes("villageois")||o.includes("villageois")?"Cliquez pour voir les sÃ©ries Villageois":l.includes("victoire")||o.includes("victoire")?"Cliquez pour voir les sÃ©ries de victoires":"Cliquez pour voir les sÃ©ries consÃ©cutives"}break;case"performance":if(s.redirectTo.subTab==="campPerformance"){const l=s.redirectTo.chartSection,o=y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)";return l==="camp-loup"?`Cliquez pour voir les performances camp Loup${o}`:l==="camp-villageois"?`Cliquez pour voir les performances camp Villageois${o}`:l==="camp-idiot"?`Cliquez pour voir les performances camp Idiot du Village${o}`:l==="camp-amoureux"?`Cliquez pour voir les performances camp Amoureux${o}`:l==="solo-roles"?`Cliquez pour voir le classement (rÃ´les spÃ©ciaux)${o}`:l==="hall-of-fame"?`Cliquez pour voir le Hall of Fame (toutes performances)${o}`:`Cliquez pour voir les performances par camp${o}`}break;case"voting":if(s.redirectTo.subTab==="votingStats"){const l=s.description.match(/min\.\s*(\d+)/),o=l?parseInt(l[1],10):25,a=y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)",v=s.title.toLowerCase();return v.includes("agressivitÃ©")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le score d'agressivitÃ© (min. ${o} meetings)${a}`:v.includes("taux de vote")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir le taux de vote (min. ${o} meetings)${a}`:v.includes("prÃ©cision")?`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir la prÃ©cision des votes${a}`:`Classement: ${s.rank}${s.totalRanked?`/${s.totalRanked} joueurs`:""} - Cliquez pour voir les statistiques de vote${a}`}break}return`Cliquez pour voir ${s.redirectTo.subTab}`+(y==="modded"?" (Filtre parties moddÃ©es activÃ©)":" (Filtres rÃ©initialisÃ©s)")},d=s=>i[s]||oe(s),w=s=>{const N=[/avec ([^:]+?):/,/contre ([^:]+?):/];let k=s;return N.forEach(l=>{const o=s.match(l);if(o&&o[1]){const a=o[1].trim(),b=`<span class="player-name-highlight" style="color: ${d(a)};">${a}</span>`;k=k.replace(a,b)}}),k};if(u.length===0)return e.jsxs("div",{className:"achievements-empty",children:[e.jsx("h4",{children:x}),e.jsx("p",{children:f||"Aucun succÃ¨s dans cette catÃ©gorie"})]});const C=s=>s===1?"ðŸ¥‡":s===2?"ðŸ¥ˆ":s===3?"ðŸ¥‰":"",$=s=>s===1?"rank-1":s===2?"rank-2":s===3?"rank-3":s&&s<=10?"rank-top-10":"",S=u.filter(s=>s.category!=="comparison"&&(s.type==="good"||s.type==="neutral")).sort((s,N)=>(s.rank??999)-(N.rank??999)),F=u.filter(s=>s.category!=="comparison"&&s.type==="bad").sort((s,N)=>(s.rank??999)-(N.rank??999)),P=u.filter(s=>s.category==="comparison"),W=S.filter(s=>s.rank&&s.rank<=3).length;return e.jsxs("div",{className:"achievements-container",children:[e.jsx("h4",{children:x}),W>0&&e.jsxs("div",{className:"top3-showcase",children:[e.jsx("h5",{className:"top3-title",children:"âœ¨ Podium d'Excellence âœ¨"}),e.jsx("div",{className:"top3-grid",children:S.filter(s=>s.rank&&s.rank<=3).map((s,N)=>e.jsxs("div",{className:`top3-card ${$(s.rank)} animate-slide-in`,style:{animationDelay:`${N*.15}s`},onClick:k=>p(s,k),title:n(s),children:[e.jsx("div",{className:"top3-medal-container",children:e.jsx("span",{className:"top3-medal",children:C(s.rank)})}),e.jsxs("div",{className:"top3-content",children:[e.jsxs("div",{className:"top3-rank-badge",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]}),e.jsx("h6",{className:"top3-achievement-title",children:s.title}),e.jsx("p",{className:"top3-achievement-description",children:s.description})]}),e.jsxs("div",{className:"top3-sparkles",children:[e.jsx("span",{className:"sparkle sparkle-1",children:"âœ¨"}),e.jsx("span",{className:"sparkle sparkle-2",children:"â­"}),e.jsx("span",{className:"sparkle sparkle-3",children:"âœ¨"})]})]},s.id))})]}),S.length>0&&e.jsxs("div",{className:"achievements-section good-achievements",children:[e.jsx("h5",{children:"ðŸ† Classements"}),e.jsx("div",{className:"achievements-grid",children:S.filter(s=>!s.rank||s.rank>3).map((s,N)=>e.jsxs("div",{className:`achievement-card good ${$(s.rank)}`,onClick:k=>p(s,k),title:n(s),style:{animationDelay:`${N*.05}s`},children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:s.title}),e.jsxs("span",{className:"achievement-rank",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:s.description})]},s.id))})]}),F.length>0&&e.jsxs("div",{className:"achievements-section bad-achievements",children:[e.jsx("h5",{children:"ðŸ’€ Classements (InversÃ©s)"}),e.jsx("div",{className:"achievements-grid",children:F.map(s=>e.jsxs("div",{className:`achievement-card bad rank-${s.rank}`,onClick:N=>p(s,N),title:n(s),children:[e.jsxs("div",{className:"achievement-header",children:[e.jsx("span",{className:"achievement-title",children:s.title}),e.jsxs("span",{className:"achievement-rank",children:["#",s.rank,s.totalRanked?`/${s.totalRanked}`:""]})]}),e.jsx("p",{className:"achievement-description",children:s.description})]},s.id))})]}),P.length>0&&e.jsxs("div",{className:"achievements-section comparison-achievements",children:[e.jsx("h5",{children:"ðŸ“Š Statistiques Face-Ã -Face"}),e.jsx("div",{className:"achievements-grid",children:P.map(s=>e.jsxs("div",{className:"achievement-card comparison",onClick:N=>p(s,N),title:n(s),children:[e.jsx("div",{className:"achievement-header",children:e.jsx("span",{className:"achievement-title",children:s.title})}),e.jsx("p",{className:"achievement-description",dangerouslySetInnerHTML:{__html:w(s.description)}})]},s.id))})]})]})}function ve({selectedPlayerName:u,groupingMethod:x,campFilter:f="all"}){const{navigateToGameDetails:y}=H(),{data:j,isLoading:h,error:m}=B(u),g=T.useMemo(()=>{switch(x){case"month":return"par Mois";case"quarter":return"par Trimestre";case"year":return"par AnnÃ©e";default:return"par Session"}},[x]),r=T.useMemo(()=>{if(!j?.games)return new Map;const c=new Map;return j.games.forEach(n=>{if(!c.has(n.date)){const d=n.date.split("/");d.length===3?c.set(n.date,new Date(parseInt(d[2]),parseInt(d[1])-1,parseInt(d[0])).getTime()):c.set(n.date,new Date(n.date).getTime())}}),c},[j?.games]),t=T.useMemo(()=>{if(!j?.games)return[];const c={};return j.games.forEach(n=>{if(f!=="all"){if(f==="solo"){if(n.camp==="Villageois"||n.camp==="Loup")return}else if(n.camp!==f)return}let d;const w=n.date.split("/");if(x==="month")if(w.length===3)d=`${w[1].padStart(2,"0")}/${w[2]}`;else{const C=new Date(n.date);d=`${String(C.getMonth()+1).padStart(2,"0")}/${C.getFullYear()}`}else if(x==="quarter")if(w.length===3){const C=parseInt(w[1],10);d=`T${Math.floor((C-1)/3)+1}/${w[2]}`}else{const C=new Date(n.date);d=`T${Math.floor(C.getMonth()/3)+1}/${C.getFullYear()}`}else x==="year"?w.length===3?d=`${w[2]}`:d=`${new Date(n.date).getFullYear()}`:d=n.date;c[d]||(c[d]={games:[],wins:0,total:0}),c[d].games.push(n),c[d].total++,n.won&&c[d].wins++}),Object.entries(c).map(([n,d])=>({period:n,totalGames:d.total,victories:d.wins,defeats:d.total-d.wins,winRate:d.total>0?(d.wins/d.total*100).toFixed(1):"0.0",winRateNum:d.total>0?d.wins/d.total*100:0})).sort((n,d)=>{if(x==="month"){const[w,C]=n.period.split("/"),[$,S]=d.period.split("/"),F=new Date(parseInt(C),parseInt(w)-1,1),P=new Date(parseInt(S),parseInt($)-1,1);return F.getTime()-P.getTime()}else if(x==="quarter"){const[w,C]=n.period.split("/"),[$,S]=d.period.split("/"),F=parseInt(w.replace(/\D/g,""),10)||1,P=parseInt($.replace(/\D/g,""),10)||1,W=new Date(parseInt(C,10),(F-1)*3,1),s=new Date(parseInt(S,10),(P-1)*3,1);return W.getTime()-s.getTime()}else if(x==="year"){const w=parseInt(n.period,10),C=parseInt(d.period,10);return w-C}else{const w=r.get(n.period)||0,C=r.get(d.period)||0;return w-C}})},[j,x,r,f]),p=(c=>c<=15?{fontSize:12,angle:-45,height:80,interval:0}:c<=30?{fontSize:12,angle:-45,height:85,interval:1}:c<=50?{fontSize:12,angle:-60,height:95,interval:2}:{fontSize:12,angle:-75,height:105,interval:Math.floor(c/12)})(t.length);return h?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):m?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",m]}):j?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["Ã‰volution des Performances ",g]}),e.jsx(z,{title:`Ã‰volution des Performances ${g}`,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(de,{data:t,margin:{top:20,right:30,left:20,bottom:20},onClick:c=>{if(c&&c.activeLabel){const n=t.find(d=>d.period===c.activeLabel);n&&y({selectedPlayer:u,selectedDate:n.period,fromComponent:`Ã‰volution des Performances ${g}`})}},style:{cursor:"pointer"},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"period",angle:p.angle,textAnchor:"end",height:p.height,interval:p.interval,fontSize:p.fontSize}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:c,payload:n})=>{if(c&&n&&n.length>0){const d=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:d.period})}),e.jsxs("div",{children:["Parties: ",d.totalGames]}),e.jsxs("div",{children:["Victoires: ",d.victories]}),e.jsxs("div",{children:["Taux: ",d.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(ue,{type:"monotone",dataKey:"winRateNum",stroke:"var(--accent-primary)",strokeWidth:2,dot:{fill:"var(--accent-primary)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsxs("h3",{children:["RÃ©partition Victoires/DÃ©faites ",g]}),e.jsx(z,{title:`RÃ©partition Victoires/DÃ©faites ${g}`,children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:t,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"period",angle:p.angle,textAnchor:"end",height:p.height,interval:p.interval,fontSize:p.fontSize}),e.jsx(E,{label:{value:"Nombre de parties",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:c,payload:n})=>{if(c&&n&&n.length>0){const d=n[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:d.period})}),e.jsxs("div",{children:["Total: ",d.totalGames," parties"]}),e.jsxs("div",{children:["Victoires: ",d.victories]}),e.jsxs("div",{children:["DÃ©faites: ",d.defeats]}),e.jsxs("div",{children:["Taux: ",d.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(V,{dataKey:"victories",stackId:"games",fill:"var(--accent-tertiary)",name:"Victoires",children:t.map((c,n)=>e.jsx(A,{fill:"var(--accent-tertiary)",onClick:()=>{y({selectedPlayer:u,selectedDate:c.period,fromComponent:`Historique Joueur - Victoires ${g}`})},style:{cursor:"pointer"}},`cell-victories-${n}`))}),e.jsx(V,{dataKey:"defeats",stackId:"games",fill:"var(--chart-color-4)",name:"DÃ©faites",children:t.map((c,n)=>e.jsx(A,{fill:"var(--chart-color-4)",onClick:()=>{y({selectedPlayer:u,selectedDate:c.period,fromComponent:`Historique Joueur - DÃ©faites ${g}`})},style:{cursor:"pointer"}},`cell-defeats-${n}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function je({selectedPlayerName:u}){const{navigateToGameDetails:x}=H(),{data:f,isLoading:y,error:j}=B(u),h=ce(),m=T.useMemo(()=>f?.campStats?Object.entries(f.campStats).map(([r,t])=>({name:r,value:t.appearances,winRate:t.winRate,winRateDisplay:Math.max(parseFloat(t.winRate),1),wins:t.wins,percentage:(t.appearances/f.totalGames*100).toFixed(1)})):[],[f]),g=T.useMemo(()=>{if(!m.length)return[];const r=5;let t=0;const i=[],p=[];if(m.forEach(c=>{parseFloat(c.percentage)<r?(t+=Number(c.value),i.push(c)):p.push(c)}),t>0){const c=m.reduce((n,d)=>n+Number(d.value),0);p.push({name:"Autres",value:t,winRate:"0.0",winRateDisplay:1,wins:i.reduce((n,d)=>n+d.wins,0),percentage:(t/c*100).toFixed(1),_details:i})}return p},[m]);return y?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):j?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",j]}):f?e.jsxs("div",{className:"lycans-graphiques-groupe",children:[e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Distribution par Camps"}),e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(me,{children:[e.jsx(pe,{data:g,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,fill:"#8884d8",dataKey:"value",label:r=>{const t=r.percent!==void 0?r.percent:0;return r.name==="Autres"?`Autres : ${r.value} (${(t*100).toFixed(1)}%)`:`${r.name}: ${r.value} (${(t*100).toFixed(1)}%)`},children:g.map((r,t)=>e.jsx(A,{fill:r.name==="Autres"?Q:h[r.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{if(r.name==="Autres"){const i=r._details?.map(p=>p.name)||[];x({selectedPlayer:u,campFilter:{selectedCamp:"Autres",campFilterMode:"all-assignments",_smallCamps:i},fromComponent:"Distribution par Camps"})}else r.name==="TraÃ®tre"||r.name==="Louveteau"?x({selectedPlayer:u,campFilter:{selectedCamp:r.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):r.name==="Loup"?x({selectedPlayer:u,campFilter:{selectedCamp:"Loup",campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Distribution par Camps"}):x({selectedPlayer:u,campFilter:{selectedCamp:r.name,campFilterMode:"all-assignments"},fromComponent:"Distribution par Camps"})},style:{cursor:"pointer"}},`cell-${t}`))}),e.jsx(G,{content:({active:r,payload:t})=>{if(r&&t&&t.length>0){const i=t[0].payload;if(i.name==="Autres"&&i._details){const p=[...i._details].sort((c,n)=>n.value-c.value);return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:["Autres - ",i.value," parties (",i.percentage,"%)"]})}),e.jsx("div",{children:p.map((c,n)=>e.jsxs("div",{children:[c.name,": ",c.value," parties (",c.percentage,"%)"]},n))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--chart-color-1)",marginTop:"0.25rem",fontStyle:"italic"},children:"Cliquez pour voir toutes les parties de ces camps"})]})}return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsxs("strong",{children:[i.name," - ",i.value," parties (",i.percentage,"%)"]})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}})]})})})]}),e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Camp"}),e.jsx(z,{title:"Performance par Camp",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:m,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(G,{content:({active:r,payload:t})=>{if(r&&t&&t.length>0){const i=t[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:i.name})}),e.jsxs("div",{children:["Victoires: ",i.wins," / ",i.value]}),e.jsxs("div",{children:["Taux: ",i.winRate,"%"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(V,{dataKey:"winRateDisplay",children:m.map((r,t)=>e.jsx(A,{fill:parseFloat(r.winRate)===0?`${h[r.name]||`var(--chart-color-${t%6+1})`}50`:h[r.name]||`var(--chart-color-${t%6+1})`,onClick:()=>{r.name==="TraÃ®tre"||r.name==="Louveteau"?x({selectedPlayer:u,campFilter:{selectedCamp:r.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):r.name==="Loup"?x({selectedPlayer:u,campFilter:{selectedCamp:r.name,campFilterMode:"all-assignments",excludeWolfSubRoles:!0},fromComponent:"Performance par Camp"}):x({selectedPlayer:u,campFilter:{selectedCamp:r.name,campFilterMode:"all-assignments"},fromComponent:"Performance par Camp"})},style:{cursor:"pointer"}},`cell-${t}`))})]})})})})]})]}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function ye({selectedPlayerName:u}){const{navigateToGameDetails:x}=H(),{data:f,isLoading:y,error:j}=B(u),h=T.useMemo(()=>{if(!f?.mapStats)return[];const m=fe(f.mapStats);return Object.entries(m).map(([g,r])=>({name:g,value:r.appearances,winRate:r.winRate,winRateDisplay:Math.max(parseFloat(r.winRate),.1),wins:r.wins,percentage:(r.appearances/f.totalGames*100).toFixed(1)}))},[f]);return y?e.jsx("div",{className:"donnees-attente",children:"Chargement de l'historique du joueur..."}):j?e.jsxs("div",{className:"donnees-probleme",children:["Erreur: ",j]}):f?h.length===0?e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune donnÃ©e de carte disponible"}),e.jsx("p",{children:"Aucune statistique de carte n'est disponible pour ce joueur."})]}):e.jsx("div",{className:"lycans-graphiques-groupe",children:e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"Performance par Carte"}),e.jsx(z,{title:"Performance par Carte",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:h,margin:{top:20,right:140,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"name",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Taux de victoire (%)",angle:270,position:"left",style:{textAnchor:"middle"}},domain:[0,100]}),e.jsx(J,{y:50,stroke:"var(--text-secondary)",strokeDasharray:"5 5",strokeOpacity:.5}),(()=>{if(h.length>0){const m=h.reduce((t,i)=>t+i.value,0),g=h.reduce((t,i)=>t+i.wins,0),r=m>0?g/m*100:0;if(r!==50)return e.jsx(J,{y:r,stroke:"var(--accent-primary)",strokeDasharray:"3 3",strokeOpacity:.7,label:{value:`Moyenne: ${r.toFixed(1)}%`,position:"right",offset:5,style:{fill:"var(--accent-primary)"}}})}return null})(),e.jsx(G,{content:({active:m,payload:g})=>{if(m&&g&&g.length>0){const r=g[0].payload,t=[];return h.forEach(i=>{if(i.name!==r.name&&i.value>=5){const p=parseFloat(r.winRate)-parseFloat(i.winRate);Math.abs(p)>=2&&t.push({map:i.name,diff:p,better:p>0})}}),e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)",maxWidth:"250px"},children:[e.jsx("div",{children:e.jsx("strong",{children:r.name})}),e.jsxs("div",{children:["Parties: ",r.value]}),e.jsxs("div",{children:["Victoires: ",r.wins]}),e.jsx("div",{style:{marginBottom:"0.5rem"},children:e.jsxs("strong",{children:["Taux: ",r.winRate,"%"]})}),t.length>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",marginBottom:"0.25rem"},children:"Comparaisons:"}),t.map((i,p)=>e.jsxs("div",{style:{fontSize:"0.75rem",color:i.better?"var(--accent-tertiary)":"var(--chart-color-4)"},children:[i.better?"â†—":"â†˜"," ",Math.abs(i.diff).toFixed(1),"% vs ",i.map]},p))]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--accent-primary)",marginTop:"0.5rem",fontWeight:"bold",textAlign:"center",animation:"pulse 1.5s infinite"},children:"ðŸ–±ï¸ Cliquez pour voir les parties"})]})}return null}}),e.jsx(V,{dataKey:"winRateDisplay",label:m=>{const{x:g,y:r,width:t,payload:i}=m;if(g===void 0||r===void 0||t===void 0||!i)return null;const p=i.winRate||"0";return e.jsxs("text",{x:g+t/2,y:r-5,fill:"var(--text-primary)",textAnchor:"middle",fontSize:"12",fontWeight:"bold",children:[p,"%"]})},onClick:m=>{m&&m.name&&x({selectedPlayer:u,selectedMapName:m.name,fromComponent:"Performance par Carte"})},children:h.map((m,g)=>{let r;m.name==="Village"?r="var(--accent-secondary)":m.name==="ChÃ¢teau"?r="var(--accent-tertiary)":m.name==="Autres"?r=Q:r=`var(--chart-color-${g%6+1})`;const t=Math.max(...h.map(p=>parseFloat(p.winRate))),i=parseFloat(m.winRate)===t&&t>0;return e.jsx(A,{fill:parseFloat(m.winRate)===0?`${r}30`:r,stroke:"transparent",strokeWidth:i?3:1,style:{cursor:"pointer"}},`cell-map-${g}`)})})]})})})})]})}):e.jsx("div",{className:"donnees-manquantes",children:"Aucune donnÃ©e d'historique disponible"})}function be({selectedPlayerName:u}){const{gameData:x}=ae(),{joueursData:f}=_(),y=Y(f),j=T.useMemo(()=>{if(!x||!u)return{playersKilled:[],killedBy:[]};const h={},m={};x.forEach(t=>{const i=t.PlayerStats.find(p=>p.Username.toLowerCase()===u.toLowerCase());i&&(t.PlayerStats.forEach(p=>{p.KillerName?.toLowerCase()===u.toLowerCase()&&(h[p.Username]=(h[p.Username]||0)+1)}),i.KillerName&&(m[i.KillerName]=(m[i.KillerName]||0)+1))});const g=Object.entries(h).map(([t,i])=>({player:t,kills:i})).sort((t,i)=>i.kills-t.kills).slice(0,10),r=Object.entries(m).map(([t,i])=>({player:t,kills:i})).sort((t,i)=>i.kills-t.kills).slice(0,10);return{playersKilled:g,killedBy:r}},[x,u]);return e.jsxs("div",{className:"lycans-graphiques-groupe",children:[j.playersKilled.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"A tuÃ© le plus souvent"}),e.jsx(z,{title:"A tuÃ© le plus souvent",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:j.playersKilled,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:h,payload:m})=>{if(h&&m&&m.length>0){const g=m[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:g.player})}),e.jsxs("div",{children:["TuÃ© ",g.kills," fois par ",u]})]})}return null}}),e.jsx(V,{dataKey:"kills",children:j.playersKilled.map((h,m)=>e.jsx(A,{fill:y[h.player]||"var(--chart-color-3)"},`cell-killed-${m}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucun kill enregistrÃ©"}),e.jsxs("p",{children:[u," n'a tuÃ© aucun joueur dans les parties enregistrÃ©es."]})]}),j.killedBy.length>0?e.jsxs("div",{className:"lycans-graphique-section",children:[e.jsx("h3",{children:"A Ã©tÃ© tuÃ© le plus souvent"}),e.jsx(z,{title:"A Ã©tÃ© tuÃ© le plus souvent",children:e.jsx("div",{style:{height:400},children:e.jsx(q,{width:"100%",height:"100%",children:e.jsxs(K,{data:j.killedBy,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(M,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"player",angle:-45,textAnchor:"end",height:90,interval:0,fontSize:14}),e.jsx(E,{label:{value:"Nombre de kills",angle:270,position:"left",style:{textAnchor:"middle"}},allowDecimals:!1}),e.jsx(G,{content:({active:h,payload:m})=>{if(h&&m&&m.length>0){const g=m[0].payload;return e.jsxs("div",{style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:12,borderRadius:8,border:"1px solid var(--border-color)"},children:[e.jsx("div",{children:e.jsx("strong",{children:g.player})}),e.jsxs("div",{children:["A tuÃ© ",u," ",g.kills," fois"]})]})}return null}}),e.jsx(V,{dataKey:"kills",children:j.killedBy.map((h,m)=>e.jsx(A,{fill:y[h.player]||"var(--chart-color-4)"},`cell-killer-${m}`))})]})})})})]}):e.jsxs("div",{className:"lycans-empty-section",children:[e.jsx("h3",{children:"Aucune mort par kill"}),e.jsxs("p",{children:[u," n'a jamais Ã©tÃ© tuÃ© par un autre joueur dans les parties enregistrÃ©es."]})]})]})}function Ge(){const{settings:u,updateSettings:x}=O(),{navigateToGameDetails:f}=H(),{data:y,isLoading:j,error:h}=te(),{joueursData:m,isLoading:g}=_(),{data:r,isLoading:t,error:i}=he(u.highlightedPlayer),p=Y(m),[c,n]=T.useState(""),[d,w]=T.useState("all"),[C,$]=T.useState("achievements"),[S,F]=T.useState("session"),[P,W]=T.useState("all"),{data:s}=B(u.highlightedPlayer||""),N=T.useMemo(()=>{if(!y||!y.GameStats)return[];const a=new Map;return y.GameStats.forEach(v=>{const b=new Date(v.StartDate);v.PlayerStats.forEach(R=>{const D=U(R),Z=m?.Players?.find(ee=>ee.ID===D)?.Joueur||X(R);a.has(D)||a.set(D,{games:0,wins:0,firstDate:b,lastDate:b,displayName:Z});const L=a.get(D);L.games++,R.Victorious&&L.wins++,b<L.firstDate&&(L.firstDate=b),b>L.lastDate&&(L.lastDate=b)})}),Array.from(a.entries()).map(([v,b])=>{let R=m?.Players?.find(D=>D.ID===v);return R||(R=m?.Players?.find(D=>D.Joueur===b.displayName)),{name:b.displayName,totalGames:b.games,totalWins:b.wins,winRate:b.games>0?b.wins/b.games*100:0,firstGameDate:b.firstDate.toLocaleDateString("fr-FR"),lastGameDate:b.lastDate.toLocaleDateString("fr-FR"),isHighlighted:b.displayName===u.highlightedPlayer,image:R?.Image||null,twitch:R?.Twitch||null,youtube:R?.Youtube||null}})},[y,u.highlightedPlayer,m]),k=T.useMemo(()=>{if(!c.trim())return N;const a=c.toLowerCase();return N.filter(v=>v.name.toLowerCase().includes(a))},[N,c]),l=T.useMemo(()=>[...k].sort((a,v)=>v.totalGames-a.totalGames),[k]),o=a=>{x({highlightedPlayer:a}),n("")};return j||g?e.jsxs("div",{className:"player-selection-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des joueurs..."})]}):h?e.jsxs("div",{className:"player-selection-error",children:[e.jsx("h2",{children:"Erreur"}),e.jsxs("p",{children:["Impossible de charger les donnÃ©es des joueurs: ",h]})]}):!y||N.length===0?e.jsxs("div",{className:"player-selection-empty",children:[e.jsx("h2",{children:"Aucune donnÃ©e disponible"}),e.jsx("p",{children:"Aucun joueur trouvÃ© dans les donnÃ©es."})]}):e.jsxs("div",{className:"player-selection-container",children:[!u.highlightedPlayer&&e.jsxs("div",{className:"search-controls-header",children:[e.jsxs("div",{className:"selection-prompt-content",children:[e.jsx("h2",{children:"SÃ©lectionnez un joueur"}),e.jsx("p",{children:"Choisissez un joueur pour le mettre en Ã©vidence dans tous les graphiques."})]}),e.jsxs("div",{className:"search-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Rechercher un joueur...",value:c,onChange:a=>n(a.target.value),className:"search-input"}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"player-count",children:[k.length," joueur",k.length!==1?"s":"",c&&` (filtrÃ©${k.length!==1?"s":""} de ${N.length})`]})]})]}),e.jsx("div",{className:"player-display",children:c?k.length>0?e.jsxs("div",{className:"search-results",children:[e.jsxs("div",{className:"search-results-header",children:[e.jsx("h3",{children:"RÃ©sultats de recherche:"}),e.jsx("button",{className:"clear-search-btn",onClick:()=>n(""),children:"Effacer la recherche"})]}),e.jsx("div",{className:"suggestion-list",children:l.map(a=>e.jsxs("button",{className:`suggestion-btn ${a.isHighlighted?"highlighted":""}`,onClick:()=>o(a.name),children:[a.image?e.jsx("img",{src:a.image,alt:a.name,className:"player-avatar"}):e.jsx("div",{className:"player-avatar-default",style:{"--player-color":p[a.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"suggestion-btn-content",children:[e.jsxs("div",{className:"suggestion-btn-name",children:[a.name,a.isHighlighted&&e.jsx("span",{className:"highlight-indicator",children:" â˜…"})]}),e.jsxs("div",{className:"suggestion-btn-stats",children:[a.totalGames," parties â€¢ ",a.winRate.toFixed(1),"% victoires"]})]})]},a.name))})]}):e.jsxs("div",{className:"no-results",children:[e.jsxs("p",{children:['Aucun joueur trouvÃ© pour "',c,'"']}),e.jsx("button",{className:"clear-search-btn",onClick:()=>n(""),children:"Effacer la recherche"})]}):u.highlightedPlayer?(()=>{const a=N.find(v=>v.name===u.highlightedPlayer);return a?e.jsxs("div",{className:"single-player-card highlighted",children:[e.jsxs("div",{className:"player-card-header",children:[e.jsx("h3",{className:"player-name",children:a.name}),e.jsx("span",{className:"highlight-badge",children:"â˜… Mis en Ã©vidence"})]}),e.jsxs("div",{className:"player-info-row",children:[a.image?e.jsx("img",{src:a.image,alt:a.name,className:"player-avatar large"}):e.jsx("div",{className:"player-avatar-default large",style:{"--player-color":p[a.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"player-avatar-overlay"})}),e.jsxs("div",{className:"player-info-text",children:[e.jsxs("div",{className:"player-stats-summary",children:[a.totalGames," parties â€¢ ",a.totalWins," victoires â€¢ ",a.winRate.toFixed(1),"% taux de victoire"]}),(a.twitch||a.youtube)&&e.jsxs("div",{className:"social-links",children:[a.twitch&&e.jsx("a",{href:a.twitch,target:"_blank",rel:"noopener noreferrer",className:"social-link twitch",children:"ðŸ“º Twitch"}),a.youtube&&e.jsx("a",{href:a.youtube,target:"_blank",rel:"noopener noreferrer",className:"social-link youtube",children:"ðŸŽ¬ YouTube"})]})]})]}),e.jsxs("div",{className:"player-actions",children:[e.jsxs("div",{className:"lycans-categories-selection",style:{marginBottom:"1rem"},children:[e.jsx("button",{className:`lycans-categorie-btn ${C==="achievements"?"active":""}`,onClick:()=>$("achievements"),children:"Classement"}),e.jsx("button",{className:`lycans-categorie-btn ${C==="evolution"?"active":""}`,onClick:()=>$("evolution"),children:"Ã‰volution"}),e.jsx("button",{className:`lycans-categorie-btn ${C==="camps"?"active":""}`,onClick:()=>$("camps"),children:"Camps"}),e.jsx("button",{className:`lycans-categorie-btn ${C==="maps"?"active":""}`,onClick:()=>$("maps"),children:"Maps"}),e.jsx("button",{className:`lycans-categorie-btn ${C==="kills"?"active":""}`,onClick:()=>$("kills"),children:"Kills"})]}),C==="achievements"&&e.jsxs("div",{className:"achievements-section",children:[t?e.jsxs("div",{className:"achievements-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Chargement des classements..."})]}):i?e.jsx("div",{className:"achievements-error",children:e.jsxs("p",{children:["âŒ Erreur lors du chargement des classements: ",i]})}):r?e.jsx(xe,{achievements:d==="all"?r.allGamesAchievements:r.moddedOnlyAchievements,title:d==="all"?"Classements - Toutes les parties":"Classements - Parties moddÃ©es",emptyMessage:"Aucun classement dans cette catÃ©gorie",achievementType:d}):e.jsx("div",{className:"achievements-empty",children:e.jsx("p",{children:"Aucun classement disponible pour ce joueur"})}),e.jsxs("div",{className:"achievements-filter",children:[e.jsx("button",{className:`filter-btn ${d==="all"?"active":""}`,onClick:v=>{v.stopPropagation(),w("all")},children:"Toutes les parties"}),e.jsx("button",{className:`filter-btn ${d==="modded"?"active":""}`,onClick:v=>{v.stopPropagation(),w("modded")},children:"Parties moddÃ©es"})]})]}),C==="evolution"&&e.jsxs("div",{className:"player-history-section",children:[s&&e.jsxs("div",{className:"lycans-resume-conteneur",children:[e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Total Parties"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{f({selectedPlayer:a.name,fromComponent:"Historique Joueur - Total Parties"})},title:`Cliquer pour voir toutes les parties de ${a.name}`,children:s.totalGames}),e.jsx("p",{children:"parties jouÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Victoires"}),e.jsx("div",{className:"lycans-valeur-principale lycans-clickable",onClick:()=>{f({selectedPlayer:a.name,selectedPlayerWinMode:"wins-only",fromComponent:"Historique Joueur - Victoires"})},title:`Cliquer pour voir toutes les victoires de ${a.name}`,children:s.totalWins}),e.jsx("p",{children:"parties gagnÃ©es"})]}),e.jsxs("div",{className:"lycans-stat-carte",children:[e.jsx("h3",{children:"Taux de Victoire"}),e.jsxs("div",{className:"lycans-valeur-principale",children:[s.winRate,"%"]}),e.jsx("p",{children:"pourcentage global"})]})]}),e.jsxs("div",{className:"lycans-controls-section",style:{display:"flex",gap:"2rem",marginBottom:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"grouping-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Groupement:"}),e.jsxs("select",{id:"grouping-select",value:S,onChange:v=>F(v.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"session",children:"Par session"}),e.jsx("option",{value:"month",children:"Par mois"}),e.jsx("option",{value:"quarter",children:"Par trimestre"}),e.jsx("option",{value:"year",children:"Par annÃ©e"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("label",{htmlFor:"camp-filter-select",style:{color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Camp:"}),e.jsxs("select",{id:"camp-filter-select",value:P,onChange:v=>W(v.target.value),style:{background:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"4px",padding:"0.5rem",fontSize:"0.9rem",minWidth:"160px"},children:[e.jsx("option",{value:"all",children:"Tous les camps"}),e.jsx("option",{value:"Villageois",children:"Villageois"}),e.jsx("option",{value:"Loup",children:"Loups"}),e.jsx("option",{value:"solo",children:"RÃ´les solo"})]})]})]}),e.jsx(ve,{selectedPlayerName:a.name,groupingMethod:S,campFilter:P})]}),C==="camps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(je,{selectedPlayerName:a.name})}),C==="maps"&&e.jsx("div",{className:"player-history-section",children:e.jsx(ye,{selectedPlayerName:a.name})}),C==="kills"&&e.jsx("div",{className:"player-history-section",children:e.jsx(be,{selectedPlayerName:a.name})}),e.jsx("button",{className:"highlight-btn active",onClick:v=>{v.stopPropagation(),x({highlightedPlayer:null})},children:"â˜… Retirer la mise en Ã©vidence"})]}),e.jsxs("div",{className:"player-period",children:[e.jsx("span",{className:"period-label",children:"PÃ©riode d'activitÃ©:"}),e.jsxs("span",{className:"period-range",children:[a.firstGameDate," - ",a.lastGameDate]})]})]}):e.jsxs("div",{className:"no-player-found",children:[e.jsxs("p",{children:['Le joueur "',u.highlightedPlayer,`" n'a pas Ã©tÃ© trouvÃ© dans les donnÃ©es.`]}),e.jsx("button",{className:"clear-selection-btn",onClick:()=>x({highlightedPlayer:null}),children:"Effacer la sÃ©lection"})]})})():e.jsx("div",{className:"player-selection-prompt",children:e.jsx("div",{className:"character-selection-grid",children:l.map(a=>e.jsxs("div",{className:`character-card ${a.isHighlighted?"highlighted":""}`,onClick:()=>o(a.name),title:`${a.name} - ${a.totalGames} parties, ${a.winRate.toFixed(1)}% victoires`,children:[e.jsx("div",{className:"character-avatar-container",children:a.image?e.jsx("img",{src:a.image,alt:a.name,className:"character-avatar"}):e.jsx("div",{className:"character-avatar-default",style:{"--player-color":p[a.name]||"var(--accent-primary)"},children:e.jsx("div",{className:"character-avatar-overlay"})})}),e.jsx("div",{className:"character-name",children:a.name}),(a.twitch||a.youtube)&&e.jsxs("div",{className:"character-social-indicators",children:[a.twitch&&e.jsx("div",{className:"social-indicator twitch",title:"Twitch",children:"T"}),a.youtube&&e.jsx("div",{className:"social-indicator youtube",title:"YouTube",children:"Y"})]})]},a.name))})})})]})}export{Ge as PlayerSelectionPage};
